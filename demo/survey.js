(()=>{var t={8759:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,'.editor-header {\n    position: relative;\n    display: flex; flex-direction: column;\n    max-height: 50%;\n    color: #333;\n    background-color: #fff;\n    z-index: 10;\n}\n    \n    .editor-header.collapsed .editor-header-main {\n        height: 0;\n        padding: 0;\n        opacity: 0.2;\n        overflow: hidden;\n    }\n\n.editor-header-menu {\n    display: flex; flex-direction: row;\n    justify-content: space-between;\n    height: 30px;\n    align-items: center;\n    background-color: #f5f5f5;\n    padding-left: 1%; \n}\n\n.editor-header-main {\n    display: flex;\n    flex-grow: 1;\n    padding: 6px 1% 4px;\n    background: #fff;\n    overflow: auto;\n}\n\n    .editor-header-title {\n        font: 600 1.3rem \'Segoe UI\', \'Droid Sans\', Ubuntu, \'Lucida Grande\', Arial, sans-serif;\n        color: #555;\n    }\n\n/*\n  Tabs\n-----------------------------------------------------------------------------*/\n\n.editor-header-tabs {\n    align-self: flex-start;\n    display: flex;\n    padding-left: 1%; padding-right: 1%;\n    justify-content: center;\n    height: 100%;\n    cursor: default;\n    background-color: #fff;\n}\n\n    .editor-header-tab {\n        position: relative;\n        padding-left: 12px; padding-right: 12px;\n        line-height: 34px;\n        font-size: 1.4rem;\n        background-color: #eee;\n        transition: .2s;\n    }\n\n        .editor-header-tab.selected {\n            background-color: #fff;\n            font-weight: 600;\n            color: #555;\n            height: 100%;\n            z-index: 5;\n        }\n            .editor-header-tab.selected:after {\n                content: "";\n                position: absolute;\n                right: 4px; left: 4px; bottom: 2px;\n                height: 4px;\n                border-radius: 180px;\n                background-color: #d5d5d5;\n            }\n        .editor-header-tab:not(.selected) {\n            transform: scale(0.85);\n            border-radius: 4px;\n        }\n            .editor-header-tab:not(.selected):hover {\n                background-color: #f0f0f0;\n                transform: scale(0.95);\n            }\n        .editor-header-tab:not(:last-child) {\n            margin-right: 4px;\n        }\n    \n    .editor-selector__notification {\n        position: absolute;\n        top: 0; right: 0;\n        font-style: normal;\n        width: 24px; height: 24px;\n        font-weight: bold;\n        text-align: center;\n        line-height: 24px;\n        color: #fff;\n        border-radius: 50%;\n        background-color: #e01f5fc9;\n        box-shadow: 1px 2px 2px #555;\n        transform: translate(50%, -10%);\n    }\n\n\n/*\n    Selectors\n-----------------------------------------------------------------------------*/\n\n.editor-selectors {\n    display: flex; align-items: flex-start;\n}\n    .editor-selector {\n        position: relative;\n        display: flex;\n        margin-right: 12px;\n        text-align: center; text-transform: capitalize;\n        font-size: 1.3rem; font-weight: 600;\n        border-radius: 2px;\n        background-color: #fff;\n        box-shadow: 0 1px 2px #c0c0c0;\n        cursor: default;\n        transition: .2s;\n    }\n        .editor-selector__header {\n            position: relative;\n            display: flex; justify-content: space-between; align-items: center;\n            min-width: 96px;\n            padding: 2px 6px;\n        }\n\n        .editor-selector.collapsed .editor-selector__preview {\n            display: none;\n        }\n        \n        .editor-selector__title {\n            margin: 0;\n            white-space: nowrap;\n            padding-right: 12px;\n            font-family: inherit; font-size: 1.1em; font-weight: 600;\n        }\n            \n            .editor-selector__title-concept {\n                white-space: nowrap;\n                text-transform: lowercase;\n                color: #333;\n            }\n                .editor-selector__title-concept:before { content: "@"; }\n            \n            .editor-selector__title-accept {\n                margin-left: 2px;\n                font-size: 0.95em;\n                white-space: nowrap;\n                text-transform: lowercase;\n                font-weight: 400; font-style: italic;\n                color: #555;\n            }\n                .editor-selector__title-accept:before,\n                .editor-selector__title-accept:after {\n                    font: bold 1.05em Consolas, \'Courier New\', Courier, monospace; \n                    color: #638AFF; \n                }\n                .editor-selector__title-accept:before { content: "{"; }\n                .editor-selector__title-accept:after { content: "}"; }\n\n            \n                .editor-selector__title-accept:after { content: "}"; font-family: Consolas, \'Courier New\', Courier, monospace;}\n\n        .editor-selector__header-button {\n            font-weight: 600;\n            color: #fff;\n            border-radius: 2px;\n            background-color: #555;\n        }\n    \n        .editor-selector__preview {\n            padding: 2px 6px;\n            flex: 1 1;\n            min-width: 150px; max-width: 360px; \n            max-height: 120px;\n            font-size: 1.4rem; font-weight: 400;\n            text-align: left;\n            overflow: auto;\n            color: #333;\n        }\n\n            .editor-selector__preview-attributes {\n                display: flex; flex-direction: column; align-items: flex-start;\n            }\n    \n            .editor-selector__preview-attribute {\n                display: flex; flex-wrap: wrap; width: 100%;\n            }\n        \n                .editor-selector__preview-attribute > .editor-selector__preview-attributes {\n                    padding-top: 4px;\n                    padding-left: 4px;\n                }\n    \n            .editor-selector:hover .editor-selector__preview-attributes {\n                font-size: 1em;\n            }\n        \n            .editor-selector__preview-list {\n                display: flex; flex-direction: row;\n            }\n    \n            .editor-selector__preview-list-item {\n                display: flex;\n                margin-right: 4px; margin-bottom: 4px;\n                padding: 2px 4px;\n                border-radius: 1px;\n                border: 2px dashed #c0c0c0;\n            }\n    \n    \n            .editor-selector__preview-text--attribute {\n                font-weight: 500;\n                color: #009473;\n            }\n\n            .editor-selector__preview-text--target {\n                font-weight: 500;\n            }\n\n            .editor-selector__preview-text--target-accept {\n                margin-left: 2px;\n                font-size: 0.95em;\n                white-space: nowrap;\n                text-transform: lowercase;\n                font-weight: 400; font-style: italic;\n                color: #555;\n            }\n                .editor-selector__preview-text--target-accept:before,\n                .editor-selector__preview-text--target-accept:after {\n                    font: bold 1.05em Consolas, \'Courier New\', Courier, monospace; \n                    color: #638AFF; \n                }\n                .editor-selector__preview-text--target-accept:before { content: "{"; }\n                .editor-selector__preview-text--target-accept:after { content: "}"; }\n    \n            .editor-selector__preview-text--attribute + .editor-selector__preview-text:before {\n                content: ": ";\n            } \n    \n            .editor-selector__preview-text--attribute + .editor-selector__preview-null:before {\n                content: ": ";\n            }\n    \n            .editor-selector__preview-text--attribute + .editor-selector__preview-list  {\n                width: 100%;\n            } \n            \n            .editor-selector__preview-concept {\n                display: block;\n                white-space: nowrap;\n            }\n\n            .editor-selector__preview-tags {\n                margin-top: 6px;\n                display: flex; flex-wrap: wrap;\n            }\n                .editor-selector__preview-tag {\n                    white-space: nowrap;\n                    color: #638AFF;\n                    text-transform: lowercase;\n                }\n                    .editor-selector__preview-tag:before {\n                        content: "#"\n                    }\n                    .editor-selector__preview-tag:not(:last-child) {\n                        margin-right: 4px;\n                    }\n        \n        \n        .editor-selector__action-bar {\n            display: flex; justify-content: flex-end;\n            padding: 2px 6px 4px;\n            background-color: #e5e4e2;\n        }\n\n            .editor-selector__action-bar-button {\n                height: 24px; width: 24px;\n                font-size: 1.4em;\n                text-align: center;\n                border-radius: 50%;\n                box-shadow: 1px 1px 2px -1px #555;\n                background-color: #fff;\n                cursor: pointer;\n            }\n                .editor-selector__action-bar-button:not(:first-child) {\n                    margin-left: 6px;\n                }\n\n                .editor-selector__action-bar-button:disabled,\n                .editor-selector__action-bar-button:disabled:hover,\n                .editor-selector__action-bar-button:disabled:active {\n                    color: #555;\n                    background-color: #d5d5d5;\n                    opacity: 0.8;\n                    box-shadow: none;\n                    cursor: default;\n                }\n\n            .editor-selector__action-bar-button--info {\n                margin-left: 6px;\n                font-weight: 800;\n                color: #555;\n            }\n                .editor-selector__action-bar-button--info:hover {\n                    color: #FFD300;\n                    background-color: #555;\n                }\n\n            .editor-selector__action-bar-button--clone {\n                color: #009473;\n            }\n                .editor-selector__action-bar-button--clone .ico {\n                    display: block;\n                    font-weight: 100;\n                    transform: scale(1.7) translateY(-1px);\n                }\n                .editor-selector__action-bar-button--clone:hover {\n                    color: #fff;\n                    background-color: #009473;\n                }\n\n            .editor-selector__action-bar-button--delete {\n                color: #555;\n                background-color: #f5f5f5;\n            }\n                .editor-selector__action-bar-button--delete:hover {\n                    color: #fff;\n                    background-color: #E0115F;\n                }\n\n            .editor-selector__action-bar-button .ico-copy {\n                transform: scale(0.9);\n            }\n\n\n/*\n  Breadcrumb\n-----------------------------------------------------------------------------*/\n\n.editor-breadcrumb {\n    position: relative;\n    display: flex;\n    padding-top: 4px; padding-bottom: 4px;\n    height: 24px;\n    width: 100%;\n    background-color: #fff;\n    box-shadow: 0 1px 2px -1px rgba(105, 105, 105, 0.8);\n    z-index: 30;\n}\n\n    .editor-breadcrumb:after {\n        content: "";\n        position: absolute;\n        top: 0; right: 0; left: 0;\n        height: 50%;\n        border-bottom: 4px dotted #c0c0c0;\n        z-index: 1;\n    }\n\n.selector-concepts {\n    position: relative;\n    display: flex; align-items: center;\n    padding-left: 1%; \n    z-index: 2;\n}\n\n    .selector-concept {\n        position: relative;\n        display: flex; align-items: center; justify-content: center;\n        padding: 0 6px 2px;\n        color: #fff;\n        font-size: 1.2em; font-weight: 500;\n        min-width: 48px;\n        border-radius: 180px;\n        cursor: pointer;\n    }\n        .selector-concept:not(:last-child) { margin-right: 6px; }\n    \n    .selector-concept--root { background-color: #1b1b1b; }\n\n    .selector-concept--parent { background-color: #555; }\n\n    .selector-concept--ancestor { color: #222; background-color: #e5e4e2; }\n    \n    .selector-concept--active {\n        flex-grow: 2;\n        color: #222;\n        border-radius: 2px;\n        background-color: #fff;\n    }\n\n    .selector-concept.error {\n        border: 1px solid #E0115F;\n    }\n\n    .selector-concept--active.valid {\n        border: 1px solid royalblue;\n    }\n\n        .selector-concept--active .selector-concept-content {\n            font-weight: 600;\n        }\n\n        .selector-concept--active .selector-concept-status {\n            width: 12px;\n            height: 12px;\n            margin-left: 3px;\n            z-index: 50;\n        }\n        .selector-concept--active .selector-concept-status.valid {\n            border-radius: 50%;\n            background-color: green;\n        }\n        .selector-concept--active .selector-concept-status.error {\n            border-radius: 2px;\n            background-color: red;\n        }\n        .selector-concept:hover .selector-concept-status.error .selector-concept-status__errors,\n        .selector-concept--active .selector-concept-status.error .selector-concept-status__errors {\n            opacity: 1;   \n            transform: scale(1);\n            transition: .2s;\n            transition-delay: 0;\n        }\n\n        .selector-concept-status__errors {\n            position: absolute;\n            display: flex; flex-direction: column;\n            top: calc(100% + 2px); left: 0;\n            padding: 3px 6px 4px;\n            font-size: 1.2rem; font-style: normal;\n            border-radius: 1px;\n            color: #fff;\n            background-color: rgba(231, 51, 19, 0.9);\n            transform: scale(0);\n            opacity: 0;\n            transition: .2s;\n            transition-delay: .2s;\n            z-index: 60;\n        }\n\n\n/*\n  Timeline\n-----------------------------------------------------------------------------*/\n\n.editor-timeline {\n    display: flex;\n    font-size: 1.1em;\n    color: #fff;\n    font-weight: 500;\n    text-transform: uppercase;\n    font-style: normal;\n    cursor: pointer;\n    box-shadow: inset 1px 0 2px -1px #555;\n    max-width: 300px;\n    z-index: 10;\n}\n\n.model-state-list {\n    display: flex; flex-direction: row;\n    padding: 6px 12px;\n}\n\n    .model-state {\n        position: relative;\n        display: flex; align-items: center;\n        font-size: 1em; font-weight: 500;\n        width: 42px; height: 42px;\n        border-radius: 6px;\n        background-color: #555;\n        color: #d5d5d5;\n        opacity: 0.6;\n        order: 2;\n        overflow: hidden;\n    }\n        .model-state:not(:last-child) {\n            margin-right: 6px;\n        }\n        .model-state:after {\n            content: "";\n            position: absolute;\n            top: 0; right: 0; bottom: 0; left: 0;\n            border-radius: 6px;\n            background: repeating-linear-gradient(45deg, #999, #999 10px, #777 10px,#777 20px);\n            opacity: 0.5;\n            z-index: -1;\n        }\n        \n        .model-state:hover,\n        .model-state:focus {\n            background-color: #1b1b1b;\n            overflow: visible;\n            opacity: 0.9;\n        }\n\n        .model-state.active {\n            color: #fff;\n            background-color: #222;\n            opacity: 1;\n            order: 1;\n        }\n\n        .model-state .btn-delete,\n        .model-state .btn-restore {\n            color: inherit;\n        }\n\n        .model-state .btn-delete {\n            position: absolute;\n            top: 0; right: 0;\n            font-size: 1.2em;\n            padding-bottom: 2px;\n            border-top-right-radius: 4px;\n            z-index: 20;\n        }\n\n            .model-state .btn-delete:hover {\n                background-color: #E0115F;\n            }\n\n        .model-state-content {\n            padding: 6px;\n        }\n\n        .model-state-preview {\n            position: absolute;\n            bottom: 100%; left: 100%;\n            z-index: 80;\n            color: #333;\n            background-color: #fefefe;\n            box-shadow: 2px -1px 6px 3px #c0c0c0;\n            opacity: 0;\n            transform: scale(0);\n            transition: .2s;\n            transition-property: opacity, transform;\n        }\n\n            .model-state-preview .field--choice__select-wrapper + .field--choice__select-list {\n                display: none;\n            }\n\n            .model-state:hover .model-state-preview,\n            .model-state:focus .model-state-preview {\n                opacity: 1;\n                transform: scale(1);\n            }\n\n \n\n/*\n  Toolbar\n-----------------------------------------------------------------------------*/\n\n.editor-toolbar {\n    display: flex;\n    flex-direction: row;\n    align-content: space-between;\n    justify-content: flex-end;\n    padding: 3px 1%; \n    align-self: flex-start;\n    background-color: #f0f0f0;\n    overflow: hidden;\n    transition: .2s;\n}\n    .editor-toolbar:hover {\n        background-color: #c0c0c0;\n        border-bottom-left-radius: 10px;\n        z-index: 10;\n    }\n\n    .editor-toolbar__button {\n        position: relative;\n        display: block;\n        padding: 0;\n        width: 24px;\n        height: 24px;\n        font-size: 1.4rem; font-weight: 500;\n        border-radius: 50%;\n        background-color: #f0f0f0;\n        box-shadow: 0 1px 2px  #555;\n        transition: .2s;\n    }\n        .editor-toolbar__button:after {\n            display: block;\n            color: #555;\n            transition: .4s;\n        }\n        .editor-toolbar__button:disabled {\n            background-color: #c0c0c0;\n            box-shadow: none;\n            opacity: 0.5;\n        }\n        .editor-toolbar__button:not(:disabled):hover {\n            background-color: #fff; \n        }\n            .editor-toolbar__button:not(:disabled):hover:after {\n                color: #222;\n            }\n        .editor-toolbar__button:not(:last-child) {\n            margin-right: 12px;\n        }\n\n        .editor-toolbar__button--close:after {\n            content: "✖";\n        }\n        .editor-toolbar__button--close:not(:disabled):hover:after {\n            transform: rotate(-180deg) scale(1.2) translateY(-2px);\n        }\n\n        .editor-toolbar__button--save:after {\n            content: "➜";\n            font-weight: 800;\n            transform: scale(1.1) rotate(90deg) translate(-3px, 0);\n        }\n        .editor-toolbar__button--save:before {\n            content: "";\n            position: absolute;\n            height: 3px;\n            bottom: 4px; left: 4px; right: 4px;\n            background-color: #555;\n            border-radius: 180px;\n        }\n        .editor-toolbar__button--save:not(:disabled):hover:after {\n            color: #222;\n            transform: scale(1.1) rotate(90deg) translate(-1px, -1px);\n        }\n\n            .editor-toolbar__button--home:after {\n                content: "•••";\n                /* transform: rotate(90deg); if you want it as vertical */\n            }\n            .editor-toolbar__button--home:not(:disabled):hover:after {\n                letter-spacing: -1px;\n                transform: rotate(-270deg) scale(1.3) translate(-1px, -1px);\n            }\n\n    .editor-toolbar .btn-new {\n        display: block;\n        margin-right: 12px;\n        width: 24px;\n        height: 24px;\n        padding: 0;\n        font-size: 2rem; font-weight: 400;\n        color: #fff;\n        background-color: royalblue;\n        box-shadow: 0 1px 1px #777;\n        border-radius: 50%;\n        transition: .2s;\n    }\n        .editor-toolbar .btn-new:after {\n            content: "+";\n            display: block;\n            width: 100%; \n            height: 100%;\n            transition: .4s;\n        }\n        .editor-toolbar .btn-new:not(:disabled):hover {\n            background-color: #638AFF;\n            \n        }\n            .editor-toolbar .btn-new:not(:disabled):hover:after {\n                transform: rotate(180deg) scale(1.1) translateY(-2px);\n            }\n\n    .editor-toolbar .btn-style {\n        display: block;\n        margin-right: 12px;\n        width: 24px;\n        height: 24px;\n        padding: 0;\n        line-height: 15px;\n        color: #fff;\n        background-color: #e01f5e;\n        box-shadow: 0 1px 1px #777;\n        border-radius: 50%;\n        transition: .2s;\n    }\n        .editor-toolbar .btn-style:after {\n            content: "#";\n            font-size: 16px; font-weight: 600;\n        }\n        .editor-toolbar .btn-style:not(:disabled):hover {\n            background-color: #ed3972;\n            transform: rotate(360deg) scale(1.1);\n        }\n\n    .editor-header__button--resize {\n        position: absolute;\n        bottom: 0; left: calc(50% - 24px);\n        display: block;\n        width: 24px;\n        height: 24px;\n        padding: 0;\n        font-size: 1.4rem; font-weight: 500;\n        background-color: #f0f0f0;\n        box-shadow: 0 1px 2px  #555;\n        border-radius: 50%;\n        transform: translateY(50%);\n        transition: .2s;\n    }\n        .editor-header__button--resize:after {\n            content: "=";\n        }\n\n.editor-header__button--collapse {\n    position: absolute;\n    display: flex; justify-content: center; align-items: flex-end;\n    top: 12px; right: 150px;\n    width: 48px; height: 24px;\n    padding-bottom: 2px;\n    font-size: 1rem; font-weight: bold;\n    color: #555;\n    border-top-left-radius: 2px; border-top-right-radius: 2px;\n    background-color: #d5d5d5;\n    outline: none;\n    transition: .2s;\n    z-index: 5;\n}\n\n    .editor-header__button--collapse[data-state="ON"] {\n        align-items: center;\n        top: 0;\n        border-radius: 0 0 2px 2px;\n    }\n\n    .editor-header__button--collapse:after {\n        content: "❯"; \n        text-shadow: 0 0 0;\n        transition: .2s;\n    }\n        .editor-header__button--collapse[data-state="ON"]:after {\n            transform: scale(2) rotate(90deg);\n        }\n            .editor-header__button--collapse[data-state="ON"]:not(:disabled):hover:after {\n                text-shadow: 2px 0 0 #777;\n                transform: scale(2,2.2) rotate(90deg);\n            }\n        .editor-header__button--collapse[data-state="OFF"]:after {\n            transform: scale(2) rotate(-90deg);\n        }\n            .editor-header__button--collapse[data-state="OFF"]:not(:disabled):hover:after {\n                text-shadow: 2px 0 0 #777;\n                transform: scale(2,2.2) rotate(-90deg);\n            }\n\n.editor-filter {\n    box-shadow: -1px 2px 3px -1px rgba(105, 105, 105, 0.85);\n    position: absolute; top: 24px; right: 0;\n    display: flex; justify-content: space-between;\n    padding-top: 4px; padding-bottom: 3px; padding-left: 6px;\n    border-bottom-left-radius: 1px;\n    background-color: #f5f5f5;\n    z-index: 20;\n}\n\n.editor-filter-header {\n    display: flex; justify-content: space-between;\n    background-color: #f5f5f5;\n    font-size: 1.4em;\n}\n\n    .editor-filter__title {\n        position: relative;\n        padding: 6px 12px;\n        font-weight: 300;\n        color: #555;\n        text-transform: uppercase;\n        padding-left: 24px;\n    }\n\n    .editor-filter__icon {\n        position: relative;\n        display: block;\n        width: 24px;\n        opacity: 0.8;\n    }\n\n        .editor-filter__icon:before {\n            content: "";\n            position: absolute;\n            top: 0; left: 0;\n            width: 10px;\n            height: 10px;\n            border: 2px solid #696969; border-radius: 50%;\n            background: radial-gradient(#f5f5f5, #d5d5d5);\n            box-shadow: inset 1px 1px 1px #999;\n            z-index: 5;\n        }\n        .editor-filter__icon:after {\n            content: "";\n            position: absolute;\n            top: 6px; left: 6px;\n            width: 2px;\n            height: 18px;\n            background-color: #555;\n            z-index: 2;\n            border-radius: 180px;\n            transform: rotate(-30deg) translate(4px, 2px);\n        }\n\n    .editor-filter__btn-close {\n        font-size: 1.6rem;\n        width: 24px;\n    }\n\n.editor-filter-input {\n    padding: 3px 6px;\n    font-size: 1.4em;\n    border: 1px solid #d5d5d5;\n    border-radius: 2px;\n}',""]);const o=a},4313:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,'\n.editor-home-header {\n    display: flex; align-items: center;\n    padding-top: 6px; padding-left: 1%;\n}\n\n.editor-logo {\n    height: 36px; width: auto;\n    margin-right: 12px;\n}\n\n.editor-title {\n    position: relative;\n    display: block;\n    margin: 0;\n    font-size: 2rem; font-weight: 800;\n    color: #555;\n}\n\n.editor-home-menu {\n    flex-grow: 2;\n    position: relative;\n    display: flex; flex-direction: row;\n    padding-top: 24px; padding-left: 1%;\n    height: calc(100% - 60px);\n}\n    .editor-home-section:not(:last-child) {\n        margin-right: calc(2% + 2px);\n    }\n\n    .editor-home-menu-section {\n        flex-grow: 2;\n        box-shadow: 0 0 2px -1px #555, 0 0 6px #d5d5d5;\n        border-radius: 6px;\n    }\n\n    .editor-home-file-section {\n        display: flex; flex-direction: column;\n        margin-right: 6px;\n    }\n\n    .editor-home-menu-aside {\n        position: absolute;\n        top: 0; right: 0; bottom: 0;\n        padding-left: 12px;\n        overflow: auto;\n        background-color: #eee;\n    }\n\n    .editor-home-section--model__button {\n        align-self: flex-end;\n\n        margin-top: 24px;\n        padding: 6px 12px 7px;\n        font-size: 1.7rem; font-weight: 800;\n        text-align: center;\n        border-radius: 2px;\n        text-transform: capitalize;\n        background-color: #5497FF;\n        color: #fff;\n        transition: .2s;\n        cursor: pointer;\n    }\n\n        .editor-home-section--model__button:disabled {\n            color: #f5f5f5;\n            background-color: #a5a5a5;\n            box-shadow: none;\n            opacity: 0.9;\n            transform: scale(0.9);\n        }\n            .editor-home-section--model__button:not(:disabled):hover { \n                transform: scale(1); \n                opacity: 1; \n                background-color: #2d71b5;\n            }\n\n/*\n  EDITOR HOME TABS\n--------------------------------------------------------------------*/\n\n.editor-home-menu-tabs {\n    display: flex; flex-direction: column;\n    min-width: 200px;\n}\n\n.editor-home-menu-tab {\n    font-weight: 500;\n    padding: 6px 6px 8px; padding-right: 24px;\n    border-radius: 180px;\n    cursor: pointer;\n}\n\n    .editor-home-menu-tab:hover {\n        background-color: #f5f5f5;\n        box-shadow: 0 1px 2px -1px #d5d5d5;\n    }\n\n    .editor-home-menu-tab.selected {\n        color: #5497FF;\n    }\n\n/*\n  EDITOR HOME FILE\n--------------------------------------------------------------------*/\n\n.editor-file {\n    flex: 1 1;\n    position: relative;\n    display: flex; flex-direction: row; flex-wrap: wrap; align-content: flex-start;\n    margin-right: 12px;\n    height: 100%;\n    padding-bottom: 12px;\n    background-color: #fff;\n    /* overflow: auto; */\n    border-radius: 6px;\n    z-index: 10;\n}\n    .editor-file--concept {\n        box-shadow: 0 0 0 1px #2d71b5;\n    }\n\n    .editor-file--projection {\n        box-shadow: 0 0 0 1px #b52d44;\n    }\n\n    .editor-file .editor-file__list-wrapper {\n        display: flex; flex-direction: column; align-items: center;\n        padding: 6px 12px;\n        width: 96px;\n    }\n    .editor-file--concept .editor-file__list-wrapper {\n        background-color: #2d71b5;\n    }\n    .editor-file--projection .editor-file__list-wrapper {\n        background-color: #b52d44;\n    }\n\n    .editor-file-title {\n        font-size: 1.3em; font-weight: 500;\n        text-transform: capitalize;\n        color: #fff;\n    }\n\n    .editor-file-actionbar {\n        display: flex; flex-direction: row; justify-content: flex-end;\n        padding-top: 6px; padding-right: 6px; padding-bottom: 6px;\n        width: 100%;\n    }\n\n    .editor-file-modactions {\n        display: flex; flex-direction: row; justify-content: flex-end; align-items: flex-end;\n        padding-top: 6px; padding-right: 6px; padding-bottom: 6px;\n        height: 60px;   \n    }\n\n    .editor-file-actionbar__button {\n        position: relative;\n        padding: 0;\n        width: 30px;\n        height: 30px;\n        font-size: 1.4rem; font-weight: 500;\n        border-radius: 50%;\n        background-color: #f0f0f0;\n        box-shadow: 0 1px 2px -1px  #555;\n        transition: .2s;\n        z-index: 10;\n    }    \n        .editor-file-actionbar__button:not(:last-child) {\n            margin-right: 6px;\n        }\n        .editor-file-actionbar__button:before {\n            display: block;\n            transition: .4s;\n        }\n        .editor-file-actionbar__button:after {\n            display: block;\n            transition: .4s;\n        }\n        .editor-file-actionbar__button:hover {\n            background-color: #fff;\n        }\n        .editor-file-actionbar__button:disabled {\n            color: #d5d5d5;\n            background-color: #c0c0c0;\n            opacity: 0.5;\n        }\n\n        .editor-file-actionbar__btn-download:after {\n            display: block;\n            content: "➜";\n            font-weight: 800;\n            transform: scale(1.1) rotate(90deg) translate(-3px, 0);\n        }\n        .editor-file-actionbar__btn-download:before {\n            content: "";\n            position: absolute;\n            height: 3px;\n            bottom: 4px; left: 4px; right: 4px;\n            background-color: #555;\n            border-radius: 180px;\n        }\n        .editor-file-actionbar__btn-download:not(:disabled):hover:after {\n            color: #222;\n            transform: scale(1.1) rotate(90deg) translate(-1px, -1px);\n        }\n\n        .editor-file-actionbar__btn-remove:after {\n            content: "||";\n            position: absolute;\n            bottom: 5px; left: 8px;\n            width: 10px; height: 13px;\n            color: #777;\n            border: 2px solid #555;\n            border-top: 0 none;\n            border-radius: 0 0 3px 3px;\n            z-index: -2;\n            overflow: hidden;\n        }\n            .editor-file-actionbar__btn-remove:not(:disabled):hover:after {\n                transform: rotate(25deg) scale(1.05);\n            }\n        .editor-file-actionbar__btn-remove:before {\n            content: "";\n            position: absolute;\n            height: 4px;\n            width:  16px;\n            top: 8px; left: 7px;\n            background-color: #444;\n            border-radius: 180px 180px 0 0;\n            z-index: -1;\n        }\n            .editor-file-actionbar__btn-remove:not(:disabled):hover:before {\n                transform: rotate(-15deg) translateY(-3px) scale(1.1);\n            }\n       \n       \n    .editor-file__list {\n        display: flex; align-items: center; flex-wrap: wrap;\n        border-radius: 6px;\n    }\n        .editor-file-placeholder {\n            margin: 0;\n            width: 250px;\n            font-size: 1.4em; font-style: italic;\n            line-height: 1.5;\n            color: #555;\n            padding: 6px 12px;\n            background-color: #fbfbfb;\n            border-radius: 4px;\n        }\n            .editor-file-placeholder.error {\n                color: #F64141;\n                font-style: normal;\n                background-color: #f5f5f5;\n                border-left: 4px solid currentColor;\n                border-radius: 0;\n            }\n\n        .editor-file__list-item {\n            position: relative;\n            display: flex; flex-direction: column; align-items: center;\n            margin-right: 12px;\n            padding-left: 6px; padding-right: 6px; padding-bottom: 3px;\n            cursor: default;\n        }\n            .editor-file__list-item--concept {\n                border-bottom: 4px solid #2d71b5;\n            }\n            .editor-file__list-item--projection {\n                border-bottom: 4px solid #b52d44;\n            }\n            .editor-file__list-item--placeholder {\n                border: 2px dashed #b2b2b2;\n                box-shadow: none;\n                background-color: #d5d5d5;\n                transform: none;\n            }\n\n            .editor-file__list-item-icon {\n                display: block;\n                width: 36px; height: 42px;\n                border-radius: 4px;\n                background-color: #f5f5f5;\n                background-image: repeating-linear-gradient(0deg, #eee, #eee 3px, #f5f5f5 3px, #f5f5f5 6px);\n                box-shadow: 1px 1px 1px #d5d5d5, 3px 2px 2px -1px #555;\n                transform: skew(-2deg);\n            }\n\n            .editor-file__list-item-type {\n                margin-top: 2px;\n                font-size: 0.9em; font-weight: 500;\n            }\n\n            .editor-file__list-item__btn-remove {\n                position: absolute;\n                top: -6px; right: 0;\n                width: 24px; height: 24px;\n                border-radius: 50%;\n                border: 0 none;\n                color: #fff;\n                background-color: #555;\n                box-shadow: 0 -1px 2px -1px #999;\n            }\n\n            .editor-file__list-item__btn-remove .ico-delete {\n                font-size: 0.9em;\n            }\n\n    .editor-file__browse {\n        display: flex; flex-direction: column; align-items: center;\n        margin-top: 12px;\n    }\n\n    .editor-file__browse-button {\n        margin-right: 12px;\n        padding-left: 8px; padding-right: 8px;\n        height: 30px;\n        font-size: 1.5em; font-weight: 500;\n        text-align: center;\n        color: #fff;\n        border-radius: 2px;\n        opacity: 0.8;\n        transition: .2s;\n        background-color: #5497FF;\n        cursor: pointer;  \n    }\n\n    .editor-home__btn-browse-icon {\n        font-size: 1.2em;\n        font-weight: 300;\n\n    }\n\n    .editor-home__btn-browse-text {\n        font-size: 0.9em;\n    }\n\n.editor-file-mainview {\n    flex-grow: 2;\n    display: flex; flex-direction: column;\n    width: 70%;\n    height: calc(100% - 60px);\n    padding-left: 12px;\n}\n\n.detail-area {\n    display: flex; flex-direction: column;\n    flex-grow: 2;\n    height: 50%;\n}\n\n.concept-filter {\n    display: flex; flex-direction: row;\n    margin-bottom: 8px;\n    width: 50%; min-width: 300px;\n    padding: 3px 6px;\n    border-radius: 3px;\n    background-color: #f5f5f5;\n    box-shadow: 1px 2px 1px #d5d5d5;\n}\n\n.concept-filter-option {\n    display: flex;\n    margin-right: 6px;\n    font-size: 1.4em;\n    padding: 6px;\n    border-radius: 180px;\n}\n\n    .concept-filter-option:hover,\n    .concept-filter-option.checked {\n        background-color: #fff;\n    }\n\n    .cf-option-checkbox {\n        \n    }\n\n    .cf-option-text {\n        padding-left: 2px;\n        font-weight: 500;\n        text-transform: capitalize;\n        color: #555;\n    }\n\n    .cf-option-checkbox:checked + .cf-option-text {\n        color: #1f75fe;\n    }\n\n/*\n  EDITOR HOME CONCEPT\n--------------------------------------------------------------------*/\n\n.editor-file-concept {\n    display: flex; align-items: center;\n    margin-right: 4px; margin-bottom: 4px;\n    padding: 4px 12px 6px;\n    color: #fff;\n    font-weight: 500;\n    border-radius: 2px;\n    background-color: #222;\n    cursor: default;\n}\n    .editor-file-concept:hover {\n        background-color: #5497FF;\n    }\n\n    .editor-file-concept-root {\n        position: relative;\n        display: block;\n        margin-left: 6px;\n        height: 12px;\n        width: 12px;\n        border-radius: 50%;\n        background-color: #fff;\n    }\n\n/*\n  EDITOR HOME CONFIG\n--------------------------------------------------------------------*/\n\n.editor-config {\n    flex: 1 1;\n    position: relative;\n    display: flex; flex-direction: row; \n    background-color: #fff;\n    min-height: 200px;\n    border-radius: 6px;\n    overflow: hidden;\n    z-index: 10;\n}        \n    .editor-config.empty {\n        background-color: #d5d5d5;\n        background-image: repeating-linear-gradient(45deg, #c0c0c0, #c0c0c0 12px, #d5d5d5 12px, #d5d5d5 24px);\n    }\n\n    .editor-config-main {\n        flex-grow: 2;\n        display: flex; align-items: center;\n        max-width: 360px;\n        min-height: 100%;\n    }\n\n    .editor-config-placeholder {\n        background-color: rgba(55, 55, 55, 0.6);\n        color: #fff;\n        padding: 12px;\n    }\n\n    .editor-config-info {\n        max-height: 100%;\n        overflow: auto;\n    }\n\n    .editor-config__list {\n        position: relative;\n        flex-grow: 2;\n        display: flex; flex-wrap: wrap; align-content: flex-start;\n        width: 100%; height: 100%;\n        padding: 12px 18px;\n        overflow: auto;\n        transition: .2s;\n    }\n\n    .loaded-element {\n        padding: 6px;\n        overflow: hidden;\n        display: flex; flex-direction: row;\n        margin-right: 6px; margin-bottom: 6px;\n        font-size: 1.3rem;\n        border-radius: 2px;\n        background-color: #f5f5f5;\n        box-shadow: 0 0 2px -1px #555;\n        cursor: default;\n    }\n        .loaded-element-name {\n            max-width: 120px; padding-right: 6px;\n        }\n\n        .file-section__actionbar-button {\n            position: relative;\n            padding: 0;\n            width: 24px;\n            height: 24px;\n            font-size: 1.4rem; font-weight: 500;\n            border-radius: 50%;\n            background-color: #d5d5d5;\n            box-shadow: 0 1px 2px -1px #c0c0c0;\n            opacity: 0.9;\n            transition: .2s;\n        }    \n            \n            .file-section__actionbar-button:hover {\n                background-color: #fff;\n            }\n            .file-section__actionbar-button:disabled {\n                color: #d5d5d5;\n                background-color: #969696;\n                opacity: 0.9;\n            }\n            .file-section__actionbar-button:before {\n                display: block;\n                transition: .4s;\n            }\n            .file-section__actionbar-button:after {\n                display: block;\n                transition: .4s;\n            }\n\n        .file-section__actionbar-button--edit:after {\n            content: "";\n            position: absolute;\n            width: 0;\n            height: 0;\n            bottom: 2px; left: calc(50% - 4px);\n            border-left: 2px solid transparent;\n            border-right: 2px solid transparent;\n            border-top: 4px solid #222;\n            transform: rotate(25deg);\n        }\n        .file-section__actionbar-button--edit:before {\n            content: "";\n            position: absolute;\n            height: 14px;\n            width:  4px;\n            top: 4px; left: 50%;\n            background-color: #555;\n            border-radius:  180px 180px 0 0;\n            transform: rotate(25deg);\n        }\n        .file-section__actionbar-button--edit:not(:disabled):hover:before {\n            transform: rotate(25deg) scale(1.1);\n        }\n        .file-section__actionbar-button--edit:not(:disabled):hover:after {\n            transform: rotate(25deg) scale(1.1);\n        }\n\n        .file-section__actionbar-button--remove:after {\n            content: "||";\n            position: absolute;\n            bottom: 3px; left: 6px;\n            width: 9px; height: 13px;\n            color: #777;\n            border: 2px solid #555;\n            border-top: 0 none;\n            border-radius: 0 0 3px 3px;\n            z-index: -2;\n            overflow: hidden;\n        }\n        .file-section__actionbar-button--remove:before {\n            content: "";\n            position: absolute;\n            height: 4px;\n            width:  16px;\n            top: 4px; left: 5px;\n            background-color: #444;\n            border-radius: 180px 180px 0 0;\n            z-index: -1;\n        }\n        .file-section__actionbar-button--remove:not(:disabled):hover:before {\n            transform: rotate(-15deg) scale(1.1);\n        }\n        .file-section__actionbar-button--remove:not(:disabled):hover:after {\n            transform: rotate(25deg) scale(1.05);\n        }\n\n        .editor-home-section__drop-area--concept:hover {\n            border-color: #2d71b5;\n        }\n        .editor-home-section__drop-area--projection:hover {\n            border-color: #b52d44;\n        }\n            .editor-home-section__drop-area:hover:before {\n                transform: skew(-2deg) translateY(-4px);\n                opacity: 0.8;\n            }\n            \n            .editor-home-section__drop-area:hover:after {\n                opacity: 0.8;\n            }\n\n    .drop-area__button {\n        position: relative;\n        padding: 3px 6px 4px;\n        width: 124px;\n        margin-top: 6px;\n        font-size: 1.3em; font-weight: 500;\n        text-align: center;\n        color: #fff;\n        border-radius: 2px;\n        background-color: #2d71b5;\n        opacity: 0.8;\n        transition: .2s;\n        cursor: pointer;  \n    }\n\n        .drop-area__button--model {\n            background-color: #2d71b5;\n        }\n        \n        .drop-area__button--projection {\n            background-color: #b52d44;\n        }\n    \n    \n    \n    \n    .loader-option:active {\n        box-shadow: none;\n    }\n        .loader-option:active:before {\n            opacity: 1;\n        }\n\n/*\n    EDITOR HOME FILE CONCEPT\n---------------------------------------------------------------------------------------*/\n\n.app-model-concept {\n    padding: 4px 6px;\n    font-size: 1.3em;\n    margin-bottom: 3px;\n    cursor: pointer;\n    height: 100%;\n    transition: .2s;\n}\n\n    .app-model-concept.selected .app-model-concept-name {\n        font-weight: 500;\n    }\n\n.app-model-concept-header {\n    position: relative;\n    display: flex;\n    padding-top: 3px; padding-bottom: 3px;\n}\n\n    .app-model-concept-nature {\n        display: flex; align-items: center; justify-content: center;\n        font-weight: bold; font-family: Consolas, \'Courier New\', Courier, monospace; font-style: normal;\n        text-transform: uppercase;\n        height: 18px; min-height: 18px;\n        width: 18px; min-width: 18px;\n        border-radius: 50%;\n        color: #fff;\n    }\n        .app-model-concept-nature[data-name="concrete"] {\n            background-color: #FF6F61;\n        }\n        .app-model-concept-nature[data-name="prototype"] {\n            background-color: #1f75fe;\n        }\n        .app-model-concept-nature[data-name="derivative"] {\n            background-color: #53b04b;\n        }\n        .app-model-concept-nature[data-name="primitive"] {\n            background-color: #5F4B8B;\n        }\n\n    .app-model-concept-name {\n        text-transform: uppercase;\n        font-size: 1.1em;\n    }\n\n    .app-model-concept-nature + .app-model-concept-name {\n        margin-left: 3px;\n    }\n\n    .app-model-concept-menu {\n        display: flex;\n        margin-left: 6px;\n    }\n\n        .app-model-concept-menu-item {\n            margin-right: 6px;\n            font-size: 1em; font-weight: 500;\n            padding: 2px 6px 3px;\n            background-color: #f5f5f5;\n        }\n\n.app-model-concept-body {\n    font-size: 1rem;\n    border-radius: 3px;\n    box-shadow: inset 0 2px 2px #d5d5d5;\n    background-color: #f9f9f9;\n    height: calc(100% - 24px);\n    overflow: auto;\n}\n\n.app-model-concept-attributes {\n    display: flex; flex-direction: column;\n    font-size: 1rem;\n}\n\n    .app-model-concept-attribute {\n        margin-bottom: 3px;\n        font-size: 1.3em; font-weight: 500;\n        color: #738CFF;\n        cursor: pointer;\n        transition: .2s;\n    }\n        .app-model-concept-attribute.selected {\n            color: #fff;\n            border-radius: 2px;\n            background-color: #6667AB;\n        }\n\n    .app-model__attribute-info {\n        margin-top: 6px;\n        padding: 4px 6px 2px;\n        font-size: 1.3rem;\n        border-radius: 4px;\n    }\n\n    .app-model__attribute-header {\n        display: flex; align-items: baseline;\n    }\n\n    .app-model__attribute-name {\n        font-weight: bold;\n        font-size: 1.2em;\n        color: #555;\n    }\n\n    .app-model__attribute-required {\n        position: relative;\n        margin-right: 6px;\n        display: inline-block;\n        font-size: 0.9em; font-style: normal; font-weight: 500;\n        height: 12px; width: 12px;\n        border-radius: 1px;\n        background-color: #FF5747;\n    }\n\n    .app-model__attribute-required .help {\n        position: absolute;\n        left: 100%;\n        padding: 3px 6px 4px;\n        color: #fff;\n        background-color: #555;\n        border-radius: 2px;\n        opacity: 0;\n        transform: scale(0);\n        transition: .2s;\n    }\n\n    .app-model__attribute-required:hover .help {\n        opacity: 1;\n        transform: scale(1) translateX(2px);\n    }\n\n    .app-model__attribute-target {\n        display: flex;\n    }\n\n    .target-name {\n        color: #6667AB; font-weight: 500;\n        cursor: pointer;\n    }\n\n    .target-name:hover {\n        text-decoration: underline;\n    }\n\n    .target-name + .target-accept:before {\n        content: "->";\n        font-family: Consolas, \'Courier New\', Courier, monospace;\n        font-weight: bold;\n        margin-left: 2px; margin-right: 2px;\n    }\n\n    .target-accept.array > .target-name:first-child:before {\n        content: "["\n    }\n\n    .target-accept.array > .target-name +.target-name:before {\n        content: ", "\n    }\n\n    .target-accept.array > .target-name:last-child:after {\n        content: "]"\n    }\n\n        ',""]);const o=a},2482:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,".tpl-concept {\n    font: normal 1rem 'Segoe UI', 'Droid Sans', Ubuntu, 'Lucida Grande', Arial, sans-serif;\n    color: #333;\n    background-color: #c0c0c0;\n    height: 100%;\n}\n\n.tpl-concept-header {\n    display: flex; flex-direction: column;\n    background-color: #dcdcdc;\n    padding: 8px 12px;\n}\n\n    .tpl-concept-heading {\n        display: flex; align-items: center;\n        margin-bottom: 6px;\n    }\n    .tpl-concept-name {\n        margin: 0;\n        font-size: 1.6em; font-weight: 300; font-family: inherit;\n        text-transform: uppercase;\n        color: #222;\n    }\n\n    .tpl-concept-nature {\n        display: inline-block;\n        margin-left: 6px;\n        padding: 2px 6px 3px;\n        font-size: 1.3em; font-weight: 500;\n        color: #fff;\n        background-color: #3B3B3B;\n        border-radius: 18px;\n    }\n\n    .tpl-concept-wrapper {\n        margin: 0;\n        display: inline-flex;\n    }\n\n    .tpl-concept-prototype {\n        color: royalblue;\n        color: rgb(113, 102, 217);\n        font-weight: 500;\n    }\n\n    .tpl-concept__title {\n        margin: 0; margin-bottom: 2px;\n        font-size: 1.5em; font-weight: 800; font-family: inherit;\n        color: #555;\n    }\n\n.tpl-concept-body {\n\n}\n\n    .tpl-concept-section {\n        padding: 6px 12px;\n    }\n\n.tpl-concept-attribute-list {\n    display: flex; flex-direction: row; flex-wrap: wrap;\n}\n\n    .tpl-concept-attribute {\n        display: inline-flex;\n        margin-bottom: 6px; margin-right: 4px;\n        padding: 2px 6px 3px; font-weight: 500;\n        color: rgb(113, 102, 217);\n        border-radius: 2px; overflow: hidden;\n        background-color: #f5f5f5;\n    }\n\n        .tpl-concept-attribute-name {\n            \n        }\n\n        .tpl-concept-attribute-required {\n\n        }\n\n.tpl-concept-property-list {\n    display: flex; flex-direction: row; flex-wrap: wrap;\n}\n\n    .tpl-concept-property {\n        display: inline-flex;\n        margin-bottom: 6px; margin-right: 4px;\n    }\n\n        .tpl-label {\n            padding: 3px 6px; display: inline-flex; align-items: center;\n            color: #fff;\n            font-weight: bold;\n            font-family: Consolas, 'Courier New', Courier, monospace;\n            letter-spacing: -0.2px;\n            background-color: #6667AB;;\n        }\n\n        .tpl-value {\n            padding: 3px 6px;\n            color: rgb(113, 102, 217);\n            background-color: #f5f5f5;\n        }",""]);const o=a},1133:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,'.gentleman-editor {\n    position: relative;\n    display: flex; flex-direction: column;\n    width: 100%;\n    height: 100%;\n    z-index: 1;\n}\n    \n    .gentleman-editor.unfocus:before {\n        content: "";\n        position: absolute;\n        top: 0; right: 0; bottom: 0; left: 0;\n        backdrop-filter: blur(2px);\n        background-color: rgba(245, 245, 245, 0.65);\n        z-index: 50;\n    }\n\n.editor-body {\n    flex-grow: 1;\n\n    position: relative;\n    display: flex; flex-direction: row;\n    background-color: #d5d5d5;\n    background: repeating-linear-gradient(45deg, #f5f5f5, #f5f5f5 4px, #f0f0f0 4px,#f0f0f0 8px);\n    outline: none;\n    max-height: 100%;\n    overflow: auto;\n}\n\n    .editor-body-main {\n        flex-grow: 2;\n        display: flex; flex-direction: row;\n        width: 100%;\n        height: 100%;\n        overflow: auto;\n    }\n\n    .editor-body-aside {\n        border-left: 1px solid #c0c0c0;\n    }\n\n.editor-home {\n    position: absolute;\n    top: 30px; right: 0; bottom: 24px; left: 0;\n    display: flex; flex-direction: column; \n    padding-right: 15%;\n    padding-bottom: 60px;\n    background-color: rgba(255, 255, 255, 0.98);\n    overflow: hidden;\n    z-index: 80;\n}\n\n.editor-footer {\n    max-height: 50%;\n    background-color: #555;\n}\n\n.editor-window-header {\n    display: none;\n}\n\n\n.helper {\n    position: absolute;\n    top: 100%; left: 0;\n    width: 120px;\n    padding: 3px 6px 4px;\n    border-radius: 1px;\n    font-size: 1.2rem; font-style: normal;\n    color: #fff;\n    background-color: rgba(55, 55, 55, 0.85);\n    opacity: 0;\n    transition: .2s;\n    transform: scale(0); transition-property: opacity, transform;\n    z-index: 20;\n}\n\n.has-helper:hover > .helper {\n    opacity: 1;   \n    transform: scale(1) translateY(2px);\n}\n\n\n/*\n  Status bar section\n-----------------------------------------------------------------------------*/\n\n.editor-statusbar {\n    display: flex;\n    justify-content: space-between;\n    color: #fff;\n    background-color: #232425;\n    height: 24px;\n}\n\n.editor-statusbar-badge-container {\n    display: flex;\n    padding-left: 1%;\n}\n\n.editor-statusbar.error { background-color: #F64141; }\n\n.editor-statusbar-model {\n    padding: 2px 6px; \n    display: flex; flex-direction: row; align-items: center;\n    cursor: default;\n}\n\n    .editor-statusbar-model-badge {\n        width: 12px;\n        height: 12px;\n        margin-right: 3px;\n    }\n        .editor-statusbar-model-badge.valid {\n            border-radius: 50%;\n            background-color: green;\n        }\n        .editor-statusbar-model-badge.error {\n            border-radius: 2px;\n            background-color: red;\n        }\n\n    .editor-statusbar-model-info {\n        font-size: 1.2em; font-weight: 500;\n    }\n\n.editor-statusbar-global {\n    padding: 2px 6px; \n    display: flex; flex-direction: row; align-items: center;\n    cursor: default;\n}\n\n    .editor-statusbar-global-badge {\n        display: flex;\n        width: 12px;\n        height: 100%;\n        margin-right: 3px; \n        font-style: normal;\n    }\n        .editor-statusbar-global-badge.valid {\n            display: none;\n        }\n        .editor-statusbar-global-badge.error {\n            border-radius: 2px;\n        }\n        .editor-statusbar-global-badge.error:before {\n            content: "⚠";\n            color: #E86923;\n            font-weight: bold;\n            transform: scale(1.6);\n        }\n\n    .editor-statusbar-global-info {\n        display: none;\n        font-size: 1.2em; font-weight: 500;\n    }\n\n\n.editor-statusbar-viewer-container {\n    display: flex; justify-content: flex-end;\n}\n\n.editor-statusbar-viewers {\n    display: flex; justify-content: flex-end;\n}\n\n.editor-statusbar-viewer__button-add {\n    font-size: 1.4em;\n    color: #fff;\n    border: 0 none;\n    background: none;\n}\n\n    .editor-statusbar-viewer {\n        flex: 1 1;\n        padding: 2px 8px;\n        font-size: 1.2em;\n        text-transform: uppercase;\n        color: #fff;\n        border-radius: 2px;\n        cursor: default;\n    }\n        .editor-statusbar-viewer:hover { color: #0059B3; background-color: #d5d5d5; }\n        .editor-statusbar-viewer.selected { font-weight: bold; color: #007FFF; }\n\n.editor-style {\n    position: absolute;\n    top: 36px; right: 0; bottom: 0; left: 0;\n    display: flex; align-items: flex-start; justify-content: center;\n    backdrop-filter: blur(2px);\n    background-color: rgba(245, 245, 245, 0.8);\n    z-index: 100;\n}\n\n\n/*\n  Breadcrumb concept section\n-----------------------------------------------------------------------------*/\n\n.model-navigation-section {\n    position: relative;\n    display: flex;  flex-direction: column;\n}\n\n/*\n  Value concept window\n-----------------------------------------------------------------------------*/\n\n.model-value-window {\n    color: #fff;\n    z-index: 10;\n    background-color: #c0c0c0;\n}\n\n.model-value-list {\n    display: flex; flex-direction: row;\n    overflow: auto;\n}\n\n    .model-value {\n        display: flex; flex-direction: row;\n        font-size: 1.3em; \n        background-color: #f5f5f5;\n    }\n        .model-value:not(:last-child) { margin-right: 2px; }\n\n        .model-value .btn-copy {\n            display: flex; flex-direction: row;\n            padding: 6px 12px;\n            font-weight: 500;\n            color: #444;\n        }\n    \n.ico {\n    font-style: normal;\n}\n\n.ico-copy {\n    position: relative;\n    display: block;\n    margin-right: 6px;\n    width: 12px; height: 14px;\n    background-color: #f5f5f5;\n    border: 1px solid #777; border-radius: 2px;\n}\n    .ico-copy:after {\n        content: "";\n        position: absolute;\n        top: 0; right: 0; bottom: 0; left: 0;\n        height: 100%; width: 100%;\n        border: 1px solid #555; border-radius: 2px;\n        background-color: #fff;\n        transform: translate(3px, -4px);\n        z-index: 2;\n    }\n\n\n/*\n  Editor concept section\n-----------------------------------------------------------------------------*/\n\n.model-concept-section {\n    flex-grow: 2;\n    \n    position: relative;\n    display: flex;     \n    overflow-y: auto; overflow-x: visible;\n    scrollbar-color: #c0c0c0; scrollbar-width: thin;\n}\n\n.model-concept-section[data-view="grid"] {\n    flex-wrap: wrap; align-content: flex-start; align-items: flex-start;\n    padding: 18px 1%;\n}\n\n.model-concept-section[data-view="col"] {\n    flex-direction: row;\n    padding: 0;\n}\n\n.model-concept-section[data-view="tab"] {\n    flex-direction: column;\n    padding: 0;\n}\n\n.model-concept-section[data-view="nav"] {\n    flex-direction: row;\n    padding: 0;\n}\n\n    .model-concept-section[data-view="grid"] .editor-concept { \n        margin-right: 6px; margin-bottom: 6px;\n        min-width: 360px; min-height: 120px;\n        box-shadow: 0 2px 2px #d5d5d5;\n    }\n\n    .model-concept-section[data-view="grid"] .editor-concept.collapsed { \n        min-height: auto;\n    }\n        .model-concept-section[data-view="grid"] .editor-concept > .layout-container { \n            flex-grow: 2; \n            overflow: auto; \n        }\n\n    .model-concept-section[data-view="tab"] .editor-concept,\n    .model-concept-section[data-view="tab"] .editor-concept-header,\n    .model-concept-section[data-view="tab"] .editor-concept--projection {\n        margin: 0;\n        border-radius: 0;\n        width: 100%;\n    }\n\n    .model-concept-section[data-view="tab"] .editor-concept.active {\n        height: 100%;\n    }\n\n    .model-concept-section[data-view="tab"] .editor-concept-header,\n    .model-concept-section[data-view="tab"] .resizers {\n        display: none;\n    }\n\n    .model-view-section {\n        position: relative;\n        background: #e5e2e2;\n    }\n\n    .model-concept-section[data-view="tab"] .model-view-section {\n        width: 100%;\n    }\n\n    .editor-view-tablist {\n        display: flex; flex-direction: row;\n        width: 100%;\n        overflow: auto;\n        cursor: default;\n    }\n\n    .editor-view-tablist-item {\n        flex: 1 1;\n        max-width: 120px;\n        position: relative;\n        display: inline-flex; align-items: center; justify-content: space-between;\n        font-size: 1.2em;\n        color: #555;\n        background-color: #f0f0f0;\n        opacity: 0.9;\n    }\n        \n        .editor-view-tablist-item:not(:last-child):not(.active):after {\n            content: "";\n            position: absolute;\n            top: 3px; bottom: 3px; right: 0;\n            width: 1px;\n            background-color: #999;\n            box-shadow: 0 0 1px #c0c0c0;\n        }\n\n        .editor-view-tablist-item__content {\n            padding: 2px 6px;\n            width: 100%;\n        }\n\n        .editor-view-tablist-item .btn-close {\n            padding: 2px 6px;\n            margin-left: 4px;\n        }\n\n        .editor-view-tablist-item .btn-close:hover {\n            background-color: #c0c0c0;\n        }\n        \n        .editor-view-tablist-item:hover {\n            background-color: #fff;\n        }\n\n        .editor-view-tablist-item.active {\n            color: #222;\n            background-color: #fff;\n            border-radius: 2px 2px 0 0;\n            opacity: 1;\n            font-weight: bold;\n            box-shadow: 1px 0 2px -1px #777, -1px 0 2px -1px #777;\n            z-index: 50;\n        }\n\n        \n    .editor-concept {\n        position: relative;\n        display: flex; flex-direction: column;\n        font-size: 1.4rem;\n        border-radius: 1px;\n        background-color: #fefefe;\n        transition: transform .2s;\n    }\n        .editor-concept > .layout-container { \n            flex-grow: 2;\n        }\n\n        .editor-concept.active {\n            border-radius: 2px;\n        }\n            .editor-concept.active .editor-concept-header { background-color: #232425; }\n    \n        .editor-concept:focus {\n            box-shadow: 0 0 0 2px #5897F5;\n        }\n\n        .model-concept-section.fullscreen {\n            padding: 0;\n        }\n\n        .model-concept-section.fullscreen .editor-concept:not([data-size="fullscreen"]) {\n            display: none;\n        }\n\n        .editor-concept[data-size="fullscreen"] {\n            position: absolute;\n            top: 0; right: 0; bottom: 0; left: 0;\n            margin: 0!important;\n            border-radius: 0;\n            box-shadow: none;\n        }\n\n        .editor-concept[data-size="fullscreen"] .editor-concept-header {\n            border-radius: 0;\n        }\n\n        .editor-concept[data-size="fullscreen"] .resizers {\n            display: none;\n        }\n\n        .editor-concept.collapsed {\n            background-color: rgba(55, 55, 55, 0.4);\n        }\n            .editor-concept.collapsed > .layout-container { opacity: 0.5; z-index: -20; height: 30px; overflow: hidden; }\n            .editor-concept.collapsed [data-nature="layout"],\n            .editor-concept.collapsed [data-nature="field"] {\n                font-size: 0.8rem;\n            }\n\n        .editor-concept--projection .editor-concept-header {\n            background-color: #555;\n        }\n            .editor-concept--projection.active .editor-concept-header {\n                background-color: #444;\n            }\n        .editor-concept--projection .editor-concept-title {\n            font-style: italic;\n            color: #eee;\n        }\n        .editor-concept--projection .editor-concept-toolbar__btn-collapse,\n        .editor-concept--projection .editor-concept-toolbar__btn-maximize,\n        .editor-concept--projection .editor-concept-toolbar__btn-delete {\n            color: #f5f5f5;\n        }\n\n    .editor-concept-header {\n        display: flex; align-items: center;\n        border-top-left-radius: 4px; border-top-right-radius: 4px;\n        background-color: #555;\n        height: 24px;\n    }\n\n    .editor-concept-title {\n        margin: 0;\n        padding-left: 6px;\n        font-weight: 500; font-size: 1em; font-family: inherit;\n        text-transform: capitalize;\n        color: #fff;\n    }\n\n    .editor-concept-toolbar {\n        flex: 1 1;\n        display: flex; justify-content: flex-end;\n        padding: 6px;\n    }\n\n    .editor-concept-toolbar__btn-maximize {\n        margin-right: 8px;\n        font-size: 1.5rem; font-weight: 600;\n        display: flex; align-items: center; justify-content: center;\n        width: 18px;\n        height: 18px;\n        border-radius: 50%;\n        color: #f5f5f5;\n        box-shadow: 0 1px 2px -1px #111;\n        z-index: 5;\n        outline: none;\n    }\n        .editor-concept-toolbar__btn-maximize:before {\n            content: "▢";\n            display: block;\n            transition: .25s;\n        }\n        .editor-concept-toolbar__btn-maximize:hover,\n        .editor-concept.focus .editor-concept-toolbar__btn-maximize {\n            box-shadow: 0 1px 1px #1b1b1b;\n            background-color: rgba(25, 25, 25, 0.1);\n        }\n            .editor-concept-toolbar__btn-maximize:hover:before,\n            .editor-concept.focus .editor-concept-toolbar__btn-maximize:before {\n                transform: skew(-1deg) scale(1.3);\n            }\n\n    .editor-concept-toolbar__btn-delete {\n        display: flex; align-items: center; justify-content: center;\n        width: 18px;\n        height: 18px;\n        font-size: 1.4rem; font-weight: 600;\n        color: #f5f5f5;\n        border-radius: 50%;\n        box-shadow: 0 1px 2px -1px #111;\n        z-index: 5;\n        outline: none;\n    }\n        .editor-concept-toolbar__btn-delete:before {\n            content: "✖";\n            display: block;\n            transition: .4s;\n        }\n        .editor-concept-toolbar__btn-delete:hover {\n            background-color: rgba(155, 155, 155, 0.1);\n            box-shadow: 0 1px 1px #343434;\n        }\n            .editor-concept-toolbar__btn-delete:hover:before {\n                transform: rotate(180deg) scale(1.1) translateY(-2px);\n            }\n\n    .editor-concept-toolbar__btn-new {\n        margin-left: 12px;\n        font-size: 1.4rem; font-weight: 600;\n        width: 18px;\n        height: 18px;\n        border-radius: 50%;\n        color: #575757;\n        background-color: rgba(255, 255, 255, 0.1);\n        box-shadow: 0 1px 2px -1px #575757;\n        z-index: 5;\n        outline: none;\n    }\n        .editor-concept-toolbar__btn-new:before {\n            content: "+";\n            display: block;\n            transform: scale(1.9) translateY(-1px);\n            transition: .4s;\n        }\n        .editor-concept-toolbar__btn-new:hover {\n            background-color: rgba(155, 155, 155, 0.1);\n            box-shadow: 0 1px 1px #343434;\n        }\n            .editor-concept-toolbar__btn-new:hover:before {\n                transform: rotate(180deg) scale(2) translateY(-2px);\n            }            \n\n    .editor-concept-toolbar__btn-collapse {\n        margin-right: 8px;\n        font-size: 1.4rem; font-weight: 600;\n        width: 18px;\n        height: 18px;\n        border-radius: 50%;\n        color: #f5f5f5;\n        box-shadow: 0 1px 2px -1px #111;\n        z-index: 5;\n        outline: none;\n    }\n        .editor-concept-toolbar__btn-collapse:before {\n            content: "–";\n            display: block;\n            transform: scale(1.8) translateY(-1px);\n            transition: .4s;\n        }\n        .editor-concept-toolbar__btn-collapse:hover {\n            background-color: rgba(155, 155, 155, 0.1);\n            color: #fff;\n            box-shadow: 0 1px 1px #343434;\n        }\n            .editor-concept-toolbar__btn-collapse:hover:before,\n            .editor-concept.collapsed .editor-concept-toolbar__btn-collapse:before {\n                transform: rotate(-90deg) scale(2) translateY(-2px);\n            }\n\n\n/*\n  Exporter\n-----------------------------------------------------------------------------*/\n\n.editor-exporter {\n    position: absolute;\n    top: 30px; right: 60px;\n    width: 300px; \n    display: flex; flex-direction: column;\n    padding: 12px;\n    z-index: 50;\n    background-color: #fefefe;\n    border-radius: 4px;\n    box-shadow: -1px 2px 6px -2px #b2b2b2;\n}\n\n\n\n.btn-collapse {\n    position: absolute;\n    top: 6px; right: 4px;\n    width: 20px; height: 20px;\n    font-size: 1.7em;\n    display: flex; align-items: center; justify-content: center;\n    color: #fff;\n    border-radius: 4px;\n    background-color: #555;\n}\n    .btn-collapse:before {\n        content: "❯";\n        position: absolute;\n        font-weight: 300;\n        top: 0; right: 0; bottom: 0; left: 0;\n        transform: rotate(-90deg);\n    }\n    .btn-collapse:hover {\n        background-color: #232425;\n    }\n\n.editor-exporter-title {\n    margin: 0;\n    color: #555;\n    font-size: 1.6rem; font-weight: 300;\n    text-transform: uppercase;\n}\n\n.editor-exporter__instruction {\n    font-size: 1.3rem;\n}\n\n.editor-exporter-file__label {\n    display: flex;\n    margin-bottom: 12px;\n}\n\n.editor-exporter-file__label-value {\n    font-size: 1.4em; font-weight: 500;\n    padding: 4px 8px;\n    background-color: #d5d5d5;\n}\n\n.editor-exporter-file__input {\n    flex-grow: 2;\n    width: 100%;\n    padding-left: 4px; padding-right: 4px;\n    font-size: 1.5em;\n    background-color: #f5f5f5;\n    box-shadow: 1px 0 1px #d5d5d5;\n    border: 0 none; border-radius: 0 2px 2px 0;\n}\n\n.export-selector {\n    display: flex;\n    margin-bottom: 6px;\n}\n\n.export-selector-item {\n    display: flex;\n    margin-right: 6px;\n    font-weight: 500;\n    font-size: 1.4em;\n    color: #444;\n    background-color: #eee;\n    border-radius: 3px;\n}\n\n.export-selector-item.selected {\n    color: #007FFF; \n    background-color: #fff;\n    border-bottom: 2px solid #007FFF;\n    border-radius: 0;\n}\n\n.export-selector-item__label {\n    display: block;\n    padding: 6px 8px 2px;\n}\n\n.export-selector-item__input {\n    display: none;\n}\n\n.btn-export {\n    align-items: flex-end;\n    padding: 6px 12px;\n    color: #fff;\n    font-size: 1.4em; font-weight: 500;\n    border-radius: 2px;\n    background-color: #5F84F4;\n}\n\n/*\n  Download list\n-----------------------------------------------------------------------------*/\n\n.download-list {\n    display: flex;\n} \n    .download-list:not(:empty) {\n        padding-top: 2px;\n    } \n\n    .download-item {\n        position: relative;\n        display: flex; flex-direction: column;\n        padding: 2px 1px 4px;\n        font-size: 1.3rem;\n        color: #555;\n        border-radius: 2px;\n        box-shadow: 1px -1px 2px #c0c0c0;\n        background-color: #fff;\n    }\n\n    .download-item:not(:last-child) {\n        margin-right: 4px;\n    }\n\n    .download-item .btn-delete {\n        align-self: flex-end;\n        padding: 1px 2px;\n    }\n\n        .download-item__link {\n            display: block;\n            width: 100%;\n            height: 100%;\n            padding: 2px 8px;\n            font-size: 0.9em;\n        }\n\n\n/*\n  Log list\n-----------------------------------------------------------------------------*/\n\n.log-list {\n    display: flex; flex-direction: column;\n    background-color: #1b1b1b;\n} \n    .log-list:not(:empty) {\n        padding-top: 2px;\n    } \n\n    .log-item {\n        position: relative;\n        display: flex; flex-direction: column;\n        padding: 2px 6px 4px;\n        font-size: 1.3rem;\n        color: #555;\n    }\n\n    .log-item--error {\n        color: #F64141;\n    }\n    .log-item--success {\n        color: #00ca4e;\n    }\n    .log-item--warning {\n        color: #E86923;\n    }\n\n    .log-item:not(:last-child) {\n        box-shadow: 0 -1px 0 0 #777;\n    }\n\n    .log-item--error .log-item-messages {\n        font-weight: 600;\n    }\n\n    .log-item .btn-delete {\n        color: inherit;\n        align-self: flex-end;\n        transform: scale(1.2);\n        padding: 1px 2px;\n    }\n\n        .log-item-messages {\n            display: flex;\n            flex-direction: column;\n            padding-left: 0.5em;\n            font-size: 0.9em;\n            font-family: "Consolas", \'Courier New\', Courier, monospace;\n        }\n\n        .log-item-message {\n            line-height: 1.25;\n        }\n\n        .log-item-message:before {\n            content: "- "\n        }\n        .log-item-message:not(:last-child) {\n            margin-bottom: 2px;\n        }\n\n    .error-message {\n        text-decoration: none;\n    }\n\n    .error-message__link {\n        display: inline-block;\n        padding: 0 3px 1px;\n        font-style: italic;\n        font-size: 1.1em;\n        background-color: #f5f5f5;\n        box-shadow: 0 1px 1px #555;\n        color: #B3312E;\n        border-radius: 2px;\n        cursor: pointer;\n    }\n\n    .error-message__link:hover {\n        color: #FF5F5C;\n        background-color: #222;\n    }\n\n\n/*\n  Resource list\n-----------------------------------------------------------------------------*/\n\n.editor-resource {\n    position: absolute;\n    bottom: 20vh; right: 0;\n    display: flex; justify-content: space-between; flex-wrap: wrap;\n    width: 120px;\n    background-color: #555;\n    box-shadow: -1px 1px 2px -1px #999;\n    transform: translateX(40px);\n    transition: .2s;\n    z-index: 50;\n}\n\n.editor-resource:hover {\n    transform: translateX(0);\n}\n\n.editor-resource-title {\n    padding: 6px 8px;\n    font-size: 1.4em; font-weight: 300;\n    color: #fff;\n}\n\n.editor-resource__button {\n    padding: 4px 6px;\n    color: #fff;\n    background-color: #222;\n    font-size: 1.2em; font-weight: 500;\n}\n\n.resource-list {\n    display: flex; flex-direction: column;\n    width: 100%;\n    background-color: #d5d5d5;\n} \n    .resource-list:not(:empty) {\n        padding-top: 2px;\n    } \n\n    .resource-item {\n        position: relative;\n        display: flex; justify-content: space-between;\n        padding: 2px 6px 4px;\n        font-size: 1.2em;\n        color: #555;\n    }\n    .resource-item:before {\n        content: "–";\n        margin-right: 2px;\n        font-weight: 800;\n    }\n        .resource-item__name { font-weight: 500; }\n\n        .resource-item .btn-delete {\n            color: inherit;\n            align-self: flex-end;\n            transform: scale(1.2);\n            padding: 1px 2px;\n        }\n\n\n/*\n  Notify\n-----------------------------------------------------------------------------*/\n\n.notify {\n    position: absolute;\n    top: 60px; right: 24px;\n    margin: 0;\n    padding: 12px 24px;\n    font-weight: 500;\n    color: #fff;\n    background-color: royalblue;\n    box-shadow: -1px 0 4px #555;\n    transform: translateX(900px);\n    opacity: .5;\n    z-index: 100;\n    transition: transform .4s, opacity .2s;\n}\n    .notify.error {\n        color: #fff;\n        background-color: #ff605c;\n    }\n    .notify.success {\n        color: #fff;\n        background-color: #00ca4e;\n    }\n    .notify.warning {\n        color: #555;\n        background-color: #E86923;\n        background-color: #ffa55c;\n    }\n    .notify.open { \n        transform: translateX(0); \n        opacity: 1;\n        transition: transform .2s, opacity .4s;\n    }\n\n\n/*\n  Projection window\n-----------------------------------------------------------------------------*/\n\n.projection-window {\n    position: absolute;\n    top: 120px; left: calc(100% - 240px);\n    padding: 6px 12px 8px;\n    background-color: #f5f5f5;\n    border-radius: 4px; \n    box-shadow: 0 1px 6px -2px #999;\n    z-index: 50;\n    transition: .2s;\n}\n\n    .projection-window-title {\n        display: block;\n        font-size: 1.4em; font-weight: 300;\n        margin-bottom: 6px;\n    }\n\n    .projection-window-views {\n        display: flex; flex-wrap: wrap;\n        max-width: 300px;\n    }\n\n    .projection-window-view {\n        margin-right: 6px; margin-bottom: 6px;\n        height: 48px; width: 48px;\n        padding: 4px 6px;\n        color: #222;\n        font-size: 1.3em;\n        border-radius: 2px;\n        box-shadow: inset -1px -2px 2px -1px #999;\n        background-color: #fff;\n    }\n\n    .projection-window-button {\n        margin-right: 12px;\n        height: 60px; width: 60px;\n        padding: 0;\n        line-height: 60px;\n        font-size: 1.3em; font-weight: 500;\n        color: #fff;\n        background-color: #5F84F4;\n        border-radius: 50%;\n        box-shadow: 0 2px 4px -1px #555;\n        transition: .2s;\n    }\n        .projection-window-button:disabled {\n            background-color: #555;\n            transform: scale(0.9);\n            opacity: 0.5;\n        }\n',""]);const o=a},3012:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,"/*\n * General field style\n-----------------------------------------------------------------------------*/\n\n.field {\n    position: relative;\n    z-index: 1;\n}\n\n    .field.active { z-index: 30; opacity: 1; }\n\n    .field.focus { z-index: 50; opacity: 1; }\n\n    .field.control {\n        display: inline-flex;\n        flex-direction: column;\n    }\n\n        .field.active > .field-message {\n            opacity: 1;\n            transform: translateY(-2px);\n        }\n\n        .field.active .notification-message {\n            opacity: 1;\n            z-index: 100;\n            background-color: #555;\n        }\n        .field.active .notification-message--error {\n            background-color: #db3b1f;\n        }\n\n    .field-message {\n        margin-left: 5px;\n        height: 10px; width: 10px;\n        font-style: normal;\n        border-radius: 50%;\n        background-color: #555;\n        transition: .2s;\n        z-index: 20;\n    }\n\n        .field-message .notification-message {\n            position: absolute;\n            top: calc(100% + 4px); left: calc(100% + 2px);\n            display: block;\n            padding: 5px;\n            font-size: 1.2rem; font-weight: 600;\n            color: #fff;\n            border-radius: 2px;\n            box-shadow: 1px 1px 3px -1px rgba(50, 50, 50, 0.95);\n            transform: translateY(-50%);\n            opacity: 0;\n            transition: .2s;\n            z-index: -10;\n        }\n        .field-message .notification-message--info { background-color: rgba(50, 50, 50, 0.95); }\n        .field-message .notification-message--error { background-color: rgb(221, 64, 36, 0.95); }\n\n\n/*\n * Field: Binary\n-----------------------------------------------------------------------------*/\n\n.field--checkbox {\n    display: inline-block;\n}\n\n.field--checkbox__input {\n    white-space: nowrap;\n    font-size: 1em;\n}\n\n.field--checkbox__label {\n    display: inline-flex;\n    align-items: center;\n    text-transform: capitalize;\n}\n\n    .field--checkbox__label-text {\n        margin-left: 4px;\n    }\n\n/*\n * Field: Text\n-----------------------------------------------------------------------------*/\n\n.field--textbox {\n    display: inline-flex;\n}\n\n.field--textbox__input {\n    display: inline-block;\n    width: 100%; min-width: 42px;\n    padding-left: 1px; padding-right: 1px;\n    font-size: 1em; font-family: inherit;\n    color: inherit;\n    border: 1px solid #000; border-radius: 1px;\n    background-color: transparent;\n    outline: none;\n    z-index: 5;\n}\n    .field--textbox__input.error {\n        border-color: #dd4124;\n        background-color: rgba(191, 25, 50, 0.2);\n    }\n    .field--textbox__input.empty {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n    }\n\n    .name-field--textual__input {\n        font-family: inherit;\n        display: inline-flex;\n        width: auto;\n        color: #333;\n        border-bottom: 1px solid #d5d5d5;\n        background-color: #f5f5f5;\n    }\n\n    .field--textbox.empty .field--textbox__input-pseudo:before {\n        content: attr(data-placeholder);\n        padding-left: 4px; padding-right: 4px;\n        flex: 1 1;\n        font-style: italic;\n        color: #555;\n    }\n\n.field--textbox__choices {\n    position: absolute;\n    top: calc(100% + 1px); left: 0;\n    min-width: 150px;\n    font-size: 1rem;\n    box-shadow: 0 1px 2px #999;\n    background-color: #fff;\n    z-index: 20;\n    cursor: default;\n}\n\n    .field--textbox__choice {\n        padding: 4px 1%;\n        color: #333;\n        font-size: 1.2em;\n    }\n        .field--textbox__choice:hover,\n        .field--textbox__choice:focus,\n        .field--textbox__choice:active {\n            background-color: #ffd300;\n        }\n\n\n/*\n * Field: List\n-----------------------------------------------------------------------------*/\n\n.field--list {\n    position: relative;\n}\n\n.field--list__list {\n    position: relative;\n    display: flex;\n    flex-wrap: wrap;\n    align-items: stretch;\n    width: 100%;\n}\n    .field--list__list.vertical { flex-direction: column; }\n\n    .field--list__list.horizontal { flex-direction: row; }\n\n    .field--list-item {\n        position: relative;\n        display: flex;\n        font-size: 1em;\n    }\n\n    .field--list-item .btn-remove {\n        font-size: 1em;\n    }\n\n\n/*\n * Field: Table\n-----------------------------------------------------------------------------*/\n\n.field--table {\n    width: 100%;\n}\n\n    .field--table__table {\n        width: 100%;\n        border: 0 none;\n    }\n\n    .field--table-cell {\n        position: relative;\n    }\n\n    .field--table__btn-add {\n        cursor: default;\n    }\n\n    .field--table-row:hover .field--table__btn-add {\n        opacity: 1;\n        transform: translateY(50%);\n    }\n\n/*\n * Field: Choice\n-----------------------------------------------------------------------------*/\n\n.field--choice {\n    display: inline-flex;\n    flex-wrap: wrap;\n    flex-direction: column;\n    font-size: 1em;\n}\n\n    .field--choice__input {\n        font-size: 1em;\n        margin-bottom: 2px;\n        overflow: hidden;\n        outline: none;\n        border: 1px solid #d5d5d5;\n        background-color: #fefefe;\n        z-index: 5;\n    }\n\n    .field--choice__choices {\n        position: relative;\n        display: flex;\n        margin: 0; padding: 0; list-style: none;\n        z-index: 2;\n    }\n    .field--choice__choice {\n        border: 1px solid #555;\n        cursor: pointer;\n    }\n    .field--choice__choice:hover {\n        background-color: #eee;\n    }\n    .field--choice__choice.selected {\n        background-color: #ffd300;\n    }\n\n\n.field--choice__select-wrapper {\n    display: flex; flex-direction: row;\n    border: 1px solid #c0c0c0;\n    border-radius: 2px;\n}\n\n.field--choice__select-value {\n    display: flex; flex-direction: row;\n    padding: 2px;\n    flex-grow: 2;\n}\n\n.field--choice__select-icon {\n    display: block;\n    padding: 2px 4px;\n}\n    .field--choice__select-icon:before {\n        content: '▼';\n        font-size: 0.9em;\n    }\n\n    .field--choice__select-list {\n        position: absolute;\n        top: 100%;\n        display: flex; flex-direction: column;\n        background-color: #fff;\n        box-shadow: 1px 0 1px #c0c0c0;\n        z-index: 50;\n    }\n\n    .field--choice__select-list .field--choice__choices {\n        flex-direction: column;\n        max-height: 300px;\n        overflow: auto;\n    }\n\n    .field--choice__choice {\n        position: relative;\n    }\n    \n    .field--choice__choice:after {\n        content: \"\";\n        position: absolute;\n        top: 0; right: 0; bottom: 0; left: 0;\n        background: transparent;\n        z-index: 50;\n    }",""]);const o=a},2016:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,'.active {\n    z-index: 10;\n}\n\n[data-projection].active-parent {\n    z-index: 5;\n}\n\n.algorithm-container.active{\n    filter: drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));\n    outline: 1px solid #5897F5;\n}\n\n[data-projection]:focus,\n.static.active,\n.field.active,\n.field--list-item:focus,\n.field-action:focus {\n    /* Visible in the full-colour space */\n    box-shadow: 0 0 0 1px #fff, 0 0 1px 3px #5897F5;\n\n    /* Visible in Windows high-contrast themes */\n    outline-color: transparent;\n    outline-width: 2px;\n    outline-style: dotted;\n}\n\n.projection.highlighted {\n    border-radius: 2px;\n    box-shadow: 0 0 0 1px #fff, 0 0 1px 3px #5897F5;\n    opacity: 1;\n    transition: .2s;\n    transition-property: transform, opacity;\n}\n\n.projection__btn-delete {\n    display: flex; align-items: center; justify-content: center;\n    font-weight: 600;\n    z-index: 5;\n}\n    .projection__btn-delete:before {\n        content: "✖";\n        display: block;\n        transition: .2s;\n    }\n\n.layout-container .btn-edit {\n    position: absolute;\n    top: 0; left: calc(100% + 2px);\n    padding: 4px 6px;\n    font-size: 1.3rem;\n    color: #fff;\n    background-color: #232425;\n    border-radius: 4px;\n    opacity: 0;\n    transform: scale(0);\n    transition: .2s;\n}\n\n/* .layout-container.active-parent > .btn-edit,\n.layout-container.active > .btn-edit {\n    opacity: 1;\n    transform: scale(1);   \n} */\n\n.layout-container.edit {\n    box-shadow: inset 0 1px 1px #999;\n    background-color: #f5f5f5;\n}\n\n    .layout-container.edit > [data-nature="layout"] {\n        opacity: 0.8;\n    }\n\n\n.layout-container > .btn-collapse {\n    position: absolute;\n    display: flex; justify-content: center;\n    top: -9px; right: calc(100% - 24px);\n    font-size: 0.9em;\n    height: 18px; \n    width: 18px;\n    border-radius: 50%;\n    background-color: #fff;\n    border: 1px solid #d5d5d5;\n    box-shadow: 1px 0 1px -1px #555;\n    outline: none;\n    transition: .2s;\n    z-index: 5;\n}\n\n.layout-container > .btn-collapse:hover {\n    transform: scale(1.1);\n}\n\n    .layout-container > .btn-collapse:after {\n        content: "-";\n        color: #222;\n        transform: scale(3) rotate(360deg) translateY(-1.5px);\n        transition: transform .2s;\n    }\n        .layout-container.collapsed > .btn-collapse:after {\n            content: "+";\n            color: #555;\n            transform: scale(2) rotate(0) translateY(-1.5px);\n        }\n\n    .layout-container:not(.collapsed) > .btn-collapse {\n        right: 6px;\n        box-shadow: -1px 0 1px -1px #555;\n        border-color: #bdbdbd;\n    }\n\n    .layout-container.collapsed > .layout-container-collapse {\n        max-height: 48px;\n        opacity: 0.5;\n    }',""]);const o=a},1901:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,"html,\nbody {\n    height: 100%;\n    font: normal 10px 'Segoe UI', 'Droid Sans', Ubuntu, 'Lucida Grande', Arial, sans-serif;\n}\n\nh1, h2, h3, h4, h5, h6 {\n    font-family: Garamond, Baskerville, Georgia, 'Times New Roman', Times, serif;\n}\n\np, li, td, th { font-size: 1.5em; }\n\nli li, \np li, td li, th li,\nli p, li td, li th { font-size: 1em; }\n\ntable, th, td { border: 1px solid #1b1b1b; border-collapse: collapse; }\n\nth { text-align: center; }\n\n.content-wrapper { position: relative; padding: 0 1%; }\n\n.btn {\n    border: none;\n    background: none;\n    font-family: 'Segoe UI', 'Droid Sans', Ubuntu, 'Lucida Grande', Arial, sans-serif;\n    text-decoration: none; text-align: center;\n    cursor: default;\n}\n\n[contenteditable=true] { outline: none; }\n\n[data-gentleman=\"editor\"] {\n    position: relative;\n    display: flex; flex-direction: column;\n    height: 100%; width: 100%;\n    font-size: 1rem;\n}\n\n.font-gentleman { font-family: Garamond, Baskerville, Georgia, 'Times New Roman', Times, serif; }\n\n.font-ui { font-family: 'Segoe UI', 'Droid Sans', Ubuntu, 'Lucida Grande', Arial, sans-serif; }\n\n.font-code { font-family: Consolas, 'Courier New', Courier, monospace; }\n\n/* Organization */\n\n.left { float: left; }\n\n.right { float: right; }\n\n.clear { clear: both; display: block; }\n\n.clear:after {\n    content: \".\";\n    clear: both;\n    display: block;\n    height: 0;\n    visibility: hidden;\n}\n\n/* Reset */\n\n.bare-list { margin: 0; padding: 0; list-style: none; }\n\n.bare-link { color: inherit; text-decoration: none; }\n\n.block { display: block!important; }\n\n.inline { display: inline-block!important; }\n\n.hidden { display: none!important; }\n\n.fit-content { overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }\n\n/* Scrollbar */\n\n/* width */\n::-webkit-scrollbar {\n    width: calc(6px + 1%); max-width: 10px;\n    height: calc(6px + 1%); max-height: 10px;\n}\n  \n/* Track */\n::-webkit-scrollbar-track {\n    background: #dcdcdc;\n}\n\n/* Handle */\n::-webkit-scrollbar-thumb {\n    background: #bfbfbf;\n}\n    /* Handle on hover */\n    ::-webkit-scrollbar-thumb:hover {\n        background: #808080;\n    }\n    /* Handle on active */\n    ::-webkit-scrollbar-thumb:active {\n        background: #555;\n    }\n\n/* Chrome, Safari, Edge, Opera */\ninput::-webkit-outer-spin-button,\ninput::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\n/* Firefox */\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n* {\n    box-sizing: border-box;\n}",""]);const o=a},2997:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,".shake {\n    -webkit-animation: shake 0.82s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;\n            animation: shake 0.82s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;\n    -webkit-transform: translate3d(0, 0, 0);\n            transform: translate3d(0, 0, 0);\n    -webkit-backface-visibility: hidden;\n            backface-visibility: hidden;\n    -webkit-perspective: 1000px;\n            perspective: 1000px;\n}\n    \n    @-webkit-keyframes shake {\n        10%, 90% {\n            -webkit-transform: translate3d(-1px, 0, 0);\n                    transform: translate3d(-1px, 0, 0);\n        }\n        20%, 80% {\n            -webkit-transform: translate3d(2px, 0, 0);\n                    transform: translate3d(2px, 0, 0);\n        }\n        30%, 50%, 70% {\n            -webkit-transform: translate3d(-4px, 0, 0);\n                    transform: translate3d(-4px, 0, 0);\n        }\n        40%, 60% {\n            -webkit-transform: translate3d(4px, 0, 0);\n                    transform: translate3d(4px, 0, 0);\n        }\n    }\n    \n    @keyframes shake {\n        10%, 90% {\n            -webkit-transform: translate3d(-1px, 0, 0);\n                    transform: translate3d(-1px, 0, 0);\n        }\n        20%, 80% {\n            -webkit-transform: translate3d(2px, 0, 0);\n                    transform: translate3d(2px, 0, 0);\n        }\n        30%, 50%, 70% {\n            -webkit-transform: translate3d(-4px, 0, 0);\n                    transform: translate3d(-4px, 0, 0);\n        }\n        40%, 60% {\n            -webkit-transform: translate3d(4px, 0, 0);\n                    transform: translate3d(4px, 0, 0);\n        }\n    }\n\n.swap-left {\n    position: absolute;\n    padding: 20px;\n    background-color: #fff;\n    border-radius: 2px;\n    box-shadow: 1px 2px 2px rgba(20, 20, 20, 0.8);\n    transform: scale(1) translate(0, 0);\n    overflow: hidden;\n    animation: swap-left .6s ease-in;\n    animation-fill-mode: forwards;\n    z-index: 10;\n}\n    \n    @keyframes swap-left {\n        20% {\n            opacity: 1;\n            box-shadow: 2px 4px 5px rgba(20, 20, 20, 0.8);\n            transform: scale(1.2) translate(20px, 20px);\n        }\n        50% {\n            opacity: 0.8;\n            box-shadow: 2px 4px 10px rgba(20, 20, 20, 0.6);\n            transform: scale(1) translate(0px, 20px);\n        }\n        80% {\n            opacity: 0.5;    \n            box-shadow: 2px 4px 10px rgba(20, 20, 20, 0.5);\n            transform: scale(0.8) translate(-200px, 20px);\n        }\n        100% {\n            opacity: 0;    \n            box-shadow: 2px 4px 10px rgba(20, 20, 20, 0.2);\n            transform: scale(0.8) translate(-600px, 0);\n        }\n    }\n\n.fade-in {\n    -webkit-animation: fadein .4s;\n            animation: fadein .4s;\n}\n\n@keyframes fadein {\n    from { opacity: 0; }\n    to   { opacity: 1; }\n}\n\n\n\n.resizer {\n    position: absolute;\n    opacity: 0;\n    background-color: #d5d5d5;\n}\n    .resizer:hover { \n        opacity: 0.8; \n    }\n    .resizer:active,\n    .resizer:focus {\n        opacity: 1;\n        background-color: #5897F5;\n    }\n\n.resizer.horizontal {\n    top: 0; left: 100%;\n    width: 6px;\n    height: 100%;\n    cursor: col-resize;\n}\n\n.resizer.vertical {\n    top: 100%; left: 0;\n    width: 100%;\n    height: 6px;\n    cursor: row-resize;\n}\n",""]);const o=a},5501:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,'/* Document\n   ========================================================================== */\n\n/**\n * 1. Change the default font family in all browsers (opinionated).\n * 2. Correct the line height in all browsers.\n * 3. Prevent adjustments of font size after orientation changes in\n *    IE on Windows Phone and in iOS.\n */\n\nhtml {\n  font-family: sans-serif; /* 1 */\n  line-height: 1.15; /* 2 */\n  -ms-text-size-adjust: 100%; /* 3 */\n  -webkit-text-size-adjust: 100%; /* 3 */\n}\n\n/* Sections\n   ========================================================================== */\n\n/**\n * Remove the margin in all browsers (opinionated).\n */\n\nbody {\n  margin: 0;\n}\n\n/**\n * Add the correct display in IE 9-.\n */\n\narticle,\naside,\nfooter,\nheader,\nnav,\nsection {\n  display: block;\n}\n\n/**\n * Correct the font size and margin on `h1` elements within `section` and\n * `article` contexts in Chrome, Firefox, and Safari.\n */\n\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\n\n/* Grouping content\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 9-.\n * 1. Add the correct display in IE.\n */\n\nfigcaption,\nfigure,\nmain { /* 1 */\n  display: block;\n}\n\n/**\n * Add the correct margin in IE 8.\n */\n\nfigure {\n  margin: 1em 40px;\n}\n\n/**\n * 1. Add the correct box sizing in Firefox.\n * 2. Show the overflow in Edge and IE.\n */\n\nhr {\n  box-sizing: content-box; /* 1 */\n  height: 0; /* 1 */\n  overflow: visible; /* 2 */\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\npre {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/* Text-level semantics\n   ========================================================================== */\n\n/**\n * 1. Remove the gray background on active links in IE 10.\n * 2. Remove gaps in links underline in iOS 8+ and Safari 8+.\n */\n\na {\n  background-color: transparent; /* 1 */\n  -webkit-text-decoration-skip: objects; /* 2 */\n}\n\n/**\n * Remove the outline on focused links when they are also active or hovered\n * in all browsers (opinionated).\n */\n\na:active,\na:hover {\n  outline-width: 0;\n}\n\n/**\n * 1. Remove the bottom border in Firefox 39-.\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\n */\n\nabbr[title] {\n  border-bottom: none; /* 1 */\n  text-decoration: underline; /* 2 */\n  text-decoration: underline dotted; /* 2 */\n}\n\n/**\n * Prevent the duplicate application of `bolder` by the next rule in Safari 6.\n */\n\nb,\nstrong {\n  font-weight: inherit;\n}\n\n/**\n * Add the correct font weight in Chrome, Edge, and Safari.\n */\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\ncode,\nkbd,\nsamp {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/**\n * Add the correct font style in Android 4.3-.\n */\n\ndfn {\n  font-style: italic;\n}\n\n/**\n * Add the correct background and color in IE 9-.\n */\n\nmark {\n  background-color: #ff0;\n  color: #000;\n}\n\n/**\n * Add the correct font size in all browsers.\n */\n\nsmall {\n  font-size: 80%;\n}\n\n/**\n * Prevent `sub` and `sup` elements from affecting the line height in\n * all browsers.\n */\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/* Embedded content\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 9-.\n */\n\naudio,\nvideo {\n  display: inline-block;\n}\n\n/**\n * Add the correct display in iOS 4-7.\n */\n\naudio:not([controls]) {\n  display: none;\n  height: 0;\n}\n\n/**\n * Remove the border on images inside links in IE 10-.\n */\n\nimg {\n  border-style: none;\n}\n\n/**\n * Hide the overflow in IE.\n */\n\nsvg:not(:root) {\n  overflow: hidden;\n}\n\n/* Forms\n   ========================================================================== */\n\n/**\n * 1. Change the font styles in all browsers (opinionated).\n * 2. Remove the margin in Firefox and Safari.\n */\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: sans-serif; /* 1 */\n  font-size: 100%; /* 1 */\n  line-height: 1.15; /* 1 */\n  margin: 0; /* 2 */\n}\n\n/**\n * Show the overflow in IE.\n * 1. Show the overflow in Edge.\n */\n\nbutton,\ninput { /* 1 */\n  overflow: visible;\n}\n\n/**\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\n * 1. Remove the inheritance of text transform in Firefox.\n */\n\nbutton,\nselect { /* 1 */\n  text-transform: none;\n}\n\n/**\n * 1. Prevent a WebKit bug where (2) destroys native `audio` and `video`\n *    controls in Android 4.\n * 2. Correct the inability to style clickable types in iOS and Safari.\n */\n\nbutton,\nhtml [type="button"], /* 1 */\n[type="reset"],\n[type="submit"] {\n  -webkit-appearance: button; /* 2 */\n}\n\n/**\n * Remove the inner border and padding in Firefox.\n */\n\nbutton::-moz-focus-inner,\n[type="button"]::-moz-focus-inner,\n[type="reset"]::-moz-focus-inner,\n[type="submit"]::-moz-focus-inner {\n  border-style: none;\n  padding: 0;\n}\n\n/**\n * Restore the focus styles unset by the previous rule.\n */\n\nbutton:-moz-focusring,\n[type="button"]:-moz-focusring,\n[type="reset"]:-moz-focusring,\n[type="submit"]:-moz-focusring {\n  outline: 1px dotted ButtonText;\n}\n\n/**\n * Change the border, margin, and padding in all browsers (opinionated).\n */\n\nfieldset {\n  border: 1px solid #c0c0c0;\n  margin: 0 2px;\n  padding: 0.35em 0.625em 0.75em;\n}\n\n/**\n * 1. Correct the text wrapping in Edge and IE.\n * 2. Correct the color inheritance from `fieldset` elements in IE.\n * 3. Remove the padding so developers are not caught out when they zero out\n *    `fieldset` elements in all browsers.\n */\n\nlegend {\n  box-sizing: border-box; /* 1 */\n  color: inherit; /* 2 */\n  display: table; /* 1 */\n  max-width: 100%; /* 1 */\n  padding: 0; /* 3 */\n  white-space: normal; /* 1 */\n}\n\n/**\n * 1. Add the correct display in IE 9-.\n * 2. Add the correct vertical alignment in Chrome, Firefox, and Opera.\n */\n\nprogress {\n  display: inline-block; /* 1 */\n  vertical-align: baseline; /* 2 */\n}\n\n/**\n * Remove the default vertical scrollbar in IE.\n */\n\ntextarea {\n  overflow: auto;\n}\n\n/**\n * 1. Add the correct box sizing in IE 10-.\n * 2. Remove the padding in IE 10-.\n */\n\n[type="checkbox"],\n[type="radio"] {\n  box-sizing: border-box; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Correct the cursor style of increment and decrement buttons in Chrome.\n */\n\n[type="number"]::-webkit-inner-spin-button,\n[type="number"]::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/**\n * 1. Correct the odd appearance in Chrome and Safari.\n * 2. Correct the outline style in Safari.\n */\n\n[type="search"] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/**\n * Remove the inner padding and cancel buttons in Chrome and Safari on macOS.\n */\n\n[type="search"]::-webkit-search-cancel-button,\n[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/**\n * 1. Correct the inability to style clickable types in iOS and Safari.\n * 2. Change font properties to `inherit` in Safari.\n */\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/* Interactive\n   ========================================================================== */\n\n/*\n * Add the correct display in IE 9-.\n * 1. Add the correct display in Edge, IE, and Firefox.\n */\n\ndetails, /* 1 */\nmenu {\n  display: block;\n}\n\n/*\n * Add the correct display in all browsers.\n */\n\nsummary {\n  display: list-item;\n}\n\n/* Scripting\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 9-.\n */\n\ncanvas {\n  display: inline-block;\n}\n\n/**\n * Add the correct display in IE.\n */\n\ntemplate {\n  display: none;\n}\n\n/* Hidden\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 10-.\n */\n\n[hidden] {\n  display: none;\n}',""]);const o=a},4987:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([t.id,'.content-wrapper { padding-left: 1%; padding-right: 1%; }\n\n.app {\n    height: 100%;\n    display: flex;\n}\n    .app .editor-statusbar {\n        background-color: #d5d5d5;\n    }\n    .app .editor-statusbar-viewers {\n        display: none;\n    }\n\n    .app .editor-concept-header {\n        display: none;\n    }\n    \n    .app .editor-toolbar__button--home {\n        display: none;\n    }\n\n.app-editor {\n    overflow: auto;\n}\n\n.app-editor-header__button {\n    position: relative;\n    display: block;\n    width: 60px; height: 24px;\n    padding: 0;\n    font-size: 1.4rem;\n    font-weight: 500;\n    border-radius: 180px;\n    background-color: #f0f0f0;\n    box-shadow: 0 1px 2px #777;\n    transition: .2s;\n    margin-left: 6px;\n}\n\n.app-preview {\n    width: 50%;\n    padding-left: 12px;\n}\n\n.form {\n    background-color: #f5f5f5;\n    box-shadow: 0 1px 2px #999;\n    height: 100%;\n}\n\n.page-header {\n    flex-grow: 1;\n    display: flex; align-items: center;\n    height: 42px;\n    color: #fff;\n    background-color: #3573DD;\n}\n\n.page-body {\n    height: 100%;\n    height: calc(100% - 42px);\n}\n\n.page-footer {\n    color: #fff;\n    background-color: #292723;\n    padding: 24px 1%;\n}\n\n    .poweredby {\n        font-size: 1.3em;\n    }\n\n    .page-footer__link--gentleman {\n        background-color: #fff;\n        color: #3a3b4f;\n        padding: 1px 6px 2px;\n        border-radius: 180px;\n    }\n\n    .page-footer__link--gentleman .info {\n        display: none;\n    }\n\n\n.survey {\n    height: 100%;\n    font-size: 12px;\n    padding: 12px;\n}\n\n.survey button {\n    border: 0 none;\n}\n\n.survey .title {\n    font-size: 1.3em; \n    font-weight: 500;\n    margin-bottom: 6px;\n}\n\n.survey .projection-element--placeholder {\n    display: inline-block;\n    padding: 4px 6px 5px;\n    text-align: center;\n    margin-top: 6px;\n    margin-bottom: 6px;\n    color: #fff;\n    width: 120px;\n    font-style: normal; font-weight: 500; font-size: 1.2em;\n    border-radius: 2px;\n    background-color: #2C5EB4;\n    cursor: pointer;\n}\n\n.labeled-textbox {\n    display: inline-flex; flex-direction: column\n}\n\n    .labeled-textbox__label {\n        margin-bottom: 1px;\n        font-size: 1.2em; font-weight: 500;\n        color: #555;\n    }\n\n    .labeled-textbox.active .labeled-textbox__label {\n        color: #1F75FE;\n    }\n\n    .labeled-textbox__input {\n        border: 2px solid #e5e4e2;\n        border-radius: 4px; font-size: 1.3em;\n        padding: 6px;\n        background-color: #fbfbfb;\n    }\n\n    .labeled-textbox__input.empty {\n        border-color: #d5d5d5;\n    }\n\n    .labeled-textbox__input:focus,\n    .labeled-textbox__input:active {\n        border-color: #1F75FE;\n    }\n\n    .labeled-textbox__input.error {\n        border-color: #F27E88;\n    }\n\n\n\n.labeled-numbox {\n    display: inline-flex; flex-direction: column\n}\n\n    .labeled-numbox__label {\n        margin-bottom: 1px;\n        font-size: 1.2em; font-weight: 500;\n        color: #555;\n    }\n\n    .labeled-numbox.active .labeled-numbox__label {\n        color: #1F75FE;\n    }\n\n    .labeled-numbox__input {\n        border: 2px solid #e5e4e2;\n        border-radius: 4px; font-size: 1.3em;\n        padding: 6px;\n        background-color: #fbfbfb;\n    }\n\n    .labeled-numbox__input.empty {\n        border-color: #d5d5d5;\n    }\n\n    .labeled-numbox__input:focus,\n    .labeled-numbox__input:active {\n        border-color: #1F75FE;\n    }\n\n    .labeled-numbox__input.error {\n        border-color: #F27E88;\n    }\n\n\n\n/*\n  Question SET styling\n-----------------------------------------------------------------------------*/\n\n.ql-question-set {\n    width: 100%;\n    margin-top: 6px;\n}\n\n.ql-question-set-header {\n    align-items: center;\n    padding-bottom: 2px;\n    margin-bottom: 6px;\n}\n\n    .ql-question-set-header-title {\n        color: #283440;\n        text-transform: uppercase;\n        margin-right: 6px;\n        font-size: 1.3em;\n    }\n\n    .ql-question-set-header__button {\n        display: flex; align-items: center;\n        height: 24px;\n        font-weight: 500; font-size: 1.2em;\n        border-radius: 180px;\n        color: #fff;\n        background-color: #1F75FE;\n    }\n        .ql-question-set-header__button:hover { \n            color: #fff;\n            background-color: #232425;\n        }\n\n        .ql-question-set-header__button-content {\n            display: flex; align-items: center; justify-content: center;\n            width: 100%;\n            height: 100%;\n            padding-left: 3px; padding-right: 3px;\n        }\n\n.ql-question-set__list {\n    display: flex; flex-direction: column;\n}\n\n.ql-question-set__list-item {\n    display: flex; flex-direction: row;\n    background-color: #f5f5f5;\n    padding: 12px;\n    border-radius: 6px;\n    box-shadow: 0 2px 1px -1px #999;\n}\n    .ql-question-set__list-item:not(:last-child) {\n        margin-bottom: 6px;\n    }\n\n    .ql-question-set__list-item >  .ql-textbox {\n        width: calc(100% - 24px);\n    }\n\n    .ql-question-set__list-item >  .ql-textbox .ql-textarea__input {\n        border-radius: 2px 2px 0 0;\n    }\n\n    .ql-question-set__list-item > .projection__btn-delete {\n        order: 2;\n        position: relative;\n        margin-left: 6px;\n        width: 18px;\n        height: 18px;\n        font-size: 1.2rem; font-weight: 300;\n        border-radius: 50%;\n        color: #f1645a;\n        background-color: #fff;\n        opacity: 0.8;\n        border: 1px solid currentColor;\n    }\n    .ql-question-set__list-item > .projection__btn-delete:hover {\n        color: #A6352D;\n        opacity: 1;\n    }\n    .ql-question-set__list-item > .projection__btn-delete:hover:before {\n        transform: rotate(180deg);\n    }\n    \n    .ql-question-set__list-item.collapsed .question-identification,\n    .ql-question-set__list-item.collapsed .question-config {\n        display: none!important;\n    }\n    \n    .ql-question-set__list-item.collapsed  .question-preview {\n        display: flex!important;\n    }\n\n\n    .ql-question-set__list-item .question-preview {\n        display: none!important;\n    }\n\n    .ql-question-set__list-item > .projection__btn-delete {\n        position: absolute;\n        top: 6px; right: 12px;\n        width: 24px; height: 24px;\n        font-size: 0.9em; font-weight: 300;\n        border: 0 none;\n        background-color: #d5d5d5;\n        color: #222;\n        z-index: 50;\n    }\n        .ql-question-set__list-item > .projection__btn-delete:before {\n            content: "✖";\n        }\n        .ql-question-set__list-item > .projection__btn-delete:hover {\n            color: #fff;\n            background-color: #ff1c55;\n        }\n\n\n    .ql-question-set__list-item > .projection__btn-collapse {\n        position: absolute;\n        top: 6px; right: 48px;\n        display: flex; align-items: center; justify-content: center;\n        width: 24px; height: 24px;\n        font-size: 0.7em; font-weight: 800;\n        background-color: #d5d5d5;\n        color: #222;\n        z-index: 50;\n    }\n        .ql-question-set__list-item > .projection__btn-collapse:before {\n            content: "—";\n        }\n\n        .ql-question-set__list-item > .projection__btn-collapse:hover {\n            color: #fff;\n            background-color: #1f75fe;\n        }\n        \n        .ql-question-set__list-item.collapsed > .projection__btn-collapse:before {\n            content: "▢";\n            font-size: 1.3em;\n        }\n\n\n\n.ql-question-header {\n    align-items: flex-end;\n}\n\n.ql-question-title {\n    flex-grow: 2;\n}\n\n.question-name .field--textbox__input  {\n    font-family: Consolas, \'Courier New\', Courier, monospace;\n}\n\n.question-order {\n    margin-left: 2px;\n}\n    .question-order .labeled-numbox__input {\n        width: 60px;\n    }\n\n.question-label {\n    flex-grow: 2;\n    margin-left: 12px;\n}\n\n.question-expression {\n    margin-top: 6px;\n    margin-bottom: 6px;\n}\n\n    .question-expression .projection__btn-delete  {\n        position: absolute;\n        right: 0;\n    }\n\n    .question-expression .labeled-textbox__input {\n        font-family: Consolas, \'Courier New\', Courier, monospace;\n    }\n\n.selector-choice__option {\n    margin-right: 6px;\n    padding: 6px 12px;\n    font-weight: 500;\n    font-size: 1em;\n    border: 0 none;\n    border-radius: 180px;\n    background-color: #e5e4e2;\n    box-shadow: 0 1px 2px #999;\n}\n    .selector-choice__option:hover {\n        color: #fff;\n        background-color: #232425;\n    }\n\n    .selector-choice__option.selected {\n        color: #fff;\n        background-color: royalblue;\n        transition: .2s;\n        box-shadow: none;\n    }\n\n\n\n\n/*\n    Tag list\n-----------------------------------------------------------------------------*/\n\n.mp-tags {\n    display: flex;\n}\n\n.mp-tag {\n    padding: 0;\n    display: inline-flex; align-items: baseline;\n    border-radius: 2px;\n    margin-right: 6px;\n    padding-left: 2px;\n    background-color: #f5f5f5;\n}\n\n    .mp-tag .mp-textfield-input {\n        order: 1;\n        padding-left: 2px;\n        padding-right: 2px;\n        border: 0 none;\n    }\n        .mp-tag:before {\n            content: "#";\n            font-size: 1.2em; font-weight: bold;\n            color: #1f75fe;\n            font-family: Consolas, \'Courier New\', Courier, monospace;\n        }\n\n    .mp-tag .projection__btn-delete {\n        order: 2;\n        color: #555;\n        border-left: 1px solid currentColor;\n        font-size: 0.9em;\n    }\n        .mp-tag .projection__btn-delete:hover {\n            color: #FF350D;\n        }\n\n        .mp-tag .projection__btn-delete:hover + .mp-tag__input {\n            opacity: 0.6;\n        }\n\n    .mp-tag .projection__btn-collapse {\n        display: none;\n    }\n\n\n\n/*\n Select choice\n-----------------------------------------------------------------------------*/\n\n.select-choice {\n    font-size: 1.3rem;\n    border: 0 none;\n    border-radius: 2px;\n    background-color: #e5e4e2;\n}\n\n    .select-choice__input {\n        padding: 1px 3px;\n        border: 0 none;  border-radius: 180px;\n        box-shadow: 0 1px 1px #c0c0c0;\n    }\n\n    .select-choice__list-option.selected {\n        color: #3197eb;\n        background-color: #fff;\n    }\n\n    .select-choice:not(.active):not(.empty) .field--choice__select-wrapper {\n        padding: 2px 6px;\n        border: 0 none;\n        font-weight: 500;\n    }\n\n    .select-choice .field--choice__select-list {\n        min-width: 100%;\n    }\n\n    .select-choice:not(.empty) .field--choice__select-value {  \n        color: #222;\n    }\n\n    .select-choice__list-option {\n        font-size: 0.95em;\n        padding: 4px 6px;\n        margin-top: 2px;\n        border: 0 none;\n        border-radius: 1px;\n        background-color: #e5e4e2;\n        transition: transform .2s;\n    }      \n        .select-choice__list-option:hover,\n        .select-choice__list-option:focus {\n            background-color: #f5f5f5;\n        }       \n        .select-choice__list-option.selected {\n            font-weight: bold;\n        }\n    \n        .select-choice__list-option.field--choice__choice--placeholder {\n            font-style: italic;\n            background-color: #f5f5f5;\n        }\n \n\n\n/*\n Radio choice\n-----------------------------------------------------------------------------*/\n\n.radio-choice {\n    display: flex; \n}\n\n    .radio-choice__list-option.selected {\n        color: #222;\n        text-transform: uppercase;\n        background-color: #ffd300;\n    }\n\n    .radio-choice__list-option.field--choice__choice--placeholder {\n        font-style: italic;\n        background-color: #f5f5f5;\n    }\n\n    .radio-choice:not(.empty) .field--choice__select-value {  \n        text-transform: uppercase;\n        color: #222;\n    }\n\n    .radio-choice__list-option {\n        font-size: 1.2rem;\n        flex: 1 1;\n        padding: 2px 4px;\n        margin-top: 2px;\n        border: 0 none;\n        border-radius: 1px;\n        color: #fff;\n        background-color: #555;\n        transition: transform .2s;\n    }      \n        .radio-choice__list-option:hover,\n        .radio-choice__list-option:not(.selected):focus {\n            background-color: #222;\n        }\n\n        .radio-choice__list-option .text {\n            display: block;\n            width: 100%;\n            text-align: center;\n        }\n\n\n/*\n Switch field\n------------------------------------------------------------------*/\n\n.switch-field__checkbox { display: none; }\n\n.switch-field__label { \n    position: relative;\n    padding-top: 2px; padding-bottom: 2px; padding-left: 50px;\n    font-size: 1.3em; font-weight: 600;\n    z-index: 20;\n    /* background-color: #fff; */\n}\n    .switch-field__label:before,\n    .switch-field__label:after {\n        content: "";\n        position: absolute;\n    }\n    .switch-field__label:before {\n        top: calc(50% - 9px); left: 0;\n        width: 18px; \n        height: 18px;\n        border-radius: 50%;\n        background-color: #555;\n        box-shadow: 0 1px 2px #999, 0 -1px #d5d5d5;\n        z-index: -1;\n        transition: transform .2s;\n    }\n    .switch-field__label:after {\n        top: calc(50% - 8px); left: 0;\n        height: 16px;\n        width: 36px;\n        border-radius: 180px;\n        background-color: #c0c0c0;\n        z-index: -2;\n        transition: background-color .2s .1s\n    }\n\n    .switch-field[data-state="on"] .switch-field__label:before { \n        background-color: royalblue; \n        box-shadow: 0 2px 3px #999, 0 -1px #d5d5d5;\n        transform: translateX(18px) scale(1.02); \n    }\n\n    .switch-field[data-state="on"] {\n        color: royalblue;\n    }\n\n.computed-field {\n    background-color: #f3f3f3;\n    padding: 6px 10px;\n    border: 1px dashed #ccc;\n    font-style: italic;\n    color: #444;\n}',""]);const o=a},6314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<t.length;c++){var h=[].concat(t[c]);i&&a[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),e.push(h))}},e}},1601:t=>{"use strict";t.exports=function(t){return t[1]}},4143:(t,e,n)=>{var i,r;!function(){var s={version:"3.5.17"},a=[].slice,o=function(t){return a.call(t)},l=this.document;function c(t){return t&&(t.ownerDocument||t.document||t).documentElement}function h(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(l)try{o(l.documentElement.childNodes)[0].nodeType}catch(t){o=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),l)try{l.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var u=this.Element.prototype,d=u.setAttribute,p=u.setAttributeNS,f=this.CSSStyleDeclaration.prototype,m=f.setProperty;u.setAttribute=function(t,e){d.call(this,t,e+"")},u.setAttributeNS=function(t,e,n){p.call(this,t,e,n+"")},f.setProperty=function(t,e,n){m.call(this,t,e+"",n)}}function g(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function b(t){return null===t?NaN:+t}function v(t){return!isNaN(t)}function y(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)<0?i=s+1:r=s}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)>0?r=s:i=s+1}return i}}}s.ascending=g,s.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},s.min=function(t,e){var n,i,r=-1,s=t.length;if(1===arguments.length){for(;++r<s;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<s;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<s;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<s;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},s.max=function(t,e){var n,i,r=-1,s=t.length;if(1===arguments.length){for(;++r<s;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<s;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<s;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<s;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},s.extent=function(t,e){var n,i,r,s=-1,a=t.length;if(1===arguments.length){for(;++s<a;)if(null!=(i=t[s])&&i>=i){n=r=i;break}for(;++s<a;)null!=(i=t[s])&&(n>i&&(n=i),r<i&&(r=i))}else{for(;++s<a;)if(null!=(i=e.call(t,t[s],s))&&i>=i){n=r=i;break}for(;++s<a;)null!=(i=e.call(t,t[s],s))&&(n>i&&(n=i),r<i&&(r=i))}return[n,r]},s.sum=function(t,e){var n,i=0,r=t.length,s=-1;if(1===arguments.length)for(;++s<r;)v(n=+t[s])&&(i+=n);else for(;++s<r;)v(n=+e.call(t,t[s],s))&&(i+=n);return i},s.mean=function(t,e){var n,i=0,r=t.length,s=-1,a=r;if(1===arguments.length)for(;++s<r;)v(n=b(t[s]))?i+=n:--a;else for(;++s<r;)v(n=b(e.call(t,t[s],s)))?i+=n:--a;if(a)return i/a},s.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],s=n-i;return s?r+s*(t[i]-r):r},s.median=function(t,e){var n,i=[],r=t.length,a=-1;if(1===arguments.length)for(;++a<r;)v(n=b(t[a]))&&i.push(n);else for(;++a<r;)v(n=b(e.call(t,t[a],a)))&&i.push(n);if(i.length)return s.quantile(i.sort(g),.5)},s.variance=function(t,e){var n,i,r=t.length,s=0,a=0,o=-1,l=0;if(1===arguments.length)for(;++o<r;)v(n=b(t[o]))&&(a+=(i=n-s)*(n-(s+=i/++l)));else for(;++o<r;)v(n=b(e.call(t,t[o],o)))&&(a+=(i=n-s)*(n-(s+=i/++l)));if(l>1)return a/(l-1)},s.deviation=function(){var t=s.variance.apply(this,arguments);return t?Math.sqrt(t):t};var x=y(g);function w(t){return t.length}s.bisectLeft=x.left,s.bisect=s.bisectRight=x.right,s.bisector=function(t){return y(1===t.length?function(e,n){return g(t(e),n)}:t)},s.shuffle=function(t,e,n){(s=arguments.length)<3&&(n=t.length,s<2&&(e=0));for(var i,r,s=n-e;s;)r=Math.random()*s--|0,i=t[s+e],t[s+e]=t[r+e],t[r+e]=i;return t},s.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},s.pairs=function(t){for(var e=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);e<n;)r[e]=[i,i=t[++e]];return r},s.transpose=function(t){if(!(r=t.length))return[];for(var e=-1,n=s.min(t,w),i=new Array(n);++e<n;)for(var r,a=-1,o=i[e]=new Array(r);++a<r;)o[a]=t[a][e];return i},s.zip=function(){return s.transpose(arguments)},s.keys=function(t){var e=[];for(var n in t)e.push(n);return e},s.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},s.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},s.merge=function(t){for(var e,n,i,r=t.length,s=-1,a=0;++s<r;)a+=t[s].length;for(n=new Array(a);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--a]=i[e];return n};var E=Math.abs;function A(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function N(){this._=Object.create(null)}s.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var i,r=[],s=function(t){for(var e=1;t*e%1;)e*=10;return e}(E(n)),a=-1;if(t*=s,e*=s,(n*=s)<0)for(;(i=t+n*++a)>e;)r.push(i/s);else for(;(i=t+n*++a)<e;)r.push(i/s);return r},s.map=function(t,e){var n=new N;if(t instanceof N)t.forEach((function(t,e){n.set(t,e)}));else if(Array.isArray(t)){var i,r=-1,s=t.length;if(1===arguments.length)for(;++r<s;)n.set(r,t[r]);else for(;++r<s;)n.set(e.call(t,i=t[r],r),i)}else for(var a in t)n.set(a,t[a]);return n};var O="__proto__",k="\0";function _(t){return(t+="")===O||t[0]===k?k+t:t}function j(t){return(t+="")[0]===k?t.slice(1):t}function M(t){return _(t)in this._}function C(t){return(t=_(t))in this._&&delete this._[t]}function S(){var t=[];for(var e in this._)t.push(j(e));return t}function L(){var t=0;for(var e in this._)++t;return t}function T(){for(var t in this._)return!1;return!0}function I(){this._=Object.create(null)}function U(t){return t}function D(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function H(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=P.length;n<i;++n){var r=P[n]+e;if(r in t)return r}}A(N,{has:M,get:function(t){return this._[_(t)]},set:function(t,e){return this._[_(t)]=e},remove:C,keys:S,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:j(e),value:this._[e]});return t},size:L,empty:T,forEach:function(t){for(var e in this._)t.call(this,j(e),this._[e])}}),s.nest=function(){var t,e,n={},i=[],r=[];function a(r,s,o){if(o>=i.length)return e?e.call(n,s):t?s.sort(t):s;for(var l,c,h,u,d=-1,p=s.length,f=i[o++],m=new N;++d<p;)(u=m.get(l=f(c=s[d])))?u.push(c):m.set(l,[c]);return r?(c=r(),h=function(t,e){c.set(t,a(r,e,o))}):(c={},h=function(t,e){c[t]=a(r,e,o)}),m.forEach(h),c}function o(t,e){if(e>=i.length)return t;var n=[],s=r[e++];return t.forEach((function(t,i){n.push({key:t,values:o(i,e)})})),s?n.sort((function(t,e){return s(t.key,e.key)})):n}return n.map=function(t,e){return a(e,t,0)},n.entries=function(t){return o(a(s.map,t,0),0)},n.key=function(t){return i.push(t),n},n.sortKeys=function(t){return r[i.length-1]=t,n},n.sortValues=function(e){return t=e,n},n.rollup=function(t){return e=t,n},n},s.set=function(t){var e=new I;if(t)for(var n=0,i=t.length;n<i;++n)e.add(t[n]);return e},A(I,{has:M,add:function(t){return this._[_(t+="")]=!0,t},remove:C,values:S,size:L,empty:T,forEach:function(t){for(var e in this._)t.call(this,j(e))}}),s.behavior={},s.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=D(t,e,e[n]);return t};var P=["webkit","ms","moz","Moz","o","O"];function z(){}function V(){}function R(t){var e=[],n=new N;function i(){for(var n,i=e,r=-1,s=i.length;++r<s;)(n=i[r].on)&&n.apply(this,arguments);return t}return i.on=function(i,r){var s,a=n.get(i);return arguments.length<2?a&&a.on:(a&&(a.on=null,e=e.slice(0,s=e.indexOf(a)).concat(e.slice(s+1)),n.remove(i)),r&&e.push(n.set(i,{on:r})),t)},i}function B(){s.event.preventDefault()}function q(){for(var t,e=s.event;t=e.sourceEvent;)e=t;return e}function F(t){for(var e=new V,n=0,i=arguments.length;++n<i;)e[arguments[n]]=R(e);return e.of=function(n,i){return function(r){try{var a=r.sourceEvent=s.event;r.target=t,s.event=r,e[r.type].apply(n,i)}finally{s.event=a}}},e}s.dispatch=function(){for(var t=new V,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=R(t);return t},V.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},s.event=null,s.requote=function(t){return t.replace($,"\\$&")};var $=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,W={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};function Y(t){return W(t,Z),t}var X=function(t,e){return e.querySelector(t)},G=function(t,e){return e.querySelectorAll(t)},J=function(t,e){var n=t.matches||t[H(t,"matchesSelector")];return J=function(t,e){return n.call(t,e)},J(t,e)};"function"==typeof Sizzle&&(X=function(t,e){return Sizzle(t,e)[0]||null},G=Sizzle,J=Sizzle.matchesSelector),s.selection=function(){return s.select(l.documentElement)};var Z=s.selection.prototype=[];function Q(t){return"function"==typeof t?t:function(){return X(t,this)}}function K(t){return"function"==typeof t?t:function(){return G(t,this)}}Z.select=function(t){var e,n,i,r,s=[];t=Q(t);for(var a=-1,o=this.length;++a<o;){s.push(e=[]),e.parentNode=(i=this[a]).parentNode;for(var l=-1,c=i.length;++l<c;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,a)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return Y(s)},Z.selectAll=function(t){var e,n,i=[];t=K(t);for(var r=-1,s=this.length;++r<s;)for(var a=this[r],l=-1,c=a.length;++l<c;)(n=a[l])&&(i.push(e=o(t.call(n,n.__data__,l,r))),e.parentNode=n);return Y(i)};var tt="http://www.w3.org/1999/xhtml",et={svg:"http://www.w3.org/2000/svg",xhtml:tt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nt(t,e){return t=s.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function it(t){return t.trim().replace(/\s+/g," ")}function rt(t){return new RegExp("(?:^|\\s+)"+s.requote(t)+"(?:\\s+|$)","g")}function st(t){return(t+"").trim().split(/^|\s+/)}function at(t,e){var n=(t=st(t).map(ot)).length;return"function"==typeof e?function(){for(var i=-1,r=e.apply(this,arguments);++i<n;)t[i](this,r)}:function(){for(var i=-1;++i<n;)t[i](this,e)}}function ot(t){var e=rt(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",it(r+" "+t))):n.setAttribute("class",it(r.replace(e," ")))}}function lt(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}:function(){this.style.setProperty(t,e,n)}}function ct(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function ht(t){return"function"==typeof t?t:(t=s.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var e=this.ownerDocument,n=this.namespaceURI;return n===tt&&e.documentElement.namespaceURI===tt?e.createElement(t):e.createElementNS(n,t)}}function ut(){var t=this.parentNode;t&&t.removeChild(this)}function dt(t){return{__data__:t}}function pt(t){return function(){return J(this,t)}}function ft(t){return arguments.length||(t=g),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function mt(t,e){for(var n=0,i=t.length;n<i;n++)for(var r,s=t[n],a=0,o=s.length;a<o;a++)(r=s[a])&&e(r,a,n);return t}function gt(t){return W(t,bt),t}s.ns={prefix:et,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),et.hasOwnProperty(n)?{space:et[n],local:t}:t}},Z.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=s.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(nt(e,t[e]));return this}return this.each(nt(t,e))},Z.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=st(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!rt(t[r]).test(e))return!1;return!0}for(e in t)this.each(at(e,t[e]));return this}return this.each(at(t,e))},Z.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.each(lt(n,t[n],e));return this}if(i<2){var r=this.node();return h(r).getComputedStyle(r,null).getPropertyValue(t)}n=""}return this.each(lt(t,e,n))},Z.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(ct(e,t[e]));return this}return this.each(ct(t,e))},Z.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},Z.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},Z.append=function(t){return t=ht(t),this.select((function(){return this.appendChild(t.apply(this,arguments))}))},Z.insert=function(t,e){return t=ht(t),e=Q(e),this.select((function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)}))},Z.remove=function(){return this.each(ut)},Z.data=function(t,e){var n,i,r=-1,s=this.length;if(!arguments.length){for(t=new Array(s=(n=this[0]).length);++r<s;)(i=n[r])&&(t[r]=i.__data__);return t}function a(t,n){var i,r,s,a=t.length,h=n.length,u=Math.min(a,h),d=new Array(h),p=new Array(h),f=new Array(a);if(e){var m,g=new N,b=new Array(a);for(i=-1;++i<a;)(r=t[i])&&(g.has(m=e.call(r,r.__data__,i))?f[i]=r:g.set(m,r),b[i]=m);for(i=-1;++i<h;)(r=g.get(m=e.call(n,s=n[i],i)))?!0!==r&&(d[i]=r,r.__data__=s):p[i]=dt(s),g.set(m,!0);for(i=-1;++i<a;)i in b&&!0!==g.get(b[i])&&(f[i]=t[i])}else{for(i=-1;++i<u;)r=t[i],s=n[i],r?(r.__data__=s,d[i]=r):p[i]=dt(s);for(;i<h;++i)p[i]=dt(n[i]);for(;i<a;++i)f[i]=t[i]}p.update=d,p.parentNode=d.parentNode=f.parentNode=t.parentNode,o.push(p),l.push(d),c.push(f)}var o=gt([]),l=Y([]),c=Y([]);if("function"==typeof t)for(;++r<s;)a(n=this[r],t.call(n,n.parentNode.__data__,r));else for(;++r<s;)a(n=this[r],t);return l.enter=function(){return o},l.exit=function(){return c},l},Z.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},Z.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=pt(t));for(var s=0,a=this.length;s<a;s++){r.push(e=[]),e.parentNode=(n=this[s]).parentNode;for(var o=0,l=n.length;o<l;o++)(i=n[o])&&t.call(i,i.__data__,o,s)&&e.push(i)}return Y(r)},Z.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,s=i[r];--r>=0;)(n=i[r])&&(s&&s!==n.nextSibling&&s.parentNode.insertBefore(n,s),s=n);return this},Z.sort=function(t){t=ft.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},Z.each=function(t){return mt(this,(function(e,n,i){t.call(e,e.__data__,n,i)}))},Z.call=function(t){var e=o(arguments);return t.apply(e[0]=this,e),this},Z.empty=function(){return!this.node()},Z.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],i=0,r=n.length;i<r;i++){var s=n[i];if(s)return s}return null},Z.size=function(){var t=0;return mt(this,(function(){++t})),t};var bt=[];function vt(t,e,n){var i="__on"+t,r=t.indexOf("."),a=xt;r>0&&(t=t.slice(0,r));var l=yt.get(t);function c(){var e=this[i];e&&(this.removeEventListener(t,e,e.$),delete this[i])}return l&&(t=l,a=wt),r?e?function(){var r=a(e,o(arguments));c.call(this),this.addEventListener(t,this[i]=r,r.$=n),r._=e}:c:e?z:function(){var e,n=new RegExp("^__on([^.]+)"+s.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}}s.selection.enter=gt,s.selection.enter.prototype=bt,bt.append=Z.append,bt.empty=Z.empty,bt.node=Z.node,bt.call=Z.call,bt.size=Z.size,bt.select=function(t){for(var e,n,i,r,s,a=[],o=-1,l=this.length;++o<l;){i=(r=this[o]).update,a.push(e=[]),e.parentNode=r.parentNode;for(var c=-1,h=r.length;++c<h;)(s=r[c])?(e.push(i[c]=n=t.call(r.parentNode,s.__data__,c,o)),n.__data__=s.__data__):e.push(null)}return Y(a)},bt.insert=function(t,e){var n,i,r;return arguments.length<2&&(n=this,e=function(t,e,s){var a,o=n[s].update,l=o.length;for(s!=r&&(r=s,i=0),e>=i&&(i=e+1);!(a=o[i])&&++i<l;);return a}),Z.insert.call(this,t,e)},s.select=function(t){var e;return"string"==typeof t?(e=[X(t,l)]).parentNode=l.documentElement:(e=[t]).parentNode=c(t),Y([e])},s.selectAll=function(t){var e;return"string"==typeof t?(e=o(G(t,l))).parentNode=l.documentElement:(e=o(t)).parentNode=null,Y([e])},Z.on=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=!1),t)this.each(vt(n,t[n],e));return this}if(i<2)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(vt(t,e,n))};var yt=s.map({mouseenter:"mouseover",mouseleave:"mouseout"});function xt(t,e){return function(n){var i=s.event;s.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{s.event=i}}}function wt(t,e){var n=xt(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}l&&yt.forEach((function(t){"on"+t in l&&yt.remove(t)}));var Et,At=0;function Nt(t){var e=".dragsuppress-"+ ++At,n="click"+e,i=s.select(h(t)).on("touchmove"+e,B).on("dragstart"+e,B).on("selectstart"+e,B);if(null==Et&&(Et=!("onselectstart"in t)&&H(t.style,"userSelect")),Et){var r=c(t).style,a=r[Et];r[Et]="none"}return function(t){if(i.on(e,null),Et&&(r[Et]=a),t){var s=function(){i.on(n,null)};i.on(n,(function(){B(),s()}),!0),setTimeout(s,0)}}}s.mouse=function(t){return kt(t,q())};var Ot=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function kt(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(Ot<0){var r=h(t);if(r.scrollX||r.scrollY){var a=(n=s.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();Ot=!(a.f||a.e),n.remove()}}return Ot?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function _t(){return s.event.changedTouches[0].identifier}s.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=q().changedTouches),e)for(var i,r=0,s=e.length;r<s;++r)if((i=e[r]).identifier===n)return kt(t,i)},s.behavior.drag=function(){var t=F(r,"drag","dragstart","dragend"),e=null,n=a(z,s.mouse,h,"mousemove","mouseup"),i=a(_t,s.touch,U,"touchmove","touchend");function r(){this.on("mousedown.drag",n).on("touchstart.drag",i)}function a(n,i,r,a,o){return function(){var l,c=this,h=s.event.target.correspondingElement||s.event.target,u=c.parentNode,d=t.of(c,arguments),p=0,f=n(),m=".drag"+(null==f?"":"-"+f),g=s.select(r(h)).on(a+m,(function(){var t,e,n=i(u,f);n&&(t=n[0]-v[0],e=n[1]-v[1],p|=t|e,v=n,d({type:"drag",x:n[0]+l[0],y:n[1]+l[1],dx:t,dy:e}))})).on(o+m,(function(){i(u,f)&&(g.on(a+m,null).on(o+m,null),b(p),d({type:"dragend"}))})),b=Nt(h),v=i(u,f);l=e?[(l=e.apply(c,arguments)).x-v[0],l.y-v[1]]:[0,0],d({type:"dragstart"})}}return r.origin=function(t){return arguments.length?(e=t,r):e},s.rebind(r,t,"on")},s.touches=function(t,e){return arguments.length<2&&(e=q().touches),e?o(e).map((function(e){var n=kt(t,e);return n.identifier=e.identifier,n})):[]};var jt=1e-6,Mt=jt*jt,Ct=Math.PI,St=2*Ct,Lt=St-jt,Tt=Ct/2,It=Ct/180,Ut=180/Ct;function Dt(t){return t>0?1:t<0?-1:0}function Ht(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Pt(t){return t>1?0:t<-1?Ct:Math.acos(t)}function zt(t){return t>1?Tt:t<-1?-Tt:Math.asin(t)}function Vt(t){return((t=Math.exp(t))+1/t)/2}function Rt(t){return(t=Math.sin(t/2))*t}var Bt=Math.SQRT2;s.interpolateZoom=function(t,e){var n,i,r=t[0],s=t[1],a=t[2],o=e[0],l=e[1],c=e[2],h=o-r,u=l-s,d=h*h+u*u;if(d<Mt)i=Math.log(c/a)/Bt,n=function(t){return[r+t*h,s+t*u,a*Math.exp(Bt*t*i)]};else{var p=Math.sqrt(d),f=(c*c-a*a+4*d)/(2*a*2*p),m=(c*c-a*a-4*d)/(2*c*2*p),g=Math.log(Math.sqrt(f*f+1)-f),b=Math.log(Math.sqrt(m*m+1)-m);i=(b-g)/Bt,n=function(t){var e,n=t*i,o=Vt(g),l=a/(2*p)*(o*(e=Bt*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[r+l*h,s+l*u,a*o/Vt(Bt*n+g)]}}return n.duration=1e3*i,n},s.behavior.zoom=function(){var t,e,n,i,r,a,o,c,u,d={x:0,y:0,k:1},p=[960,500],f=$t,m=250,g=0,b="mousedown.zoom",v="mousemove.zoom",y="mouseup.zoom",x="touchstart.zoom",w=F(E,"zoomstart","zoom","zoomend");function E(t){t.on(b,S).on(Ft+".zoom",T).on("dblclick.zoom",I).on(x,L)}function A(t){return[(t[0]-d.x)/d.k,(t[1]-d.y)/d.k]}function N(t){d.k=Math.max(f[0],Math.min(f[1],t))}function O(t,e){e=function(t){return[t[0]*d.k+d.x,t[1]*d.k+d.y]}(e),d.x+=t[0]-e[0],d.y+=t[1]-e[1]}function k(t,n,i,r){t.__chart__={x:d.x,y:d.y,k:d.k},N(Math.pow(2,r)),O(e=n,i),t=s.select(t),m>0&&(t=t.transition().duration(m)),t.call(E.event)}function _(){o&&o.domain(a.range().map((function(t){return(t-d.x)/d.k})).map(a.invert)),u&&u.domain(c.range().map((function(t){return(t-d.y)/d.k})).map(c.invert))}function j(t){g++||t({type:"zoomstart"})}function M(t){_(),t({type:"zoom",scale:d.k,translate:[d.x,d.y]})}function C(t){--g||(t({type:"zoomend"}),e=null)}function S(){var t=this,e=w.of(t,arguments),n=0,i=s.select(h(t)).on(v,(function(){n=1,O(s.mouse(t),r),M(e)})).on(y,(function(){i.on(v,null).on(y,null),a(n),C(e)})),r=A(s.mouse(t)),a=Nt(t);Co.call(t),j(e)}function L(){var t,e=this,n=w.of(e,arguments),i={},a=0,o=".zoom-"+s.event.changedTouches[0].identifier,l="touchmove"+o,c="touchend"+o,h=[],u=s.select(e),p=Nt(e);function f(){var n=s.touches(e);return t=d.k,n.forEach((function(t){t.identifier in i&&(i[t.identifier]=A(t))})),n}function m(){var t=s.event.target;s.select(t).on(l,g).on(c,v),h.push(t);for(var n=s.event.changedTouches,o=0,u=n.length;o<u;++o)i[n[o].identifier]=null;var p=f(),m=Date.now();if(1===p.length){if(m-r<500){var b=p[0];k(e,b,i[b.identifier],Math.floor(Math.log(d.k)/Math.LN2)+1),B()}r=m}else if(p.length>1){b=p[0];var y=p[1],x=b[0]-y[0],w=b[1]-y[1];a=x*x+w*w}}function g(){var o,l,c,h,u=s.touches(e);Co.call(e);for(var d=0,p=u.length;d<p;++d,h=null)if(c=u[d],h=i[c.identifier]){if(l)break;o=c,l=h}if(h){var f=(f=c[0]-o[0])*f+(f=c[1]-o[1])*f,m=a&&Math.sqrt(f/a);o=[(o[0]+c[0])/2,(o[1]+c[1])/2],l=[(l[0]+h[0])/2,(l[1]+h[1])/2],N(m*t)}r=null,O(o,l),M(n)}function v(){if(s.event.touches.length){for(var t=s.event.changedTouches,e=0,r=t.length;e<r;++e)delete i[t[e].identifier];for(var a in i)return void f()}s.selectAll(h).on(o,null),u.on(b,S).on(x,L),p(),C(n)}m(),j(n),u.on(b,null).on(x,m)}function T(){var r=w.of(this,arguments);i?clearTimeout(i):(Co.call(this),t=A(e=n||s.mouse(this)),j(r)),i=setTimeout((function(){i=null,C(r)}),50),B(),N(Math.pow(2,.002*qt())*d.k),O(e,t),M(r)}function I(){var t=s.mouse(this),e=Math.log(d.k)/Math.LN2;k(this,t,A(t),s.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}return Ft||(Ft="onwheel"in l?(qt=function(){return-s.event.deltaY*(s.event.deltaMode?120:1)},"wheel"):"onmousewheel"in l?(qt=function(){return s.event.wheelDelta},"mousewheel"):(qt=function(){return-s.event.detail},"MozMousePixelScroll")),E.event=function(t){t.each((function(){var t=w.of(this,arguments),n=d;To?s.select(this).transition().each("start.zoom",(function(){d=this.__chart__||{x:0,y:0,k:1},j(t)})).tween("zoom:zoom",(function(){var i=p[0],r=p[1],a=e?e[0]:i/2,o=e?e[1]:r/2,l=s.interpolateZoom([(a-d.x)/d.k,(o-d.y)/d.k,i/d.k],[(a-n.x)/n.k,(o-n.y)/n.k,i/n.k]);return function(e){var n=l(e),r=i/n[2];this.__chart__=d={x:a-n[0]*r,y:o-n[1]*r,k:r},M(t)}})).each("interrupt.zoom",(function(){C(t)})).each("end.zoom",(function(){C(t)})):(this.__chart__=d,j(t),M(t),C(t))}))},E.translate=function(t){return arguments.length?(d={x:+t[0],y:+t[1],k:d.k},_(),E):[d.x,d.y]},E.scale=function(t){return arguments.length?(d={x:d.x,y:d.y,k:null},N(+t),_(),E):d.k},E.scaleExtent=function(t){return arguments.length?(f=null==t?$t:[+t[0],+t[1]],E):f},E.center=function(t){return arguments.length?(n=t&&[+t[0],+t[1]],E):n},E.size=function(t){return arguments.length?(p=t&&[+t[0],+t[1]],E):p},E.duration=function(t){return arguments.length?(m=+t,E):m},E.x=function(t){return arguments.length?(o=t,a=t.copy(),d={x:0,y:0,k:1},E):o},E.y=function(t){return arguments.length?(u=t,c=t.copy(),d={x:0,y:0,k:1},E):u},s.rebind(E,w,"on")};var qt,Ft,$t=[0,1/0];function Wt(){}function Yt(t,e,n){return this instanceof Yt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof Yt?new Yt(t.h,t.s,t.l):fe(""+t,me,Yt):new Yt(t,e,n)}s.color=Wt,Wt.prototype.toString=function(){return this.rgb()+""},s.hsl=Yt;var Xt=Yt.prototype=new Wt;function Gt(t,e,n){var i,r;function s(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?i+(r-i)*t/60:t<180?r:t<240?i+(r-i)*(240-t)/60:i}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)||e<0?0:e>1?1:e,i=2*(n=n<0?0:n>1?1:n)-(r=n<=.5?n*(1+e):n+e-n*e),new ce(s(t+120),s(t),s(t-120))}function Jt(t,e,n){return this instanceof Jt?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof Jt?new Jt(t.h,t.c,t.l):function(t,e,n){return t>0?new Jt(Math.atan2(n,e)*Ut,Math.sqrt(e*e+n*n),t):new Jt(NaN,NaN,t)}(t instanceof Kt?t.l:(t=ge((t=s.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Jt(t,e,n)}Xt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Yt(this.h,this.s,this.l/t)},Xt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Yt(this.h,this.s,t*this.l)},Xt.rgb=function(){return Gt(this.h,this.s,this.l)},s.hcl=Jt;var Zt=Jt.prototype=new Wt;function Qt(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new Kt(n,Math.cos(t*=It)*e,Math.sin(t)*e)}function Kt(t,e,n){return this instanceof Kt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof Kt?new Kt(t.l,t.a,t.b):t instanceof Jt?Qt(t.h,t.c,t.l):ge((t=ce(t)).r,t.g,t.b):new Kt(t,e,n)}Zt.brighter=function(t){return new Jt(this.h,this.c,Math.min(100,this.l+te*(arguments.length?t:1)))},Zt.darker=function(t){return new Jt(this.h,this.c,Math.max(0,this.l-te*(arguments.length?t:1)))},Zt.rgb=function(){return Qt(this.h,this.c,this.l).rgb()},s.lab=Kt;var te=18,ee=.95047,ne=1,ie=1.08883,re=Kt.prototype=new Wt;function se(t,e,n){var i=(t+16)/116,r=i+e/500,s=i-n/200;return new ce(le(3.2404542*(r=ae(r)*ee)-1.5371385*(i=ae(i)*ne)-.4985314*(s=ae(s)*ie)),le(-.969266*r+1.8760108*i+.041556*s),le(.0556434*r-.2040259*i+1.0572252*s))}function ae(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function oe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function le(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ce(t,e,n){return this instanceof ce?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof ce?new ce(t.r,t.g,t.b):fe(""+t,ce,Gt):new ce(t,e,n)}function he(t){return new ce(t>>16,t>>8&255,255&t)}function ue(t){return he(t)+""}re.brighter=function(t){return new Kt(Math.min(100,this.l+te*(arguments.length?t:1)),this.a,this.b)},re.darker=function(t){return new Kt(Math.max(0,this.l-te*(arguments.length?t:1)),this.a,this.b)},re.rgb=function(){return se(this.l,this.a,this.b)},s.rgb=ce;var de=ce.prototype=new Wt;function pe(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function fe(t,e,n){var i,r,s,a=0,o=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(ve(r[0]),ve(r[1]),ve(r[2]))}return(s=ye.get(t))?e(s.r,s.g,s.b):(null==t||"#"!==t.charAt(0)||isNaN(s=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&s)>>4,a|=a>>4,o=240&s,o|=o>>4,l=15&s,l|=l<<4):7===t.length&&(a=(16711680&s)>>16,o=(65280&s)>>8,l=255&s)),e(a,o,l))}function me(t,e,n){var i,r,s=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),o=a-s,l=(a+s)/2;return o?(r=l<.5?o/(a+s):o/(2-a-s),i=t==a?(e-n)/o+(e<n?6:0):e==a?(n-t)/o+2:(t-e)/o+4,i*=60):(i=NaN,r=l>0&&l<1?0:i),new Yt(i,r,l)}function ge(t,e,n){var i=oe((.4124564*(t=be(t))+.3575761*(e=be(e))+.1804375*(n=be(n)))/ee),r=oe((.2126729*t+.7151522*e+.072175*n)/ne);return Kt(116*r-16,500*(i-r),200*(r-oe((.0193339*t+.119192*e+.9503041*n)/ie)))}function be(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ve(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}de.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&e<r&&(e=r),n&&n<r&&(n=r),i&&i<r&&(i=r),new ce(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new ce(r,r,r)},de.darker=function(t){return new ce((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},de.hsl=function(){return me(this.r,this.g,this.b)},de.toString=function(){return"#"+pe(this.r)+pe(this.g)+pe(this.b)};var ye=s.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function xe(t){return"function"==typeof t?t:function(){return t}}function we(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),Ee(e,n,t,i)}}function Ee(t,e,n,i){var r={},a=s.dispatch("beforesend","progress","load","error"),l={},c=new XMLHttpRequest,h=null;function u(){var t,e=c.status;if(!e&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(c)||e>=200&&e<300||304===e){try{t=n.call(r,c)}catch(t){return void a.error.call(r,t)}a.load.call(r,t)}else a.error.call(r,c)}return this.XDomainRequest&&!("withCredentials"in c)&&/^(http(s)?:)?\/\//.test(t)&&(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(t){var e=s.event;s.event=t;try{a.progress.call(r,c)}finally{s.event=e}},r.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",r)},r.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",r):e},r.responseType=function(t){return arguments.length?(h=t,r):h},r.response=function(t){return n=t,r},["get","post"].forEach((function(t){r[t]=function(){return r.send.apply(r,[t].concat(o(arguments)))}})),r.send=function(n,i,s){if(2===arguments.length&&"function"==typeof i&&(s=i,i=null),c.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),c.setRequestHeader)for(var o in l)c.setRequestHeader(o,l[o]);return null!=e&&c.overrideMimeType&&c.overrideMimeType(e),null!=h&&(c.responseType=h),null!=s&&r.on("error",s).on("load",(function(t){s(null,t)})),a.beforesend.call(r,c),c.send(null==i?null:i),r},r.abort=function(){return c.abort(),r},s.rebind(r,a,"on"),null==i?r:r.get(function(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}(i))}ye.forEach((function(t,e){ye.set(t,he(e))})),s.functor=xe,s.xhr=we(U),s.dsv=function(t,e){var n=new RegExp('["'+t+"\n]"),i=t.charCodeAt(0);function r(t,n,i){arguments.length<3&&(i=n,n=null);var r=Ee(t,e,null==n?s:a(n),i);return r.row=function(t){return arguments.length?r.response(null==(n=t)?s:a(t)):n},r}function s(t){return r.parse(t.responseText)}function a(t){return function(e){return r.parse(e.responseText,t)}}function o(e){return e.map(l).join(t)}function l(t){return n.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return r.parse=function(t,e){var n;return r.parseRows(t,(function(t,i){if(n)return n(t,i-1);var r=new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+"]"})).join(",")+"}");n=e?function(t,n){return e(r(t),n)}:r}))},r.parseRows=function(t,e){var n,r,s={},a={},o=[],l=t.length,c=0,h=0;function u(){if(c>=l)return a;if(r)return r=!1,s;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return c=n+2,13===(o=t.charCodeAt(n+1))?(r=!0,10===t.charCodeAt(n+2)&&++c):10===o&&(r=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;c<l;){var o,h=1;if(10===(o=t.charCodeAt(c++)))r=!0;else if(13===o)r=!0,10===t.charCodeAt(c)&&(++c,++h);else if(o!==i)continue;return t.slice(e,c-h)}return t.slice(e)}for(;(n=u())!==a;){for(var d=[];n!==s&&n!==a;)d.push(n),n=u();e&&null==(d=e(d,h++))||o.push(d)}return o},r.format=function(e){if(Array.isArray(e[0]))return r.formatRows(e);var n=new I,i=[];return e.forEach((function(t){for(var e in t)n.has(e)||i.push(n.add(e))})),[i.map(l).join(t)].concat(e.map((function(e){return i.map((function(t){return l(e[t])})).join(t)}))).join("\n")},r.formatRows=function(t){return t.map(o).join("\n")},r},s.csv=s.dsv(",","text/csv"),s.tsv=s.dsv("\t","text/tab-separated-values");var Ae,Ne,Oe,ke,_e=this[H(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function je(t,e,n){var i=arguments.length;i<2&&(e=0),i<3&&(n=Date.now());var r={c:t,t:n+e,n:null};return Ne?Ne.n=r:Ae=r,Ne=r,Oe||(ke=clearTimeout(ke),Oe=1,_e(Me)),r}function Me(){var t=Ce(),e=Se()-t;e>24?(isFinite(e)&&(clearTimeout(ke),ke=setTimeout(Me,e)),Oe=0):(Oe=1,_e(Me))}function Ce(){for(var t=Date.now(),e=Ae;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Se(){for(var t,e=Ae,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:Ae=e.n;return Ne=t,n}function Le(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}s.timer=function(){je.apply(this,arguments)},s.timer.flush=function(){Ce(),Se()},s.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Te=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map((function(t,e){var n=Math.pow(10,3*E(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}));function Ie(t){var e=t.decimal,n=t.thousands,i=t.grouping,r=t.currency,a=i&&n?function(t,e){for(var r=t.length,s=[],a=0,o=i[0],l=0;r>0&&o>0&&(l+o+1>e&&(o=Math.max(1,e-l)),s.push(t.substring(r-=o,r+o)),!((l+=o+1)>e));)o=i[a=(a+1)%i.length];return s.reverse().join(n)}:U;return function(t){var n=Ue.exec(t),i=n[1]||" ",o=n[2]||">",l=n[3]||"-",c=n[4]||"",h=n[5],u=+n[6],d=n[7],p=n[8],f=n[9],m=1,g="",b="",v=!1,y=!0;switch(p&&(p=+p.substring(1)),(h||"0"===i&&"="===o)&&(h=i="0",o="="),f){case"n":d=!0,f="g";break;case"%":m=100,b="%",f="f";break;case"p":m=100,b="%",f="r";break;case"b":case"o":case"x":case"X":"#"===c&&(g="0"+f.toLowerCase());case"c":y=!1;case"d":v=!0,p=0;break;case"s":m=-1,f="r"}"$"===c&&(g=r[0],b=r[1]),"r"!=f||p||(f="g"),null!=p&&("g"==f?p=Math.max(1,Math.min(21,p)):"e"!=f&&"f"!=f||(p=Math.max(0,Math.min(20,p)))),f=De.get(f)||He;var x=h&&d;return function(t){var n=b;if(v&&t%1)return"";var r=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===l?"":l;if(m<0){var c=s.formatPrefix(t,p);t=c.scale(t),n=c.symbol+b}else t*=m;var w,E,A=(t=f(t,p)).lastIndexOf(".");if(A<0){var N=y?t.lastIndexOf("e"):-1;N<0?(w=t,E=""):(w=t.substring(0,N),E=t.substring(N))}else w=t.substring(0,A),E=e+t.substring(A+1);!h&&d&&(w=a(w,1/0));var O=g.length+w.length+E.length+(x?0:r.length),k=O<u?new Array(O=u-O+1).join(i):"";return x&&(w=a(k+w,k.length?u-E.length:1/0)),r+=g,t=w+E,("<"===o?r+t+k:">"===o?k+r+t:"^"===o?k.substring(0,O>>=1)+r+t+k.substring(O):r+(x?t:k+t))+n}}}s.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=s.round(t,Le(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),Te[8+n/3]};var Ue=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,De=s.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=s.round(t,Le(t,e))).toFixed(Math.max(0,Math.min(20,Le(t*(1+1e-15),e))))}});function He(t){return t+""}var Pe=s.time={},ze=Date;function Ve(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Ve.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Re.setUTCDate.apply(this._,arguments)},setDay:function(){Re.setUTCDay.apply(this._,arguments)},setFullYear:function(){Re.setUTCFullYear.apply(this._,arguments)},setHours:function(){Re.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Re.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Re.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Re.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Re.setUTCSeconds.apply(this._,arguments)},setTime:function(){Re.setTime.apply(this._,arguments)}};var Re=Date.prototype;function Be(t,e,n){function i(e){var n=t(e),i=s(n,1);return e-n<i-e?n:i}function r(n){return e(n=t(new ze(n-1)),1),n}function s(t,n){return e(t=new ze(+t),n),t}function a(t,i,s){var a=r(t),o=[];if(s>1)for(;a<i;)n(a)%s||o.push(new Date(+a)),e(a,1);else for(;a<i;)o.push(new Date(+a)),e(a,1);return o}t.floor=t,t.round=i,t.ceil=r,t.offset=s,t.range=a;var o=t.utc=qe(t);return o.floor=o,o.round=qe(i),o.ceil=qe(r),o.offset=qe(s),o.range=function(t,e,n){try{ze=Ve;var i=new Ve;return i._=t,a(i,e,n)}finally{ze=Date}},t}function qe(t){return function(e,n){try{ze=Ve;var i=new Ve;return i._=e,t(i,n)._}finally{ze=Date}}}function Fe(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,a=t.days,o=t.shortDays,l=t.months,c=t.shortMonths;function h(t){var e=t.length;function n(n){for(var i,r,s,a=[],o=-1,l=0;++o<e;)37===t.charCodeAt(o)&&(a.push(t.slice(l,o)),null!=(r=$e[i=t.charAt(++o)])&&(i=t.charAt(++o)),(s=w[i])&&(i=s(n,null==r?"e"===i?" ":"0":r)),a.push(i),l=o+1);return a.push(t.slice(l,o)),a.join("")}return n.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(u(n,t,e,0)!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var i=null!=n.Z&&ze!==Ve,r=new(i?Ve:ze);return"j"in n?r.setFullYear(n.y,0,n.j):"W"in n||"U"in n?("w"in n||(n.w="W"in n?1:0),r.setFullYear(n.y,0,1),r.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(r.getDay()+5)%7:n.w+7*n.U-(r.getDay()+6)%7)):r.setFullYear(n.y,n.m,n.d),r.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),i?r._:r},n.toString=function(){return t},n}function u(t,e,n,i){for(var r,s,a,o=0,l=e.length,c=n.length;o<l;){if(i>=c)return-1;if(37===(r=e.charCodeAt(o++))){if(a=e.charAt(o++),!(s=E[a in $e?e.charAt(o++):a])||(i=s(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}h.utc=function(t){var e=h(t);function n(t){try{var n=new(ze=Ve);return n._=t,e(n)}finally{ze=Date}}return n.parse=function(t){try{ze=Ve;var n=e.parse(t);return n&&n._}finally{ze=Date}},n.toString=e.toString,n},h.multi=h.utc.multi=pn;var d=s.map(),p=Ge(a),f=Je(a),m=Ge(o),g=Je(o),b=Ge(l),v=Je(l),y=Ge(c),x=Je(c);r.forEach((function(t,e){d.set(t.toLowerCase(),e)}));var w={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:h(e),d:function(t,e){return Xe(t.getDate(),e,2)},e:function(t,e){return Xe(t.getDate(),e,2)},H:function(t,e){return Xe(t.getHours(),e,2)},I:function(t,e){return Xe(t.getHours()%12||12,e,2)},j:function(t,e){return Xe(1+Pe.dayOfYear(t),e,3)},L:function(t,e){return Xe(t.getMilliseconds(),e,3)},m:function(t,e){return Xe(t.getMonth()+1,e,2)},M:function(t,e){return Xe(t.getMinutes(),e,2)},p:function(t){return r[+(t.getHours()>=12)]},S:function(t,e){return Xe(t.getSeconds(),e,2)},U:function(t,e){return Xe(Pe.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Xe(Pe.mondayOfYear(t),e,2)},x:h(n),X:h(i),y:function(t,e){return Xe(t.getFullYear()%100,e,2)},Y:function(t,e){return Xe(t.getFullYear()%1e4,e,4)},Z:un,"%":function(){return"%"}},E={a:function(t,e,n){m.lastIndex=0;var i=m.exec(e.slice(n));return i?(t.w=g.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){p.lastIndex=0;var i=p.exec(e.slice(n));return i?(t.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){y.lastIndex=0;var i=y.exec(e.slice(n));return i?(t.m=x.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){b.lastIndex=0;var i=b.exec(e.slice(n));return i?(t.m=v.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,e,n){return u(t,w.c.toString(),e,n)},d:sn,e:sn,H:on,I:on,j:an,L:hn,m:rn,M:ln,p:function(t,e,n){var i=d.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)},S:cn,U:Qe,w:Ze,W:Ke,x:function(t,e,n){return u(t,w.x.toString(),e,n)},X:function(t,e,n){return u(t,w.X.toString(),e,n)},y:en,Y:tn,Z:nn,"%":dn};return h}Pe.year=Be((function(t){return(t=Pe.day(t)).setMonth(0,1),t}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t){return t.getFullYear()})),Pe.years=Pe.year.range,Pe.years.utc=Pe.year.utc.range,Pe.day=Be((function(t){var e=new ze(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t){return t.getDate()-1})),Pe.days=Pe.day.range,Pe.days.utc=Pe.day.utc.range,Pe.dayOfYear=function(t){var e=Pe.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(t,e){e=7-e;var n=Pe[t]=Be((function(t){return(t=Pe.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t}),(function(t,e){t.setDate(t.getDate()+7*Math.floor(e))}),(function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)-(n!==e)}));Pe[t+"s"]=n.range,Pe[t+"s"].utc=n.utc.range,Pe[t+"OfYear"]=function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)}})),Pe.week=Pe.sunday,Pe.weeks=Pe.sunday.range,Pe.weeks.utc=Pe.sunday.utc.range,Pe.weekOfYear=Pe.sundayOfYear;var $e={"-":"",_:" ",0:"0"},We=/^\s*\d+/,Ye=/^%/;function Xe(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function Ge(t){return new RegExp("^(?:"+t.map(s.requote).join("|")+")","i")}function Je(t){for(var e=new N,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Ze(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Qe(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Ke(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function tn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function en(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.y=function(t){return t+(t>68?1900:2e3)}(+i[0]),n+i[0].length):-1}function nn(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function rn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function sn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function an(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function on(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function ln(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function cn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function hn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function un(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=E(e)/60|0,r=E(e)%60;return n+Xe(i,"0",2)+Xe(r,"0",2)}function dn(t,e,n){Ye.lastIndex=0;var i=Ye.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function pn(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}s.locale=function(t){return{numberFormat:Ie(t),timeFormat:Fe(t)}};var fn=s.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function mn(){}s.format=fn.numberFormat,s.geo={},mn.prototype={s:0,t:0,add:function(t){bn(t,this.t,gn),bn(gn.s,this.s,this),this.s?this.t+=gn.t:this.s=gn.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var gn=new mn;function bn(t,e,n){var i=n.s=t+e,r=i-t,s=i-r;n.t=t-s+(e-r)}function vn(t,e){t&&xn.hasOwnProperty(t.type)&&xn[t.type](t,e)}s.geo.stream=function(t,e){t&&yn.hasOwnProperty(t.type)?yn[t.type](t,e):vn(t,e)};var yn={Feature:function(t,e){vn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)vn(n[i].geometry,e)}},xn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){wn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)wn(n[i],e,0)},Polygon:function(t,e){En(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)En(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)vn(n[i],e)}};function wn(t,e,n){var i,r=-1,s=t.length-n;for(e.lineStart();++r<s;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function En(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)wn(t[n],e,1);e.polygonEnd()}s.geo.area=function(t){return An=0,s.geo.stream(t,Dn),An};var An,Nn,On,kn,_n,jn,Mn,Cn,Sn,Ln,Tn,In,Un=new mn,Dn={sphere:function(){An+=4*Ct},point:z,lineStart:z,lineEnd:z,polygonStart:function(){Un.reset(),Dn.lineStart=Hn},polygonEnd:function(){var t=2*Un;An+=t<0?4*Ct+t:t,Dn.lineStart=Dn.lineEnd=Dn.point=z}};function Hn(){var t,e,n,i,r;function s(t,e){e=e*It/2+Ct/4;var s=(t*=It)-n,a=s>=0?1:-1,o=a*s,l=Math.cos(e),c=Math.sin(e),h=r*c,u=i*l+h*Math.cos(o),d=h*a*Math.sin(o);Un.add(Math.atan2(d,u)),n=t,i=l,r=c}Dn.point=function(a,o){Dn.point=s,n=(t=a)*It,i=Math.cos(o=(e=o)*It/2+Ct/4),r=Math.sin(o)},Dn.lineEnd=function(){s(t,e)}}function Pn(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function zn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Vn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Rn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Bn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function qn(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Fn(t){return[Math.atan2(t[1],t[0]),zt(t[2])]}function $n(t,e){return E(t[0]-e[0])<jt&&E(t[1]-e[1])<jt}s.geo.bounds=function(){var t,e,n,i,r,a,o,l,c,h,u,d={point:p,lineStart:m,lineEnd:g,polygonStart:function(){d.point=b,d.lineStart=v,d.lineEnd=y,c=0,Dn.polygonStart()},polygonEnd:function(){Dn.polygonEnd(),d.point=p,d.lineStart=m,d.lineEnd=g,Un<0?(t=-(n=180),e=-(i=90)):c>jt?i=90:c<-jt&&(e=-90),u[0]=t,u[1]=n}};function p(r,s){h.push(u=[t=r,n=r]),s<e&&(e=s),s>i&&(i=s)}function f(s,a){var o=Pn([s*It,a*It]);if(l){var c=Vn(l,o),h=Vn([c[1],-c[0],0],c);qn(h),h=Fn(h);var u=s-r,d=u>0?1:-1,f=h[0]*Ut*d,m=E(u)>180;if(m^(d*r<f&&f<d*s))(g=h[1]*Ut)>i&&(i=g);else if(m^(d*r<(f=(f+360)%360-180)&&f<d*s)){var g;(g=-h[1]*Ut)<e&&(e=g)}else a<e&&(e=a),a>i&&(i=a);m?s<r?x(t,s)>x(t,n)&&(n=s):x(s,n)>x(t,n)&&(t=s):n>=t?(s<t&&(t=s),s>n&&(n=s)):s>r?x(t,s)>x(t,n)&&(n=s):x(s,n)>x(t,n)&&(t=s)}else p(s,a);l=o,r=s}function m(){d.point=f}function g(){u[0]=t,u[1]=n,d.point=p,l=null}function b(t,e){if(l){var n=t-r;c+=E(n)>180?n+(n>0?360:-360):n}else a=t,o=e;Dn.point(t,e),f(t,e)}function v(){Dn.lineStart()}function y(){b(a,o),Dn.lineEnd(),E(c)>jt&&(t=-(n=180)),u[0]=t,u[1]=n,l=null}function x(t,e){return(e-=t)<0?e+360:e}function w(t,e){return t[0]-e[0]}function A(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(r){if(i=n=-(t=e=1/0),h=[],s.geo.stream(r,d),c=h.length){h.sort(w);for(var a=1,o=[m=h[0]];a<c;++a)A((p=h[a])[0],m)||A(p[1],m)?(x(m[0],p[1])>x(m[0],m[1])&&(m[1]=p[1]),x(p[0],m[1])>x(m[0],m[1])&&(m[0]=p[0])):o.push(m=p);for(var l,c,p,f=-1/0,m=(a=0,o[c=o.length-1]);a<=c;m=p,++a)p=o[a],(l=x(m[1],p[0]))>f&&(f=l,t=p[0],n=m[1])}return h=u=null,t===1/0||e===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,e],[n,i]]}}(),s.geo.centroid=function(t){Nn=On=kn=_n=jn=Mn=Cn=Sn=Ln=Tn=In=0,s.geo.stream(t,Wn);var e=Ln,n=Tn,i=In,r=e*e+n*n+i*i;return r<Mt&&(e=Mn,n=Cn,i=Sn,On<jt&&(e=kn,n=_n,i=jn),(r=e*e+n*n+i*i)<Mt)?[NaN,NaN]:[Math.atan2(n,e)*Ut,zt(i/Math.sqrt(r))*Ut]};var Wn={sphere:z,point:Yn,lineStart:Gn,lineEnd:Jn,polygonStart:function(){Wn.lineStart=Zn},polygonEnd:function(){Wn.lineStart=Gn}};function Yn(t,e){t*=It;var n=Math.cos(e*=It);Xn(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Xn(t,e,n){++Nn,kn+=(t-kn)/Nn,_n+=(e-_n)/Nn,jn+=(n-jn)/Nn}function Gn(){var t,e,n;function i(i,r){i*=It;var s=Math.cos(r*=It),a=s*Math.cos(i),o=s*Math.sin(i),l=Math.sin(r),c=Math.atan2(Math.sqrt((c=e*l-n*o)*c+(c=n*a-t*l)*c+(c=t*o-e*a)*c),t*a+e*o+n*l);On+=c,Mn+=c*(t+(t=a)),Cn+=c*(e+(e=o)),Sn+=c*(n+(n=l)),Xn(t,e,n)}Wn.point=function(r,s){r*=It;var a=Math.cos(s*=It);t=a*Math.cos(r),e=a*Math.sin(r),n=Math.sin(s),Wn.point=i,Xn(t,e,n)}}function Jn(){Wn.point=Yn}function Zn(){var t,e,n,i,r;function s(t,e){t*=It;var s=Math.cos(e*=It),a=s*Math.cos(t),o=s*Math.sin(t),l=Math.sin(e),c=i*l-r*o,h=r*a-n*l,u=n*o-i*a,d=Math.sqrt(c*c+h*h+u*u),p=n*a+i*o+r*l,f=d&&-Pt(p)/d,m=Math.atan2(d,p);Ln+=f*c,Tn+=f*h,In+=f*u,On+=m,Mn+=m*(n+(n=a)),Cn+=m*(i+(i=o)),Sn+=m*(r+(r=l)),Xn(n,i,r)}Wn.point=function(a,o){t=a,e=o,Wn.point=s,a*=It;var l=Math.cos(o*=It);n=l*Math.cos(a),i=l*Math.sin(a),r=Math.sin(o),Xn(n,i,r)},Wn.lineEnd=function(){s(t,e),Wn.lineEnd=Jn,Wn.point=Yn}}function Qn(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Kn(){return!0}function ti(t,e,n,i,r){var s=[],a=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if($n(n,i)){r.lineStart();for(var o=0;o<e;++o)r.point((n=t[o])[0],n[1]);r.lineEnd()}else{var l=new ni(n,t,null,!0),c=new ni(n,null,l,!1);l.o=c,s.push(l),a.push(c),l=new ni(i,t,null,!1),c=new ni(i,null,l,!0),l.o=c,s.push(l),a.push(c)}}})),a.sort(e),ei(s),ei(a),s.length){for(var o=0,l=n,c=a.length;o<c;++o)a[o].e=l=!l;for(var h,u,d=s[0];;){for(var p=d,f=!0;p.v;)if((p=p.n)===d)return;h=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(o=0,c=h.length;o<c;++o)r.point((u=h[o])[0],u[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f)for(o=(h=p.p.z).length-1;o>=0;--o)r.point((u=h[o])[0],u[1]);else i(p.x,p.p.x,-1,r);p=p.p}h=(p=p.o).z,f=!f}while(!p.v);r.lineEnd()}}}function ei(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function ni(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function ii(t,e,n,i){return function(r,a){var o,l=e(a),c=r.invert(i[0],i[1]),h={point:u,lineStart:p,lineEnd:f,polygonStart:function(){h.point=x,h.lineStart=w,h.lineEnd=E,o=[],m=[]},polygonEnd:function(){h.point=u,h.lineStart=p,h.lineEnd=f,o=s.merge(o);var t=function(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],s=0,a=0;Un.reset();for(var o=0,l=e.length;o<l;++o){var c=e[o],h=c.length;if(h)for(var u=c[0],d=u[0],p=u[1]/2+Ct/4,f=Math.sin(p),m=Math.cos(p),g=1;;){g===h&&(g=0);var b=(t=c[g])[0],v=t[1]/2+Ct/4,y=Math.sin(v),x=Math.cos(v),w=b-d,E=w>=0?1:-1,A=E*w,N=A>Ct,O=f*y;if(Un.add(Math.atan2(O*E*Math.sin(A),m*x+O*Math.cos(A))),s+=N?w+E*St:w,N^d>=n^b>=n){var k=Vn(Pn(u),Pn(t));qn(k);var _=Vn(r,k);qn(_);var j=(N^w>=0?-1:1)*zt(_[2]);(i>j||i===j&&(k[0]||k[1]))&&(a+=N^w>=0?1:-1)}if(!g++)break;d=b,f=y,m=x,u=t}}return(s<-jt||s<jt&&Un<-jt)^1&a}(c,m);o.length?(y||(a.polygonStart(),y=!0),ti(o,ai,t,n,a)):t&&(y||(a.polygonStart(),y=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),y&&(a.polygonEnd(),y=!1),o=m=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function u(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&a.point(e,n)}function d(t,e){var n=r(t,e);l.point(n[0],n[1])}function p(){h.point=d,l.lineStart()}function f(){h.point=u,l.lineEnd()}var m,g,b=si(),v=e(b),y=!1;function x(t,e){g.push([t,e]);var n=r(t,e);v.point(n[0],n[1])}function w(){v.lineStart(),g=[]}function E(){x(g[0][0],g[0][1]),v.lineEnd();var t,e=v.clean(),n=b.buffer(),i=n.length;if(g.pop(),m.push(g),g=null,i)if(1&e){var r,s=-1;if((i=(t=n[0]).length-1)>0){for(y||(a.polygonStart(),y=!0),a.lineStart();++s<i;)a.point((r=t[s])[0],r[1]);a.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),o.push(n.filter(ri))}return h}}function ri(t){return t.length>1}function si(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:z,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function ai(t,e){return((t=t.x)[0]<0?t[1]-Tt-jt:Tt-t[1])-((e=e.x)[0]<0?e[1]-Tt-jt:Tt-e[1])}var oi=ii(Kn,(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,a){var o=s>0?Ct:-Ct,l=E(s-n);E(l-Ct)<jt?(t.point(n,i=(i+a)/2>0?Tt:-Tt),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),t.point(s,i),e=0):r!==o&&l>=Ct&&(E(n-r)<jt&&(n-=r*jt),E(s-o)<jt&&(s-=o*jt),i=function(t,e,n,i){var r,s,a=Math.sin(t-n);return E(a)>jt?Math.atan((Math.sin(e)*(s=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*s*a)):(e+i)/2}(n,i,s,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),e=0),t.point(n=s,i=a),r=o},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*Tt,i.point(-Ct,r),i.point(0,r),i.point(Ct,r),i.point(Ct,0),i.point(Ct,-r),i.point(0,-r),i.point(-Ct,-r),i.point(-Ct,0),i.point(-Ct,r);else if(E(t[0]-e[0])>jt){var s=t[0]<e[0]?Ct:-Ct;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(e[0],e[1])}),[-Ct,-Ct/2]);function li(t,e,n,i){return function(r){var s,a=r.a,o=r.b,l=a.x,c=a.y,h=0,u=1,d=o.x-l,p=o.y-c;if(s=t-l,d||!(s>0)){if(s/=d,d<0){if(s<h)return;s<u&&(u=s)}else if(d>0){if(s>u)return;s>h&&(h=s)}if(s=n-l,d||!(s<0)){if(s/=d,d<0){if(s>u)return;s>h&&(h=s)}else if(d>0){if(s<h)return;s<u&&(u=s)}if(s=e-c,p||!(s>0)){if(s/=p,p<0){if(s<h)return;s<u&&(u=s)}else if(p>0){if(s>u)return;s>h&&(h=s)}if(s=i-c,p||!(s<0)){if(s/=p,p<0){if(s>u)return;s>h&&(h=s)}else if(p>0){if(s<h)return;s<u&&(u=s)}return h>0&&(r.a={x:l+h*d,y:c+h*p}),u<1&&(r.b={x:l+u*d,y:c+u*p}),r}}}}}}var ci=1e9;function hi(t,e,n,i){return function(l){var c,h,u,d,p,f,m,g,b,v,y,x=l,w=si(),E=li(t,e,n,i),A={point:k,lineStart:function(){A.point=_,h&&h.push(u=[]),v=!0,b=!1,m=g=NaN},lineEnd:function(){c&&(_(d,p),f&&b&&w.rejoin(),c.push(w.buffer())),A.point=k,b&&l.lineEnd()},polygonStart:function(){l=w,c=[],h=[],y=!0},polygonEnd:function(){l=x,c=s.merge(c);var e=function(t){for(var e=0,n=h.length,i=t[1],r=0;r<n;++r)for(var s,a=1,o=h[r],l=o.length,c=o[0];a<l;++a)s=o[a],c[1]<=i?s[1]>i&&Ht(c,s,t)>0&&++e:s[1]<=i&&Ht(c,s,t)<0&&--e,c=s;return 0!==e}([t,i]),n=y&&e,r=c.length;(n||r)&&(l.polygonStart(),n&&(l.lineStart(),N(null,null,1,l),l.lineEnd()),r&&ti(c,a,e,N,l),l.polygonEnd()),c=h=u=null}};function N(s,a,l,c){var h=0,u=0;if(null==s||(h=r(s,l))!==(u=r(a,l))||o(s,a)<0^l>0)do{c.point(0===h||3===h?t:n,h>1?i:e)}while((h=(h+l+4)%4)!==u);else c.point(a[0],a[1])}function O(r,s){return t<=r&&r<=n&&e<=s&&s<=i}function k(t,e){O(t,e)&&l.point(t,e)}function _(t,e){var n=O(t=Math.max(-ci,Math.min(ci,t)),e=Math.max(-ci,Math.min(ci,e)));if(h&&u.push([t,e]),v)d=t,p=e,f=n,v=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&b)l.point(t,e);else{var i={a:{x:m,y:g},b:{x:t,y:e}};E(i)?(b||(l.lineStart(),l.point(i.a.x,i.a.y)),l.point(i.b.x,i.b.y),n||l.lineEnd(),y=!1):n&&(l.lineStart(),l.point(t,e),y=!1)}m=t,g=e,b=n}return A};function r(i,r){return E(i[0]-t)<jt?r>0?0:3:E(i[0]-n)<jt?r>0?2:1:E(i[1]-e)<jt?r>0?1:0:r>0?3:2}function a(t,e){return o(t.x,e.x)}function o(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}}function ui(t){var e=0,n=Ct/3,i=Ui(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Ct/180,n=t[1]*Ct/180):[e/Ct*180,n/Ct*180]},r}function di(t,e){var n=Math.sin(t),i=(n+Math.sin(e))/2,r=1+n*(2*i-n),s=Math.sqrt(r)/i;function a(t,e){var n=Math.sqrt(r-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),s-n*Math.cos(t)]}return a.invert=function(t,e){var n=s-e;return[Math.atan2(t,n)/i,zt((r-(t*t+n*n)*i*i)/(2*i))]},a}s.geo.clipExtent=function(){var t,e,n,i,r,s,a={stream:function(t){return r&&(r.valid=!1),(r=s(t)).valid=!0,r},extent:function(o){return arguments.length?(s=hi(t=+o[0][0],e=+o[0][1],n=+o[1][0],i=+o[1][1]),r&&(r.valid=!1,r=null),a):[[t,e],[n,i]]}};return a.extent([[0,0],[960,500]])},(s.geo.conicEqualArea=function(){return ui(di)}).raw=di,s.geo.albers=function(){return s.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},s.geo.albersUsa=function(){var t,e,n,i,r=s.geo.albers(),a=s.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=s.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,n){t=[e,n]}};function c(r){var s=r[0],a=r[1];return t=null,e(s,a),t||(n(s,a),t)||i(s,a),t}return c.invert=function(t){var e=r.scale(),n=r.translate(),i=(t[0]-n[0])/e,s=(t[1]-n[1])/e;return(s>=.12&&s<.234&&i>=-.425&&i<-.214?a:s>=.166&&s<.234&&i>=-.214&&i<-.115?o:r).invert(t)},c.stream=function(t){var e=r.stream(t),n=a.stream(t),i=o.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},c.precision=function(t){return arguments.length?(r.precision(t),a.precision(t),o.precision(t),c):r.precision()},c.scale=function(t){return arguments.length?(r.scale(t),a.scale(.35*t),o.scale(t),c.translate(r.translate())):r.scale()},c.translate=function(t){if(!arguments.length)return r.translate();var s=r.scale(),h=+t[0],u=+t[1];return e=r.translate(t).clipExtent([[h-.455*s,u-.238*s],[h+.455*s,u+.238*s]]).stream(l).point,n=a.translate([h-.307*s,u+.201*s]).clipExtent([[h-.425*s+jt,u+.12*s+jt],[h-.214*s-jt,u+.234*s-jt]]).stream(l).point,i=o.translate([h-.205*s,u+.212*s]).clipExtent([[h-.214*s+jt,u+.166*s+jt],[h-.115*s-jt,u+.234*s-jt]]).stream(l).point,c},c.scale(1070)};var pi,fi,mi,gi,bi,vi,yi={point:z,lineStart:z,lineEnd:z,polygonStart:function(){fi=0,yi.lineStart=xi},polygonEnd:function(){yi.lineStart=yi.lineEnd=yi.point=z,pi+=E(fi/2)}};function xi(){var t,e,n,i;function r(t,e){fi+=i*t-n*e,n=t,i=e}yi.point=function(s,a){yi.point=r,t=n=s,e=i=a},yi.lineEnd=function(){r(t,e)}}var wi={point:function(t,e){t<mi&&(mi=t),t>bi&&(bi=t),e<gi&&(gi=e),e>vi&&(vi=e)},lineStart:z,lineEnd:z,polygonStart:z,polygonEnd:z};function Ei(){var t=Ai(4.5),e=[],n={point:i,lineStart:function(){n.point=r},lineEnd:a,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=a,n.point=i},pointRadius:function(e){return t=Ai(e),n},result:function(){if(e.length){var t=e.join("");return e=[],t}}};function i(n,i){e.push("M",n,",",i,t)}function r(t,i){e.push("M",t,",",i),n.point=s}function s(t,n){e.push("L",t,",",n)}function a(){n.point=i}function o(){e.push("Z")}return n}function Ai(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var Ni,Oi={point:ki,lineStart:_i,lineEnd:ji,polygonStart:function(){Oi.lineStart=Mi},polygonEnd:function(){Oi.point=ki,Oi.lineStart=_i,Oi.lineEnd=ji}};function ki(t,e){kn+=t,_n+=e,++jn}function _i(){var t,e;function n(n,i){var r=n-t,s=i-e,a=Math.sqrt(r*r+s*s);Mn+=a*(t+n)/2,Cn+=a*(e+i)/2,Sn+=a,ki(t=n,e=i)}Oi.point=function(i,r){Oi.point=n,ki(t=i,e=r)}}function ji(){Oi.point=ki}function Mi(){var t,e,n,i;function r(t,e){var r=t-n,s=e-i,a=Math.sqrt(r*r+s*s);Mn+=a*(n+t)/2,Cn+=a*(i+e)/2,Sn+=a,Ln+=(a=i*t-n*e)*(n+t),Tn+=a*(i+e),In+=3*a,ki(n=t,i=e)}Oi.point=function(s,a){Oi.point=r,ki(t=n=s,e=i=a)},Oi.lineEnd=function(){r(t,e)}}function Ci(t){var e=4.5,n={point:i,lineStart:function(){n.point=r},lineEnd:a,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=a,n.point=i},pointRadius:function(t){return e=t,n},result:z};function i(n,i){t.moveTo(n+e,i),t.arc(n,i,e,0,St)}function r(e,i){t.moveTo(e,i),n.point=s}function s(e,n){t.lineTo(e,n)}function a(){n.point=i}function o(){t.closePath()}return n}function Si(t){var e=.5,n=Math.cos(30*It),i=16;function r(t){return(i?a:s)(t)}function s(e){return Ti(e,(function(n,i){n=t(n,i),e.point(n[0],n[1])}))}function a(e){var n,r,s,a,l,c,h,u,d,p,f,m,g={point:b,lineStart:v,lineEnd:x,polygonStart:function(){e.polygonStart(),g.lineStart=w},polygonEnd:function(){e.polygonEnd(),g.lineStart=v}};function b(n,i){n=t(n,i),e.point(n[0],n[1])}function v(){u=NaN,g.point=y,e.lineStart()}function y(n,r){var s=Pn([n,r]),a=t(n,r);o(u,d,h,p,f,m,u=a[0],d=a[1],h=n,p=s[0],f=s[1],m=s[2],i,e),e.point(u,d)}function x(){g.point=b,e.lineEnd()}function w(){v(),g.point=E,g.lineEnd=A}function E(t,e){y(n=t,e),r=u,s=d,a=p,l=f,c=m,g.point=y}function A(){o(u,d,h,p,f,m,r,s,n,a,l,c,i,e),g.lineEnd=x,x()}return g}function o(i,r,s,a,l,c,h,u,d,p,f,m,g,b){var v=h-i,y=u-r,x=v*v+y*y;if(x>4*e&&g--){var w=a+p,A=l+f,N=c+m,O=Math.sqrt(w*w+A*A+N*N),k=Math.asin(N/=O),_=E(E(N)-1)<jt||E(s-d)<jt?(s+d)/2:Math.atan2(A,w),j=t(_,k),M=j[0],C=j[1],S=M-i,L=C-r,T=y*S-v*L;(T*T/x>e||E((v*S+y*L)/x-.5)>.3||a*p+l*f+c*m<n)&&(o(i,r,s,a,l,c,M,C,_,w/=O,A/=O,N,g,b),b.point(M,C),o(M,C,_,w,A,N,h,u,d,p,f,m,g,b))}}return r.precision=function(t){return arguments.length?(i=(e=t*t)>0&&16,r):Math.sqrt(e)},r}function Li(t){this.stream=t}function Ti(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Ii(t){return Ui((function(){return t}))()}function Ui(t){var e,n,i,r,a,o,l=Si((function(t,n){return[(t=e(t,n))[0]*c+r,a-t[1]*c]})),c=150,h=480,u=250,d=0,p=0,f=0,m=0,g=0,b=oi,v=U,y=null,x=null;function w(t){return[(t=i(t[0]*It,t[1]*It))[0]*c+r,a-t[1]*c]}function A(t){return(t=i.invert((t[0]-r)/c,(a-t[1])/c))&&[t[0]*Ut,t[1]*Ut]}function N(){i=Qn(n=zi(f,m,g),e);var t=e(d,p);return r=h-t[0]*c,a=u+t[1]*c,O()}function O(){return o&&(o.valid=!1,o=null),w}return w.stream=function(t){return o&&(o.valid=!1),(o=Di(b(n,l(v(t))))).valid=!0,o},w.clipAngle=function(t){return arguments.length?(b=null==t?(y=t,oi):function(t){var e=Math.cos(t),n=e>0,i=E(e)>jt;return ii(r,(function(t){var e,o,l,c,h;return{lineStart:function(){c=l=!1,h=1},point:function(u,d){var p,f=[u,d],m=r(u,d),g=n?m?0:a(u,d):m?a(u+(u<0?Ct:-Ct),d):0;if(!e&&(c=l=m)&&t.lineStart(),m!==l&&(p=s(e,f),($n(e,p)||$n(f,p))&&(f[0]+=jt,f[1]+=jt,m=r(f[0],f[1]))),m!==l)h=0,m?(t.lineStart(),p=s(f,e),t.point(p[0],p[1])):(p=s(e,f),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(i&&e&&n^m){var b;g&o||!(b=s(f,e,!0))||(h=0,n?(t.lineStart(),t.point(b[0][0],b[0][1]),t.point(b[1][0],b[1][1]),t.lineEnd()):(t.point(b[1][0],b[1][1]),t.lineEnd(),t.lineStart(),t.point(b[0][0],b[0][1])))}!m||e&&$n(e,f)||t.point(f[0],f[1]),e=f,l=m,o=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return h|(c&&l)<<1}}}),qi(t,6*It),n?[0,-t]:[-Ct,t-Ct]);function r(t,n){return Math.cos(t)*Math.cos(n)>e}function s(t,n,i){var r=[1,0,0],s=Vn(Pn(t),Pn(n)),a=zn(s,s),o=s[0],l=a-o*o;if(!l)return!i&&t;var c=e*a/l,h=-e*o/l,u=Vn(r,s),d=Bn(r,c);Rn(d,Bn(s,h));var p=u,f=zn(d,p),m=zn(p,p),g=f*f-m*(zn(d,d)-1);if(!(g<0)){var b=Math.sqrt(g),v=Bn(p,(-f-b)/m);if(Rn(v,d),v=Fn(v),!i)return v;var y,x=t[0],w=n[0],A=t[1],N=n[1];w<x&&(y=x,x=w,w=y);var O=w-x,k=E(O-Ct)<jt;if(!k&&N<A&&(y=A,A=N,N=y),k||O<jt?k?A+N>0^v[1]<(E(v[0]-x)<jt?A:N):A<=v[1]&&v[1]<=N:O>Ct^(x<=v[0]&&v[0]<=w)){var _=Bn(p,(-f+b)/m);return Rn(_,d),[v,Fn(_)]}}}function a(e,i){var r=n?t:Ct-t,s=0;return e<-r?s|=1:e>r&&(s|=2),i<-r?s|=4:i>r&&(s|=8),s}}((y=+t)*It),O()):y},w.clipExtent=function(t){return arguments.length?(x=t,v=t?hi(t[0][0],t[0][1],t[1][0],t[1][1]):U,O()):x},w.scale=function(t){return arguments.length?(c=+t,N()):c},w.translate=function(t){return arguments.length?(h=+t[0],u=+t[1],N()):[h,u]},w.center=function(t){return arguments.length?(d=t[0]%360*It,p=t[1]%360*It,N()):[d*Ut,p*Ut]},w.rotate=function(t){return arguments.length?(f=t[0]%360*It,m=t[1]%360*It,g=t.length>2?t[2]%360*It:0,N()):[f*Ut,m*Ut,g*Ut]},s.rebind(w,l,"precision"),function(){return e=t.apply(this,arguments),w.invert=e.invert&&A,N()}}function Di(t){return Ti(t,(function(e,n){t.point(e*It,n*It)}))}function Hi(t,e){return[t,e]}function Pi(t,e){return[t>Ct?t-St:t<-Ct?t+St:t,e]}function zi(t,e,n){return t?e||n?Qn(Ri(t),Bi(e,n)):Ri(t):e||n?Bi(e,n):Pi}function Vi(t){return function(e,n){return[(e+=t)>Ct?e-St:e<-Ct?e+St:e,n]}}function Ri(t){var e=Vi(t);return e.invert=Vi(-t),e}function Bi(t,e){var n=Math.cos(t),i=Math.sin(t),r=Math.cos(e),s=Math.sin(e);function a(t,e){var a=Math.cos(e),o=Math.cos(t)*a,l=Math.sin(t)*a,c=Math.sin(e),h=c*n+o*i;return[Math.atan2(l*r-h*s,o*n-c*i),zt(h*r+l*s)]}return a.invert=function(t,e){var a=Math.cos(e),o=Math.cos(t)*a,l=Math.sin(t)*a,c=Math.sin(e),h=c*r-l*s;return[Math.atan2(l*r+c*s,o*n+h*i),zt(h*n-o*i)]},a}function qi(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,s,a,o){var l=a*e;null!=r?(r=Fi(n,r),s=Fi(n,s),(a>0?r<s:r>s)&&(r+=a*St)):(r=t+a*St,s=t-.5*l);for(var c,h=r;a>0?h>s:h<s;h-=l)o.point((c=Fn([n,-i*Math.cos(h),-i*Math.sin(h)]))[0],c[1])}}function Fi(t,e){var n=Pn(e);n[0]-=t,qn(n);var i=Pt(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-jt)%(2*Math.PI)}function $i(t,e,n){var i=s.range(t,e-jt,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function Wi(t,e,n){var i=s.range(t,e-jt,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function Yi(t){return t.source}function Xi(t){return t.target}s.geo.path=function(){var t,e,n,i,r,a=4.5;function o(t){return t&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),r&&r.valid||(r=n(i)),s.geo.stream(t,r)),i.result()}function l(){return r=null,o}return o.area=function(t){return pi=0,s.geo.stream(t,n(yi)),pi},o.centroid=function(t){return kn=_n=jn=Mn=Cn=Sn=Ln=Tn=In=0,s.geo.stream(t,n(Oi)),In?[Ln/In,Tn/In]:Sn?[Mn/Sn,Cn/Sn]:jn?[kn/jn,_n/jn]:[NaN,NaN]},o.bounds=function(t){return bi=vi=-(mi=gi=1/0),s.geo.stream(t,n(wi)),[[mi,gi],[bi,vi]]},o.projection=function(e){return arguments.length?(n=(t=e)?e.stream||(i=e,r=Si((function(t,e){return i([t*Ut,e*Ut])})),function(t){return Di(r(t))}):U,l()):t;var i,r},o.context=function(t){return arguments.length?(i=null==(e=t)?new Ei:new Ci(t),"function"!=typeof a&&i.pointRadius(a),l()):e},o.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),o):a},o.projection(s.geo.albersUsa()).context(null)},s.geo.transform=function(t){return{stream:function(e){var n=new Li(e);for(var i in t)n[i]=t[i];return n}}},Li.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},s.geo.projection=Ii,s.geo.projectionMutator=Ui,(s.geo.equirectangular=function(){return Ii(Hi)}).raw=Hi.invert=Hi,s.geo.rotation=function(t){function e(e){return(e=t(e[0]*It,e[1]*It))[0]*=Ut,e[1]*=Ut,e}return t=zi(t[0]%360*It,t[1]*It,t.length>2?t[2]*It:0),e.invert=function(e){return(e=t.invert(e[0]*It,e[1]*It))[0]*=Ut,e[1]*=Ut,e},e},Pi.invert=Hi,s.geo.circle=function(){var t,e,n=[0,0],i=6;function r(){var t="function"==typeof n?n.apply(this,arguments):n,i=zi(-t[0]*It,-t[1]*It,0).invert,r=[];return e(null,null,1,{point:function(t,e){r.push(t=i(t,e)),t[0]*=Ut,t[1]*=Ut}}),{type:"Polygon",coordinates:[r]}}return r.origin=function(t){return arguments.length?(n=t,r):n},r.angle=function(n){return arguments.length?(e=qi((t=+n)*It,i*It),r):t},r.precision=function(n){return arguments.length?(e=qi(t*It,(i=+n)*It),r):i},r.angle(90)},s.geo.distance=function(t,e){var n,i=(e[0]-t[0])*It,r=t[1]*It,s=e[1]*It,a=Math.sin(i),o=Math.cos(i),l=Math.sin(r),c=Math.cos(r),h=Math.sin(s),u=Math.cos(s);return Math.atan2(Math.sqrt((n=u*a)*n+(n=c*h-l*u*o)*n),l*h+c*u*o)},s.geo.graticule=function(){var t,e,n,i,r,a,o,l,c,h,u,d,p=10,f=p,m=90,g=360,b=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return s.range(Math.ceil(i/m)*m,n,m).map(u).concat(s.range(Math.ceil(l/g)*g,o,g).map(d)).concat(s.range(Math.ceil(e/p)*p,t,p).filter((function(t){return E(t%m)>jt})).map(c)).concat(s.range(Math.ceil(a/f)*f,r,f).filter((function(t){return E(t%g)>jt})).map(h))}return v.lines=function(){return y().map((function(t){return{type:"LineString",coordinates:t}}))},v.outline=function(){return{type:"Polygon",coordinates:[u(i).concat(d(o).slice(1),u(n).reverse().slice(1),d(l).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.majorExtent(t).minorExtent(t):v.minorExtent()},v.majorExtent=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],l=+t[0][1],o=+t[1][1],i>n&&(t=i,i=n,n=t),l>o&&(t=l,l=o,o=t),v.precision(b)):[[i,l],[n,o]]},v.minorExtent=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],r=+n[1][1],e>t&&(n=e,e=t,t=n),a>r&&(n=a,a=r,r=n),v.precision(b)):[[e,a],[t,r]]},v.step=function(t){return arguments.length?v.majorStep(t).minorStep(t):v.minorStep()},v.majorStep=function(t){return arguments.length?(m=+t[0],g=+t[1],v):[m,g]},v.minorStep=function(t){return arguments.length?(p=+t[0],f=+t[1],v):[p,f]},v.precision=function(s){return arguments.length?(b=+s,c=$i(a,r,90),h=Wi(e,t,b),u=$i(l,o,90),d=Wi(i,n,b),v):b},v.majorExtent([[-180,-90+jt],[180,90-jt]]).minorExtent([[-180,-80-jt],[180,80+jt]])},s.geo.greatArc=function(){var t,e,n=Yi,i=Xi;function r(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),e||i.apply(this,arguments)]}}return r.distance=function(){return s.geo.distance(t||n.apply(this,arguments),e||i.apply(this,arguments))},r.source=function(e){return arguments.length?(n=e,t="function"==typeof e?null:e,r):n},r.target=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,r):i},r.precision=function(){return arguments.length?r:0},r},s.geo.interpolate=function(t,e){return function(t,e,n,i){var r=Math.cos(e),s=Math.sin(e),a=Math.cos(i),o=Math.sin(i),l=r*Math.cos(t),c=r*Math.sin(t),h=a*Math.cos(n),u=a*Math.sin(n),d=2*Math.asin(Math.sqrt(Rt(i-e)+r*a*Rt(n-t))),p=1/Math.sin(d),f=d?function(t){var e=Math.sin(t*=d)*p,n=Math.sin(d-t)*p,i=n*l+e*h,r=n*c+e*u,a=n*s+e*o;return[Math.atan2(r,i)*Ut,Math.atan2(a,Math.sqrt(i*i+r*r))*Ut]}:function(){return[t*Ut,e*Ut]};return f.distance=d,f}(t[0]*It,t[1]*It,e[0]*It,e[1]*It)},s.geo.length=function(t){return Ni=0,s.geo.stream(t,Gi),Ni};var Gi={sphere:z,point:z,lineStart:function(){var t,e,n;function i(i,r){var s=Math.sin(r*=It),a=Math.cos(r),o=E((i*=It)-t),l=Math.cos(o);Ni+=Math.atan2(Math.sqrt((o=a*Math.sin(o))*o+(o=n*s-e*a*l)*o),e*s+n*a*l),t=i,e=s,n=a}Gi.point=function(r,s){t=r*It,e=Math.sin(s*=It),n=Math.cos(s),Gi.point=i},Gi.lineEnd=function(){Gi.point=Gi.lineEnd=z}},lineEnd:z,polygonStart:z,polygonEnd:z};function Ji(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),s=t(i*r);return[s*r*Math.sin(e),s*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),s=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*s,i*a),Math.asin(i&&n*s/i)]},n}var Zi=Ji((function(t){return Math.sqrt(2/(1+t))}),(function(t){return 2*Math.asin(t/2)}));(s.geo.azimuthalEqualArea=function(){return Ii(Zi)}).raw=Zi;var Qi=Ji((function(t){var e=Math.acos(t);return e&&e/Math.sin(e)}),U);function Ki(t,e){var n=Math.cos(t),i=function(t){return Math.tan(Ct/4+t/2)},r=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(i(e)/i(t)),s=n*Math.pow(i(t),r)/r;if(!r)return nr;function a(t,e){s>0?e<-Tt+jt&&(e=-Tt+jt):e>Tt-jt&&(e=Tt-jt);var n=s/Math.pow(i(e),r);return[n*Math.sin(r*t),s-n*Math.cos(r*t)]}return a.invert=function(t,e){var n=s-e,i=Dt(r)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/r,2*Math.atan(Math.pow(s/i,1/r))-Tt]},a}function tr(t,e){var n=Math.cos(t),i=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),r=n/i+t;if(E(i)<jt)return Hi;function s(t,e){var n=r-e;return[n*Math.sin(i*t),r-n*Math.cos(i*t)]}return s.invert=function(t,e){var n=r-e;return[Math.atan2(t,n)/i,r-Dt(i)*Math.sqrt(t*t+n*n)]},s}(s.geo.azimuthalEquidistant=function(){return Ii(Qi)}).raw=Qi,(s.geo.conicConformal=function(){return ui(Ki)}).raw=Ki,(s.geo.conicEquidistant=function(){return ui(tr)}).raw=tr;var er=Ji((function(t){return 1/t}),Math.atan);function nr(t,e){return[t,Math.log(Math.tan(Ct/4+e/2))]}function ir(t){var e,n=Ii(t),i=n.scale,r=n.translate,s=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=s.apply(n,arguments);if(a===n){if(e=null==t){var o=Ct*i(),l=r();s([[l[0]-o,l[1]-o],[l[0]+o,l[1]+o]])}}else e&&(a=null);return a},n.clipExtent(null)}(s.geo.gnomonic=function(){return Ii(er)}).raw=er,nr.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Tt]},(s.geo.mercator=function(){return ir(nr)}).raw=nr;var rr=Ji((function(){return 1}),Math.asin);(s.geo.orthographic=function(){return Ii(rr)}).raw=rr;var sr=Ji((function(t){return 1/(1+t)}),(function(t){return 2*Math.atan(t)}));function ar(t,e){return[Math.log(Math.tan(Ct/4+e/2)),-t]}function or(t){return t[0]}function lr(t){return t[1]}function cr(t){for(var e=t.length,n=[0,1],i=2,r=2;r<e;r++){for(;i>1&&Ht(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function hr(t,e){return t[0]-e[0]||t[1]-e[1]}(s.geo.stereographic=function(){return Ii(sr)}).raw=sr,ar.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Tt]},(s.geo.transverseMercator=function(){var t=ir(ar),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90])}).raw=ar,s.geom={},s.geom.hull=function(t){var e=or,n=lr;if(arguments.length)return i(t);function i(t){if(t.length<3)return[];var i,r=xe(e),s=xe(n),a=t.length,o=[],l=[];for(i=0;i<a;i++)o.push([+r.call(this,t[i],i),+s.call(this,t[i],i),i]);for(o.sort(hr),i=0;i<a;i++)l.push([o[i][0],-o[i][1]]);var c=cr(o),h=cr(l),u=h[0]===c[0],d=h[h.length-1]===c[c.length-1],p=[];for(i=c.length-1;i>=0;--i)p.push(t[o[c[i]][2]]);for(i=+u;i<h.length-d;++i)p.push(t[o[h[i]][2]]);return p}return i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(t){return arguments.length?(n=t,i):n},i},s.geom.polygon=function(t){return W(t,ur),t};var ur=s.geom.polygon.prototype=[];function dr(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function pr(t,e,n,i){var r=t[0],s=n[0],a=e[0]-r,o=i[0]-s,l=t[1],c=n[1],h=e[1]-l,u=i[1]-c,d=(o*(l-c)-u*(r-s))/(u*a-o*h);return[r+d*a,l+d*h]}function fr(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}ur.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},ur.centroid=function(t){var e,n,i=-1,r=this.length,s=0,a=0,o=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=o,o=this[i],n=e[0]*o[1]-o[0]*e[1],s+=(e[0]+o[0])*n,a+=(e[1]+o[1])*n;return[s*t,a*t]},ur.clip=function(t){for(var e,n,i,r,s,a,o=fr(t),l=-1,c=this.length-fr(this),h=this[c-1];++l<c;){for(e=t.slice(),t.length=0,r=this[l],s=e[(i=e.length-o)-1],n=-1;++n<i;)dr(a=e[n],h,r)?(dr(s,h,r)||t.push(pr(s,a,h,r)),t.push(a)):dr(s,h,r)&&t.push(pr(s,a,h,r)),s=a;o&&t.push(t[0]),h=r}return t};var mr,gr,br,vr,yr,xr=[],wr=[];function Er(){Vr(this),this.edge=this.site=this.circle=null}function Ar(t){var e=xr.pop()||new Er;return e.site=t,e}function Nr(t){Tr(t),br.remove(t),xr.push(t),Vr(t)}function Or(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},s=t.P,a=t.N,o=[t];Nr(t);for(var l=s;l.circle&&E(n-l.circle.x)<jt&&E(i-l.circle.cy)<jt;)s=l.P,o.unshift(l),Nr(l),l=s;o.unshift(l),Tr(l);for(var c=a;c.circle&&E(n-c.circle.x)<jt&&E(i-c.circle.cy)<jt;)a=c.N,o.push(c),Nr(c),c=a;o.push(c),Tr(c);var h,u=o.length;for(h=1;h<u;++h)c=o[h],l=o[h-1],Hr(c.edge,l.site,c.site,r);l=o[0],(c=o[u-1]).edge=Dr(l.site,c.site,null,r),Lr(l),Lr(c)}function kr(t){for(var e,n,i,r,s=t.x,a=t.y,o=br._;o;)if((i=_r(o,a)-s)>jt)o=o.L;else{if(!((r=s-jr(o,a))>jt)){i>-jt?(e=o.P,n=o):r>-jt?(e=o,n=o.N):e=n=o;break}if(!o.R){e=o;break}o=o.R}var l=Ar(t);if(br.insert(e,l),e||n){if(e===n)return Tr(e),n=Ar(e.site),br.insert(l,n),l.edge=n.edge=Dr(e.site,l.site),Lr(e),void Lr(n);if(n){Tr(e),Tr(n);var c=e.site,h=c.x,u=c.y,d=t.x-h,p=t.y-u,f=n.site,m=f.x-h,g=f.y-u,b=2*(d*g-p*m),v=d*d+p*p,y=m*m+g*g,x={x:(g*v-p*y)/b+h,y:(d*y-m*v)/b+u};Hr(n.edge,c,f,x),l.edge=Dr(c,t,null,x),n.edge=Dr(t,f,null,x),Lr(e),Lr(n)}else l.edge=Dr(e.site,l.site)}}function _r(t,e){var n=t.site,i=n.x,r=n.y,s=r-e;if(!s)return i;var a=t.P;if(!a)return-1/0;var o=(n=a.site).x,l=n.y,c=l-e;if(!c)return o;var h=o-i,u=1/s-1/c,d=h/c;return u?(-d+Math.sqrt(d*d-2*u*(h*h/(-2*c)-l+c/2+r-s/2)))/u+i:(i+o)/2}function jr(t,e){var n=t.N;if(n)return _r(n,e);var i=t.site;return i.y===e?i.x:1/0}function Mr(t){this.site=t,this.edges=[]}function Cr(t,e){return e.angle-t.angle}function Sr(){Vr(this),this.x=this.y=this.arc=this.site=this.cy=null}function Lr(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,s=n.site;if(i!==s){var a=r.x,o=r.y,l=i.x-a,c=i.y-o,h=s.x-a,u=2*(l*(g=s.y-o)-c*h);if(!(u>=-Mt)){var d=l*l+c*c,p=h*h+g*g,f=(g*d-c*p)/u,m=(l*p-h*d)/u,g=m+o,b=wr.pop()||new Sr;b.arc=t,b.site=r,b.x=f+a,b.y=g+Math.sqrt(f*f+m*m),b.cy=g,t.circle=b;for(var v=null,y=yr._;y;)if(b.y<y.y||b.y===y.y&&b.x<=y.x){if(!y.L){v=y.P;break}y=y.L}else{if(!y.R){v=y;break}y=y.R}yr.insert(v,b),v||(vr=b)}}}}function Tr(t){var e=t.circle;e&&(e.P||(vr=e.N),yr.remove(e),wr.push(e),Vr(e),t.circle=null)}function Ir(t,e){var n=t.b;if(n)return!0;var i,r,s=t.a,a=e[0][0],o=e[1][0],l=e[0][1],c=e[1][1],h=t.l,u=t.r,d=h.x,p=h.y,f=u.x,m=u.y,g=(d+f)/2,b=(p+m)/2;if(m===p){if(g<a||g>=o)return;if(d>f){if(s){if(s.y>=c)return}else s={x:g,y:l};n={x:g,y:c}}else{if(s){if(s.y<l)return}else s={x:g,y:c};n={x:g,y:l}}}else if(r=b-(i=(d-f)/(m-p))*g,i<-1||i>1)if(d>f){if(s){if(s.y>=c)return}else s={x:(l-r)/i,y:l};n={x:(c-r)/i,y:c}}else{if(s){if(s.y<l)return}else s={x:(c-r)/i,y:c};n={x:(l-r)/i,y:l}}else if(p<m){if(s){if(s.x>=o)return}else s={x:a,y:i*a+r};n={x:o,y:i*o+r}}else{if(s){if(s.x<a)return}else s={x:o,y:i*o+r};n={x:a,y:i*a+r}}return t.a=s,t.b=n,!0}function Ur(t,e){this.l=t,this.r=e,this.a=this.b=null}function Dr(t,e,n,i){var r=new Ur(t,e);return mr.push(r),n&&Hr(r,t,e,n),i&&Hr(r,e,t,i),gr[t.i].edges.push(new Pr(r,t,e)),gr[e.i].edges.push(new Pr(r,e,t)),r}function Hr(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function Pr(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function zr(){this._=null}function Vr(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Rr(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Br(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function qr(t){for(;t.L;)t=t.L;return t}function Fr(t,e){var n,i,r,s=t.sort($r).pop();for(mr=[],gr=new Array(t.length),br=new zr,yr=new zr;;)if(r=vr,s&&(!r||s.y<r.y||s.y===r.y&&s.x<r.x))s.x===n&&s.y===i||(gr[s.i]=new Mr(s),kr(s),n=s.x,i=s.y),s=t.pop();else{if(!r)break;Or(r.arc)}e&&(function(t){for(var e,n=mr,i=li(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)(!Ir(e=n[r],t)||!i(e)||E(e.a.x-e.b.x)<jt&&E(e.a.y-e.b.y)<jt)&&(e.a=e.b=null,n.splice(r,1))}(e),function(t){for(var e,n,i,r,s,a,o,l,c,h,u=t[0][0],d=t[1][0],p=t[0][1],f=t[1][1],m=gr,g=m.length;g--;)if((s=m[g])&&s.prepare())for(l=(o=s.edges).length,a=0;a<l;)i=(h=o[a].end()).x,r=h.y,e=(c=o[++a%l].start()).x,n=c.y,(E(i-e)>jt||E(r-n)>jt)&&(o.splice(a,0,new Pr((b=s.site,v=h,y=E(i-u)<jt&&f-r>jt?{x:u,y:E(e-u)<jt?n:f}:E(r-f)<jt&&d-i>jt?{x:E(n-f)<jt?e:d,y:f}:E(i-d)<jt&&r-p>jt?{x:d,y:E(e-d)<jt?n:p}:E(r-p)<jt&&i-u>jt?{x:E(n-p)<jt?e:u,y:p}:null,x=void 0,(x=new Ur(b,null)).a=v,x.b=y,mr.push(x),x),s.site,null)),++l);var b,v,y,x}(e));var a={cells:gr,edges:mr};return br=yr=mr=gr=null,a}function $r(t,e){return e.y-t.y||e.x-t.x}Mr.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(Cr),e.length},Pr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},zr.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=qr(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Rr(this,n),n=(t=n).U),n.C=!1,i.C=!0,Br(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Br(this,n),n=(t=n).U),n.C=!1,i.C=!0,Rr(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,s=t.L,a=t.R;if(n=s?a?qr(a):s:a,r?r.L===t?r.L=n:r.R=n:this._=n,s&&a?(i=n.C,n.C=t.C,n.L=s,s.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,Rr(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Br(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Rr(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Br(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Rr(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Br(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},s.geom.voronoi=function(t){var e=or,n=lr,i=e,r=n,s=Wr;if(t)return a(t);function a(t){var e=new Array(t.length),n=s[0][0],i=s[0][1],r=s[1][0],a=s[1][1];return Fr(o(t),s).cells.forEach((function(s,o){var l=s.edges,c=s.site;(e[o]=l.length?l.map((function(t){var e=t.start();return[e.x,e.y]})):c.x>=n&&c.x<=r&&c.y>=i&&c.y<=a?[[n,a],[r,a],[r,i],[n,i]]:[]).point=t[o]})),e}function o(t){return t.map((function(t,e){return{x:Math.round(i(t,e)/jt)*jt,y:Math.round(r(t,e)/jt)*jt,i:e}}))}return a.links=function(t){return Fr(o(t)).edges.filter((function(t){return t.l&&t.r})).map((function(e){return{source:t[e.l.i],target:t[e.r.i]}}))},a.triangles=function(t){var e=[];return Fr(o(t)).cells.forEach((function(n,i){for(var r,s,a,o,l=n.site,c=n.edges.sort(Cr),h=-1,u=c.length,d=c[u-1].edge,p=d.l===l?d.r:d.l;++h<u;)r=p,p=(d=c[h].edge).l===l?d.r:d.l,i<r.i&&i<p.i&&(a=r,o=p,((s=l).x-o.x)*(a.y-s.y)-(s.x-a.x)*(o.y-s.y)<0)&&e.push([t[i],t[r.i],t[p.i]])})),e},a.x=function(t){return arguments.length?(i=xe(e=t),a):e},a.y=function(t){return arguments.length?(r=xe(n=t),a):n},a.clipExtent=function(t){return arguments.length?(s=null==t?Wr:t,a):s===Wr?null:s},a.size=function(t){return arguments.length?a.clipExtent(t&&[[0,0],t]):s===Wr?null:s&&s[1]},a};var Wr=[[-1e6,-1e6],[1e6,1e6]];function Yr(t){return t.x}function Xr(t){return t.y}function Gr(t,e,n,i,r,s){if(!t(e,n,i,r,s)){var a=.5*(n+r),o=.5*(i+s),l=e.nodes;l[0]&&Gr(t,l[0],n,i,a,o),l[1]&&Gr(t,l[1],a,i,r,o),l[2]&&Gr(t,l[2],n,o,a,s),l[3]&&Gr(t,l[3],a,o,r,s)}}function Jr(t,e){t=s.rgb(t),e=s.rgb(e);var n=t.r,i=t.g,r=t.b,a=e.r-n,o=e.g-i,l=e.b-r;return function(t){return"#"+pe(Math.round(n+a*t))+pe(Math.round(i+o*t))+pe(Math.round(r+l*t))}}function Zr(t,e){var n,i={},r={};for(n in t)n in e?i[n]=ns(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function Qr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Kr(t,e){var n,i,r,s=ts.lastIndex=es.lastIndex=0,a=-1,o=[],l=[];for(t+="",e+="";(n=ts.exec(t))&&(i=es.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),o[a]?o[a]+=r:o[++a]=r),(n=n[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:Qr(n,i)})),s=es.lastIndex;return s<e.length&&(r=e.slice(s),o[a]?o[a]+=r:o[++a]=r),o.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,i=0;i<e;++i)o[(n=l[i]).i]=n.x(t);return o.join("")})}s.geom.delaunay=function(t){return s.geom.voronoi().triangles(t)},s.geom.quadtree=function(t,e,n,i,r){var s,a=or,o=lr;if(s=arguments.length)return a=Yr,o=Xr,3===s&&(r=n,i=e,n=e=0),l(t);function l(t){var l,c,h,u,d,p,f,m,g,b=xe(a),v=xe(o);if(null!=e)p=e,f=n,m=i,g=r;else if(m=g=-(p=f=1/0),c=[],h=[],d=t.length,s)for(u=0;u<d;++u)(l=t[u]).x<p&&(p=l.x),l.y<f&&(f=l.y),l.x>m&&(m=l.x),l.y>g&&(g=l.y),c.push(l.x),h.push(l.y);else for(u=0;u<d;++u){var y=+b(l=t[u],u),x=+v(l,u);y<p&&(p=y),x<f&&(f=x),y>m&&(m=y),x>g&&(g=x),c.push(y),h.push(x)}var w=m-p,A=g-f;function N(t,e,n,i,r,s,a,o){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(E(l-n)+E(c-i)<.01)O(t,e,n,i,r,s,a,o);else{var h=t.point;t.x=t.y=t.point=null,O(t,h,l,c,r,s,a,o),O(t,e,n,i,r,s,a,o)}else t.x=n,t.y=i,t.point=e}else O(t,e,n,i,r,s,a,o)}function O(t,e,n,i,r,s,a,o){var l=.5*(r+a),c=.5*(s+o),h=n>=l,u=i>=c,d=u<<1|h;t.leaf=!1,h?r=l:a=l,u?s=c:o=c,N(t=t.nodes[d]||(t.nodes[d]={leaf:!0,nodes:[],point:null,x:null,y:null}),e,n,i,r,s,a,o)}w>A?g=f+w:m=p+A;var k={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){N(k,t,+b(t,++u),+v(t,u),p,f,m,g)}};if(k.visit=function(t){Gr(t,k,p,f,m,g)},k.find=function(t){return function(t,e,n,i,r,s,a){var o,l=1/0;return function t(c,h,u,d,p){if(!(h>s||u>a||d<i||p<r)){if(f=c.point){var f,m=e-c.x,g=n-c.y,b=m*m+g*g;if(b<l){var v=Math.sqrt(l=b);i=e-v,r=n-v,s=e+v,a=n+v,o=f}}for(var y=c.nodes,x=.5*(h+d),w=.5*(u+p),E=(n>=w)<<1|e>=x,A=E+4;E<A;++E)if(c=y[3&E])switch(3&E){case 0:t(c,h,u,x,w);break;case 1:t(c,x,u,d,w);break;case 2:t(c,h,w,x,p);break;case 3:t(c,x,w,d,p)}}}(t,i,r,s,a),o}(k,t[0],t[1],p,f,m,g)},u=-1,null==e){for(;++u<d;)N(k,t[u],c[u],h[u],p,f,m,g);--u}else t.forEach(k.add);return c=h=t=l=null,k}return l.x=function(t){return arguments.length?(a=t,l):a},l.y=function(t){return arguments.length?(o=t,l):o},l.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),l):null==e?null:[[e,n],[i,r]]},l.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),l):null==e?null:[i-e,r-n]},l},s.interpolateRgb=Jr,s.interpolateObject=Zr,s.interpolateNumber=Qr,s.interpolateString=Kr;var ts=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,es=new RegExp(ts.source,"g");function ns(t,e){for(var n,i=s.interpolators.length;--i>=0&&!(n=s.interpolators[i](t,e)););return n}function is(t,e){var n,i=[],r=[],s=t.length,a=e.length,o=Math.min(t.length,e.length);for(n=0;n<o;++n)i.push(ns(t[n],e[n]));for(;n<s;++n)r[n]=t[n];for(;n<a;++n)r[n]=e[n];return function(t){for(n=0;n<o;++n)r[n]=i[n](t);return r}}s.interpolate=ns,s.interpolators=[function(t,e){var n=typeof e;return("string"===n?ye.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?Jr:Kr:e instanceof Wt?Jr:Array.isArray(e)?is:"object"===n&&isNaN(e)?Zr:Qr)(t,e)}],s.interpolateArray=is;var rs=function(){return U},ss=s.map({linear:rs,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return cs},cubic:function(){return hs},sin:function(){return ds},exp:function(){return ps},circle:function(){return fs},elastic:function(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/St*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*St/e)}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},bounce:function(){return ms}}),as=s.map({in:U,out:os,"in-out":ls,"out-in":function(t){return ls(os(t))}});function os(t){return function(e){return 1-t(1-e)}}function ls(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function cs(t){return t*t}function hs(t){return t*t*t}function us(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function ds(t){return 1-Math.cos(t*Tt)}function ps(t){return Math.pow(2,10*(t-1))}function fs(t){return 1-Math.sqrt(1-t*t)}function ms(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function gs(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function bs(t){var e,n,i,r=[t.a,t.b],s=[t.c,t.d],a=ys(r),o=vs(r,s),l=ys(((e=s)[0]+=(i=-o)*(n=r)[0],e[1]+=i*n[1],e))||0;r[0]*s[1]<s[0]*r[1]&&(r[0]*=-1,r[1]*=-1,a*=-1,o*=-1),this.rotate=(a?Math.atan2(r[1],r[0]):Math.atan2(-s[0],s[1]))*Ut,this.translate=[t.e,t.f],this.scale=[a,l],this.skew=l?Math.atan2(o,l)*Ut:0}function vs(t,e){return t[0]*e[0]+t[1]*e[1]}function ys(t){var e=Math.sqrt(vs(t,t));return e&&(t[0]/=e,t[1]/=e),e}s.ease=function(t){var e,n=t.indexOf("-"),i=n>=0?t.slice(0,n):t,r=n>=0?t.slice(n+1):"in";return i=ss.get(i)||rs,r=as.get(r)||U,e=r(i.apply(null,a.call(arguments,1))),function(t){return t<=0?0:t>=1?1:e(t)}},s.interpolateHcl=function(t,e){t=s.hcl(t),e=s.hcl(e);var n=t.h,i=t.c,r=t.l,a=e.h-n,o=e.c-i,l=e.l-r;return isNaN(o)&&(o=0,i=isNaN(i)?e.c:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360),function(t){return Qt(n+a*t,i+o*t,r+l*t)+""}},s.interpolateHsl=function(t,e){t=s.hsl(t),e=s.hsl(e);var n=t.h,i=t.s,r=t.l,a=e.h-n,o=e.s-i,l=e.l-r;return isNaN(o)&&(o=0,i=isNaN(i)?e.s:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360),function(t){return Gt(n+a*t,i+o*t,r+l*t)+""}},s.interpolateLab=function(t,e){t=s.lab(t),e=s.lab(e);var n=t.l,i=t.a,r=t.b,a=e.l-n,o=e.a-i,l=e.b-r;return function(t){return se(n+a*t,i+o*t,r+l*t)+""}},s.interpolateRound=gs,s.transform=function(t){var e=l.createElementNS(s.ns.prefix.svg,"g");return(s.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new bs(n?n.matrix:xs)})(t)},bs.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var xs={a:1,b:0,c:0,d:1,e:0,f:0};function ws(t){return t.length?t.pop()+",":""}function Es(t,e){var n=[],i=[];return t=s.transform(t),e=s.transform(e),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push("translate(",null,",",null,")");i.push({i:r-4,x:Qr(t[0],e[0])},{i:r-2,x:Qr(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}(t.translate,e.translate,n,i),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(ws(n)+"rotate(",null,")")-2,x:Qr(t,e)})):e&&n.push(ws(n)+"rotate("+e+")")}(t.rotate,e.rotate,n,i),function(t,e,n,i){t!==e?i.push({i:n.push(ws(n)+"skewX(",null,")")-2,x:Qr(t,e)}):e&&n.push(ws(n)+"skewX("+e+")")}(t.skew,e.skew,n,i),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push(ws(n)+"scale(",null,",",null,")");i.push({i:r-4,x:Qr(t[0],e[0])},{i:r-2,x:Qr(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(ws(n)+"scale("+e+")")}(t.scale,e.scale,n,i),t=e=null,function(t){for(var e,r=-1,s=i.length;++r<s;)n[(e=i[r]).i]=e.x(t);return n.join("")}}function As(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Ns(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Os(t){for(var e=t.source,n=t.target,i=function(t,e){if(t===e)return t;for(var n=ks(t),i=ks(e),r=n.pop(),s=i.pop(),a=null;r===s;)a=r,r=n.pop(),s=i.pop();return a}(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var s=r.length;n!==i;)r.splice(s,0,n),n=n.parent;return r}function ks(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function _s(t){t.fixed|=2}function js(t){t.fixed&=-7}function Ms(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Cs(t){t.fixed&=-5}function Ss(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var s,a=t.nodes,o=a.length,l=-1;++l<o;)null!=(s=a[l])&&(Ss(s,e,n),t.charge+=s.charge,i+=s.charge*s.cx,r+=s.charge*s.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*n[t.point.index];t.charge+=t.pointCharge=c,i+=c*t.point.x,r+=c*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}s.interpolateTransform=Es,s.layout={},s.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(Os(t[n]));return e}},s.layout.chord=function(){var t,e,n,i,r,a,o,l={},c=0;function h(){var l,h,d,p,f,m={},g=[],b=s.range(i),v=[];for(t=[],e=[],l=0,p=-1;++p<i;){for(h=0,f=-1;++f<i;)h+=n[p][f];g.push(h),v.push(s.range(i)),l+=h}for(r&&b.sort((function(t,e){return r(g[t],g[e])})),a&&v.forEach((function(t,e){t.sort((function(t,i){return a(n[e][t],n[e][i])}))})),l=(St-c*i)/l,h=0,p=-1;++p<i;){for(d=h,f=-1;++f<i;){var y=b[p],x=v[y][f],w=n[y][x],E=h,A=h+=w*l;m[y+"-"+x]={index:y,subindex:x,startAngle:E,endAngle:A,value:w}}e[y]={index:y,startAngle:d,endAngle:h,value:g[y]},h+=c}for(p=-1;++p<i;)for(f=p-1;++f<i;){var N=m[p+"-"+f],O=m[f+"-"+p];(N.value||O.value)&&t.push(N.value<O.value?{source:O,target:N}:{source:N,target:O})}o&&u()}function u(){t.sort((function(t,e){return o((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)}))}return l.matrix=function(r){return arguments.length?(i=(n=r)&&n.length,t=e=null,l):n},l.padding=function(n){return arguments.length?(c=n,t=e=null,l):c},l.sortGroups=function(n){return arguments.length?(r=n,t=e=null,l):r},l.sortSubgroups=function(e){return arguments.length?(a=e,t=null,l):a},l.sortChords=function(e){return arguments.length?(o=e,t&&u(),l):o},l.chords=function(){return t||h(),t},l.groups=function(){return e||h(),e},l},s.layout.force=function(){var t,e,n,i,r,a,o={},l=s.dispatch("start","tick","end"),c=[1,1],h=.9,u=Ls,d=Ts,p=-30,f=Is,m=.1,g=.64,b=[],v=[];function y(t){return function(e,n,i,r){if(e.point!==t){var s=e.cx-t.x,a=e.cy-t.y,o=r-n,l=s*s+a*a;if(o*o/g<l){if(l<f){var c=e.charge/l;t.px-=s*c,t.py-=a*c}return!0}e.point&&l&&l<f&&(c=e.pointCharge/l,t.px-=s*c,t.py-=a*c)}return!e.charge}}function x(t){t.px=s.event.x,t.py=s.event.y,o.resume()}return o.tick=function(){if((n*=.99)<.005)return t=null,l.end({type:"end",alpha:n=0}),!0;var e,o,u,d,f,g,x,w,E,A=b.length,N=v.length;for(o=0;o<N;++o)d=(u=v[o]).source,(g=(w=(f=u.target).x-d.x)*w+(E=f.y-d.y)*E)&&(w*=g=n*r[o]*((g=Math.sqrt(g))-i[o])/g,E*=g,f.x-=w*(x=d.weight+f.weight?d.weight/(d.weight+f.weight):.5),f.y-=E*x,d.x+=w*(x=1-x),d.y+=E*x);if((x=n*m)&&(w=c[0]/2,E=c[1]/2,o=-1,x))for(;++o<A;)(u=b[o]).x+=(w-u.x)*x,u.y+=(E-u.y)*x;if(p)for(Ss(e=s.geom.quadtree(b),n,a),o=-1;++o<A;)(u=b[o]).fixed||e.visit(y(u));for(o=-1;++o<A;)(u=b[o]).fixed?(u.x=u.px,u.y=u.py):(u.x-=(u.px-(u.px=u.x))*h,u.y-=(u.py-(u.py=u.y))*h);l.tick({type:"tick",alpha:n})},o.nodes=function(t){return arguments.length?(b=t,o):b},o.links=function(t){return arguments.length?(v=t,o):v},o.size=function(t){return arguments.length?(c=t,o):c},o.linkDistance=function(t){return arguments.length?(u="function"==typeof t?t:+t,o):u},o.distance=o.linkDistance,o.linkStrength=function(t){return arguments.length?(d="function"==typeof t?t:+t,o):d},o.friction=function(t){return arguments.length?(h=+t,o):h},o.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,o):p},o.chargeDistance=function(t){return arguments.length?(f=t*t,o):Math.sqrt(f)},o.gravity=function(t){return arguments.length?(m=+t,o):m},o.theta=function(t){return arguments.length?(g=t*t,o):Math.sqrt(g)},o.alpha=function(e){return arguments.length?(e=+e,n?e>0?n=e:(t.c=null,t.t=NaN,t=null,l.end({type:"end",alpha:n=0})):e>0&&(l.start({type:"start",alpha:n=e}),t=je(o.tick)),o):n},o.start=function(){var t,e,n,s=b.length,l=v.length,h=c[0],f=c[1];for(t=0;t<s;++t)(n=b[t]).index=t,n.weight=0;for(t=0;t<l;++t)"number"==typeof(n=v[t]).source&&(n.source=b[n.source]),"number"==typeof n.target&&(n.target=b[n.target]),++n.source.weight,++n.target.weight;for(t=0;t<s;++t)n=b[t],isNaN(n.x)&&(n.x=m("x",h)),isNaN(n.y)&&(n.y=m("y",f)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(i=[],"function"==typeof u)for(t=0;t<l;++t)i[t]=+u.call(this,v[t],t);else for(t=0;t<l;++t)i[t]=u;if(r=[],"function"==typeof d)for(t=0;t<l;++t)r[t]=+d.call(this,v[t],t);else for(t=0;t<l;++t)r[t]=d;if(a=[],"function"==typeof p)for(t=0;t<s;++t)a[t]=+p.call(this,b[t],t);else for(t=0;t<s;++t)a[t]=p;function m(n,i){if(!e){for(e=new Array(s),c=0;c<s;++c)e[c]=[];for(c=0;c<l;++c){var r=v[c];e[r.source.index].push(r.target),e[r.target.index].push(r.source)}}for(var a,o=e[t],c=-1,h=o.length;++c<h;)if(!isNaN(a=o[c][n]))return a;return Math.random()*i}return o.resume()},o.resume=function(){return o.alpha(.1)},o.stop=function(){return o.alpha(0)},o.drag=function(){if(e||(e=s.behavior.drag().origin(U).on("dragstart.force",_s).on("drag.force",x).on("dragend.force",js)),!arguments.length)return e;this.on("mouseover.force",Ms).on("mouseout.force",Cs).call(e)},s.rebind(o,l,"on")};var Ls=20,Ts=1,Is=1/0;function Us(t,e){return s.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Rs,t}function Ds(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function Hs(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(s=t.children)&&(r=s.length))for(var r,s,a=-1;++a<r;)n.push(s[a]);for(;null!=(t=i.pop());)e(t)}function Ps(t){return t.children}function zs(t){return t.value}function Vs(t,e){return e.value-t.value}function Rs(t){return s.merge(t.map((function(t){return(t.children||[]).map((function(e){return{source:t,target:e}}))})))}s.layout.hierarchy=function(){var t=Vs,e=Ps,n=zs;function i(r){var s,a=[r],o=[];for(r.depth=0;null!=(s=a.pop());)if(o.push(s),(c=e.call(i,s,s.depth))&&(l=c.length)){for(var l,c,h;--l>=0;)a.push(h=c[l]),h.parent=s,h.depth=s.depth+1;n&&(s.value=0),s.children=c}else n&&(s.value=+n.call(i,s,s.depth)||0),delete s.children;return Hs(r,(function(e){var i,r;t&&(i=e.children)&&i.sort(t),n&&(r=e.parent)&&(r.value+=e.value)})),o}return i.sort=function(e){return arguments.length?(t=e,i):t},i.children=function(t){return arguments.length?(e=t,i):e},i.value=function(t){return arguments.length?(n=t,i):n},i.revalue=function(t){return n&&(Ds(t,(function(t){t.children&&(t.value=0)})),Hs(t,(function(t){var e;t.children||(t.value=+n.call(i,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)}))),t},i},s.layout.partition=function(){var t=s.layout.hierarchy(),e=[1,1];function n(t,e,i,r){var s=t.children;if(t.x=e,t.y=t.depth*r,t.dx=i,t.dy=r,s&&(a=s.length)){var a,o,l,c=-1;for(i=t.value?i/t.value:0;++c<a;)n(o=s[c],e,l=o.value*i,r),e+=l}}function i(t){var e=t.children,n=0;if(e&&(r=e.length))for(var r,s=-1;++s<r;)n=Math.max(n,i(e[s]));return 1+n}function r(r,s){var a=t.call(this,r,s);return n(a[0],0,e[0],e[1]/i(a[0])),a}return r.size=function(t){return arguments.length?(e=t,r):e},Us(r,t)},s.layout.pie=function(){var t=Number,e=Bs,n=0,i=St,r=0;function a(o){var l,c=o.length,h=o.map((function(e,n){return+t.call(a,e,n)})),u=+("function"==typeof n?n.apply(this,arguments):n),d=("function"==typeof i?i.apply(this,arguments):i)-u,p=Math.min(Math.abs(d)/c,+("function"==typeof r?r.apply(this,arguments):r)),f=p*(d<0?-1:1),m=s.sum(h),g=m?(d-c*f)/m:0,b=s.range(c),v=[];return null!=e&&b.sort(e===Bs?function(t,e){return h[e]-h[t]}:function(t,n){return e(o[t],o[n])}),b.forEach((function(t){v[t]={data:o[t],value:l=h[t],startAngle:u,endAngle:u+=l*g+f,padAngle:p}})),v}return a.value=function(e){return arguments.length?(t=e,a):t},a.sort=function(t){return arguments.length?(e=t,a):e},a.startAngle=function(t){return arguments.length?(n=t,a):n},a.endAngle=function(t){return arguments.length?(i=t,a):i},a.padAngle=function(t){return arguments.length?(r=t,a):r},a};var Bs={};function qs(t){return t.x}function Fs(t){return t.y}function $s(t,e,n){t.y0=e,t.y=n}s.layout.stack=function(){var t=U,e=Xs,n=Gs,i=$s,r=qs,a=Fs;function o(l,c){if(!(p=l.length))return l;var h=l.map((function(e,n){return t.call(o,e,n)})),u=h.map((function(t){return t.map((function(t,e){return[r.call(o,t,e),a.call(o,t,e)]}))})),d=e.call(o,u,c);h=s.permute(h,d),u=s.permute(u,d);var p,f,m,g,b=n.call(o,u,c),v=h[0].length;for(m=0;m<v;++m)for(i.call(o,h[0][m],g=b[m],u[0][m][1]),f=1;f<p;++f)i.call(o,h[f][m],g+=u[f-1][m][1],u[f][m][1]);return l}return o.values=function(e){return arguments.length?(t=e,o):t},o.order=function(t){return arguments.length?(e="function"==typeof t?t:Ws.get(t)||Xs,o):e},o.offset=function(t){return arguments.length?(n="function"==typeof t?t:Ys.get(t)||Gs,o):n},o.x=function(t){return arguments.length?(r=t,o):r},o.y=function(t){return arguments.length?(a=t,o):a},o.out=function(t){return arguments.length?(i=t,o):i},o};var Ws=s.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(Js),a=t.map(Zs),o=s.range(i).sort((function(t,e){return r[t]-r[e]})),l=0,c=0,h=[],u=[];for(e=0;e<i;++e)n=o[e],l<c?(l+=a[n],h.push(n)):(c+=a[n],u.push(n));return u.reverse().concat(h)},reverse:function(t){return s.range(t.length).reverse()},default:Xs}),Ys=s.map({silhouette:function(t){var e,n,i,r=t.length,s=t[0].length,a=[],o=0,l=[];for(n=0;n<s;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];i>o&&(o=i),a.push(i)}for(n=0;n<s;++n)l[n]=(o-a[n])/2;return l},wiggle:function(t){var e,n,i,r,s,a,o,l,c,h=t.length,u=t[0],d=u.length,p=[];for(p[0]=l=c=0,n=1;n<d;++n){for(e=0,r=0;e<h;++e)r+=t[e][n][1];for(e=0,s=0,o=u[n][0]-u[n-1][0];e<h;++e){for(i=0,a=(t[e][n][1]-t[e][n-1][1])/(2*o);i<e;++i)a+=(t[i][n][1]-t[i][n-1][1])/o;s+=a*t[e][n][1]}p[n]=l-=r?s/r*o:0,l<c&&(c=l)}for(n=0;n<d;++n)p[n]-=c;return p},expand:function(t){var e,n,i,r=t.length,s=t[0].length,a=1/r,o=[];for(n=0;n<s;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];if(i)for(e=0;e<r;e++)t[e][n][1]/=i;else for(e=0;e<r;e++)t[e][n][1]=a}for(n=0;n<s;++n)o[n]=0;return o},zero:Gs});function Xs(t){return s.range(t.length)}function Gs(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function Js(t){for(var e,n=1,i=0,r=t[0][1],s=t.length;n<s;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function Zs(t){return t.reduce(Qs,0)}function Qs(t,e){return t+e[1]}function Ks(t,e){return ta(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function ta(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,s=[];++n<=e;)s[n]=r*n+i;return s}function ea(t){return[s.min(t),s.max(t)]}function na(t,e){return t.value-e.value}function ia(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function ra(t,e){t._pack_next=e,e._pack_prev=t}function sa(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function aa(t){if((e=t.children)&&(l=e.length)){var e,n,i,r,s,a,o,l,c=1/0,h=-1/0,u=1/0,d=-1/0;if(e.forEach(oa),(n=e[0]).x=-n.r,n.y=0,y(n),l>1&&((i=e[1]).x=i.r,i.y=0,y(i),l>2))for(ha(n,i,r=e[2]),y(r),ia(n,r),n._pack_prev=r,ia(r,i),i=n._pack_next,s=3;s<l;s++){ha(n,i,r=e[s]);var p=0,f=1,m=1;for(a=i._pack_next;a!==i;a=a._pack_next,f++)if(sa(a,r)){p=1;break}if(1==p)for(o=n._pack_prev;o!==a._pack_prev&&!sa(o,r);o=o._pack_prev,m++);p?(f<m||f==m&&i.r<n.r?ra(n,i=a):ra(n=o,i),s--):(ia(n,r),i=r,y(r))}var g=(c+h)/2,b=(u+d)/2,v=0;for(s=0;s<l;s++)(r=e[s]).x-=g,r.y-=b,v=Math.max(v,r.r+Math.sqrt(r.x*r.x+r.y*r.y));t.r=v,e.forEach(la)}function y(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),u=Math.min(t.y-t.r,u),d=Math.max(t.y+t.r,d)}}function oa(t){t._pack_next=t._pack_prev=t}function la(t){delete t._pack_next,delete t._pack_prev}function ca(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var s=-1,a=r.length;++s<a;)ca(r[s],e,n,i)}function ha(t,e,n){var i=t.r+n.r,r=e.x-t.x,s=e.y-t.y;if(i&&(r||s)){var a=e.r+n.r,o=r*r+s*s,l=.5+((i*=i)-(a*=a))/(2*o),c=Math.sqrt(Math.max(0,2*a*(i+o)-(i-=o)*i-a*a))/(2*o);n.x=t.x+l*r+c*s,n.y=t.y+l*s-c*r}else n.x=t.x+i,n.y=t.y}function ua(t,e){return t.parent==e.parent?1:2}function da(t){var e=t.children;return e.length?e[0]:t.t}function pa(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function fa(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function ma(t,e,n){return t.a.parent===e.parent?t.a:n}function ga(t){var e=t.children;return e&&e.length?ga(e[0]):t}function ba(t){var e,n=t.children;return n&&(e=n.length)?ba(n[e-1]):t}function va(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function ya(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],s=t.dy-e[0]-e[2];return r<0&&(n+=r/2,r=0),s<0&&(i+=s/2,s=0),{x:n,y:i,dx:r,dy:s}}function xa(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function wa(t){return t.rangeExtent?t.rangeExtent():xa(t.range())}function Ea(t,e,n,i){var r=n(t[0],t[1]),s=i(e[0],e[1]);return function(t){return s(r(t))}}function Aa(t,e){var n,i=0,r=t.length-1,s=t[i],a=t[r];return a<s&&(n=i,i=r,r=n,n=s,s=a,a=n),t[i]=e.floor(s),t[r]=e.ceil(a),t}function Na(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:Oa}s.layout.histogram=function(){var t=!0,e=Number,n=ea,i=Ks;function r(r,a){for(var o,l,c=[],h=r.map(e,this),u=n.call(this,h,a),d=i.call(this,u,h,a),p=(a=-1,h.length),f=d.length-1,m=t?1:1/p;++a<f;)(o=c[a]=[]).dx=d[a+1]-(o.x=d[a]),o.y=0;if(f>0)for(a=-1;++a<p;)(l=h[a])>=u[0]&&l<=u[1]&&((o=c[s.bisect(d,l,1,f)-1]).y+=m,o.push(r[a]));return c}return r.value=function(t){return arguments.length?(e=t,r):e},r.range=function(t){return arguments.length?(n=xe(t),r):n},r.bins=function(t){return arguments.length?(i="number"==typeof t?function(e){return ta(e,t)}:xe(t),r):i},r.frequency=function(e){return arguments.length?(t=!!e,r):t},r},s.layout.pack=function(){var t,e=s.layout.hierarchy().sort(na),n=0,i=[1,1];function r(r,s){var a=e.call(this,r,s),o=a[0],l=i[0],c=i[1],h=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(o.x=o.y=0,Hs(o,(function(t){t.r=+h(t.value)})),Hs(o,aa),n){var u=n*(t?1:Math.max(2*o.r/l,2*o.r/c))/2;Hs(o,(function(t){t.r+=u})),Hs(o,aa),Hs(o,(function(t){t.r-=u}))}return ca(o,l/2,c/2,t?1:1/Math.max(2*o.r/l,2*o.r/c)),a}return r.size=function(t){return arguments.length?(i=t,r):i},r.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,r):t},r.padding=function(t){return arguments.length?(n=+t,r):n},Us(r,e)},s.layout.tree=function(){var t=s.layout.hierarchy().sort(null).value(null),e=ua,n=[1,1],i=null;function r(r,s){var c=t.call(this,r,s),h=c[0],u=function(t){for(var e,n={A:null,children:[t]},i=[n];null!=(e=i.pop());)for(var r,s=e.children,a=0,o=s.length;a<o;++a)i.push((s[a]=r={_:s[a],parent:e,children:(r=s[a].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=r);return n.children[0]}(h);if(Hs(u,a),u.parent.m=-u.z,Ds(u,o),i)Ds(h,l);else{var d=h,p=h,f=h;Ds(h,(function(t){t.x<d.x&&(d=t),t.x>p.x&&(p=t),t.depth>f.depth&&(f=t)}));var m=e(d,p)/2-d.x,g=n[0]/(p.x+e(p,d)/2+m),b=n[1]/(f.depth||1);Ds(h,(function(t){t.x=(t.x+m)*g,t.y=t.depth*b}))}return c}function a(t){var n=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(n.length){!function(t){for(var e,n=0,i=0,r=t.children,s=r.length;--s>=0;)(e=r[s]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(t);var s=(n[0].z+n[n.length-1].z)/2;r?(t.z=r.z+e(t._,r._),t.m=t.z-s):t.z=s}else r&&(t.z=r.z+e(t._,r._));t.parent.A=function(t,n,i){if(n){for(var r,s=t,a=t,o=n,l=s.parent.children[0],c=s.m,h=a.m,u=o.m,d=l.m;o=pa(o),s=da(s),o&&s;)l=da(l),(a=pa(a)).a=t,(r=o.z+u-s.z-c+e(o._,s._))>0&&(fa(ma(o,t,i),t,r),c+=r,h+=r),u+=o.m,c+=s.m,d+=l.m,h+=a.m;o&&!pa(a)&&(a.t=o,a.m+=u-h),s&&!da(l)&&(l.t=s,l.m+=c-d,i=t)}return i}(t,r,t.parent.A||i[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=n[0],t.y=t.depth*n[1]}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(t){return arguments.length?(i=null==(n=t)?l:null,r):i?null:n},r.nodeSize=function(t){return arguments.length?(i=null==(n=t)?null:l,r):i?n:null},Us(r,t)},s.layout.cluster=function(){var t=s.layout.hierarchy().sort(null).value(null),e=ua,n=[1,1],i=!1;function r(r,a){var o,l=t.call(this,r,a),c=l[0],h=0;Hs(c,(function(t){var n=t.children;n&&n.length?(t.x=function(t){return t.reduce((function(t,e){return t+e.x}),0)/t.length}(n),t.y=function(t){return 1+s.max(t,(function(t){return t.y}))}(n)):(t.x=o?h+=e(t,o):0,t.y=0,o=t)}));var u=ga(c),d=ba(c),p=u.x-e(u,d)/2,f=d.x+e(d,u)/2;return Hs(c,i?function(t){t.x=(t.x-c.x)*n[0],t.y=(c.y-t.y)*n[1]}:function(t){t.x=(t.x-p)/(f-p)*n[0],t.y=(1-(c.y?t.y/c.y:1))*n[1]}),l}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(t){return arguments.length?(i=null==(n=t),r):i?null:n},r.nodeSize=function(t){return arguments.length?(i=null!=(n=t),r):i?n:null},Us(r,t)},s.layout.treemap=function(){var t,e=s.layout.hierarchy(),n=Math.round,i=[1,1],r=null,a=va,o=!1,l="squarify",c=.5*(1+Math.sqrt(5));function h(t,e){for(var n,i,r=-1,s=t.length;++r<s;)i=(n=t[r]).value*(e<0?0:e),n.area=isNaN(i)||i<=0?0:i}function u(t){var e=t.children;if(e&&e.length){var n,i,r,s=a(t),o=[],c=e.slice(),d=1/0,m="slice"===l?s.dx:"dice"===l?s.dy:"slice-dice"===l?1&t.depth?s.dy:s.dx:Math.min(s.dx,s.dy);for(h(c,s.dx*s.dy/t.value),o.area=0;(r=c.length)>0;)o.push(n=c[r-1]),o.area+=n.area,"squarify"!==l||(i=p(o,m))<=d?(c.pop(),d=i):(o.area-=o.pop().area,f(o,m,s,!1),m=Math.min(s.dx,s.dy),o.length=o.area=0,d=1/0);o.length&&(f(o,m,s,!0),o.length=o.area=0),e.forEach(u)}}function d(t){var e=t.children;if(e&&e.length){var n,i=a(t),r=e.slice(),s=[];for(h(r,i.dx*i.dy/t.value),s.area=0;n=r.pop();)s.push(n),s.area+=n.area,null!=n.z&&(f(s,n.z?i.dx:i.dy,i,!r.length),s.length=s.area=0);e.forEach(d)}}function p(t,e){for(var n,i=t.area,r=0,s=1/0,a=-1,o=t.length;++a<o;)(n=t[a].area)&&(n<s&&(s=n),n>r&&(r=n));return e*=e,(i*=i)?Math.max(e*r*c/i,i/(e*s*c)):1/0}function f(t,e,i,r){var s,a=-1,o=t.length,l=i.x,c=i.y,h=e?n(t.area/e):0;if(e==i.dx){for((r||h>i.dy)&&(h=i.dy);++a<o;)(s=t[a]).x=l,s.y=c,s.dy=h,l+=s.dx=Math.min(i.x+i.dx-l,h?n(s.area/h):0);s.z=!0,s.dx+=i.x+i.dx-l,i.y+=h,i.dy-=h}else{for((r||h>i.dx)&&(h=i.dx);++a<o;)(s=t[a]).x=l,s.y=c,s.dx=h,c+=s.dy=Math.min(i.y+i.dy-c,h?n(s.area/h):0);s.z=!1,s.dy+=i.y+i.dy-c,i.x+=h,i.dx-=h}}function m(n){var r=t||e(n),s=r[0];return s.x=s.y=0,s.value?(s.dx=i[0],s.dy=i[1]):s.dx=s.dy=0,t&&e.revalue(s),h([s],s.dx*s.dy/s.value),(t?d:u)(s),o&&(t=r),r}return m.size=function(t){return arguments.length?(i=t,m):i},m.padding=function(t){if(!arguments.length)return r;function e(e){return ya(e,t)}var n;return a=null==(r=t)?va:"function"==(n=typeof t)?function(e){var n=t.call(m,e,e.depth);return null==n?va(e):ya(e,"number"==typeof n?[n,n,n,n]:n)}:"number"===n?(t=[t,t,t,t],e):e,m},m.round=function(t){return arguments.length?(n=t?Math.round:Number,m):n!=Number},m.sticky=function(e){return arguments.length?(o=e,t=null,m):o},m.ratio=function(t){return arguments.length?(c=t,m):c},m.mode=function(t){return arguments.length?(l=t+"",m):l},Us(m,e)},s.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,i,r;do{r=(n=2*Math.random()-1)*n+(i=2*Math.random()-1)*i}while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=s.random.normal.apply(s,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=s.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},s.scale={};var Oa={floor:U,ceil:U};function ka(t,e,n,i){var r=[],a=[],o=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<=l;)r.push(n(t[o-1],t[o])),a.push(i(e[o-1],e[o]));return function(e){var n=s.bisect(t,e,1,l)-1;return a[n](r[n](e))}}function _a(t,e,n,i){var r,s;function a(){var a=Math.min(t.length,e.length)>2?ka:Ea,l=i?Ns:As;return r=a(t,e,l,n),s=a(e,t,l,ns),o}function o(t){return r(t)}return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),a()):t},o.range=function(t){return arguments.length?(e=t,a()):e},o.rangeRound=function(t){return o.range(t).interpolate(gs)},o.clamp=function(t){return arguments.length?(i=t,a()):i},o.interpolate=function(t){return arguments.length?(n=t,a()):n},o.ticks=function(e){return Sa(t,e)},o.tickFormat=function(e,n){return La(t,e,n)},o.nice=function(e){return Ma(t,e),a()},o.copy=function(){return _a(t,e,n,i)},a()}function ja(t,e){return s.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Ma(t,e){return Aa(t,Na(Ca(t,e)[2])),Aa(t,Na(Ca(t,e)[2])),t}function Ca(t,e){null==e&&(e=10);var n=xa(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),s=e/i*r;return s<=.15?r*=10:s<=.35?r*=5:s<=.75&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Sa(t,e){return s.range.apply(s,Ca(t,e))}function La(t,e,n){var i=Ca(t,e);if(n){var r=Ue.exec(n);if(r.shift(),"s"===r[8]){var a=s.formatPrefix(Math.max(E(i[0]),E(i[1])));return r[7]||(r[7]="."+Ia(a.scale(i[2]))),r[8]="f",n=s.format(r.join("")),function(t){return n(a.scale(t))+a.symbol}}r[7]||(r[7]="."+function(t,e){var n=Ia(e[2]);return t in Ta?Math.abs(n-Ia(Math.max(E(e[0]),E(e[1]))))+ +("e"!==t):n-2*("%"===t)}(r[8],i)),n=r.join("")}else n=",."+Ia(i[2])+"f";return s.format(n)}s.scale.linear=function(){return _a([0,1],[0,1],ns,!1)};var Ta={s:1,g:1,p:1,r:1,e:1};function Ia(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Ua(t,e,n,i){function r(t){return(n?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function a(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function o(e){return t(r(e))}return o.invert=function(e){return a(t.invert(e))},o.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(r)),o):i},o.base=function(n){return arguments.length?(e=+n,t.domain(i.map(r)),o):e},o.nice=function(){var e=Aa(i.map(r),n?Math:Ha);return t.domain(e),i=e.map(a),o},o.ticks=function(){var t=xa(i),s=[],o=t[0],l=t[1],c=Math.floor(r(o)),h=Math.ceil(r(l)),u=e%1?2:e;if(isFinite(h-c)){if(n){for(;c<h;c++)for(var d=1;d<u;d++)s.push(a(c)*d);s.push(a(c))}else for(s.push(a(c));c++<h;)for(d=u-1;d>0;d--)s.push(a(c)*d);for(c=0;s[c]<o;c++);for(h=s.length;s[h-1]>l;h--);s=s.slice(c,h)}return s},o.tickFormat=function(t,n){if(!arguments.length)return Da;arguments.length<2?n=Da:"function"!=typeof n&&(n=s.format(n));var i=Math.max(1,e*t/o.ticks().length);return function(t){var s=t/a(Math.round(r(t)));return s*e<e-.5&&(s*=e),s<=i?n(t):""}},o.copy=function(){return Ua(t.copy(),e,n,i)},ja(o,t)}s.scale.log=function(){return Ua(s.scale.linear().domain([0,1]),10,!0,[1,10])};var Da=s.format(".0e"),Ha={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function Pa(t,e,n){var i=za(e),r=za(1/e);function s(e){return t(i(e))}return s.invert=function(e){return r(t.invert(e))},s.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(i)),s):n},s.ticks=function(t){return Sa(n,t)},s.tickFormat=function(t,e){return La(n,t,e)},s.nice=function(t){return s.domain(Ma(n,t))},s.exponent=function(a){return arguments.length?(i=za(e=a),r=za(1/e),t.domain(n.map(i)),s):e},s.copy=function(){return Pa(t.copy(),e,n)},ja(s,t)}function za(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Va(t,e){var n,i,r;function a(r){return i[((n.get(r)||("range"===e.t?n.set(r,t.push(r)):NaN))-1)%i.length]}function o(e,n){return s.range(t.length).map((function(t){return e+n*t}))}return a.domain=function(i){if(!arguments.length)return t;t=[],n=new N;for(var r,s=-1,o=i.length;++s<o;)n.has(r=i[s])||n.set(r,t.push(r));return a[e.t].apply(a,e.a)},a.range=function(t){return arguments.length?(i=t,r=0,e={t:"range",a:arguments},a):i},a.rangePoints=function(n,s){arguments.length<2&&(s=0);var l=n[0],c=n[1],h=t.length<2?(l=(l+c)/2,0):(c-l)/(t.length-1+s);return i=o(l+h*s/2,h),r=0,e={t:"rangePoints",a:arguments},a},a.rangeRoundPoints=function(n,s){arguments.length<2&&(s=0);var l=n[0],c=n[1],h=t.length<2?(l=c=Math.round((l+c)/2),0):(c-l)/(t.length-1+s)|0;return i=o(l+Math.round(h*s/2+(c-l-(t.length-1+s)*h)/2),h),r=0,e={t:"rangeRoundPoints",a:arguments},a},a.rangeBands=function(n,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var c=n[1]<n[0],h=n[c-0],u=(n[1-c]-h)/(t.length-s+2*l);return i=o(h+u*l,u),c&&i.reverse(),r=u*(1-s),e={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(n,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var c=n[1]<n[0],h=n[c-0],u=n[1-c],d=Math.floor((u-h)/(t.length-s+2*l));return i=o(h+Math.round((u-h-(t.length-s)*d)/2),d),c&&i.reverse(),r=Math.round(d*(1-s)),e={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return r},a.rangeExtent=function(){return xa(e.a[0])},a.copy=function(){return Va(t,e)},a.domain(t)}s.scale.pow=function(){return Pa(s.scale.linear(),1,[0,1])},s.scale.sqrt=function(){return s.scale.pow().exponent(.5)},s.scale.ordinal=function(){return Va([],{t:"range",a:[[]]})},s.scale.category10=function(){return s.scale.ordinal().range(Ra)},s.scale.category20=function(){return s.scale.ordinal().range(Ba)},s.scale.category20b=function(){return s.scale.ordinal().range(qa)},s.scale.category20c=function(){return s.scale.ordinal().range(Fa)};var Ra=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ue),Ba=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ue),qa=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ue),Fa=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ue);function $a(t,e){var n;function i(){var i=0,a=e.length;for(n=[];++i<a;)n[i-1]=s.quantile(t,i/a);return r}function r(t){if(!isNaN(t=+t))return e[s.bisect(n,t)]}return r.domain=function(e){return arguments.length?(t=e.map(b).filter(v).sort(g),i()):t},r.range=function(t){return arguments.length?(e=t,i()):e},r.quantiles=function(){return n},r.invertExtent=function(i){return(i=e.indexOf(i))<0?[NaN,NaN]:[i>0?n[i-1]:t[0],i<n.length?n[i]:t[t.length-1]]},r.copy=function(){return $a(t,e)},i()}function Wa(t,e,n){var i,r;function s(e){return n[Math.max(0,Math.min(r,Math.floor(i*(e-t))))]}function a(){return i=n.length/(e-t),r=n.length-1,s}return s.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],a()):[t,e]},s.range=function(t){return arguments.length?(n=t,a()):n},s.invertExtent=function(e){return[e=(e=n.indexOf(e))<0?NaN:e/i+t,e+1/i]},s.copy=function(){return Wa(t,e,n)},a()}function Ya(t,e){function n(n){if(n<=n)return e[s.bisect(t,n)]}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return Ya(t,e)},n}function Xa(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Sa(t,e)},e.tickFormat=function(e,n){return La(t,e,n)},e.copy=function(){return Xa(t)},e}function Ga(){return 0}s.scale.quantile=function(){return $a([],[])},s.scale.quantize=function(){return Wa(0,1,[0,1])},s.scale.threshold=function(){return Ya([.5],[0,1])},s.scale.identity=function(){return Xa([0,1])},s.svg={},s.svg.arc=function(){var t=Za,e=Qa,n=Ga,i=Ja,r=Ka,s=to,a=eo;function o(){var o=Math.max(0,+t.apply(this,arguments)),c=Math.max(0,+e.apply(this,arguments)),h=r.apply(this,arguments)-Tt,u=s.apply(this,arguments)-Tt,d=Math.abs(u-h),p=h>u?0:1;if(c<o&&(f=c,c=o,o=f),d>=Lt)return l(c,p)+(o?l(o,1-p):"")+"Z";var f,m,g,b,v,y,x,w,E,A,N,O,k=0,_=0,j=[];if((b=(+a.apply(this,arguments)||0)/2)&&(g=i===Ja?Math.sqrt(o*o+c*c):+i.apply(this,arguments),p||(_*=-1),c&&(_=zt(g/c*Math.sin(b))),o&&(k=zt(g/o*Math.sin(b)))),c){v=c*Math.cos(h+_),y=c*Math.sin(h+_),x=c*Math.cos(u-_),w=c*Math.sin(u-_);var M=Math.abs(u-h-2*_)<=Ct?0:1;if(_&&no(v,y,x,w)===p^M){var C=(h+u)/2;v=c*Math.cos(C),y=c*Math.sin(C),x=w=null}}else v=y=0;if(o){E=o*Math.cos(u-k),A=o*Math.sin(u-k),N=o*Math.cos(h+k),O=o*Math.sin(h+k);var S=Math.abs(h-u+2*k)<=Ct?0:1;if(k&&no(E,A,N,O)===1-p^S){var L=(h+u)/2;E=o*Math.cos(L),A=o*Math.sin(L),N=O=null}}else E=A=0;if(d>jt&&(f=Math.min(Math.abs(c-o)/2,+n.apply(this,arguments)))>.001){m=o<c^p?0:1;var T=f,I=f;if(d<Ct){var U=null==N?[E,A]:null==x?[v,y]:pr([v,y],[N,O],[x,w],[E,A]),D=v-U[0],H=y-U[1],P=x-U[0],z=w-U[1],V=1/Math.sin(Math.acos((D*P+H*z)/(Math.sqrt(D*D+H*H)*Math.sqrt(P*P+z*z)))/2),R=Math.sqrt(U[0]*U[0]+U[1]*U[1]);I=Math.min(f,(o-R)/(V-1)),T=Math.min(f,(c-R)/(V+1))}if(null!=x){var B=io(null==N?[E,A]:[N,O],[v,y],c,T,p),q=io([x,w],[E,A],c,T,p);f===T?j.push("M",B[0],"A",T,",",T," 0 0,",m," ",B[1],"A",c,",",c," 0 ",1-p^no(B[1][0],B[1][1],q[1][0],q[1][1]),",",p," ",q[1],"A",T,",",T," 0 0,",m," ",q[0]):j.push("M",B[0],"A",T,",",T," 0 1,",m," ",q[0])}else j.push("M",v,",",y);if(null!=N){var F=io([v,y],[N,O],o,-I,p),$=io([E,A],null==x?[v,y]:[x,w],o,-I,p);f===I?j.push("L",$[0],"A",I,",",I," 0 0,",m," ",$[1],"A",o,",",o," 0 ",p^no($[1][0],$[1][1],F[1][0],F[1][1]),",",1-p," ",F[1],"A",I,",",I," 0 0,",m," ",F[0]):j.push("L",$[0],"A",I,",",I," 0 0,",m," ",F[0])}else j.push("L",E,",",A)}else j.push("M",v,",",y),null!=x&&j.push("A",c,",",c," 0 ",M,",",p," ",x,",",w),j.push("L",E,",",A),null!=N&&j.push("A",o,",",o," 0 ",S,",",1-p," ",N,",",O);return j.push("Z"),j.join("")}function l(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}return o.innerRadius=function(e){return arguments.length?(t=xe(e),o):t},o.outerRadius=function(t){return arguments.length?(e=xe(t),o):e},o.cornerRadius=function(t){return arguments.length?(n=xe(t),o):n},o.padRadius=function(t){return arguments.length?(i=t==Ja?Ja:xe(t),o):i},o.startAngle=function(t){return arguments.length?(r=xe(t),o):r},o.endAngle=function(t){return arguments.length?(s=xe(t),o):s},o.padAngle=function(t){return arguments.length?(a=xe(t),o):a},o.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Tt;return[Math.cos(i)*n,Math.sin(i)*n]},o};var Ja="auto";function Za(t){return t.innerRadius}function Qa(t){return t.outerRadius}function Ka(t){return t.startAngle}function to(t){return t.endAngle}function eo(t){return t&&t.padAngle}function no(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function io(t,e,n,i,r){var s=t[0]-e[0],a=t[1]-e[1],o=(r?i:-i)/Math.sqrt(s*s+a*a),l=o*a,c=-o*s,h=t[0]+l,u=t[1]+c,d=e[0]+l,p=e[1]+c,f=(h+d)/2,m=(u+p)/2,g=d-h,b=p-u,v=g*g+b*b,y=n-i,x=h*p-d*u,w=(b<0?-1:1)*Math.sqrt(Math.max(0,y*y*v-x*x)),E=(x*b-g*w)/v,A=(-x*g-b*w)/v,N=(x*b+g*w)/v,O=(-x*g+b*w)/v,k=E-f,_=A-m,j=N-f,M=O-m;return k*k+_*_>j*j+M*M&&(E=N,A=O),[[E-l,A-c],[E*n/y,A*n/y]]}function ro(t){var e=or,n=lr,i=Kn,r=ao,s=r.key,a=.7;function o(s){var o,l=[],c=[],h=-1,u=s.length,d=xe(e),p=xe(n);function f(){l.push("M",r(t(c),a))}for(;++h<u;)i.call(this,o=s[h],h)?c.push([+d.call(this,o,h),+p.call(this,o,h)]):c.length&&(f(),c=[]);return c.length&&f(),l.length?l.join(""):null}return o.x=function(t){return arguments.length?(e=t,o):e},o.y=function(t){return arguments.length?(n=t,o):n},o.defined=function(t){return arguments.length?(i=t,o):i},o.interpolate=function(t){return arguments.length?(s="function"==typeof t?r=t:(r=so.get(t)||ao).key,o):s},o.tension=function(t){return arguments.length?(a=t,o):a},o}s.svg.line=function(){return ro(U)};var so=s.map({linear:ao,"linear-closed":oo,step:function(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")},"step-before":lo,"step-after":co,basis:po,"basis-open":function(t){if(t.length<4)return ao(t);for(var e,n=[],i=-1,r=t.length,s=[0],a=[0];++i<3;)e=t[i],s.push(e[0]),a.push(e[1]);for(n.push(fo(bo,s)+","+fo(bo,a)),--i;++i<r;)e=t[i],s.shift(),s.push(e[0]),a.shift(),a.push(e[1]),vo(n,s,a);return n.join("")},"basis-closed":function(t){for(var e,n,i=-1,r=t.length,s=r+4,a=[],o=[];++i<4;)n=t[i%r],a.push(n[0]),o.push(n[1]);for(e=[fo(bo,a),",",fo(bo,o)],--i;++i<s;)n=t[i%r],a.shift(),a.push(n[0]),o.shift(),o.push(n[1]),vo(e,a,o);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var i,r,s=t[0][0],a=t[0][1],o=t[n][0]-s,l=t[n][1]-a,c=-1;++c<=n;)r=c/n,(i=t[c])[0]=e*i[0]+(1-e)*(s+r*o),i[1]=e*i[1]+(1-e)*(a+r*l);return po(t)},cardinal:function(t,e){return t.length<3?ao(t):t[0]+ho(t,uo(t,e))},"cardinal-open":function(t,e){return t.length<4?ao(t):t[1]+ho(t.slice(1,-1),uo(t,e))},"cardinal-closed":function(t,e){return t.length<3?oo(t):t[0]+ho((t.push(t[0]),t),uo([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?ao(t):t[0]+ho(t,function(t){for(var e,n,i,r,s=[],a=function(t){for(var e=0,n=t.length-1,i=[],r=t[0],s=t[1],a=i[0]=yo(r,s);++e<n;)i[e]=(a+(a=yo(r=s,s=t[e+1])))/2;return i[e]=a,i}(t),o=-1,l=t.length-1;++o<l;)e=yo(t[o],t[o+1]),E(e)<jt?a[o]=a[o+1]=0:(r=(n=a[o]/e)*n+(i=a[o+1]/e)*i)>9&&(r=3*e/Math.sqrt(r),a[o]=r*n,a[o+1]=r*i);for(o=-1;++o<=l;)r=(t[Math.min(l,o+1)][0]-t[Math.max(0,o-1)][0])/(6*(1+a[o]*a[o])),s.push([r||0,a[o]*r||0]);return s}(t))}});function ao(t){return t.length>1?t.join("L"):t+"Z"}function oo(t){return t.join("L")+"Z"}function lo(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function co(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function ho(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return ao(t);var n=t.length!=e.length,i="",r=t[0],s=t[1],a=e[0],o=a,l=1;if(n&&(i+="Q"+(s[0]-2*a[0]/3)+","+(s[1]-2*a[1]/3)+","+s[0]+","+s[1],r=t[1],l=2),e.length>1){o=e[1],s=t[l],l++,i+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(s[0]-o[0])+","+(s[1]-o[1])+","+s[0]+","+s[1];for(var c=2;c<e.length;c++,l++)s=t[l],o=e[c],i+="S"+(s[0]-o[0])+","+(s[1]-o[1])+","+s[0]+","+s[1]}if(n){var h=t[l];i+="Q"+(s[0]+2*o[0]/3)+","+(s[1]+2*o[1]/3)+","+h[0]+","+h[1]}return i}function uo(t,e){for(var n,i=[],r=(1-e)/2,s=t[0],a=t[1],o=1,l=t.length;++o<l;)n=s,s=a,a=t[o],i.push([r*(a[0]-n[0]),r*(a[1]-n[1])]);return i}function po(t){if(t.length<3)return ao(t);var e=1,n=t.length,i=t[0],r=i[0],s=i[1],a=[r,r,r,(i=t[1])[0]],o=[s,s,s,i[1]],l=[r,",",s,"L",fo(bo,a),",",fo(bo,o)];for(t.push(t[n-1]);++e<=n;)i=t[e],a.shift(),a.push(i[0]),o.shift(),o.push(i[1]),vo(l,a,o);return t.pop(),l.push("L",i),l.join("")}function fo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}so.forEach((function(t,e){e.key=t,e.closed=/-closed$/.test(t)}));var mo=[0,2/3,1/3,0],go=[0,1/3,2/3,0],bo=[0,1/6,2/3,1/6];function vo(t,e,n){t.push("C",fo(mo,e),",",fo(mo,n),",",fo(go,e),",",fo(go,n),",",fo(bo,e),",",fo(bo,n))}function yo(t,e){return(e[1]-t[1])/(e[0]-t[0])}function xo(t){for(var e,n,i,r=-1,s=t.length;++r<s;)n=(e=t[r])[0],i=e[1]-Tt,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function wo(t){var e=or,n=or,i=0,r=lr,s=Kn,a=ao,o=a.key,l=a,c="L",h=.7;function u(o){var u,d,p,f=[],m=[],g=[],b=-1,v=o.length,y=xe(e),x=xe(i),w=e===n?function(){return d}:xe(n),E=i===r?function(){return p}:xe(r);function A(){f.push("M",a(t(g),h),c,l(t(m.reverse()),h),"Z")}for(;++b<v;)s.call(this,u=o[b],b)?(m.push([d=+y.call(this,u,b),p=+x.call(this,u,b)]),g.push([+w.call(this,u,b),+E.call(this,u,b)])):m.length&&(A(),m=[],g=[]);return m.length&&A(),f.length?f.join(""):null}return u.x=function(t){return arguments.length?(e=n=t,u):n},u.x0=function(t){return arguments.length?(e=t,u):e},u.x1=function(t){return arguments.length?(n=t,u):n},u.y=function(t){return arguments.length?(i=r=t,u):r},u.y0=function(t){return arguments.length?(i=t,u):i},u.y1=function(t){return arguments.length?(r=t,u):r},u.defined=function(t){return arguments.length?(s=t,u):s},u.interpolate=function(t){return arguments.length?(o="function"==typeof t?a=t:(a=so.get(t)||ao).key,l=a.reverse||a,c=a.closed?"M":"L",u):o},u.tension=function(t){return arguments.length?(h=t,u):h},u}function Eo(t){return t.radius}function Ao(t){return[t.x,t.y]}function No(){return 64}function Oo(){return"circle"}function ko(t){var e=Math.sqrt(t/Ct);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}s.svg.line.radial=function(){var t=ro(xo);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},lo.reverse=co,co.reverse=lo,s.svg.area=function(){return wo(U)},s.svg.area.radial=function(){var t=wo(xo);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},s.svg.chord=function(){var t=Yi,e=Xi,n=Eo,i=Ka,r=to;function s(n,i){var r,s,c=a(this,t,n,i),h=a(this,e,n,i);return"M"+c.p0+o(c.r,c.p1,c.a1-c.a0)+(s=h,((r=c).a0==s.a0&&r.a1==s.a1?l(c.r,c.p1,c.r,c.p0):l(c.r,c.p1,h.r,h.p0)+o(h.r,h.p1,h.a1-h.a0)+l(h.r,h.p1,c.r,c.p0))+"Z")}function a(t,e,s,a){var o=e.call(t,s,a),l=n.call(t,o,a),c=i.call(t,o,a)-Tt,h=r.call(t,o,a)-Tt;return{r:l,a0:c,a1:h,p0:[l*Math.cos(c),l*Math.sin(c)],p1:[l*Math.cos(h),l*Math.sin(h)]}}function o(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Ct)+",1 "+e}function l(t,e,n,i){return"Q 0,0 "+i}return s.radius=function(t){return arguments.length?(n=xe(t),s):n},s.source=function(e){return arguments.length?(t=xe(e),s):t},s.target=function(t){return arguments.length?(e=xe(t),s):e},s.startAngle=function(t){return arguments.length?(i=xe(t),s):i},s.endAngle=function(t){return arguments.length?(r=xe(t),s):r},s},s.svg.diagonal=function(){var t=Yi,e=Xi,n=Ao;function i(i,r){var s=t.call(this,i,r),a=e.call(this,i,r),o=(s.y+a.y)/2,l=[s,{x:s.x,y:o},{x:a.x,y:o},a];return"M"+(l=l.map(n))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return i.source=function(e){return arguments.length?(t=xe(e),i):t},i.target=function(t){return arguments.length?(e=xe(t),i):e},i.projection=function(t){return arguments.length?(n=t,i):n},i},s.svg.diagonal.radial=function(){var t=s.svg.diagonal(),e=Ao,n=t.projection;return t.projection=function(t){return arguments.length?n(function(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-Tt;return[n*Math.cos(i),n*Math.sin(i)]}}(e=t)):e},t},s.svg.symbol=function(){var t=Oo,e=No;function n(n,i){return(_o.get(t.call(this,n,i))||ko)(e.call(this,n,i))}return n.type=function(e){return arguments.length?(t=xe(e),n):t},n.size=function(t){return arguments.length?(e=xe(t),n):e},n};var _o=s.map({circle:ko,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Mo)),n=e*Mo;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/jo),n=e*jo/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/jo),n=e*jo/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});s.svg.symbolTypes=_o.keys();var jo=Math.sqrt(3),Mo=Math.tan(30*It);Z.transition=function(t){for(var e,n,i=To||++Do,r=zo(t),s=[],a=Io||{time:Date.now(),ease:us,delay:0,duration:250},o=-1,l=this.length;++o<l;){s.push(e=[]);for(var c=this[o],h=-1,u=c.length;++h<u;)(n=c[h])&&Vo(n,h,r,i,a),e.push(n)}return Lo(s,r,i)},Z.interrupt=function(t){return this.each(null==t?Co:So(zo(t)))};var Co=So(zo());function So(t){return function(){var e,n,i;(e=this[t])&&(i=e[n=e.active])&&(i.timer.c=null,i.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function Lo(t,e,n){return W(t,Uo),t.namespace=e,t.id=n,t}var To,Io,Uo=[],Do=0;function Ho(t,e,n,i){var r=t.id,s=t.namespace;return mt(t,"function"==typeof n?function(t,a,o){t[s][r].tween.set(e,i(n.call(t,t.__data__,a,o)))}:(n=i(n),function(t){t[s][r].tween.set(e,n)}))}function Po(t){return null==t&&(t=""),function(){this.textContent=t}}function zo(t){return null==t?"__transition__":"__transition_"+t+"__"}function Vo(t,e,n,i,r){var s,a,o,l,c,h=t[n]||(t[n]={active:0,count:0}),u=h[i];function d(n){var r=h.active,d=h[r];for(var f in d&&(d.timer.c=null,d.timer.t=NaN,--h.count,delete h[r],d.event&&d.event.interrupt.call(t,t.__data__,d.index)),h)if(+f<i){var m=h[f];m.timer.c=null,m.timer.t=NaN,--h.count,delete h[f]}a.c=p,je((function(){return a.c&&p(n||1)&&(a.c=null,a.t=NaN),1}),0,s),h.active=i,u.event&&u.event.start.call(t,t.__data__,e),c=[],u.tween.forEach((function(n,i){(i=i.call(t,t.__data__,e))&&c.push(i)})),l=u.ease,o=u.duration}function p(r){for(var s=r/o,a=l(s),d=c.length;d>0;)c[--d].call(t,a);if(s>=1)return u.event&&u.event.end.call(t,t.__data__,e),--h.count?delete h[i]:delete t[n],1}u||(s=r.time,a=je((function(t){var e=u.delay;if(a.t=e+s,e<=t)return d(t-e);a.c=d}),0,s),u=h[i]={tween:new N,time:s,timer:a,delay:r.delay,duration:r.duration,ease:r.ease,index:e},r=null,++h.count)}Uo.call=Z.call,Uo.empty=Z.empty,Uo.node=Z.node,Uo.size=Z.size,s.transition=function(t,e){return t&&t.transition?To?t.transition(e):t:s.selection().transition(t)},s.transition.prototype=Uo,Uo.select=function(t){var e,n,i,r=this.id,s=this.namespace,a=[];t=Q(t);for(var o=-1,l=this.length;++o<l;){a.push(e=[]);for(var c=this[o],h=-1,u=c.length;++h<u;)(i=c[h])&&(n=t.call(i,i.__data__,h,o))?("__data__"in i&&(n.__data__=i.__data__),Vo(n,h,s,r,i[s][r]),e.push(n)):e.push(null)}return Lo(a,s,r)},Uo.selectAll=function(t){var e,n,i,r,s,a=this.id,o=this.namespace,l=[];t=K(t);for(var c=-1,h=this.length;++c<h;)for(var u=this[c],d=-1,p=u.length;++d<p;)if(i=u[d]){s=i[o][a],n=t.call(i,i.__data__,d,c),l.push(e=[]);for(var f=-1,m=n.length;++f<m;)(r=n[f])&&Vo(r,f,o,a,s),e.push(r)}return Lo(l,o,a)},Uo.filter=function(t){var e,n,i=[];"function"!=typeof t&&(t=pt(t));for(var r=0,s=this.length;r<s;r++){i.push(e=[]);for(var a,o=0,l=(a=this[r]).length;o<l;o++)(n=a[o])&&t.call(n,n.__data__,o,r)&&e.push(n)}return Lo(i,this.namespace,this.id)},Uo.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):mt(this,null==e?function(e){e[i][n].tween.remove(t)}:function(r){r[i][n].tween.set(t,e)})},Uo.attr=function(t,e){if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var n="transform"==t?Es:ns,i=s.ns.qualify(t);function r(){this.removeAttribute(i)}function a(){this.removeAttributeNS(i.space,i.local)}return Ho(this,"attr."+t,e,i.local?function(t){return null==t?a:(t+="",function(){var e,r=this.getAttributeNS(i.space,i.local);return r!==t&&(e=n(r,t),function(t){this.setAttributeNS(i.space,i.local,e(t))})})}:function(t){return null==t?r:(t+="",function(){var e,r=this.getAttribute(i);return r!==t&&(e=n(r,t),function(t){this.setAttribute(i,e(t))})})})},Uo.attrTween=function(t,e){var n=s.ns.qualify(t);return this.tween("attr."+t,n.local?function(t,i){var r=e.call(this,t,i,this.getAttributeNS(n.space,n.local));return r&&function(t){this.setAttributeNS(n.space,n.local,r(t))}}:function(t,i){var r=e.call(this,t,i,this.getAttribute(n));return r&&function(t){this.setAttribute(n,r(t))}})},Uo.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.style(n,t[n],e);return this}n=""}function r(){this.style.removeProperty(t)}return Ho(this,"style."+t,e,(function(e){return null==e?r:(e+="",function(){var i,r=h(this).getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=ns(r,e),function(e){this.style.setProperty(t,i(e),n)})})}))},Uo.styleTween=function(t,e,n){return arguments.length<3&&(n=""),this.tween("style."+t,(function(i,r){var s=e.call(this,i,r,h(this).getComputedStyle(this,null).getPropertyValue(t));return s&&function(e){this.style.setProperty(t,s(e),n)}}))},Uo.text=function(t){return Ho(this,"text",t,Po)},Uo.remove=function(){var t=this.namespace;return this.each("end.transition",(function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)}))},Uo.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=s.ease.apply(s,arguments)),mt(this,(function(i){i[n][e].ease=t})))},Uo.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:mt(this,"function"==typeof t?function(i,r,s){i[n][e].delay=+t.call(i,i.__data__,r,s)}:(t=+t,function(i){i[n][e].delay=t}))},Uo.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:mt(this,"function"==typeof t?function(i,r,s){i[n][e].duration=Math.max(1,t.call(i,i.__data__,r,s))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},Uo.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var r=Io,a=To;try{To=n,mt(this,(function(e,r,s){Io=e[i][n],t.call(e,e.__data__,r,s)}))}finally{Io=r,To=a}}else mt(this,(function(r){var a=r[i][n];(a.event||(a.event=s.dispatch("start","end","interrupt"))).on(t,e)}));return this},Uo.transition=function(){for(var t,e,n,i=this.id,r=++Do,s=this.namespace,a=[],o=0,l=this.length;o<l;o++){a.push(t=[]);for(var c,h=0,u=(c=this[o]).length;h<u;h++)(e=c[h])&&Vo(e,h,s,r,{time:(n=e[s][i]).time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration}),t.push(e)}return Lo(a,s,r)},s.svg.axis=function(){var t,e=s.scale.linear(),n=Ro,i=6,r=6,a=3,l=[10],c=null;function h(o){o.each((function(){var o,h=s.select(this),u=this.__chart__||e,d=this.__chart__=e.copy(),p=null==c?d.ticks?d.ticks.apply(d,l):d.domain():c,f=null==t?d.tickFormat?d.tickFormat.apply(d,l):U:t,m=h.selectAll(".tick").data(p,d),g=m.enter().insert("g",".domain").attr("class","tick").style("opacity",jt),b=s.transition(m.exit()).style("opacity",jt).remove(),v=s.transition(m.order()).style("opacity",1),y=Math.max(i,0)+a,x=wa(d),w=h.selectAll(".domain").data([0]),E=(w.enter().append("path").attr("class","domain"),s.transition(w));g.append("line"),g.append("text");var A,N,O,k,_=g.select("line"),j=v.select("line"),M=m.select("text").text(f),C=g.select("text"),S=v.select("text"),L="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(o=qo,A="x",O="y",N="x2",k="y2",M.attr("dy",L<0?"0em":".71em").style("text-anchor","middle"),E.attr("d","M"+x[0]+","+L*r+"V0H"+x[1]+"V"+L*r)):(o=Fo,A="y",O="x",N="y2",k="x2",M.attr("dy",".32em").style("text-anchor",L<0?"end":"start"),E.attr("d","M"+L*r+","+x[0]+"H0V"+x[1]+"H"+L*r)),_.attr(k,L*i),C.attr(O,L*y),j.attr(N,0).attr(k,L*i),S.attr(A,0).attr(O,L*y),d.rangeBand){var T=d,I=T.rangeBand()/2;u=d=function(t){return T(t)+I}}else u.rangeBand?u=d:b.call(o,d,u);g.call(o,u,d),v.call(o,d,d)}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.orient=function(t){return arguments.length?(n=t in Bo?t+"":Ro,h):n},h.ticks=function(){return arguments.length?(l=o(arguments),h):l},h.tickValues=function(t){return arguments.length?(c=t,h):c},h.tickFormat=function(e){return arguments.length?(t=e,h):t},h.tickSize=function(t){var e=arguments.length;return e?(i=+t,r=+arguments[e-1],h):i},h.innerTickSize=function(t){return arguments.length?(i=+t,h):i},h.outerTickSize=function(t){return arguments.length?(r=+t,h):r},h.tickPadding=function(t){return arguments.length?(a=+t,h):a},h.tickSubdivide=function(){return arguments.length&&h},h};var Ro="bottom",Bo={top:1,right:1,bottom:1,left:1};function qo(t,e,n){t.attr("transform",(function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"}))}function Fo(t,e,n){t.attr("transform",(function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"}))}s.svg.brush=function(){var t,e,n=F(d,"brushstart","brush","brushend"),i=null,r=null,a=[0,0],o=[0,0],l=!0,c=!0,u=Wo[0];function d(t){t.each((function(){var t=s.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g),e=t.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var n=t.selectAll(".resize").data(u,U);n.exit().remove(),n.enter().append("g").attr("class",(function(t){return"resize "+t})).style("cursor",(function(t){return $o[t]})).append("rect").attr("x",(function(t){return/[ew]$/.test(t)?-3:null})).attr("y",(function(t){return/^[ns]/.test(t)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),n.style("display",d.empty()?"none":null);var a,o=s.transition(t),l=s.transition(e);i&&(a=wa(i),l.attr("x",a[0]).attr("width",a[1]-a[0]),f(o)),r&&(a=wa(r),l.attr("y",a[0]).attr("height",a[1]-a[0]),m(o)),p(o)}))}function p(t){t.selectAll(".resize").attr("transform",(function(t){return"translate("+a[+/e$/.test(t)]+","+o[+/^s/.test(t)]+")"}))}function f(t){t.select(".extent").attr("x",a[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function m(t){t.select(".extent").attr("y",o[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",o[1]-o[0])}function g(){var u,g,b=this,v=s.select(s.event.target),y=n.of(b,arguments),x=s.select(b),w=v.datum(),E=!/^(n|s)$/.test(w)&&i,A=!/^(e|w)$/.test(w)&&r,N=v.classed("extent"),O=Nt(b),k=s.mouse(b),_=s.select(h(b)).on("keydown.brush",(function(){32==s.event.keyCode&&(N||(u=null,k[0]-=a[1],k[1]-=o[1],N=2),B())})).on("keyup.brush",(function(){32==s.event.keyCode&&2==N&&(k[0]+=a[1],k[1]+=o[1],N=0,B())}));if(s.event.changedTouches?_.on("touchmove.brush",C).on("touchend.brush",L):_.on("mousemove.brush",C).on("mouseup.brush",L),x.interrupt().selectAll("*").interrupt(),N)k[0]=a[0]-k[0],k[1]=o[0]-k[1];else if(w){var j=+/w$/.test(w),M=+/^n/.test(w);g=[a[1-j]-k[0],o[1-M]-k[1]],k[0]=a[j],k[1]=o[M]}else s.event.altKey&&(u=k.slice());function C(){var t=s.mouse(b),e=!1;g&&(t[0]+=g[0],t[1]+=g[1]),N||(s.event.altKey?(u||(u=[(a[0]+a[1])/2,(o[0]+o[1])/2]),k[0]=a[+(t[0]<u[0])],k[1]=o[+(t[1]<u[1])]):u=null),E&&S(t,i,0)&&(f(x),e=!0),A&&S(t,r,1)&&(m(x),e=!0),e&&(p(x),y({type:"brush",mode:N?"move":"resize"}))}function S(n,i,r){var s,h,d=wa(i),p=d[0],f=d[1],m=k[r],g=r?o:a,b=g[1]-g[0];if(N&&(p-=m,f-=b+m),s=(r?c:l)?Math.max(p,Math.min(f,n[r])):n[r],N?h=(s+=m)+b:(u&&(m=Math.max(p,Math.min(f,2*u[r]-s))),m<s?(h=s,s=m):h=m),g[0]!=s||g[1]!=h)return r?e=null:t=null,g[0]=s,g[1]=h,!0}function L(){C(),x.style("pointer-events","all").selectAll(".resize").style("display",d.empty()?"none":null),s.select("body").style("cursor",null),_.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),O(),y({type:"brushend"})}x.style("pointer-events","none").selectAll(".resize").style("display",null),s.select("body").style("cursor",v.style("cursor")),y({type:"brushstart"}),C()}return d.event=function(i){i.each((function(){var i=n.of(this,arguments),r={x:a,y:o,i:t,j:e},l=this.__chart__||r;this.__chart__=r,To?s.select(this).transition().each("start.brush",(function(){t=l.i,e=l.j,a=l.x,o=l.y,i({type:"brushstart"})})).tween("brush:brush",(function(){var n=is(a,r.x),s=is(o,r.y);return t=e=null,function(t){a=r.x=n(t),o=r.y=s(t),i({type:"brush",mode:"resize"})}})).each("end.brush",(function(){t=r.i,e=r.j,i({type:"brush",mode:"resize"}),i({type:"brushend"})})):(i({type:"brushstart"}),i({type:"brush",mode:"resize"}),i({type:"brushend"}))}))},d.x=function(t){return arguments.length?(u=Wo[!(i=t)<<1|!r],d):i},d.y=function(t){return arguments.length?(u=Wo[!i<<1|!(r=t)],d):r},d.clamp=function(t){return arguments.length?(i&&r?(l=!!t[0],c=!!t[1]):i?l=!!t:r&&(c=!!t),d):i&&r?[l,c]:i?l:r?c:null},d.extent=function(n){var s,l,c,h,u;return arguments.length?(i&&(s=n[0],l=n[1],r&&(s=s[0],l=l[0]),t=[s,l],i.invert&&(s=i(s),l=i(l)),l<s&&(u=s,s=l,l=u),s==a[0]&&l==a[1]||(a=[s,l])),r&&(c=n[0],h=n[1],i&&(c=c[1],h=h[1]),e=[c,h],r.invert&&(c=r(c),h=r(h)),h<c&&(u=c,c=h,h=u),c==o[0]&&h==o[1]||(o=[c,h])),d):(i&&(t?(s=t[0],l=t[1]):(s=a[0],l=a[1],i.invert&&(s=i.invert(s),l=i.invert(l)),l<s&&(u=s,s=l,l=u))),r&&(e?(c=e[0],h=e[1]):(c=o[0],h=o[1],r.invert&&(c=r.invert(c),h=r.invert(h)),h<c&&(u=c,c=h,h=u))),i&&r?[[s,c],[l,h]]:i?[s,l]:r&&[c,h])},d.clear=function(){return d.empty()||(a=[0,0],o=[0,0],t=e=null),d},d.empty=function(){return!!i&&a[0]==a[1]||!!r&&o[0]==o[1]},s.rebind(d,n,"on")};var $o={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Wo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Yo=Pe.format=fn.timeFormat,Xo=Yo.utc,Go=Xo("%Y-%m-%dT%H:%M:%S.%LZ");function Jo(t){return t.toISOString()}function Zo(t,e,n){function i(e){return t(e)}function r(t,n){var i=(t[1]-t[0])/n,r=s.bisect(Ko,i);return r==Ko.length?[e.year,Ca(t.map((function(t){return t/31536e6})),n)[2]]:r?e[i/Ko[r-1]<Ko[r]/i?r-1:r]:[nl,Ca(t,n)[2]]}return i.invert=function(e){return Qo(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Qo)},i.nice=function(t,e){var n=i.domain(),s=xa(n),a=null==t?r(s,10):"number"==typeof t&&r(s,t);function o(n){return!isNaN(n)&&!t.range(n,Qo(+n+1),e).length}return a&&(t=a[0],e=a[1]),i.domain(Aa(n,e>1?{floor:function(e){for(;o(e=t.floor(e));)e=Qo(e-1);return e},ceil:function(e){for(;o(e=t.ceil(e));)e=Qo(+e+1);return e}}:t))},i.ticks=function(t,e){var n=xa(i.domain()),s=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return s&&(t=s[0],e=s[1]),t.range(n[0],Qo(+n[1]+1),e<1?1:e)},i.tickFormat=function(){return n},i.copy=function(){return Zo(t.copy(),e,n)},ja(i,t)}function Qo(t){return new Date(t)}Yo.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Jo:Go,Jo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Jo.toString=Go.toString,Pe.second=Be((function(t){return new ze(1e3*Math.floor(t/1e3))}),(function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))}),(function(t){return t.getSeconds()})),Pe.seconds=Pe.second.range,Pe.seconds.utc=Pe.second.utc.range,Pe.minute=Be((function(t){return new ze(6e4*Math.floor(t/6e4))}),(function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))}),(function(t){return t.getMinutes()})),Pe.minutes=Pe.minute.range,Pe.minutes.utc=Pe.minute.utc.range,Pe.hour=Be((function(t){var e=t.getTimezoneOffset()/60;return new ze(36e5*(Math.floor(t/36e5-e)+e))}),(function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))}),(function(t){return t.getHours()})),Pe.hours=Pe.hour.range,Pe.hours.utc=Pe.hour.utc.range,Pe.month=Be((function(t){return(t=Pe.day(t)).setDate(1),t}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t){return t.getMonth()})),Pe.months=Pe.month.range,Pe.months.utc=Pe.month.utc.range;var Ko=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],tl=[[Pe.second,1],[Pe.second,5],[Pe.second,15],[Pe.second,30],[Pe.minute,1],[Pe.minute,5],[Pe.minute,15],[Pe.minute,30],[Pe.hour,1],[Pe.hour,3],[Pe.hour,6],[Pe.hour,12],[Pe.day,1],[Pe.day,2],[Pe.week,1],[Pe.month,1],[Pe.month,3],[Pe.year,1]],el=Yo.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Kn]]),nl={range:function(t,e,n){return s.range(Math.ceil(t/n)*n,+e,n).map(Qo)},floor:U,ceil:U};tl.year=Pe.year,Pe.scale=function(){return Zo(s.scale.linear(),tl,el)};var il=tl.map((function(t){return[t[0].utc,t[1]]})),rl=Xo.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Kn]]);function sl(t){return JSON.parse(t.responseText)}function al(t){var e=l.createRange();return e.selectNode(l.body),e.createContextualFragment(t.responseText)}il.year=Pe.year.utc,Pe.scale.utc=function(){return Zo(s.scale.linear(),il,rl)},s.text=we((function(t){return t.responseText})),s.json=function(t,e){return Ee(t,"application/json",sl,e)},s.html=function(t,e){return Ee(t,"text/html",al,e)},s.xml=we((function(t){return t.responseXML})),this.d3=s,void 0===(r="function"==typeof(i=s)?i.call(e,n,e,t):i)||(t.exports=r)}()},5072:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},a=[],o=0;o<t.length;o++){var l=t[o],c=i.base?l[0]+i.base:l[0],h=s[c]||0,u="".concat(c," ").concat(h);s[c]=h+1;var d=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=r(p,i);i.byIndex=o,e.splice(o,0,{identifier:u,updater:f,references:1})}a.push(u)}return a}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var s=i(t=t||[],r=r||{});return function(t){t=t||[];for(var a=0;a<s.length;a++){var o=n(s[a]);e[o].references--}for(var l=i(t,r),c=0;c<s.length;c++){var h=n(s[c]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}s=l}}},7659:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},5056:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},1113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},6689:(t,e,n)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function h(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?x(t)?e:t:w(t)?e:t}function u(t){return g(t)&&0===t.length}function d(t){return t instanceof Date||"object"===i(t)&&"[object Date]"===Object.prototype.toString.call(t)}function p(t){return"string"==typeof t||t instanceof String}function f(t){return"function"==typeof t}function m(t){return!w(t)&&"object"===i(t)}function g(t){return!w(t)&&"function"==typeof t[Symbol.iterator]}function b(t){return g(t)&&!p(t)}function v(t){return null===t}function y(t){return!t||p(t)&&(0===t.length||/^\s*$/.test(t))}function x(t){return void 0===t}function w(t){return v(t)||x(t)}function E(t,e,n){if(!Array.isArray(t)||!Number.isInteger(e))throw new TypeError("Bad argument");return t.splice(e,0,n),t.length}function A(t){if(!Array.isArray(t))throw new TypeError("Bad argument");if(!u(t))return t[t.length-1]}function N(t){if(!Array.isArray(t))throw new TypeError("Bad argument");return t[0]}n.r(e),n.d(e,{Accordion:()=>_i,Collapsible:()=>ki,DELETE:()=>C,GET:()=>_,POST:()=>j,PUT:()=>M,Selector:()=>si,SelectorFactory:()=>ai,Switch:()=>mi,addAttributes:()=>Tt,addPath:()=>st,all:()=>K,appendChildren:()=>jt,assert:()=>Z,boolToInt:()=>G,camelCase:()=>W,capitalize:()=>B,capitalizeFirstLetter:()=>q,changeSelectValue:()=>It,cloneObject:()=>R,cloneTemplate:()=>An,compareTime:()=>L,copytoClipboard:()=>Sn,createAbbreviation:()=>De,createAnchor:()=>me,createArea:()=>ge,createArticle:()=>$t,createAside:()=>Xt,createAudio:()=>ye,createB:()=>He,createBase:()=>be,createBlockQuotation:()=>oe,createButton:()=>sn,createCaption:()=>on,createCite:()=>Re,createCode:()=>qe,createDataList:()=>tn,createDeletedPart:()=>Te,createDescriptionDetails:()=>fe,createDescriptionList:()=>de,createDescriptionTerm:()=>pe,createDiv:()=>ee,createDocFragment:()=>Pt,createEmbed:()=>ie,createEmphasis:()=>je,createFieldset:()=>Qe,createFigure:()=>Ne,createFigureCaption:()=>Oe,createFooter:()=>qt,createForm:()=>Fe,createH1:()=>Gt,createH2:()=>Jt,createH3:()=>Zt,createH4:()=>Qt,createH5:()=>Kt,createH6:()=>te,createHeader:()=>Bt,createI:()=>Pe,createImage:()=>ve,createInput:()=>$e,createInsertedPart:()=>Ie,createLabel:()=>Ye,createLegend:()=>Ke,createLineBreak:()=>re,createLink:()=>Vt,createListItem:()=>ue,createMain:()=>Ft,createMark:()=>Me,createMeter:()=>en,createNav:()=>Yt,createObject:()=>ne,createOption:()=>Ge,createOptionGroup:()=>Ze,createOrderedList:()=>he,createOutput:()=>rn,createParagraph:()=>ae,createPicture:()=>Ae,createProgress:()=>nn,createQuote:()=>Ue,createS:()=>ze,createSample:()=>Ce,createSection:()=>Wt,createSelect:()=>Xe,createSource:()=>we,createSpan:()=>ke,createStrong:()=>_e,createSubscript:()=>Se,createSuperscript:()=>Le,createTable:()=>an,createTableBody:()=>hn,createTableCell:()=>gn,createTableColumn:()=>dn,createTableColumnGroup:()=>pn,createTableFooter:()=>un,createTableHeader:()=>cn,createTableHeaderCell:()=>mn,createTableRow:()=>fn,createTemplate:()=>Rt,createTextArea:()=>We,createTextNode:()=>zt,createThematicBreak:()=>se,createTime:()=>Be,createTrack:()=>Ee,createU:()=>Ve,createUnorderedList:()=>ce,createVideo:()=>xe,fetchWithTimeout:()=>S,findAncestor:()=>_n,findByPath:()=>ct,first:()=>N,floatingLabel:()=>Dn,formatCase:()=>$,formatDate:()=>I,getDir:()=>at,getDirTarget:()=>ot,getElement:()=>xn,getElements:()=>wn,getNextElementSibling:()=>kn,getPreviousElementSibling:()=>On,getRootUrl:()=>Mi,getTemplate:()=>En,getUrlParams:()=>Ci,hasOwn:()=>z,htmlToElement:()=>wt,htmlToElements:()=>Et,inputCounter:()=>Hn,insert:()=>E,insertAfterElement:()=>kt,insertBeforeElement:()=>Ot,isCollection:()=>b,isDate:()=>d,isDerivedOf:()=>V,isDocumentFragment:()=>yt,isElement:()=>mt,isEmpty:()=>u,isFunction:()=>f,isHTMLCollection:()=>vt,isHTMLElement:()=>gt,isInElement:()=>Nt,isInViewport:()=>At,isIterable:()=>g,isNode:()=>pt,isNodeList:()=>ft,isNull:()=>v,isNullOrUndefined:()=>w,isNullOrWhitespace:()=>y,isObject:()=>m,isString:()=>p,isUndefined:()=>x,last:()=>A,lone:()=>nt,no:()=>et,one:()=>tt,pascalCase:()=>Y,preprendChild:()=>_t,queryBuilder:()=>Si,random:()=>rt,removeAccents:()=>X,removeChildren:()=>Cn,resolveDate:()=>T,shortDate:()=>U,shortDateTime:()=>D,some:()=>Q,toBoolean:()=>J,valOrDefault:()=>h,windowHeight:()=>ut,windowWidth:()=>ht});var O={OK:200,Created:201,Accepted:202,NoContent:204,BadRequest:400,Unauthorized:401,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,UnsupportedMediaType:415,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavaible:503,GatewayTimeout:504},k=function(t,e,n,i,r,s){var a=new XMLHttpRequest;return a.onreadystatechange=function(){var t;if(4===a.readyState){var e=function(t,e){return{status:t,message:e}}(a.status,a.responseText);n(a.status)?t=i:(t=r,a.status>=200&&a.status<300&&f(s)&&(t=s)),f(t)&&t(e)}},a.open(t,e,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a};function _(t,e,n,i){var r=(i=h(i,{})).successPred,s=f(r)?r:function(t){return t===O.OK};k("GET",t,s,e,n,i.pass).send()}function j(t,e,n,i,r){var s=(r=h(r,{})).successPred,a=f(s)?s:function(t){return[O.OK,O.Created].includes(t)};k("POST",t,a,n,i,r.pass).send(e)}function M(t,e,n,i,r){var s=(r=h(r,{})).successPred,a=f(s)?s:function(t){return[O.OK,O.NoContent].includes(t)};k("PUT",t,a,n,i,r.pass).send(e)}function C(t,e,n,i,r){var s=(r=h(r,{})).successPred,a=f(s)?s:function(t){return[O.OK,O.Accepted,O.NoContent].includes(t)};k("DELETE",t,a,n,i,r.pass).send(e)}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,i=new AbortController,r=a(a({},e),{},{signal:i.signal});return setTimeout((function(){i.abort()}),n),fetch(t,r).then((function(t){if(!t.ok)throw new Error("".concat(t.status,": ").concat(t.statusText));return t})).catch((function(t){if("AbortError"===t.name)throw new Error("Response timed out");throw new Error(t.message)}))}function L(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:":";if(w(t)||w(e)||!t.includes(n)||!e.includes(n))return null;var i=t.split(n),r=e.split(n);if(+i[0]>+r[0])return 1;if(+i[0]<+r[0])return-1;if(+i[1]>+r[1])return 1;if(+i[1]<+r[1])return-1;if(i.length==r.length&&3==i.length){if(+i[2]>+r[2])return 1;if(+i[2]<+r[2])return-1}return 0}function T(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(w(t))return new Date;if(d(t))return t;var n=new Date(t),i=n.getTime();return Number.isNaN(i)?new Date:e?new Date(i+6e4*n.getTimezoneOffset()):n}function I(t,e){var n=t.getDate(),i=t.getMonth()+1,r=t.getFullYear().toString(),s=t.getHours(),a=t.getMinutes(),o=t.getSeconds(),l=function(t){return t<10?"0".concat(t):t};return e.replace("yyyy",r).replace("yy",r.slice(-2)).replace("mm",l(i)).replace("m",i).replace("dd",l(n)).replace("d",n).replace("hh",l(s)).replace("h",s).replace("MM",l(a)).replace("M",a).replace("ss",l(o)).replace("s",o)}function U(t){return I(T(t),"yyyy-mm-dd")}function D(t){return I(T(t,!1),"yyyy-mm-dd hh:MM")}var H=Object.prototype.hasOwnProperty,P=Object.prototype.isPrototypeOf,z=function(t,e){return H.call(t,e)},V=function(t,e){return Object.getPrototypeOf(t)!==e&&P.call(e,t)};function R(t){if(w(t)||!m(t))return t;var e=t.constructor();for(var n in t)z(t,n)&&(t.isActiveClone=null,e[n]=R(t[n]),delete t.isActiveClone);return e}function B(t){return y(t)?t:t.toLowerCase().replace(/\b\w/g,(function(t){return t.toUpperCase()}))}function q(t){return y(t)?t:t.charAt(0).toUpperCase()+t.slice(1)}var F={camel:function(t){return W(t)},pascal:function(t){return Y(t)},upper:function(t){return t.toUpperCase()},lower:function(t){return t.toLowerCase()}};function $(t,e){return y(t)?t:z(F,e)?F[e](t):t}function W(t){if(y(t))return t;var e=Y(t);return e.charAt(0).toLowerCase()+e.slice(1)}function Y(t){return y(t)?t:B(t.replace(/[_-]+/g," ").replace(/\s+/g," ").trim()).replace(/\s+/g,"")}function X(t){return String.prototype.normalize?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):t.replace(/[àâäæ]/gi,"a").replace(/[ç]/gi,"c").replace(/[éèê]/gi,"e").replace(/[îï]/gi,"i").replace(/[ôœ]/gi,"o").replace(/[ùûü]/gi,"u")}function G(t){return t?1:0}function J(t){var e=h(t,!1);return p(e)&&"true"===e.toLowerCase()||Number.isInteger(e)&&1===e||!0===e}var Z=function(t,e,n,i){if(!Array.isArray(t)||!f(e))throw new TypeError("Bad argument");var r=it(t,e);if(K([n,i],Number.isInteger)){if(i<n)throw new Error("Bad argument: max must be greater than min");return r>=n&&r<=i}return Number.isInteger(n)?r>=n:Number.isInteger(i)?r<=i:r>0},Q=function(t,e){if(!Array.isArray(t)||!f(e))throw new TypeError("Bad argument");for(var n=0;n<t.length;n++){var i=t[n];if(e.apply(void 0,o(Array.isArray(i)?i:[i])))return!0}return!1},K=function(t,e){if(!Array.isArray(t)||!f(e))throw new TypeError("Bad argument");for(var n=0;n<t.length;n++){var i=t[n];if(!e.apply(void 0,o(Array.isArray(i)?i:[i])))return!1}return!0},tt=function(t,e){if(!Array.isArray(t)||!f(e))throw new TypeError("Bad argument");return 1===it(t,e)},et=function(t,e){if(!Array.isArray(t)||!f(e))throw new TypeError("Bad argument");return 0===it(t,e)},nt=function(t,e){if(!Array.isArray(t)||!f(e))throw new TypeError("Bad argument");return it(t,e)<=1};function it(t,e){for(var n=0,i=0;i<t.length;i++){var r=t[i];e.apply(void 0,o(Array.isArray(r)?r:[r]))&&n++}return n}function rt(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Number.isInteger(t))throw new TypeError("Bad argument");if(Number.isInteger(e)||(e=t,t=0),e<t)throw new Error("Bad argument: max must be greater than min");return t+Math.floor((n?window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295:Math.random())*(e-t+1))}function st(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";return y(t)?e:"".concat(t).concat(n).concat(e)}function at(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return t.substring(0,t.lastIndexOf(e))}function ot(t,e){return t.substring(0,t.lastIndexOf(e)-1)}function lt(t,e,n){var i=+e[0].match(/\d+/g);return t[n][i]}function ct(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",i=/\[\d+\]/g,r=R(t),s=function(t,e,n){var i=t.match(e),s=t.substring(0,t.indexOf("["));return n(r,i,s)},a=e.split(n),o=0,l=a.length;o<l;o++){var c=a[o];if(w(r=i.test(c)?s(c,i,lt):r[c]))return}return r}var ht=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},ut=function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},dt=function(t){return!w(t)&&t.nodeType===Node.ELEMENT_NODE},pt=function(t){return t instanceof Node},ft=function(t){return t instanceof NodeList},mt=function(t){return dt(t)&&t instanceof Element},gt=function(t,e){return!!(dt(t)&&t instanceof HTMLElement)&&(!g(e)||(n=t,i=Array.isArray(e)?e:[e],r=function(t){return n instanceof t},s=function(t){return n.tagName===t.toUpperCase()},a=function(t){return Array.isArray(t)?t.includes(n.type):n.type===t},i.some((function(t){if(!g(t))return!1;var e=t,n=null;if(Array.isArray(t)){var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(i=(a=o.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{i||null==o.return||o.return()}finally{if(r)throw s}}return n}}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2);e=i[0],n=i[1]}e=e.toLowerCase();var o="HTML".concat(z(bt,e)?bt[e]:Y(e),"Element");return!(!r(window[o])&&!s(e))&&(!(b(n)&&!u(n))||a(n))}))));var n,i,r,s,a},bt={a:"Anchor",br:"BR",dl:"DList",datalist:"DataList",fieldset:"FieldSet",frameset:"FrameSet",hr:"HR",h1:"Heading",h2:"Heading",h3:"Heading",h4:"Heading",h5:"Heading",h6:"Heading",li:"LI",ol:"OList",optgroup:"OptGroup",p:"Paragraph",q:"Quote",blockquote:"Quote",caption:"TableCaption",td:"TableCell",th:"TableCell",col:"TableCol",tr:"TableRow",tbody:"TableSection",thead:"TableSection",tfoot:"TableSection",textarea:"TextArea",ul:"UList"},vt=function(t){return t instanceof HTMLCollection},yt=function(t){return function(t){return!w(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE}(t)&&t instanceof DocumentFragment};function xt(t,e){if(!p(e))return null;var n=document.createElement("template");return n.innerHTML=e.trim(),n.content[t]}var wt=xt.bind(null,"firstChild"),Et=xt.bind(null,"childNodes");function At(t){if(!gt(t))throw new Error("The given element is not a valid HTML Element");var e=t.getBoundingClientRect(),n=e.top,i=e.right,r=e.bottom,s=e.left;return n>=0&&s>=0&&r<=ut()&&i<=ht()}function Nt(t,e){if(!K([t,e],gt))throw new Error("The given element is not a valid HTML Element");var n=t.getBoundingClientRect(),i=n.top,r=n.right,s=n.bottom,a=n.left,o=e.getBoundingClientRect(),l=o.top,c=o.right,h=o.bottom,u=o.left;return K([[l,i],[u,a],[r,c],[s,h]],(function(t,e){return t<=e}))}function Ot(t,e){if(!K([t,e],mt))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");return t.insertAdjacentElement("beforebegin",e),t}function kt(t,e){if(!K([t,e],mt))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");return t.insertAdjacentElement("afterend",e),t}function _t(t,e){if(!K([t,e],mt))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");return t.insertAdjacentElement("afterbegin",e),t}function jt(t,e){if(!pt(t))throw new TypeError("Bad argument: The given `parent` is not a valid Node");if(!vt(e)&&!b(e))throw new TypeError("Bad argument: The given `children` is not a valid HTMLCollection/HTMLElement array");var n=yt(t)?t:document.createDocumentFragment();return Array.from(e).forEach((function(t){var e;w(t)||n.appendChild(pt(t)?t:(e=t.toString(),document.createTextNode(e.toString())))})),t!==n&&t.appendChild(n),t}function Mt(t,e,n){t[e]=n}function Ct(t,e,n){t.setAttribute(e,n)}var St="accesskey,autocapitalize,class,dataset,editable,draggable,hidden,id,inputmode,lang,html,style,tabindex,text,title",Lt={accesskey:[Mt,"accessKey"],autocapitalize:[Mt,"autocapitalize"],class:[function(t,e){var n;if(!gt(t))throw new Error("Bad argument: The passed `element` argument is not a valid HTML Element");return(n=t.classList).add.apply(n,o(Array.isArray(e)?e:[e])),t}],dataset:[function(t,e,n){Object.assign(t[e],n)},"dataset"],draggable:[Mt,"draggable"],editable:[Mt,"contentEditable"],hidden:[Mt,"hidden"],id:[Mt,"id"],inputmode:[Mt,"inputMode"],lang:[Mt,"lang"],html:[Mt,"innerHTML"],style:[Mt,"style"],tabindex:[Mt,"tabIndex"],text:[Mt,"textContent"],title:[Mt,"title"],data:[Mt,"data"],cite:[Mt,"cite"],download:[Mt,"download"],ping:[Mt,"ping"],target:[Mt,"target"],coords:[Mt,"coords"],shape:[Mt,"shape"],autoplay:[Mt,"autoplay"],buffered:[Mt,"buffered"],controls:[Mt,"controls"],loop:[Mt,"loop"],muted:[Mt,"muted"],playsinline:[Ct,"playsinline"],poster:[Mt,"poster"],preload:[Mt,"preload"],crossorigin:[Mt,"crossOrigin"],decoding:[Mt,"decoding"],height:[Mt,"height"],ismap:[Mt,"isMap"],loading:[Mt,"loading"],srcset:[Mt,"srcset"],width:[Mt,"width"],alt:[Mt,"alt"],as:[Mt,"as"],media:[Mt,"media"],rel:[Mt,"rel"],src:[Mt,"src"],sizes:[Mt,"sizes"],reversed:[Mt,"reversed"],start:[Mt,"start"],accept:[Mt,"accept"],"accept-charset":[Mt,"acceptCharset"],action:[Mt,"action"],autocomplete:[Mt,"autocomplete"],autofocus:[Mt,"autofocus"],capture:[Mt,"capture"],checked:[Mt,"checked"],cols:[Mt,"cols"],disabled:[Mt,"disabled"],dirname:[Mt,"dirName"],enctype:[Mt,"enctype"],for:[Mt,"for"],form:[Mt,"form"],formaction:[Mt,"formAction"],formenctype:[Mt,"formEnctype"],formmethod:[Mt,"formMethod"],formnovalidate:[Mt,"formNoValidate"],formtarget:[Mt,"formTarget"],high:[Mt,"high"],label:[Mt,"label"],list:[Mt,"list"],low:[Mt,"low"],max:[Mt,"max"],maxlength:[Mt,"maxLength"],method:[Mt,"method"],min:[Mt,"min"],minlength:[Mt,"minLength"],multiple:[Mt,"multiple"],name:[Mt,"name"],novalidate:[Mt,"noValidate"],optimum:[Mt,"optimum"],pattern:[Mt,"pattern"],placeholder:[Mt,"placeholder"],readonly:[Mt,"readOnly"],required:[Mt,"required"],rows:[Mt,"rows"],selected:[Mt,"selected"],size:[Mt,"size"],spellcheck:[Ct,"spellcheck"],step:[Mt,"step"],wrap:[Mt,"wrap"],default:[Mt,"default"],kind:[Mt,"kind"],srclang:[Mt,"srclang"],abbr:[Mt,"abbr"],colspan:[Mt,"colSpan"],span:[Mt,"span"],rowspan:[Mt,"rowSpan"],scope:[Mt,"scope"],href:[Mt,"href"],hreflang:[Mt,"hreflang"],datetime:[Mt,"dateTime"],type:[Mt,"type"],value:[Mt,"value"],usemap:[Mt,"useMap"]};function Tt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!gt(t))throw new Error("Bad argument: The given element argument is not a valid HTML Element");if(!m(e))return t;for(var i=function(t){return St.includes(t)||n.includes(t)},r=0,s=Object.keys(e);r<s.length;r++){var a=s[r];if(i(a)){var l=e[a],c=Lt[a].slice(0);c.shift().apply(void 0,[t].concat(o(c),[l]))}}return t}function It(t,e){if(!gt(t,"select"))throw new Error("Bad argument: The given select argument is not a valid HTML Select element");if(w(e))throw new Error("The given value parameter is a null or undefined");for(var n=t.options,i=0;i<n.length;i++){var r=n[i];if(r.value===e.toString())return r.selected=!0,!0}return!1}function Ut(t,e,n){var i=document.createElement(t);return gt(i)?(m(n)&&Tt(i,n,h(e,"")),i):null}function Dt(t,e,n,i){var r=Ut(t,e,n);return gt(r)?(w(i)||bn(r,i),r):null}function Ht(t,e,n,i,r){var s=Ut(t,e,i);return gt(s)?(w(r)||bn(s,r,n),s):null}function Pt(t){var e=document.createDocumentFragment();return w(t)||bn(e,t),e}var zt=function(t){return document.createTextNode(t)},Vt=Ut.bind(null,"link","as,crossorigin,disabled,href,hreflang,media,rel,sizes,type"),Rt=Dt.bind(null,"template",""),Bt=Dt.bind(null,"header",""),qt=Dt.bind(null,"footer",""),Ft=Dt.bind(null,"main",""),$t=Dt.bind(null,"article",""),Wt=Dt.bind(null,"section",""),Yt=Dt.bind(null,"nav",""),Xt=Dt.bind(null,"aside",""),Gt=Dt.bind(null,"h1",""),Jt=Dt.bind(null,"h2",""),Zt=Dt.bind(null,"h3",""),Qt=Dt.bind(null,"h4",""),Kt=Dt.bind(null,"h5",""),te=Dt.bind(null,"h6",""),ee=Dt.bind(null,"div",""),ne=Dt.bind(null,"object","data,height,name,type,usemap,width"),ie=Ut.bind(null,"embed","height,src,type,width"),re=Ut.bind(null,"br",""),se=Ut.bind(null,"hr",""),ae=Dt.bind(null,"p",""),oe=Dt.bind(null,"blockquote","cite"),le=function(t){return gt(t,"li")?t:ue(null,t)},ce=Ht.bind(null,"ul","",le),he=Ht.bind(null,"ol","reversed,start,type",le),ue=Dt.bind(null,"li","value"),de=Dt.bind(null,"dl",""),pe=Dt.bind(null,"dt",""),fe=Dt.bind(null,"dd",""),me=Dt.bind(null,"a","download,href,hreflang,ping,rel,target,type"),ge=Ut.bind(null,"area","alt,coords,download,href,hreflang,media,ping,rel,shape,target"),be=Ut.bind(null,"base","href,target"),ve=Ut.bind(null,"img","alt,crossorigin,decoding,height,ismap,loading,sizes,src,srcset,usemap,width"),ye=Dt.bind(null,"audio","autoplay,controls,crossorigin,loop,muted,preload,src"),xe=Dt.bind(null,"video","autoplay,controls,crossorigin,height,loop,muted,playsinline,poster,preload,src,width"),we=Ut.bind(null,"source","media,sizes,src,srcset,type"),Ee=Ut.bind(null,"track","default,kind,label,src,srclang"),Ae=Dt.bind(null,"picture",""),Ne=Dt.bind(null,"figure",""),Oe=Dt.bind(null,"figcaption",""),ke=Dt.bind(null,"span",""),_e=Dt.bind(null,"strong",""),je=Dt.bind(null,"em",""),Me=Dt.bind(null,"mark",""),Ce=Dt.bind(null,"samp",""),Se=Dt.bind(null,"sub",""),Le=Dt.bind(null,"sup",""),Te=Dt.bind(null,"del","cite,datetime"),Ie=Dt.bind(null,"ins","cite,datetime"),Ue=Dt.bind(null,"q","cite"),De=Dt.bind(null,"abbr",""),He=Dt.bind(null,"b",""),Pe=Dt.bind(null,"i",""),ze=Dt.bind(null,"s",""),Ve=Dt.bind(null,"u",""),Re=Dt.bind(null,"cite",""),Be=Dt.bind(null,"time","datetime"),qe=Dt.bind(null,"code",""),Fe=Dt.bind(null,"form","accept-charset,action,autocomplete,enctype,method,name,novalidate,rel,target"),$e=Ut.bind(null,"input","accept,alt,autocomplete,autofocus,capture,checked,dirname,disabled,height,max,maxlength,minlength,min,multiple,name,pattern,placeholder,readonly,required,size,src,step,type,value,width"),We=Dt.bind(null,"textarea","autocomplete,autofocus,cols,disabled,maxlength,minlength,name,placeholder,readonly,required,rows,spellcheck,value,wrap"),Ye=Dt.bind(null,"label","for"),Xe=Ht.bind(null,"select","autocomplete,autofocus,disabled,multiple,name,required,size",(function(t){return gt(t,["option","optgroup"])?t:Array.isArray(t)?Ze(null,t):Ge(null,t)})),Ge=Dt.bind(null,"option","disabled,label,selected,value"),Je=function(t){return gt(t,"option")?t:Ge(null,t)},Ze=Ht.bind(null,"optgroup","disabled,label",Je),Qe=Dt.bind(null,"fieldset","disabled,name"),Ke=Dt.bind(null,"legend",""),tn=Ht.bind(null,"datalist","",Je),en=Dt.bind(null,"meter","high,low,max,min,optimum,value"),nn=Dt.bind(null,"progress","max,value"),rn=Dt.bind(null,"output","name,value"),sn=Dt.bind(null,"button","autofocus,disabled,formaction,formenctype,formmethod,formnovalidate,formtarget,name,type,value"),an=Dt.bind(null,"table",""),on=Dt.bind(null,"caption",""),ln=function(t){return gt(t,"tr")?t:fn(null,t)},cn=Ht.bind(null,"thead","",ln),hn=Ht.bind(null,"tbody","",ln),un=Ht.bind(null,"tfoot","",ln),dn=Ut.bind(null,"col","span"),pn=Ht.bind(null,"colgroup","span",(function(t){return gt(t,"col")?t:null})),fn=Ht.bind(null,"tr","",(function(t){return gt(t,["th","td"])?t:gn(null,t)})),mn=Dt.bind(null,"th","abbr,colspan,rowspan,scope"),gn=Dt.bind(null,"td","colspan,rowspan");function bn(t,e,n){var i=Array.isArray(e)?e:[e];return f(n)&&(i=i.map((function(t){return n(t)}))),jt(t,i),t}var vn=function(t){return/^\.[a-zA-Z0-9_-]+$/.test(t)},yn=function(t){return/^#[a-zA-Z0-9_-]+$/.test(t)};function xn(t,e){var n=h(e,document);return y(t)?null:yt(n)?n.querySelector(t):yn(t)?document.getElementById(t.substring(1)):vn(t)?n.getElementsByClassName(t.substring(1))[0]:n.querySelector(t)}function wn(t,e){var n=h(e,document);return y(t)?null:yt(n)?n.querySelectorAll(t):vn(t)?n.getElementsByClassName(t.substring(1)):n.querySelectorAll(t)}function En(t,e){return"content"in document.createElement("template")?xn(t,e):null}function An(t,e){return t?document.importNode(t.content,h(e,!0)):t}function Nn(t,e,n){if(!gt(e))return null;var i=e[t];if(f(n))for(;mt(i)&&!n(i);)i=i[t];return i}var On=Nn.bind(null,"previousElementSibling"),kn=Nn.bind(null,"nextElementSibling");function _n(t,e,n){if(!mt(t))throw new TypeError("Bad argument: The given target parameter is not a valid HTML Element");if(!f(e))throw new TypeError("Bad argument: The given pred parameter is not a valid Function");var i=t.parentElement;return n>0?Mn(i,e,n-1):jn(i,e)}function jn(t,e){return w(t)?null:e(t)?t:jn(t.parentElement,e)}function Mn(t,e,n){return w(t)||0===n?null:e(t)?t:Mn(t.parentElement,e,n-1)}function Cn(t,e){if(!pt(t))throw new TypeError("Bad argument: The given `node` is not a valid Node");return f(e)?(Array.from(t.childNodes).forEach((function(n){e(n)&&t.removeChild(n)})),t):function(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild);return t}(t)}function Sn(t){if(w(t))return!1;var e=We({value:gt(t)?t.textContent:t.toString(),readonly:!0});return!!gt(e)&&(document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove(),!0)}var Ln=function(t){return t.classList.add("down")},Tn=function(t){return t.classList.remove("down")},In=function(t){return t.classList.add("focused")},Un=function(t){return t.classList.remove("focused")};function Dn(t){for(var e=wn(".form-label",t),n=0;n<e.length;n++){var i=e[n];if("placeholder"==i.dataset.type&&!y(i.htmlFor)){var r=xn("#".concat(i.htmlFor));gt(r)?y(r.placeholder)?(s(r,i),u(r.value)&&Ln(i)):console.warn('%c@zenkai%c #FloatingLabel>%cfloatingLabel:%c Input "'.concat(i.htmlFor,'" contains a placeholder'),"text-decoration: underline","","font-weight: bold;","font-weight: normal;"):console.error('%c@zenkai%c #FloatingLabel>%cfloatingLabel:%c Missing input for label "'.concat(i.htmlFor,'"'),"text-decoration: underline","","font-weight: bold;","font-weight: normal;")}}function s(t,e){y(t.placeholder)&&(t.addEventListener("focus",(function(n){t.placeholder="",Tn(e),In(e.parentElement)})),t.addEventListener("blur",(function(t){u(this.value)&&Ln(e),Un(e.parentElement)})),t.addEventListener("input",(function(n){document.activeElement!=t&&(u(this.value)?Ln(e):Tn(e))})))}return e}function Hn(t){for(var e=wn("[data-counter]",t),n=0;n<e.length;n++){var i=e[n],r=i.dataset.counter,s=xn("#".concat(r));gt(s)?(i.dataset.counterMax=s.maxLength,i.dataset.counterVal=s.value.length,a(s,i)):console.error("%c@zenkai%c #InputCounter>%cinputCounter:%c Failed to add counter ".concat(r,". Input (referenced) was not found."),"text-decoration: underline","","font-weight: bold;","font-weight: normal;")}function a(t,e){t.addEventListener("input",(function(n){e.dataset.counterVal=t.value.length}))}return e}var Pn="state",zn=function(t){return t.dataset.type},Vn=function(t){return t.dataset[Pn]},Rn=function(t,e){return t.dataset[Pn]=e},Bn=function(t,e){return Rn(t,h(e,"checked"))},qn=function(t,e){return Rn(t,h(e,"unchecked"))};function Fn(t,e,n){if(gt(t))return e(t)?[t]:wn(n,t);if(p(t)&&!u(t)){var i=xn(t);return w(i)?null:Fn(i)}return w(t)?wn(n):null}function $n(t,e){return y(e.htmlFor)?xn("input[type='".concat(h(t,"text"),"']"),e):xn("#".concat(e.htmlFor))}var Wn="on",Yn={init:function(t){return Object.assign(this,t),this.isChecked()&&Bn(this.container,Wn),this},container:null,index:null,get value(){return this.container.dataset.value},isChecked:function(){return Vn(this.container)===Wn},setChecked:function(t){return!w(t)&&(t?Bn(this.container,Wn):qn(this.container,"off"),!0)}},Xn={name:"selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(t){return this.items.includes(t)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=t,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var t=this.container.dataset.value,e=null,n=0;n<this.items.length;n++){var i=this.items[n];i.isChecked()&&this.setSelectedItem(i),i.value===t&&(e=i)}return v(this.selectedItem)&&!v(e)&&this.setSelectedItem(e),this.bindEvents(),this},bindEvents:function(){var t=this;this.container.addEventListener("click",(function(e){var n=e.target;if(z(n.dataset,"selector")){var i=!1;if(f(t.beforeChange)&&(i=!1===t.beforeChange(t,e)),!i){var r=t.items.find((function(t){return t.index===+h(n.dataset.selectorIndex,-1)}));w(r)||(t.setSelectedItem(r),f(t.afterChange)&&t.afterChange(t,e))}}}))}},Gn={init:function(t){return Object.assign(this,t),this.isChecked()&&Bn(this.container,"on"),this},container:null,input:null,index:null,get value(){return this.input.value},isChecked:function(){return this.input.checked},setChecked:function(t){return!w(t)&&(t?(this.input.checked=!0,Bn(this.container,"on")):(this.input.checked=!1,qn(this.container,"off")),!0)}},Jn={name:"form-selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(t){return this.items.includes(t)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=t,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var t=this.container.dataset.value,e=null,n=0;n<this.items.length;n++){var i=this.items[n];i.isChecked()&&this.setSelectedItem(i),i.value===t&&(e=i)}return v(this.selectedItem)&&!v(e)&&this.setSelectedItem(e),this.bindEvents(),this},bindEvents:function(){var t=this;this.container.addEventListener("change",(function(e){var n=e.target,i=!1;if(f(t.beforeChange)&&(i=!1===t.beforeChange(t,e)),i)return n.checked=!1,void t.items[t.selectedIndex].setChecked(!0);var r=t.items.find((function(t){return t.index===+h(n.dataset.selectorIndex,-1)}));w(r)||(t.setSelectedItem(r),f(t.afterChange)&&t.afterChange(t,e))}))}},Zn="BAD_CONTAINER",Qn=function(t){return'[data-type="'.concat(t.name,'"]')},Kn={BaseSelector:Qn(Xn),FormSelector:Qn(Jn)},ti={create:function(t,e){if(!gt(t))return Zn;var n=wn("[data-selector]",t);if(!ft(n))return Zn;var i=null,r=null,s=zn(t);switch(s){case"selector":r=ei(n,s,!1),i=Object.create(Xn);break;case"form-selector":r=ei(n,s,!0),i=Object.create(Jn)}return Object.assign(i,e,{container:t,items:r,querySelector:Qn(i)}),i}};function ei(t,e,n){for(var i=[],r={selector:function(){return Object.create(Yn)},"form-selector":function(){return Object.create(Gn)}},s=0;s<t.length;s++){var a=t[s];a.dataset.selectorIndex=s;var o={container:a,index:s};if(n){var l=$n("radio",a);if(!gt(l))return"BAD_INPUT";l.dataset.selectorIndex=s,Object.assign(o,{input:l})}var c=r[e]().init(o);i.push(c)}return i}var ni={BAD_CONTAINER:new Error("Missing container: A selector requires a container"),BAD_INPUT:new Error("Missing input: FormSelector requires an input in the container")},ii=function(t){return RegExp("selector|form-selector").test(t.dataset.type)},ri=[Kn.BaseSelector,Kn.FormSelector].join(",");function si(t,e){var n=Fn(t,ii,ri),i=h(e,{});if(w(n))return null;for(var r=[],s=0;s<n.length;s++){var a=ti.create(n[s],i);if(z(ni,a))throw ni[a];a.init(),r.push(a)}return r}var ai=ti,oi={BAD_CONTAINER:new Error("Missing container: A switch requires a container"),BAD_INPUT:new Error("Missing input: FormSwitch requires an input in the container")},li="on",ci=function(t){return'[data-type="'.concat(t.name,'"]')},hi=function(t){return RegExp("switch|form-switch").test(t.dataset.type)},ui={create:function(t,e){if(!gt(t))return"BAD_CONTAINER";var n=null,i=null;switch(zn(t)){case"switch":n=Object.create(di);break;case"form-switch":if(i=$n("checkbox",t),!gt(i))return"BAD_INPUT";e.input=i,n=Object.create(pi)}return Object.assign(n,e,{container:t,querySelector:ci(n)}),n}},di={name:"switch",container:null,beforeChange:null,afterChange:null,get value(){return this.container.dataset.value},isChecked:function(){return Vn(this.container)===li},setChecked:function(t){return!w(t)&&(t?Bn(this.container,li):qn(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(t){return Object.assign(this,t),this.isChecked()&&Bn(this.container,li),this.bindEvents(),this},bindEvents:function(){var t=this;this.container.addEventListener("click",(function(e){var n=!1;f(t.beforeChange)&&(n=!1===t.beforeChange(t,e)),n||(t.toggle(),f(t.afterChange)&&t.afterChange(t,e))}))}},pi={name:"form-switch",container:null,input:null,beforeChange:null,afterChange:null,get value(){return this.input.value},isChecked:function(){return Vn(this.container)===li},setChecked:function(t){return!w(t)&&(this.input.checked=t,t?Bn(this.container,li):qn(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(t){return Object.assign(this,t),this.input.checked&&this.setChecked(!0),this.bindEvents(),this},bindEvents:function(){var t=this;this.input.addEventListener("change",(function(e){var n=!1;f(t.beforeChange)&&(n=!1===t.beforeChange(t,e)),n?t.input.checked=!t.input.checked:(t.toggle(),f(t.afterChange)&&t.afterChange(t,e))}))}},fi=[ci(di),ci(pi)].join(",");function mi(t,e){var n=Fn(t,hi,fi),i=h(e,{});if(w(n))return null;for(var r=[],s=0;s<n.length;s++){var a=ui.create(n[s],i);if(z(oi,a))throw oi[a];a.init(),r.push(a)}return r}function gi(t){t.style.display="block"}function bi(t){t.style.display="none"}var vi={BAD_CONTAINER_COLLAPSIBLE:"BAD_CONTAINER_COLLAPSIBLE",BAD_CONTAINER_ACCORDION:"BAD_CONTAINER_ACCORDION"},yi={BAD_CONTAINER_COLLAPSIBLE:new Error("Missing container: A collapsible requires a container"),BAD_CONTAINER_ACCORDION:new Error("Missing container: An accordion requires a container")},xi="expanded",wi="collapsed",Ei=function(t){return"collapsible"in t.dataset},Ai=function(t){return"accordion"===t.dataset.boost},Ni={create:function(t,e){if(!gt(t))return vi.BAD_CONTAINER_COLLAPSIBLE;var n=Object.create(this);return Object.assign(n,e,{container:t}),n},name:"collapsible",container:null,header:null,content:null,beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null,getState:function(){return this.container.dataset[this.name]},setState:function(t){this.container.dataset[this.name]=t},isCollapsed:function(){return this.getState()===wi},isExpanded:function(){return this.getState()===xi},isClosed:!1,isInitialized:!1,open:function(){if(this.isInitialized&&!this.isClosed)return this;var t=!1;return f(this.beforeOpen)&&(t=!1===this.beforeOpen(this)),t||(this.toggle(gi,xi,"add"),f(this.afterOpen)&&this.afterOpen(this),this.isClosed=!1),this},close:function(){if(this.isInitialized&&this.isClosed)return this;var t=!1;return f(this.beforeClose)&&(t=!1===this.beforeClose(this)),t||(this.toggle(bi,wi,"remove"),f(this.afterClose)&&this.afterClose(this),this.isClosed=!0),this},toggle:function(t,e,n){t(this.content),this.setState(e),this.container.classList[n]("expanded")},init:function(t){return Object.assign(this,t),this.header=xn("[data-".concat(this.name,"-header]"),this.container),this.content=xn("[data-".concat(this.name,"-content]"),this.container),this.isCollapsed()?this.close():this.isExpanded()&&(this.isClosed=!0,this.open()),this.bindEvents(),this.isInitialized=!0,this},bindEvents:function(){var t=this,e=this.container,n=this.header;n.addEventListener("click",(function(i){var r=_n(i.target,(function(e){return t.name in e.dataset}));e===r&&(t.isCollapsed()?t.open():n.parentNode===e&&t.close())}))}},Oi={create:function(t,e){if(!gt(t))return vi.BAD_CONTAINER_ACCORDION;var n=Object.create(this);return Object.assign(n,e,{container:t}),n},container:null,sections:null,selectedSection:null,beforeChange:null,afterChange:null,init:function(){var t=this;this.sections=[];for(var e=wn("[data-accordion]",this.container),n=0;n<e.length;n++){var i=e[n],r=Ni.create(i,{name:"accordion",index:n,afterOpen:function(e){f(t.beforeChange)&&t.beforeChange(e),t.sections.filter((function(t){return t.index!==e.index})).forEach((function(t){return t.close()})),f(t.afterChange)&&t.afterChange(e),t.selectedSection=e}});if(z(vi,r))return r;this.sections.push(r),r.init()}return this}};function ki(t,e){var n=Fn(t,Ei,"[data-collapsible]"),i=h(e,{});if(w(n))return null;for(var r=[],s=0;s<n.length;s++){var a=Ni.create(n[s],i);if(z(yi,a))throw yi[a];a.init(),r.push(a)}return r}function _i(t,e){var n=Fn(t,Ai,"[data-boost=accordion]"),i=h(e,{});if(w(n))return null;for(var r=[],s=0;s<n.length;s++){var a=Oi.create(n[s],i);if(z(yi,a))throw yi[a];a.init(),r.push(a)}return r}var ji=encodeURIComponent;function Mi(t){return t.toString().replace(/^(.*\/\/[^/?#]*).*$/,"$1")}function Ci(t,e){var n=decodeURIComponent(window.location.search);if(y(n))return null;var i={};if("URLSearchParams"in window){var r,s=new URLSearchParams(n.substring(1)),a=function(t){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=l(t))){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==e.return||e.return()}finally{if(a)throw r}}}}(s.entries());try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o[0]]=o[1]}}catch(t){a.e(t)}finally{a.f()}return t?s.get(t):i}return n.substring(1).split("&").forEach((function(t){var e=t.split("=",2);i[e[0]]=e[1]})),t?h(i[t],e):i}function Si(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return Object.keys(t).forEach((function(i){e&&y(t[i])||n.push("".concat(ji(i),"=").concat(ji(t[i])))})),n.join("&")}},7496:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AnchorHandler:()=>r});var i=n(6689);const r={models:null,init(){this.models=new Map},create(t,e){return(0,i.isNullOrUndefined)(this.models)&&this.init(),(0,i.isNullOrUndefined)(this.models.get(e.id))?this.createModel(e.id,e.rtag,t):this.register(e.id,e.rtag,t),this.models.get(e.id)},createModel(t,e,n){const i=n.projection.environment.getActiveReceiver(e);let r=[];for(let e=0;e<i.items.length;e++)if(i.items[e].render.contains(n.container))return r.push({id:n.id,pId:i.items[e].render.dataset.id,holder:i.items[e].render,elem:n}),void this.models.set(t,{items:r,index:0})},register(t,e,n){let i=this.models.get(t);const r=n.projection.environment.getActiveReceiver(e);for(let t=0;t<r.items.length;t++)if(r.items[t].render.contains(n.container)){i.items.push({id:n.id,pId:r.items[t].render.dataset.id,holder:r.items[t].render,elem:n});break}for(let t=0;t<i.index;t++)n.nextAnchor(!1)},nextAnchor(t,e){let n=this.models.get(t);for(let t=0;t<n.items.length;t++){let i=n.items[t];i.id!==e&&i.elem.nextAnchor(!1)}n.index++},findSource(t,e){const n=this.models.get(t).items,r={};let s,a;for(s=0;s<n.length;s++){const t=n[s].elem,o=t.items;if(!(0,i.isNullOrUndefined)(o))for(a=0;a<o.length;a++)if(o[a].render.contains(e)){r.x=Number(o[a].render.getAttribute("x"))+Number(n[s].holder.getAttribute("x"))+Number((t.container||t.element).getAttribute("x")),r.y=Number(o[a].render.getAttribute("y"))+Number(n[s].holder.getAttribute("y"))+Number((t.container||t.element).getAttribute("y")),r.calc={projItems:{x:Number(o[a].render.getAttribute("x")),y:Number(o[a].render.getAttribute("y"))},holder:n[s].holder,proj:t};break}if(!(0,i.isNullOrUndefined)(r.x))break}let o=n[s].elem.anchors.indexes;const l=Number(n[s].elem.items[a].render.getAttribute("x")),c=Number(n[s].elem.items[a].render.getAttribute("y"));for(let t=0;t<o.length;t++)if(o[t].x===l&&o[t].y===c)return r.index=t,r},unregister(t,e){let n=this.models.get(t).listeners;for(let t=0;t<n.length;t++)if(n[t]===e)return void n.splice(t,1)},createSubModel(t,e){let n=this.models.get(t);(0,i.isNullOrUndefined)(n.subModels)&&(n.subModels=[]),n.subModels.push({elem:e,size:1})},registerSubModel(t,e,n){let r,s=this.models.get(t);for(let t=0;t<s.subModels.length;t++)s.subModels[t].elem===e&&(r=s.subModels[t]);(0,i.isNullOrUndefined)(r.start)&&(r.start=this.estimateStart(s,r.elem));const a=s.items;let o;for(let t=0;t<a.length;t++){const e=a[t].elem,r=e.items;if(!(0,i.isNullOrUndefined)(e.items)){for(let t=0;t<r.length;t++)if(r[t].render.contains(n.container||n.element)){o={},o.j=t,o.index=r[t].index;break}if(!(0,i.isNullOrUndefined)(o)){o.i=t;break}}}if(o.index>r.start+r.size){const t=a[o.i].elem.moveElemToAnchor(r.start+r.size,o.j);a.forEach((e=>{e.elem.increaseAnchors(r.start+r.size,o.index,t,s.forbiden)}))}else if(o.index<r.start+r.size){const t=a[o.i].elem.moveElemToAnchor(r.start+r.size-1,o.j);a.forEach((e=>{e.elem.decreaseAnchors(o.index,r.start+r.size,t,s.forbiden)})),r.start--}r.elem.increaseSize(),r.size++,(0,i.isNullOrUndefined)(s.listeners)||s.listeners.forEach((t=>{t.updateValue()}))},estimateStart(t,e){const n=t.items;for(let t=0;t<n.length;t++){const i=n[t].elem.items;for(let t=0;t<i.length;t++)if(i[t].render.contains(e.container))return t}},findTarget(t,e,n){const i=this.models.get(t).items;for(let t=0;t<i.length;t++){const r=i[t].elem,s=i[t].holder,a=r.anchors.indexes;if(s.dataset.concept===e)return{x:a[n].x+Number(s.getAttribute("x"))+Number((r.container||r.element).getAttribute("x")),y:a[n].y+Number(s.getAttribute("y"))+Number((r.container||r.element).getAttribute("y")),calc:{projItems:a[n],holder:s,proj:r}}}},estimatePositionCondamn(t,e){const n=this.models.get(t),r=n.items;for(let t=0;t<r.length;t++){const s=r[t].elem,a=s.items;if(!(0,i.isNullOrUndefined)(a))for(let o=0;o<a.length;o++)if(a[o].render.contains(e.container))return(0,i.isNullOrUndefined)(this.condamn)&&(n.condamn=[],n.forbiden=[]),n.condamn.push({index:o,elem:e}),n.forbiden.push(o),n.subModels.forEach((t=>{t.elem.container===e.container&&(t.start=a[o].index)})),{x:Number(a[o].render.getAttribute("x"))+Number(r[t].holder.getAttribute("x"))+Number((s.container||s.element).getAttribute("x")),y:Number(a[o].render.getAttribute("y"))+Number(r[t].holder.getAttribute("y"))+Number((s.container||s.element).getAttribute("y")),anchors:s.anchors.next}}},estimatePosition(t){const{projItems:e,holder:n,proj:i}=t;return{x:e.x+Number(n.getAttribute("x"))+Number((i.container||i.element).getAttribute("x")),y:e.y+Number(n.getAttribute("y"))+Number((i.container||i.element).getAttribute("y"))}},registerListener(t,e){let n=this.models.get(t);(0,i.isNullOrUndefined)(n.listeners)&&(n.listeners=[]),n.listeners.push(e)},deleteItem(t,e,n){const r=this.models.get(t);if(r.items.forEach((t=>{t.id!==e&&t.elem.removeAnchor(n)})),!(0,i.isNullOrUndefined)(r.condamn)){for(let t=0;t<r.subModels.length;t++)r.subModels[t].start<n&&r.subModels[t].start+r.subModels[t].size>n&&(r.subModels[t].size--,r.subModels[t].elem.decreaseSize());for(let t=0;t<r.condamn.length;t++){if(r.condamn[t].index>n){r.condamn[t].index--,r.condamn[t].elem.decreaseAnchor();for(let t=0;t<r.subModels.length;t++)r.subModels[t].elem===r.elem&&r.subModels[t].start--}r.condamn[t].index===n&&(r.condamn.splice(t,1),t--)}for(let t=0;t<r.forbiden.length;t++)r.forbiden[t]===n&&(r.forbiden.splice(t,1),t--)}r.index--,(0,i.isNullOrUndefined)(r.listeners)||r.listeners.forEach((t=>{t.updateValue()}))}}},3296:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Simulation:()=>i});const i={notifyDimObservers(){isNullOrUndefined(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))}}},848:t=>{"use strict";t.exports=JSON.parse('{"type":"concept","concept":[{"name":"survey","nature":"concrete","root":true,"attributes":[{"name":"title","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Title"}]},"required":true,"description":""},{"name":"questions","target":{"name":"set","accept":{"name":"Question"},"constraint":{"cardinality":{"type":"range","range":{"min":{"value":1}}}}},"required":true},{"name":"groups","target":{"name":"set","accept":{"name":"Group"}},"required":true},{"name":"conditions","target":{"name":"set","accept":{"name":"Condition"}},"required":true}],"properties":[]},{"name":"Condition","nature":"concrete","attributes":[{"name":"show","target":{"name":"reference","accept":{"name":"Question"}},"required":true},{"name":"question","target":{"name":"reference","accept":{"name":"OptionQ"}},"required":false,"description":""},{"name":"value","target":{"name":"reference","accept":{"name":"OptionValue"}},"required":false,"description":""}],"properties":[]},{"name":"Group","nature":"concrete","attributes":[{"name":"name","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Name"}]},"required":true},{"name":"expression","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Condition expression"}]},"required":false},{"name":"order","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Order"}]},"required":true},{"name":"questions","target":{"name":"set","accept":{"name":"Question"},"constraint":{"cardinality":{"type":"range","range":{"min":{"value":1}}}}},"required":true}],"properties":[]},{"name":"Question","nature":"concrete","attributes":[{"name":"name","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Name"}]},"required":true},{"name":"label","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Label"}]},"required":true},{"name":"type","target":{"name":"QuestionType","properties":[{"name":"label","type":"string","value":"Type"}]},"required":true},{"name":"expression","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Condition expression"}]},"required":false},{"name":"order","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Order"}]},"required":true},{"name":"required","target":{"name":"boolean","default":true,"properties":[{"name":"label","type":"string","value":"Required"}]},"required":true},{"name":"linkTo","target":{"name":"reference","accept":{"name":"Question"},"properties":[{"name":"label","type":"string","value":"Link to"}]},"required":true}],"properties":[]},{"name":"QuestionType","nature":"prototype","attributes":[{"name":"values","target":{"name":"string"},"required":true}],"properties":[]},{"prototype":"QuestionType","name":"YesNoType","nature":"concrete","attributes":[{"name":"default","target":{"name":"boolean"}}],"properties":[{"name":"alias","type":"string","value":"boolean"}]},{"prototype":"QuestionType","name":"TextType","nature":"concrete","attributes":[{"name":"default","target":{"name":"string","default":"","properties":[{"name":"label","type":"string","value":"Default value"}]}},{"name":"minLength","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Min length"}]}},{"name":"maxLength","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Max length"}]}}],"properties":[{"name":"alias","type":"string","value":"string"}]},{"prototype":"QuestionType","name":"NumberType","nature":"concrete","attributes":[{"name":"default","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Default value"}]}},{"name":"min","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Minimum"}]}},{"name":"max","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Maximum"}]}}],"properties":[{"name":"alias","type":"string","value":"int"}]},{"prototype":"QuestionType","name":"DateType","nature":"concrete","attributes":[{"name":"default","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Default value"}]}},{"name":"format","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Format"}]}}],"properties":[{"name":"alias","type":"string","value":"date"}]},{"prototype":"QuestionType","name":"DecimalType","nature":"concrete","attributes":[{"name":"default","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Default value"}]}},{"name":"decimal","target":{"name":"number","default":2,"properties":[{"name":"label","type":"string","value":"Decimal place"}]}}],"properties":[{"name":"alias","type":"string","value":"decimal"}]},{"prototype":"QuestionType","name":"CurrencyType","nature":"concrete","attributes":[{"name":"default","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Default value"}]}},{"name":"symbol","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Currency symbol"}]}},{"name":"decimal","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Decimal"}]}}],"properties":[{"name":"alias","type":"string","value":"money"}]},{"name":"EnumType","nature":"concrete","attributes":[{"name":"default","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Default value"}]}},{"name":"options","target":{"name":"set","accept":{"name":"string"}}},{"name":"multiple","target":{"name":"boolean","properties":[{"name":"label","type":"string","value":"Multiple value"}]}}],"properties":[{"name":"alias","type":"string","value":"enum"}]},{"prototype":"QuestionType","name":"RangeType","nature":"concrete","attributes":[{"name":"default","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Default value"}]}},{"name":"min","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Minimum"}]}},{"name":"max","target":{"name":"number","properties":[{"name":"label","type":"string","value":"Maximum"}]}},{"name":"increment","target":{"name":"number","default":1,"properties":[{"name":"label","type":"string","value":"Increment"}]}}],"properties":[{"name":"alias","type":"string","value":"range"}]},{"name":"RefType","nature":"concrete","attributes":[{"name":"target","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Reference"}]}}],"properties":[{"name":"alias","type":"string","value":"ref"}]},{"name":"ComputedType","nature":"concrete","prototype":"QuestionType","attributes":[{"name":"formula","target":{"name":"string","properties":[{"name":"label","type":"string","value":"Formula"}]}}],"properties":[{"name":"alias","type":"string","value":"computed"}]},{"name":"name","nature":"derivative","base":"string","constraint":{"length":{"type":"range","range":{"min":{"value":1},"max":{"value":50}}}}}]}')},2422:t=>{"use strict";t.exports=JSON.parse('{"header":false,"toolbar":[{"type":"button","name":"button-build","action":"build-form","class":["btn","app-editor-header__button"],"content":"Build"},{"type":"button","name":"button-build","action":"export-form","class":["btn","app-editor-header__button"],"content":"Export"}]}')},8837:t=>{"use strict";t.exports=JSON.parse('{"type":"projection","projection":[{"concept":{"name":"survey"},"tags":["survey"],"container":{"content":[{"type":"attribute","name":"title","tag":"textbox-label"},{"type":"attribute","name":"questions","tag":"questions"},{"type":"attribute","name":"groups","tag":"groups","style":{"box":{"outer":{"top":{"value":12,"unit":"px"}}}}}],"style":{"css":["survey"]},"layout":{"type":"flex","orientation":"column","wrappable":false}}},{"concept":{"name":"Group"},"tags":["list-item"],"container":{"content":[{"type":"container","content":[{"type":"attribute","name":"name","tag":"text"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["question-preview"]}},{"type":"container","content":[{"type":"attribute","name":"name","tag":"textbox-label","style":{"css":["question-name"]}},{"type":"attribute","name":"order","tag":"numbox-label","style":{"css":["question-order"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["question-identification"]}},{"type":"attribute","name":"expression","tag":"textbox-label","style":{"css":["group-expression"]},"required":true},{"type":"attribute","name":"questions","tag":"questions"}],"style":{"css":["survey-header"]},"layout":{"type":"flex","orientation":"column"}}},{"concept":{"name":"Question"},"tags":["list-item"],"container":{"content":[{"type":"container","content":[{"type":"attribute","name":"name","tag":"text"},{"type":"static","static":{"type":"text","content":":"}},{"type":"attribute","name":"label","tag":"text"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["question-preview"]}},{"type":"container","content":[{"type":"attribute","name":"name","tag":"textbox-label","style":{"css":["question-name"]}},{"type":"attribute","name":"order","tag":"numbox-label","style":{"css":["question-order"]}},{"type":"attribute","name":"label","tag":"textbox-label","style":{"css":["question-label"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["question-identification"]}},{"type":"container","content":[{"type":"static","static":{"type":"text","content":"Type","style":{"css":["title"]}}},{"type":"attribute","name":"type"},{"type":"attribute","name":"expression","tag":"textbox-label","style":{"css":["question-expression"]}},{"type":"attribute","name":"required","tag":"switch-field","style":{"css":["question-required"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["question-config"]}}],"style":{"css":["survey-header"]},"layout":{"type":"flex","orientation":"column"}}},{"concept":{"name":"QuestionType"},"tags":[],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["selector-choice__option"]}},"style":{"css":["selector-choice__options"]}},"expanded":true,"input":false,"style":{"css":["selector-choice","selector-choice--category"]}}}],"style":{"css":["rl-category-header"]}}},{"type":"projection","bind":"value","placeholder":false,"required":true,"tag":"choice-selection"}],"style":{"css":["rl-category"]}}},{"concept":{"name":"YesNoType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Yes/No, True/False question","disposition":[{"type":"static","static":{"type":"text","content":"Yes/No","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"YesNoType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"default","tag":"switch-field"}],"style":{"css":["survey-header"]},"layout":{"type":"flex","orientation":"column"}}},{"concept":{"name":"TextType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Text (string)","disposition":[{"type":"static","static":{"type":"text","content":"Text","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"TextType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"default","tag":"textbox-label","style":{"css":["texttype-default"]}},{"type":"attribute","name":"minLength","tag":"numbox-label","style":{"css":["texttype-minlength"]}},{"type":"attribute","name":"maxLength","tag":"numbox-label","style":{"css":["texttype-maxlength"]}}],"style":{"css":["text-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"NumberType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Number","disposition":[{"type":"static","static":{"type":"text","content":"Number","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"NumberType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"default","tag":"numbox-label","style":{"css":["numtype-default"]}},{"type":"attribute","name":"min","tag":"numbox-label","style":{"css":["numtype-min"]}},{"type":"attribute","name":"max","tag":"numbox-label","style":{"css":["numtype-max"]}}],"style":{"css":["num-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"DateType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Date","disposition":[{"type":"static","static":{"type":"text","content":"Date","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"DateType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"default","tag":"textbox-label","style":{"css":["datetype-default"]}},{"type":"attribute","name":"format","tag":"textbox-label","style":{"css":["datetype-format"]}}],"style":{"css":["date-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"DecimalType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Decimal number","disposition":[{"type":"static","static":{"type":"text","content":"Decimal","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"DecimalType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"default","tag":"numbox-label"},{"type":"attribute","name":"decimal","tag":"numbox-label"}],"style":{"css":["decimal-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"CurrencyType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Currency/Money type","disposition":[{"type":"static","static":{"type":"text","content":"Currency","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"CurrencyType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"default","tag":"numbox-label"},{"type":"attribute","name":"symbol","tag":"textbox-label"},{"type":"attribute","name":"decimal","tag":"numbox-label"}],"style":{"css":["currency-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"EnumType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"List of predefined values","disposition":[{"type":"static","static":{"type":"text","content":"Enum","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"EnumType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"default","tag":"textbox-label"},{"type":"attribute","name":"options","tag":"tags"}],"style":{"css":["text-type"]},"layout":{"type":"flex","orientation":"column"}}},{"concept":{"name":"RangeType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Range (number)","disposition":[{"type":"static","static":{"type":"text","content":"Range","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"RangeType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"min","tag":"numbox-label"},{"type":"attribute","name":"max","tag":"numbox-label"},{"type":"attribute","name":"increment","tag":"numbox-label"}],"style":{"css":["text-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"RefType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Reference type","disposition":[{"type":"static","static":{"type":"text","content":"Reference","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"RefType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"target","tag":"textbox-label"}],"style":{"css":["text-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"ComputedType"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Computed value (formula based)","disposition":[{"type":"static","static":{"type":"text","content":"Computed","style":{"css":["category-choice-tooltip"]}}}],"style":{"css":["category-choice"]}}},{"concept":{"name":"ComputedType"},"tags":["choice-selection"],"container":{"content":[{"type":"attribute","name":"formula","tag":"textbox-label","style":{"css":["computed-formula"]}}],"style":{"css":["text-type"]},"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"set"},"type":"layout","tags":["groups"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Groups","style":{"css":["ql-question-set-header-title","ql-group-set-header-title"]}}},{"type":"field","field":{"type":"list","readonly":false,"disabled":false,"list":false,"action":{"add":{"help":"Add a group","content":[{"type":"static","static":{"type":"text","content":"+ New grouping","style":{"css":["ql-question-set-header__button-content","ql-group-set-header__button-content"]}}}],"style":{"css":["ql-question-set-header__button","ql-group-set-header__button"]}}},"style":{"css":["ql-question-set-header__list","ql-group-set-header__list"]}}}],"style":{"css":["ql-question-set-header","ql-group-set-header"]}}},{"type":"field","field":{"type":"list","list":{"item":{"template":{"tag":"","name":""},"style":{"css":["ql-question-set__list-item","ql-group-set__list-item"]}},"style":{"css":["ql-question-set__list","ql-group-set__list"]}},"action":{"add":false},"style":{"css":["ql-question-set","ql-group-set"]}}}],"style":{"css":["ql-group-set"]}}},{"concept":{"name":"set"},"type":"layout","tags":["questions"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Questions","style":{"css":["ql-question-set-header-title"]}}},{"type":"field","field":{"type":"list","readonly":false,"disabled":false,"list":false,"action":{"add":{"help":"Add a question","content":[{"type":"static","static":{"type":"text","content":"+ New question","style":{"css":["ql-question-set-header__button-content"]}}}],"style":{"css":["ql-question-set-header__button"]}}},"style":{"css":["ql-question-set-header__list"]}}}],"style":{"css":["ql-question-set-header"]}}},{"type":"field","field":{"type":"list","list":{"item":{"template":{"tag":"","name":""},"style":{"css":["ql-question-set__list-item"]}},"style":{"css":["ql-question-set__list"]}},"action":{"add":false},"style":{"css":["ql-question-set"]}}}],"style":{"css":["ql-question-set"]}}},{"concept":{"name":"boolean"},"tags":["switch-field"],"type":"field","content":{"type":"binary","checkbox":{"label":{"content":[{"type":"property","name":"refname"}],"style":{"css":["switch-field__label"]}},"style":{"css":["switch-field__checkbox"]}},"style":{"css":["switch-field"]}}},{"concept":{"name":"string"},"type":"field","tags":["tag"],"content":{"type":"text","resizable":true,"input":{"type":"text","placeholder":"tag","style":{"css":["pp-tagbox__input"]}},"style":{"css":["pp-tagbox"]}}},{"concept":{"name":"string"},"type":"field","tags":["textbox"],"content":{"type":"text","input":{"type":"text","placeholder":{"type":"property","name":"label"},"style":{"css":["simple-textbox__input"]}},"style":{"css":["simple-textbox"]}}},{"concept":{"name":"string"},"type":"field","tags":["textbox-label"],"content":{"type":"text","container":{"type":"flex","orientation":"row","content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"label"},"style":{"css":["labeled-textbox__label"]}}},{"type":"input","input":{"type":"text","placeholder":{"type":"property","name":"placeholder"},"style":{"css":["labeled-textbox__input"]}}}],"style":{"css":["labeled-textbox"]}}}},{"concept":{"name":"string"},"type":"field","tags":["textarea"],"content":{"type":"text","multiline":true,"input":{"type":"text","placeholder":"Enter a description","style":{"css":["simple-textarea__input"]}},"style":{"css":["simple-textarea"]}}},{"concept":{"name":"string"},"type":"field","tags":["textarea-label"],"field":{"type":"text","multiline":true,"container":{"content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"label"},"style":{"css":["labeled-textarea__label"]}}},{"type":"input","multiline":true,"input":{"type":"text","placeholder":"Enter a description","style":{"css":["labeled-textarea__input"]}}}],"layout":{"type":"flex","orientation":"row","wrappable":true}},"style":{"css":["labeled-textarea"]}}},{"concept":{"name":"number"},"type":"field","tags":["numbox-label"],"field":{"type":"text","container":{"content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"label"},"style":{"css":["labeled-numbox__label"]}}},{"type":"input","input":{"type":"number","style":{"css":["labeled-numbox__input"]}}}],"layout":{"type":"flex","orientation":"row","wrappable":true}},"style":{"css":["labeled-numbox"]}}},{"concept":{"name":"number"},"tags":["textual"],"type":"field","content":{"type":"text","resizable":false,"input":{"type":"number","style":{"css":["numbox__input"]}},"style":{"css":["numbox"]}}},{"concept":{"name":"number"},"tags":["label-number"],"type":"layout","content":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","groupfield-label"]}}},{"type":"field","field":{"type":"text","input":{"type":"number","style":{"css":["textbox__input"]}},"style":{"css":["textbox","groupfield__textbox"]}}}],"style":{"css":["groupfield"]}}},{"concept":{"name":"reference"},"type":"field","tags":["tag-reference"],"content":{"type":"choice","choice":{"option":{"template":{"tag":"refchoice"},"style":{"css":["tag-reference__choice-option"]}},"style":{"css":["tag-reference__choice"]}},"placeholder":"select tag","expanded":false,"input":{"placeholder":"Search..."},"style":{"css":["tag-reference"]}}},{"concept":{"name":"string"},"type":"static","tags":["text"],"content":{"type":"text","content":{"type":"property","name":"value"},"style":{"css":["ql-text"]}}},{"concept":{"name":"string"},"type":"static","tags":["email"],"content":{"type":"link","urlType":"email","url":{"type":"property","name":"value"},"content":[{"type":"property","name":"value"}],"style":{"css":["ql-email"]}}},{"concept":{"name":"string"},"type":"static","tags":["url"],"content":{"type":"link","urlType":"link","url":{"type":"property","name":"value"},"content":[{"type":"property","name":"value"}],"style":{"css":["ql-url"]}}},{"concept":{"name":"set"},"type":"field","tags":["tags"],"content":{"type":"list","list":{"item":{"template":{"tag":"tag"},"style":{"css":["pp-tag-set__list-item"]}},"style":{"css":["pp-tag-set__list"]}},"action":{"add":false,"remove":{"content":[{"kind":"static","type":"text","content":"✖"}],"style":{"css":["pp-tag-set__btn-remove"]}}}}}],"style":[{"type":"style","name":"box-left","style":{"box":{"outer":{"left":{"value":6,"unit":"px"}}}}},{"type":"style","name":"box-top","style":{"box":{"outer":{"top":{"value":6,"unit":"px"}}}}},{"type":"style","name":"box-right","style":{"box":{"outer":{"right":{"value":6,"unit":"px"}}}}},{"type":"style","name":"box-bottom","style":{"box":{"outer":{"bottom":{"value":6,"unit":"px"}}}}}]}')}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nc=void 0,(()=>{"use strict";var t=n(5072),e=n.n(t),r=n(7825),s=n.n(r),a=n(7659),o=n.n(a),l=n(5056),c=n.n(l),h=n(540),u=n.n(h),p=n(1113),f=n.n(p),m=n(5501),g={};g.styleTagTransform=f(),g.setAttributes=c(),g.insert=o().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=u(),e()(m.A,g),m.A&&m.A.locals&&m.A.locals;var b=n(1901),v={};v.styleTagTransform=f(),v.setAttributes=c(),v.insert=o().bind(null,"head"),v.domAPI=s(),v.insertStyleElement=u(),e()(b.A,v),b.A&&b.A.locals&&b.A.locals;var y=n(2997),x={};x.styleTagTransform=f(),x.setAttributes=c(),x.insert=o().bind(null,"head"),x.domAPI=s(),x.insertStyleElement=u(),e()(y.A,x),y.A&&y.A.locals&&y.A.locals;var w=n(2016),E={};E.styleTagTransform=f(),E.setAttributes=c(),E.insert=o().bind(null,"head"),E.domAPI=s(),E.insertStyleElement=u(),e()(w.A,E),w.A&&w.A.locals&&w.A.locals;var A=n(3012),N={};N.styleTagTransform=f(),N.setAttributes=c(),N.insert=o().bind(null,"head"),N.domAPI=s(),N.insertStyleElement=u(),e()(A.A,N),A.A&&A.A.locals&&A.A.locals;var O=n(1133),k={};k.styleTagTransform=f(),k.setAttributes=c(),k.insert=o().bind(null,"head"),k.domAPI=s(),k.insertStyleElement=u(),e()(O.A,k),O.A&&O.A.locals&&O.A.locals;var _=n(4313),j={};j.styleTagTransform=f(),j.setAttributes=c(),j.insert=o().bind(null,"head"),j.domAPI=s(),j.insertStyleElement=u(),e()(_.A,j),_.A&&_.A.locals&&_.A.locals;var M=n(8759),C={};C.styleTagTransform=f(),C.setAttributes=c(),C.insert=o().bind(null,"head"),C.domAPI=s(),C.insertStyleElement=u(),e()(M.A,C),M.A&&M.A.locals&&M.A.locals;var S=n(2482),L={};L.styleTagTransform=f(),L.setAttributes=c(),L.insert=o().bind(null,"head"),L.domAPI=s(),L.insertStyleElement=u(),e()(S.A,L),S.A&&S.A.locals&&S.A.locals;var T=n(4987),I={};I.styleTagTransform=f(),I.setAttributes=c(),I.insert=o().bind(null,"head"),I.domAPI=s(),I.insertStyleElement=u(),e()(T.A,I),T.A&&T.A.locals&&T.A.locals;var U=n(6689);function D(t){let e=0;if(et(t))return t.selectionStart;if(0!==window.getSelection().rangeCount){const n=window.getSelection().getRangeAt(0),i=n.cloneRange();i.selectNodeContents(t),i.setEnd(n.endContainer,n.endOffset),e=i.toString().length}return e}const H="hidden",P="collapsed",z="highlighted",V="shake",R="selected";function B(t){return(0,U.isHTMLElement)(t)?(t.classList.remove(H),t):t}function q(t){return(0,U.isHTMLElement)(t)?(t.classList.add(H),t):t}function F(t){return(0,U.isHTMLElement)(t)?(t.classList.toggle(H),t):t}function $(t){t.classList.contains(V)||(t.classList.add(V),setTimeout((()=>{t.classList.remove(V)}),1e3))}function W(t){return(0,U.isHTMLElement)(t)?(t.classList.remove(z),t):t}function Y(t){return(0,U.isHTMLElement)(t)?(t.classList.add(R),t):t}function X(t){return(0,U.isHTMLElement)(t)?(t.classList.remove(R),t):t}const G={backspace:"Backspace",tab:"Tab",enter:"Enter",ctrl:"Control",shift:"Shift",alt:"Alt",escape:"Escape",spacebar:" ",page_up:"PageUp",page_down:"PageDown",insert:"Insert",end:"End",home:"Home",left_arrow:"ArrowLeft",up_arrow:"ArrowUp",right_arrow:"ArrowRight",down_arrow:"ArrowDown",delete:"Delete",period:"."},J={NORMAL:"normal",WARNING:"warning",SUCCESS:"success",ERROR:"error"},Z="error",Q={AAC:{type:"audio/aac",extension:"aac"},BIN:{type:"application/octet-stream",extension:"bin"},JPEG:{type:"image/jpeg",extension:"jpeg"},JSON:{type:"application/json",extension:"json"},JSONCP:{type:"application/json",extension:"jsoncp"},MP3:{type:"audio/mpeg",extension:"mp3"},PDF:{type:"application/pdf",extension:"pdf"},SVG:{type:"image/svg+xml",extension:"svg"},TEXT:{type:"text/plain",extension:"txt"},XML:{type:"text/xml",extension:"xml"},ZIP:{type:"application/zip",extension:"zip"}},K={"audio/aac":"aac","application/octet-stream":"bin","image/jpeg":"jpeg","application/json":"json","audio/mpeg":"mp3","application/pdf":"pdf","image/svg+xml":"svg","text/plain":"txt","text/xml":"xml","application/zip":"zip"};function tt(t){if(!U.isHTMLElement)throw new TypeError("Bad parameter");return t.hidden||"none"===window.getComputedStyle(t).display}const et=t=>(0,U.isHTMLElement)(t,["input","textarea"]),nt=t=>et(t)||"true"===t.contentEditable,it=t=>+t.substring(0,t.indexOf("px")),rt=(t,e)=>Math.abs(t-e),st={top:t=>t.marginTop,right:t=>t.marginRight,bottom:t=>t.marginBottom,left:t=>t.marginLeft},at={top:t=>t.paddingTop,right:t=>t.paddingRight,bottom:t=>t.paddingBottom,left:t=>t.paddingLeft},ot={top:t=>t.borderTopWidth,right:t=>t.borderRightWidth,bottom:t=>t.borderBottomWidth,left:t=>t.borderLeftWidth};function lt(t,e,n){const i=window.getComputedStyle(t),r=window.getComputedStyle(e),s=st[n](i),a=at[n](r),o=ot[n](r);let l=t.getBoundingClientRect()[n]+it(s),c=e.getBoundingClientRect()[n]-it(a)-it(o);return rt(l,c)<2}function ct(t,e,n,i){return"up"===e?function(t,e,n=!0){const i=e.children,{top:r,left:s}=t.getBoundingClientRect();if(n&&lt(t,e,"top"))return null;let a=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(tt(n)||n.classList.contains("badge")||n===t)continue;const{bottom:c,left:h}=n.getBoundingClientRect();let u=Math.abs(r-c),d=Math.abs(s-h);r>=c-1&&(u<o||u===o&&d<l)&&(a=n,o=u,l=d)}return a}(t,n,i):"down"===e?function(t,e,n=!0){const i=e.children,{bottom:r,left:s}=t.getBoundingClientRect();if(n&&lt(t,e,"bottom"))return null;let a=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(tt(n)||n.classList.contains("badge")||n===t)continue;const{top:c,left:h}=n.getBoundingClientRect();let u=Math.abs(r-c),d=Math.abs(s-h);r<=c+1&&(u<o||u===o&&d<l)&&(a=n,o=u,l=d)}return a}(t,n,i):"left"===e?function(t,e,n=!0){const i=e.children,{top:r,left:s}=t.getBoundingClientRect();if(n&&lt(t,e,"left"))return null;let a=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(tt(n)||n.classList.contains("badge")||n===t)continue;const{top:c,right:h}=n.getBoundingClientRect();let u=Math.abs(r-c),d=Math.abs(s-h);s>=h-1&&(d<l||d===l&&u<o)&&(a=n,o=u,l=d)}return a}(t,n,i):"right"===e?function(t,e,n=!0){const i=e.children,{top:r,right:s}=t.getBoundingClientRect();if(n&&lt(t,e,"right"))return null;let a=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(tt(n)||n.classList.contains("badge")||n===t)continue;const{top:c,left:h}=n.getBoundingClientRect();let u=Math.abs(r-c),d=Math.abs(s-h);s<=h+1&&(d<l||d===l&&u<o)&&(a=n,o=u,l=d)}return a}(t,n,i):(console.error("unknown direction",e),null)}function ht(t,e){const n=t.children,{top:i,left:r}=t.getBoundingClientRect();if(0===n.length)return null;const s=(0,U.isFunction)(e);let a=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const c=n[t];if(s&&!e(c))continue;if(tt(c)||c.classList.contains("badge"))continue;const{top:h,left:u}=c.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(r-u);i<=h+1&&(d<o||d===o&&p<l)&&(a=c,o=d,l=p)}return a}function ut(t,e){const n=t.children,{top:i,left:r}=t.getBoundingClientRect();if(0===n.length)return null;const s=(0,U.isFunction)(e);let a=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const c=n[t];if(s&&!e(c))continue;if(tt(c)||c.classList.contains("badge"))continue;const{top:h,left:u}=c.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(r-u);r<=u+1&&(p<l||p===l&&d<o)&&(a=c,o=d,l=p)}return a}function dt(t,e){const n=t.children,{top:i,right:r}=t.getBoundingClientRect();if(0===n.length)return null;const s=(0,U.isFunction)(e);let a=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const c=n[t];if(s&&!e(c))continue;if(tt(c)||c.classList.contains("badge"))continue;const{top:h,right:u}=c.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(r-u);r>=u-1&&(p<l||p===l&&d<o)&&(a=c,o=d,l=p)}return a}function pt(t,e){const n=t.children,{bottom:i,left:r}=t.getBoundingClientRect();if(0===n.length)return null;const s=(0,U.isFunction)(e);let a=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const c=n[t];if(s&&!e(c))continue;if(tt(c)||c.classList.contains("badge"))continue;const{bottom:h,left:u}=c.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(r-u);i>=h-1&&(d<o||d===o&&p<l)&&(a=c,o=d,l=p)}return a}function ft(t){return(0,U.isHTMLElement)(t)?t:(0,U.isString)(t)&&!(0,U.isNullOrWhitespace)(t)?(0,U.getElement)(t):null}const mt=t=>(0,U.createStrong)({class:["text-bf"]},t).outerHTML,gt=t=>JSON.parse(JSON.stringify(t)),bt=function(){var t={},e=[];for(let t=0;t<256;t++)e[t]=t<16?"0"+t.toString(16):t.toString(16);return t.generate=function(){var t=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,r=4294967296*Math.random()>>>0;return e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&i|128]+e[i>>8&255]+"-"+e[i>>16&255]+e[i>>24&255]+e[255&r]+e[r>>8&255]+e[r>>16&255]+e[r>>24&255]},t}(),vt={file:null,title:null,status:null,container:null,mainView:null,infoView:null,conceptList:null,selection:null,placeholder:null,cache:null,init(){return this.cache=new Map,this},get hasFile(){return this.cache.size>0},get hasSelection(){return!(0,U.isNullOrUndefined)(this.selection)},refresh(){return this.hasFile?(this.container.classList.remove("empty"),q(this.placeholder),B(this.conceptList)):(this.container.classList.add("empty"),B(this.placeholder),q(this.conceptList)),this.hasSelection||q(this.infoView),this},render(){return this.container=(0,U.createDiv)({class:["editor-config"]}),this.mainView=(0,U.createDiv)({class:["editor-config-main"]}),this.infoView=(0,U.createDiv)({class:["editor-config-info"]}),this.conceptList=(0,U.createUnorderedList)({class:["bare-list","editor-config__list"]}),this.placeholder=(0,U.createParagraph)({class:["editor-config-placeholder"],html:`${mt("No concept found")}. Please upload your files.`}),this.mainView.append(this.conceptList,this.placeholder),this.container.append(this.mainView,this.infoView),this.bindEvents(),this.refresh(),this.container},clear(){(0,U.removeChildren)(this.conceptList),(0,U.removeChildren)(this.infoView),this.cache.clear(),this.refresh()},selectItem(t){if(!this.cache.has(t))return null;let e=this.cache.get(t);return(0,U.isHTMLElement)(this.selection)&&this.selection.classList.remove("selected"),this.selection=e,this.selection.classList.add("selected"),this.refresh(),t},show(){return B(this.container),this.visible=!0,this},hide(){return q(this.container),this.visible=!1,this},showInfo(t){let e=yt(this.editor.conceptModel.getCompleteModelConcept(t),(0,U.getTemplate)("#concept-schema"));(0,U.removeChildren)(this.infoView).append(e),B(this.infoView)},addItem(t){let e=(0,U.createSpan)({class:["loaded-element-name","fit-content"]},t.name),n=(0,U.createListItem)({class:["loaded-element",`loaded-element--${this.type}`],dataset:{context:"menu",action:"open-concept",concept:t.name,status:"active"}}),i=(0,U.createButton)({class:["btn","file-section__actionbar-button","file-section__actionbar-button--edit"],title:`Reload the ${this.type}`,dataset:{context:"menu",action:"open-concept",concept:t.name}});n.append(e,i),this.conceptList.append(n),this.cache.set(t.name,n),this.refresh()},bindEvents(){}};function yt(t,e){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad argument: The 'schema' is missing");if(!(0,U.isHTMLElement)(e))throw new TypeError("Bad argument: The given 'template' is not a valid HTML Element");const n=(0,U.cloneTemplate)(e);return(0,U.getElements)("[data-if]",n).forEach(((e,n)=>{let i=e.dataset.if;(0,U.hasOwn)(t,i)||e.remove()})),(0,U.getElements)("[data-name]",n).forEach(((e,n)=>{let i=e.dataset.name;e.textContent=t[i]})),(0,U.getElements)("[data-attr]",n).forEach(((e,n)=>{let i=e.dataset.attr,[r,s]=i.split(":"),a=(e=>e.startsWith("$")?t[e.substring(1)]:e)(s);delete e.dataset.attr,e.dataset[r]=a})),(0,U.getElements)("[data-bind]",n).forEach(((e,n)=>{let i=e.dataset.bind;if(!(0,U.hasOwn)(t,i))return;let r=(0,U.getElement)("[data-item]",e),s=r.dataset.item,a=(0,U.getTemplate)(`#${s}`);t[i].forEach((t=>{r.append(yt(t,a))}))})),n}const xt={PRIMITIVE:"E",CONCRETE:"C",PROTOTYPE:"P",DERIVATIVE:"D"},wt={file:null,title:null,status:null,container:null,mainView:null,infoView:null,files:null,btnLoad:null,btnLoadConcept:null,btnLoadProjection:null,btnUnload:null,btnDownload:null,btnEdit:null,selection:null,concepts:null,selectedConcept:null,attributes:null,filter:null,init(){return this.concepts=new Map,this.attributes=new Map,this.filter=Object.create(Nt,{editor:{value:this.editor},settings:{value:this}}).init([{label:"Concrete",nature:"concrete"},{label:"Prototype",nature:"prototype"},{label:"Derivative",nature:"derivative"}]),this},get hasFile(){return this.concepts.size>0},get hasSelection(){return!(0,U.isNullOrUndefined)(this.selection)},getFile(){return this.file},setFile(t){this.file=t,this.refresh()},refresh(){return this.hasFile?(this.container.classList.remove("empty"),B(this.files)):(this.container.classList.add("empty"),q(this.files)),this.btnUnload.disabled=!this.hasFile,this.editor.isReady?(q(this.placeholder),this.placeholder.classList.remove("error")):this.hasFile?(this.editor.hasConceptModel||(this.placeholder.innerHTML=`${mt("Missing projections")}`),this.editor.hasProjectionModel||(this.placeholder.innerHTML=`${mt("Missing projections")}`),this.placeholder.classList.add("error"),B(this.placeholder)):(this.placeholder.innerHTML=`Add your ${mt("concepts")} and ${mt("projections")} or load a previously saved ${mt("model")}`,this.placeholder.classList.remove("error")),this.hasSelection?B(this.infoView):q(this.infoView),this},reload(){this.editor.hasConceptModel?(this.editor.conceptModel.schema.forEach((t=>{let e=(0,U.createListItem)({class:["editor-file-concept"],dataset:{name:t.name,nature:t.nature,root:(0,U.valOrDefault)(t.root,"false")}},t.name);if(t.root){let t=(0,U.createI)({class:["editor-file-concept-root"],title:"root concept"});e.append(t)}this.concepts.set(t.name,e),this.files.append(e)})),this.refresh()):this.clear()},render(){this.container=(0,U.createDiv)({class:["editor-file"]});let t=(0,U.createDiv)({class:["editor-file-actionbar"]});this.btnOpen=(0,U.createButton)({class:["btn","editor-file__browse-button"],title:"Open a model",dataset:{action:"load"}},"Open"),this.btnLoad=Et("load","Browse","Load file in editor");let e=(0,U.createDiv)({class:["editor-file-modactions"]});return this.btnLoadConcept=Et("load-concept","Concept","Load some concepts into the editor"),this.btnLoadProjection=Et("load-projection","Projection","Load some projections into the editor"),this.btnUnload=(0,U.createButton)({class:["btn","editor-file-actionbar__button","editor-file-actionbar__btn-remove"],title:"Remove all files",dataset:{action:"unload"}}),e.append(this.btnLoadConcept,this.btnLoadProjection,this.btnUnload),t.append(e),this.mainView=(0,U.createDiv)({class:["editor-file-mainview"]}),this.files=(0,U.createUnorderedList)({class:["bare-list","editor-file__list"]}),this.infoView=(0,U.createDiv)({class:["detail-area","editor-file-detail"]}),this.placeholder=(0,U.createParagraph)({class:["editor-file-placeholder"],html:`Add your ${mt("concepts")}, ${mt("projections")} and all other ${mt("resources")}`}),this.mainView.append(this.filter.render(),this.files,this.infoView),this.container.append(t,this.mainView),this.bindEvents(),this.refresh(),this.container},clear(){(0,U.removeChildren)(this.files)},show(){return B(this.container),this.visible=!0,this},hide(){return q(this.container),this.visible=!1,this},selectItem(t){let e=this.concepts.get(t);(0,U.isHTMLElement)(this.selection)&&this.selection.classList.remove("selected"),this.selection=e,this.selection.classList.add("selected"),this.displayInfo(t),this.refresh()},displayConcept(t){if((0,U.isNullOrUndefined)(t))return;let e=this.editor.conceptModel.getConceptSchema(t);if((0,U.isNullOrUndefined)(e))return;this.selection=t;const{name:n,nature:i,attributes:r}=e;let s=(0,U.createDiv)({class:["app-model-concept"]}),a=(0,U.createDiv)({class:["app-model-concept-header"]}),o=(0,U.createUnorderedList)({class:["bare-list","app-model-concept-menu"]}),l=(0,U.createListItem)({class:["app-model-concept-menu-item","selected"],dataset:{action:"nav-structure"}},"Structure"),c=(0,U.createListItem)({class:["app-model-concept-menu-item"],dataset:{action:"nav-projections"}},"Projections");o.append(l,c);let h=(0,U.createI)({class:["app-model-concept-nature"],dataset:{name:i}},xt[i.toUpperCase()]),u=(0,U.createSpan)({class:["app-model-concept-name"]},n);a.append(h,u);let d=(0,U.createDiv)({class:["app-model-concept-body"]}),p=(0,U.createUnorderedList)({class:["bare-list","app-model-concept-attributes"]}),f=(0,U.createUnorderedList)({class:["bare-list","app-model-concept-projections","hidden"]});Array.isArray(r)&&r.forEach((t=>{let e=(0,U.createListItem)({class:["app-model-concept-attribute"],dataset:{name:t.name,type:"attribute"}}),n=(0,U.createDiv)({class:["app-model__attribute-header"]}),i=(0,U.createSpan)({class:["app-model__attribute-name"]},t.name);if(t.required){let t=(0,U.createI)({class:["app-model__attribute-required"]},(0,U.createSpan)({class:["help"]},"required"));n.append(t)}n.append(i);let r=(0,U.createDiv)({class:["app-model__attribute-target"]},At(t.target)),s=(0,U.createDiv)({class:["app-model__attribute-info"]},[n,r]);e.append(s),this.attributes.set(t.name,e),p.append(e)})),d.append(p,f),s.append(a,d),(0,U.removeChildren)(this.infoView),this.infoView.append(s),this.selectedConcept=e,this.selectedConceptAttrs=p,this.selectedConceptProjs=f,this.refresh()},showStructure(){B(this.selectedConceptAttrs),q(this.selectedConceptProjs)},showProjections(){q(this.selectedConceptAttrs),B(this.selectedConceptProjs)},selectAttribute(t){return!(0,U.isNullOrUndefined)(t)&&(this.selectedAttribute!==t&&(this.selectedAttribute&&this.attributes.get(this.selectedAttribute).classList.remove("selected"),!!this.attributes.has(t)&&(this.selectedAttribute=t,this.attributes.get(t).classList.add("selected"),this.displayAttribute(t),this.refresh(),!0)))},displayAttribute(t){this.refresh()},bindEvents(){this.editor.registerHandler("editor.load-concept@post",(t=>{this.reload()})),this.editor.registerHandler("editor.unload-concept@post",(t=>{this.reload()})),this.editor.registerHandler("editor.unload-projection@post",(t=>{this.reload()})),this.container.addEventListener("dragenter",(t=>{this.container.classList.add("highlight"),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("dragleave",(t=>{this.container.classList.remove("highlight"),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("dragover",(t=>{this.container.classList.add("highlight"),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("drop",(t=>{this.container.classList.remove("highlight");let e=t.dataTransfer.files[0];if(!e.name.endsWith(".json"))return void this.notify("This file is not supported. Please use a .json file");let n=new FileReader;n.onload=t=>{this.editor.load(n.result,this.type)},n.readAsText(e),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("click",(t=>{const{target:e}=t,{type:n,action:i,name:r}=e.dataset;"nav-structure"===i?this.showStructure():"nav-projections"===i&&this.showProjections(),this.displayConcept(r),"attribute"===n?this.selectAttribute(r):"concept"===n&&this.parent.selectConcept(r)}))}};function Et(t,e,n){return(0,U.createButton)({class:["btn","editor-file__browse-button"],title:n,dataset:{action:t},html:`\n            <span class="editor-home__btn-browse-icon" data-ignore="all">+</span> \n            <span class="editor-home__btn-browse-text" data-ignore="all">${e}</span>\n        `})}function At(t){const e=(0,U.createDocFragment)();if((0,U.isNullOrUndefined)(t))return e;const{name:n,accept:i}=t;let r=(0,U.createSpan)({class:["target-name"],dataset:{type:"concept",name:n}},n);if(e.append(r),i){let t=(0,U.createDiv)({class:["target-accept"]});Array.isArray(i)?(t.append(...i.map((t=>At(t)))),t.classList.add("array")):t.append(At(i)),e.append(t)}return e}const Nt={container:null,values:null,filters:null,concepts:null,init(t){this.values=(0,U.valOrDefault)(t,[]);let e=1;return this.values.forEach((t=>{t.id=e++})),this.filters=new Map,this},refresh(){this.filters.forEach(((t,e)=>{t.checked?t.parentElement.classList.add("checked"):t.parentElement.classList.remove("checked")}))},render(){return(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:"concept-filter"})),this.search=(0,U.createInput)({class:["concept-filter-search"]}),this.values.forEach((t=>{let e=(0,U.createInput)({class:["cf-option-checkbox"],type:"checkbox",checked:!0,value:t.id}),n=(0,U.createSpan)({class:["cf-option-text"]},t.label),i=(0,U.createLabel)({class:"concept-filter-option"},[e,n]);this.filters.set(t,e),this.container.append(i)})),this.bindEvents(),this.refresh(),this.container},filterConcepts(){this.settings.concepts.forEach(((t,e)=>{const{nature:n,root:i}=t.dataset;this.filters.forEach(((e,r)=>{r.nature===n&&(e.checked?B(t):q(t)),r.root===(0,U.toBoolean)(i)&&(e.checked?B(t):q(t))}))})),this.refresh()},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t;this.filterConcepts()}))}},Ot={file:null,title:null,status:null,container:null,mainView:null,infoView:null,conceptList:null,selection:null,placeholder:null,cache:null,init(){return this.cache=new Map,this},get hasFile(){return this.cache.size>0},get hasSelection(){return!(0,U.isNullOrUndefined)(this.selection)},refresh(){return this.hasFile?(this.container.classList.remove("empty"),q(this.placeholder),B(this.conceptList)):(this.container.classList.add("empty"),B(this.placeholder),q(this.conceptList)),this.hasSelection||q(this.infoView),this},render(){return this.container=(0,U.createDiv)({class:["editor-config"]}),this.mainView=(0,U.createDiv)({class:["editor-config-main"]}),this.infoView=(0,U.createDiv)({class:["editor-config-info"]}),this.conceptList=(0,U.createUnorderedList)({class:["bare-list","editor-config__list"]}),this.placeholder=(0,U.createParagraph)({class:["editor-config-placeholder"],html:`${mt("No concept found")}. Please upload your files.`}),this.mainView.append(this.conceptList,this.placeholder),this.container.append(this.mainView,this.infoView),this.bindEvents(),this.refresh(),this.container},clear(){(0,U.removeChildren)(this.conceptList),(0,U.removeChildren)(this.infoView),this.cache.clear(),this.refresh()},selectItem(t){if(!this.cache.has(t))return null;let e=this.cache.get(t);return(0,U.isHTMLElement)(this.selection)&&this.selection.classList.remove("selected"),this.selection=e,this.selection.classList.add("selected"),this.refresh(),t},show(){return B(this.container),this.visible=!0,this},hide(){return q(this.container),this.visible=!1,this},addItem(t){let e=(0,U.createSpan)({class:["loaded-element-name","fit-content"]},t.name),n=(0,U.createListItem)({class:["loaded-element",`loaded-element--${this.type}`],dataset:{context:"menu",action:"open-concept",concept:t.name,status:"active"}}),i=(0,U.createButton)({class:["btn","file-section__actionbar-button","file-section__actionbar-button--edit"],title:`Reload the ${this.type}`,dataset:{context:"menu",action:"open-concept",concept:t.name}});n.append(e,i),this.conceptList.append(n),this.cache.set(t.name,n),this.refresh()},bindEvents(){}},kt={menu:null,schema:null,isOpen:!1,visible:!0,btnStart:null,settings:null,init(t){return t&&(this.schema=t),this},get isRendered(){return(0,U.isHTMLElement)(this.container)},clear(){return(0,U.removeChildren)(this.container),this},update(){},render(){const t=(0,U.createDocFragment)();if(!(0,U.isHTMLElement)(this.container)){this.container=(0,U.createDiv)({class:["editor-home"]});let t=(0,U.createImage)({class:["editor-logo"],src:"https://gentlemancp.org/assets/images/logo_gentleman_200.png"}),e=(0,U.createH2)({class:["editor-title"]},"Settings"),n=(0,U.createDiv)({class:["editor-home-header"]},[t,e]);this.container.append(n)}return(0,U.isHTMLElement)(this.menu)||(this.menu=Object.create(_t,{editor:{value:this.editor}}).init(),t.append(this.menu.render())),(0,U.isHTMLElement)(this.btnStart)||(this.btnStart=(0,U.createButton)({class:["btn","editor-home-section--model__button","editor-home-section__button--start"],dataset:{action:"close",context:"home"}},"Done!"),t.append(this.btnStart)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){const{hasConceptModel:t,hasProjectionModel:e}=this.editor;return this.btnStart.disabled=!(t&&e),this},actionHandler(t,e){const{concept:n}=e.dataset;"open-concept"===t&&(this.menu.config.selectItem(n),this.menu.config.showInfo(n))},bindEvents(){this.editor.registerHandler("concept-model.updated",(()=>{this.menu.config.clear(),this.editor.hasConceptModel&&this.editor.conceptModel.schema.filter((t=>t.root)).forEach((t=>{this.menu.config.addItem(t)}))}))}},_t={container:null,tabsElement:null,tabs:null,currentTab:null,activeTab:null,fileIO:null,config:null,dataSettings:null,buildSettings:null,init(){return this.tabs=new Map,this.tabs.set("file","File"),this.tabs.set("config","Config"),this.currentTab="file",this},refresh(){},render(){return this.container=(0,U.createSection)({class:["editor-home-menu"]}),this.tabsElement=(0,U.createUnorderedList)({class:["bare-list","editor-home-menu-tabs"]}),this.tabs.forEach(((t,e)=>{let n=(0,U.createListItem)({class:["editor-home-menu-tab"],dataset:{name:e}},t);this.tabs.set(e,n),this.tabsElement.append(n)})),this.window=(0,U.createDiv)({class:["editor-home-menu-section"]}),this.fileIO=jt.call(this),this.config=Mt.call(this),this.dataSettings=Ct.call(this),this.window.append(this.fileIO.render()),this.window.append(this.config.render()),this.window.append(this.dataSettings.render()),this.selectTab(this.currentTab),this.container.append(this.tabsElement,this.window),this.bindEvents(),this.container},selectTab(t){(0,U.isNullOrUndefined)(t)||this.activeTab&&this.currentTab===t||("file"===t?(this.fileIO.show(),this.config.hide(),this.dataSettings.hide()):"config"===t&&(this.config.show(),this.fileIO.hide(),this.dataSettings.hide()),this.activeTab&&X(this.activeTab),this.currentTab=t,this.activeTab=this.tabs.get(this.currentTab),Y(this.activeTab))},bindEvents(){this.tabsElement.addEventListener("click",(t=>{const{target:e}=t,{name:n}=e.dataset;this.selectTab(n)}))}};function jt(t){const e=Object.create(wt,{editor:{value:this.editor}});return e.init(),e}function Mt(){const t=Object.create(vt,{editor:{value:this.editor}});return t.init(),t}function Ct(){const t=Object.create(Ot,{editor:{value:this.editor}});return t.init(),t}function St(t,e){const{name:n,object:i,id:r}=e,s=(0,U.createListItem)({class:["selector-concept",`selector-concept--${t}`],title:e.getName(),dataset:{concept:r,object:i}});var a=(0,U.createSpan)({class:["selector-concept-content"]},e.getName());s.append(a),"ancestor"===t&&a.classList.add("fit-content");const o=(0,U.createI)({class:["selector-concept-status"]});if(e.hasError){o.classList.add("error");let t=(0,U.createUnorderedList)({class:["bare-list","selector-concept-status__errors"]});e.errors.forEach((e=>{let n=(0,U.createListItem)({class:["selector-concept-status__error"]},e);n.style.minWidth=`${Math.min(.5*e.length,30)}em`,t.append(n)})),o.append(t),s.classList.add("error")}else o.classList.add("valid"),s.classList.add("valid");return s.append(o),s.addEventListener("mouseenter",(t=>{let e=(0,U.getElement)(`.projection[data-concept="${r}"]`,this.editor.body);e&&this.editor.highlight(e)})),s.addEventListener("mouseleave",(t=>{this.editor.unhighlight()})),s.addEventListener("click",(t=>{let e=(0,U.getElement)(`.projection[data-concept="${r}"]`,this.editor.body);e&&e.focus()})),s}const Lt={container:null,title:null,conceptList:null,header:null,body:null,get isRendered(){return(0,U.isHTMLElement)(this.container)},init(t={}){return this.schema=t,this},update(){},refresh(){const{activeInstance:t,activeConcept:e,hasActiveInstance:n,hasActiveConcept:i}=this.editor;if(!n||!i)return(0,U.removeChildren)(this.conceptList),this;const r=t.concept,s=(0,U.createDocFragment)();let a=St.call(this,"root",r);if(s.append(a),r===e&&a.classList.add("selector-concept--active"),r===e)return(0,U.removeChildren)(this.conceptList).append(s),this;if(!e.hasParent())return(0,U.removeChildren)(this.conceptList).append(s),this;let o=e.getParent(),l=[];for(;o&&o!==r;)l.unshift(o),o=o.getParent();return l.forEach((t=>{s.append(St.call(this,"ancestor",t))})),a=St.call(this,"active",e),s.append(a),(0,U.removeChildren)(this.conceptList).append(s),this},render(){const t=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["editor-breadcrumb"]})),(0,U.isHTMLElement)(this.notification)||(this.notification=(0,U.createDiv)({class:["notification","breadcrumb-notification"]}),t.append(this.notification));const e=(0,U.createSpan)({class:["breadcrumb-title","hidden"],dataset:{ignore:"all"}},"Breadcrumb");return t.append(e),(0,U.isHTMLElement)(this.conceptList)||(this.conceptList=(0,U.createUnorderedList)({class:["bare-list","selector-concepts"]}),t.append(this.conceptList)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.update(),this.refresh(),this.container},bindEvents(){}},Tt={schema:null,isOpen:!1,visible:!0,btnStart:null,logList:null,init(t){return t&&(this.schema=t),this},get isRendered(){return(0,U.isHTMLElement)(this.container)},add(t,e,n="normal"){if(!Array.isArray(t))return;let i=(0,U.createUnorderedList)({class:["bare-list","log-item-messages"]});t.forEach((t=>i.append((0,U.createListItem)({class:["log-item-message"]},t))));let r=(0,U.createListItem)({class:["log-item",`log-item--${n}`]}),s=(0,U.createButton)({class:["btn","btn-delete"],dataset:{action:"delete",target:"parent"}},"✖"),a=(0,U.createSpan)({class:["log-item__name"],dataset:{action:"delete",target:"parent"}},`${(0,U.valOrDefault)(e,"Log")} (${(0,U.shortDateTime)(Date.now())})`);return r.append(s,a,i),this.logList.append(r),this.refresh(),this},clear(){return(0,U.removeChildren)(this.logList),this},update(){},render(){const t=(0,U.createDocFragment)();return(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["editor-log"]})),(0,U.isHTMLElement)(this.logList)||(this.logList=(0,U.createUnorderedList)({class:["bare-list","log-list"]}),t.append(this.logList)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this.logList.hasChildNodes()?this.show():this.hide(),this},bindEvents(){}},It={modelstatus:null,editorstatus:null,notification:null,views:null,view:"grid",viewContainer:null,viewList:null,viewItem:null,activeViewItem:null,groupList:null,groupItem:null,activeGroupItem:null,visible:!0,container:null,get isRendered(){return(0,U.isHTMLElement)(this.container)},init(){return this.views=new Map,this},show(){return B(this.container),this.visible=!0,this},hide(){return q(this.container),this.visible=!1,this},toggle(){return F(this.container),this.visible=!this.visible,this},updateActiveView(){"tab"===this.view&&(this.editor.instances.forEach((t=>{t!==this.editor.activeInstance&&(t.view.classList.remove("active"),t.hide())})),this.editor.activeInstance.view.classList.add("active"),this.editor.activeInstance.show()),this.editor.refresh()},addView(t){if((0,U.isNullOrUndefined)(t))return!1;let e=t.title.textContent,n=(0,U.createI)({class:["ico","ico-delete"]},"✖"),i=(0,U.createButton)({class:["btn","btn-close"]},n),r=(0,U.createDiv)({class:[`editor-view-${this.view}list-item__content`,"fit-content"]},e),s=(0,U.createListItem)({class:[`editor-view-${this.view}list-item`],title:t.title.textContent},[r,i]);t.view=s,s.addEventListener("click",(e=>{let n=function(t){const e=t=>t===s||t===i;return e(t)?t:(0,U.findAncestor)(t,(t=>e(t)),5)}(e.target);if(n===i){let e=s.previousSibling||s.nextSibling;t.delete(),null===this.editor.activeInstance&&e&&e.click()}else this.editor.updateActiveInstance(t)})),this.tabView.append(s)},changeView(t){if(t===this.view)return this;this.view=t,X(this.viewItem),this.viewItem=this.views.get(this.view),Y(this.viewItem),(0,U.removeChildren)(this.editor.viewSection),"tab"===t?(this.tabView=(0,U.createUnorderedList)({class:["bare-list","editor-view-tablist"]}),(0,U.removeChildren)(this.tabView),this.editor.instances.forEach((t=>{t.expand(),this.addView(t)})),this.editor.viewSection.append(this.tabView)):"grid"===t&&this.editor.instances.forEach((t=>{t.show()})),this.updateActiveView()},addGroup(){(0,U.createListItem)({class:["editor-footer-group"]})},notify(t,e=4500){let n=t;const i="open";if(this.notification.classList.contains(i))return!1;this.notification.appendChild(n),setTimeout((()=>{this.notification.classList.add(i),this.container.classList.add("menu--notifying")}),50),setTimeout((()=>{this.notification.classList.remove(i),this.container.classList.remove("menu--notifying"),setTimeout((()=>{(0,U.removeChildren)(this.notification)}),500)}),e)},refresh(){const{conceptModel:t}=this.editor;if(this.editor.isReady){if(t.hasError){this.modelstatusBadge.classList.add("error"),this.modelstatusBadge.classList.remove("valid"),this.container.classList.add("error");let e=t.concepts.filter((t=>t.hasError)).length;this.modelstatusInfo.textContent=`${e} ${function(t,e,n){if(1===n)return t;let i="s".split("|");return 1===i.length?t+i[0]:t.substring(0,t.lastIndexOf(i[0]))+i[1]}("error",0,e)}`}else this.modelstatusBadge.classList.add("valid"),this.modelstatusBadge.classList.remove("error"),this.container.classList.remove("error"),(0,U.removeChildren)(this.modelstatusInfo),this.editor.logs.clear();if(this.editor.hasError){this.editorstatusBadge.classList.add("error"),this.editorstatusBadge.classList.remove("valid"),this.container.classList.add("error");let t=this.editor.errors.length;this.editorstatusInfo.textContent=`${t}`}else this.editorstatusBadge.classList.add("valid"),this.editorstatusBadge.classList.remove("error"),this.container.classList.remove("error"),(0,U.removeChildren)(this.editorstatusInfo),this.editor.logs.clear()}},render(){const t=(0,U.createDocFragment)();if((0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["editor-statusbar"]})),(0,U.isHTMLElement)(this.badgeContainer)||(this.badgeContainer=(0,U.createDiv)({class:["editor-statusbar-badge-container"]}),t.appendChild(this.badgeContainer)),(0,U.isHTMLElement)(this.modelstatus)||(this.modelstatus=(0,U.createDiv)({class:["editor-statusbar-model"]}),this.modelstatusBadge=(0,U.createI)({class:["editor-statusbar-model-badge"]}),this.modelstatusInfo=(0,U.createDiv)({class:["editor-statusbar-model-info"]}),this.modelstatus.append(this.modelstatusBadge,this.modelstatusInfo),this.badgeContainer.appendChild(this.modelstatus)),(0,U.isHTMLElement)(this.editorstatus)||(this.editorstatus=(0,U.createDiv)({class:["editor-statusbar-global"]}),this.editorstatusBadge=(0,U.createI)({class:["editor-statusbar-global-badge"]}),this.editorstatusInfo=(0,U.createDiv)({class:["editor-statusbar-global-info"]}),this.editorstatus.append(this.editorstatusBadge,this.editorstatusInfo),this.badgeContainer.appendChild(this.editorstatus)),(0,U.isHTMLElement)(this.viewContainer)||(this.viewContainer=(0,U.createDiv)({class:["editor-statusbar-viewer-container"]}),t.appendChild(this.viewContainer)),!(0,U.isHTMLElement)(this.btnGroup)){let t=(0,U.createI)({class:["ico","ico-plus","btn-content"],title:"Add a group",dataset:{ignore:"all"}},"+");this.btnGroup=(0,U.createButton)({class:["editor-statusbar-viewer__button-add"],dataset:{action:"add-group"}},t)}return(0,U.isHTMLElement)(this.groupContainer)||(this.groupContainer=(0,U.createDiv)({class:["editor-footer-group"]})),(0,U.isHTMLElement)(this.viewList)||(this.viewList=(0,U.createUnorderedList)({class:["bare-list","editor-statusbar-viewers"]}),this.viewContainer.appendChild(this.viewList)),["grid","tab"].forEach((t=>{let e=(0,U.createListItem)({class:["editor-statusbar-viewer"],dataset:{type:"viewer",action:"change-view",value:t}},t);this.views.set(t,e),this.viewList.append(e)})),this.viewItem=this.views.get(this.view),this.viewItem.classList.add("selected"),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},bindEvents(){function t(t,e){let n=(0,U.createEmphasis)({class:["link","error-message__link"]},t);const i=`.projection[data-concept="${e}"]`;return n.addEventListener("mouseenter",(t=>{let e=(0,U.getElement)(i,this.editor.body);e&&this.editor.highlight(e)})),n.addEventListener("mouseleave",(t=>{this.editor.unhighlight()})),n.addEventListener("click",(t=>{let e=this.editor.resolveElement((0,U.getElement)(i,this.editor.body));e&&e.focus()})),n}this.modelstatus.addEventListener("click",(e=>{if(!this.editor.conceptModel.hasError)return;let n=[];this.editor.conceptModel.concepts.forEach((e=>{e.hasError&&n.push(...e.errors.map((n=>{let i=t.call(this,e.getName(),e.id);return(0,U.createSpan)({class:["error-message"]},[i,`: ${n}`])})))})),this.editor.logs.clear(),this.editor.logs.add(n,"Validation error",Z)})),this.editorstatus.addEventListener("click",(t=>{if(!this.editor.hasError)return;let e=[];e.push(...this.editor.errors.map((t=>(0,U.createSpan)({class:["error-message"]},[`${t.message}`])))),this.editor.logs.clear(),this.editor.logs.add(e,"Validation error",Z)})),this.editor.registerHandler("editor.instance@active:updated",(()=>{this.updateActiveView()}))}},Ut={container:null,list:null,editor:null,dataList:null,fetch:null,init(t){return this.fetch=t,this},render(){const t=(0,U.createDocFragment)();return(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["container","container--editor-selectors"]})),(0,U.isHTMLElement)(this.list)||(this.list=(0,U.createUnorderedList)({class:["bare-list","editor-selectors","font-ui"]}),t.append(this.list)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this},update(){this.dataList=this.fetch(),(0,U.removeChildren)(this.list);let t=(0,U.valOrDefault)(this.editor.getConfig("concept"),{});return this.dataList.forEach((e=>{const{concept:n,accept:i}=e;let r=(0,U.createH4)({class:["title","editor-selector__title"]},`${s=e.name,(0,U.hasOwn)(t,s)?t[s].name:s}`);var s;n&&r.append((0,U.createSpan)({class:["editor-selector__title-concept"]},(n.name||n.prototype).replace(" ","-").toLowerCase())),i&&r.append((0,U.createSpan)({class:["editor-selector__title-accept"]},i.name)),(0,U.createButton)({class:["btn","editor-selector__header-button","editor-selector__header-button--info"],title:`View ${e.name||e.type} info`,dataset:{action:"collapse",rel:"parent",target:"selector"}},"i");let a=(0,U.createHeader)({class:["title","editor-selector__header"],title:`Expand/Collapse ${this.type}`},[r]),o=Dt[this.type],l=(0,U.createDiv)({class:["editor-selector__action-bar"]},o.call(this,e)),c=(0,U.createListItem)({class:["editor-selector","collapsed","font-ui"],tabindex:0,dataset:{type:this.type,alias:`${e.name||e.type}`,name:"selector",projection:e.id}},[a,l]);this.list.append(c)})),this.refresh(),this},show(){return B(this.container),this},hide(){return q(this.container),this},bindEvents(){}},Dt={projection:function(t){const e=(0,U.createDocFragment)();let n=(0,U.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"edit:projection",id:t.id}},"Edit");return e.append(n),e},value:function(t){const e=(0,U.createDocFragment)();let n=(0,U.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"create-instance:value",id:t.id}},(0,U.createI)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),i=(0,U.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"copy:value",id:t.id}},(0,U.createI)({class:["ico","ico-copy","btn-content"],dataset:{ignore:"all"}})),r=(0,U.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:value",id:t.id}},(0,U.createI)({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return e.append(r,i,n),e},concept:function(t){const e=(0,U.createDocFragment)();let n=this.editor.projectionModel.hasProjectionSchema(t),i=(0,U.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],disabled:!n,title:`Create an instance of "${t.name}"`,dataset:{action:"create-instance",concept:t.name}},(0,U.createI)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+"));return n||(i.title=`The concept ${t.name} has no projection`),e.append(i),e},resource:function(t){const{name:e,type:n,required:i}=t,r=(0,U.createDocFragment)();let s=(0,U.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--add"],dataset:{action:"load-resource",id:e}},(0,U.createI)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),a=(0,U.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:resource",id:e}},(0,U.createI)({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return this.editor.getResource(e)?r.append(a):r.append(s),r}},Ht={editor:null,valueCount:0,fileCount:0,container:null,title:null,visible:!0,tabs:null,tabConcept:null,tabValue:null,tabProjection:null,tabResource:null,tabConceptNotification:null,tabValueNotification:null,tabProjectionNotification:null,tabResourceNotification:null,activeTab:null,activeTabValue:null,menu:null,header:null,body:null,btnHome:null,btnSave:null,btnClose:null,get isRendered(){return(0,U.isHTMLElement)(this.container)},init(t){return t&&(this.editor=t),this._conceptSelector=function(t,e){return Object.create(Ut,{object:{value:"selector"},model:{value:void 0},type:{value:"concept"},editor:{value:e}})}(0,this.editor).init((()=>this.editor.isReady?this.editor.conceptModel.getSchema("concrete").filter((t=>t.root)):[])),this},render(){const t=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["editor-header"],dataset:{name:"editor-header",alias:"header"}})),(0,U.isHTMLElement)(this.title)||(this.title=(0,U.createSpan)({class:["editor-header-title"]},"Gentleman")),(0,U.isHTMLElement)(this.menu)||(this.menu=(0,U.createDiv)({class:["editor-header-left"]},[this.title]));let e=(0,U.valOrDefault)(this.editor.getConfig("toolbar"),[]),n=(0,U.createDiv)({class:["editor-toolbar"]},e.map((t=>(0,U.createButton)({class:(0,U.valOrDefault)(t.class,[]),dataset:{name:t.name,action:t.action}},t.content))));return(0,U.isHTMLElement)(this.btnHome)||(this.btnHome=(0,U.createButton)({class:["btn","editor-toolbar__button","editor-toolbar__button--home"],title:"Toggle menu",dataset:{action:"home"}}),n.append(this.btnHome)),(0,U.isHTMLElement)(this.header)||(this.header=(0,U.createDiv)({class:["editor-header-menu"]},[this.menu,n]),t.append(this.header)),(0,U.isHTMLElement)(this.body)||(this.body=(0,U.createDiv)({class:["editor-header-main"]}),t.append(this.body)),(0,U.isHTMLElement)(this._conceptSelector.container)||this.body.append(this._conceptSelector.render()),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){let t=(0,U.valOrDefault)(this.editor.getConfig("settings"),!0),e=(0,U.valOrDefault)(this.editor.getConfig("header"),!0);return this.editor.hasConceptModel?(this._conceptSelector.update(),B(this.body)):q(this.body),!1===t&&q(this.btnHome),!1===e&&q(this.body),this},show(t){if(!(0,U.isHTMLElement)(this[t]))return B(this.container),this.visible=!0,this;B(this[t])},hide(t){if(!(0,U.isHTMLElement)(this[t]))return q(this.container),this.visible=!1,this;q(this[t])},toggle(){return F(this.container),this.visible=!this.visible,this},bindEvents(){}};var Pt=0;const zt={createInstance(t,e,n){if((0,U.isNullOrUndefined)(t))return this.notify("The concept is not valid",J.ERROR),!1;let i="concept"===t.type?t:this.createConcept(t),r=e;(0,U.isNullOrUndefined)(r)&&this.hasProjectionModel&&(r=this.createProjection(i).init());let s=Object.create(Vt,{id:{value:"instance"+Pt++},object:{value:"environment"},name:{value:"editor-instance"},type:{value:"instance"},concept:{value:i,writable:!0},projection:{value:r,writable:!0},editor:{value:this}});const a=Object.assign({type:"concept",resize:!0,maximize:!0,close:"DELETE-CONCEPT"},n);return s.init(a),this.addInstance(s),s},getInstance(t){return this.instances.get(t)},addInstance(t){return t.isRendered||this.instanceSection.append(t.render()),this.instances.set(t.id,t),"tab"===this.status.view&&this.status.addView(t),t.concept.notify("displayed",t.projection.element.id),this.updateActiveInstance(t),this.refresh(),this},removeInstance(t){let e=this.getInstance(t);return!(0,U.isNullOrUndefined)(e)&&(e===this.activeInstance&&(this.activeInstance=null),e.view&&(0,U.removeChildren)(e.view).remove(),this.instances.delete(t),this.refresh(),!0)},moveInstance(t,e){return this.instanceSection.children[e].before(t),this},swapInstance(t,e){let n=Array.from(this.instanceSection.children);const i=n.indexOf(t),r=n.indexOf(e);return this.moveInstance(e,i),this.moveInstance(t,r),this}},Vt={window:null,container:null,title:null,visible:!0,menu:null,header:null,body:null,btnMaximize:null,btnClose:null,size:1,fullscreen:!1,collapsed:!1,schema:null,ctype:null,get isRendered(){return(0,U.isHTMLElement)(this.container)},init(t={}){return this.ctype=(0,U.valOrDefault)(t.type,"concept"),this.schema=t,this},setTitle(t){return!(0,U.isNullOrWhitespace)(t)&&(this.title.textContent=t,!0)},collapse(){var t;return t=this.container,(0,U.isHTMLElement)(t)&&t.classList.add(P),this.collapsed=!0,this.fullscreen=!1,this.size="normal",this.refresh(),this},expand(){var t;return t=this.container,(0,U.isHTMLElement)(t)&&t.classList.remove(P),this.collapsed=!1,this.refresh(),this},changeSize(t){this.size=t,"fullscreen"===t?(this.fullscreen=!0,this.container.style.removeProperty("width"),this.container.style.removeProperty("height")):this.fullscreen=!1,this.refresh()},full(){this.size="fullscreen",this.fullscreen=!0,this.container.style.removeProperty("width"),this.container.style.removeProperty("height"),this.refresh()},show(){return B(this.container),this.visible=!0,this},hide(){return q(this.container),this.visible=!1,this},toggle(){return F(this.container),this.visible=!this.visible,this},refresh(){return this.container.dataset.size=`${this.size}`,(0,U.isNullOrUndefined)(this.projection)&&(this.body.textContent="No projection found"),Array.from(this.editor.instances).some((t=>t.fullscreen))?this.editor.instanceSection.classList.add("fullscreen"):this.editor.instanceSection.classList.remove("fullscreen"),this},render(){const t=(0,U.createDocFragment)(),{name:e}=this.concept,n=e.toLowerCase();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["editor-concept",`editor-concept--${this.ctype}`],tabindex:0,dataset:{nature:"concept-container",type:this.ctype,size:1}})),(0,U.isHTMLElement)(this.header)||(this.header=(0,U.createHeader)({title:"concept"===this.schema.type?`Instance of "${n}"`:`Linked instance of "${n}"`,class:["editor-concept-header"]}),t.append(this.header)),(0,U.isHTMLElement)(this.btnClose)||(this.btnClose=(0,U.createButton)({class:["btn","editor-concept-toolbar__btn-delete"],title:`Delete the instance "${n}"`,dataset:{action:"close",context:this.type,id:this.id}}),"projection"===this.schema.type&&(this.btnClose.title=`Close the linked instance "${n}"`)),(0,U.isHTMLElement)(this.btnMaximize)||(this.btnMaximize=(0,U.createButton)({class:["btn","editor-concept-toolbar__btn-maximize"],title:`Maximize ${e.toLowerCase()}`,dataset:{action:"maximize",context:this.type,id:this.id}})),this.title=(0,U.createH3)({class:["title","editor-concept-title","fit-content"],dataset:{nature:"editable",id:this.id}},(0,U.valOrDefault)(this.schema.title,e));let i=(0,U.createDiv)({class:["editor-concept-toolbar"]},[this.btnMaximize,this.btnClose]);return(0,U.removeChildren)(this.header).append(this.title,i),this.body&&this.body.remove(),this.projection?this.body=this.projection.render():this.body=(0,U.createParagraph)(),t.append(this.body),t.hasChildNodes()&&(this.container.appendChild(t),this.bindEvents()),this.refresh(),this.container},clear(){},actionHandler(t){switch(t){case"collapse":this.collapsed?this.expand():this.collapse();break;case"maximize":this.fullscreen?this.changeSize("normal"):this.changeSize("fullscreen");break;case"close":this.delete()}},delete(){switch(this.schema.close){case"DELETE-CONCEPT":if(!this.concept.delete(!0))return this.editor.notify("The concept could not be deleted",J.ERROR),this;break;case"DELETE-PROJECTION":if(this.projection&&!this.projection.delete())return this.notify("The projection could not be deleted",J.ERROR),this}(0,U.removeChildren)(this.container).remove(),this.editor.removeInstance(this.id),this.window&&this.window.removeInstance(this)},bindEvents(){this.container.addEventListener("focusin",(t=>{this.editor.updateActiveInstance(this)}))}};var Rt=0;const Bt={createWindow(t){let e=Object.create(qt,{id:{value:"window"+Rt++},object:{value:"environment"},name:{value:"editor-window"},type:{value:"window"},editor:{value:this}});return e.refname=t,e.init(),this.addWindow(e),e},getWindow(t){return this.windows.get(t)},findWindow(t){return Array.from(this.windows.values()).find((e=>e.refname===t))},addWindow(t){return t.isRendered||this.body.append(t.render()),this.windows.set(t.id,t),"tab"===this.status.view&&this.status.addView(t),this.refresh(),this},removeWindow(t){let e=this.getWindow(t);return!(0,U.isNullOrUndefined)(e)&&(e===this.activeWindow&&(this.activeWindow=null),e.view&&(0,U.removeChildren)(e.view).remove(),this.windows.delete(t),this.refresh(),!0)},moveWindow(t,e){return this.body.children[e].before(t),this},swapWindow(t,e){let n=Array.from(this.body.children);const i=n.indexOf(t),r=n.indexOf(e);return this.moveWindow(e,i),this.moveWindow(t,r),this}},qt={container:null,title:null,visible:!0,instances:null,menu:null,header:null,body:null,btnClose:null,maxInstance:1,get isRendered(){return(0,U.isHTMLElement)(this.container)},init(t={}){return this.ctype=(0,U.valOrDefault)(t.type,"concept"),this.schema=t,this.instances=new Set,this},isEmpty(){return 0===this.instances.size},show(){return B(this.container),this.visible=!0,this},hide(){return q(this.container),this.visible=!1,this},toggle(){return F(this.container),this.visible=!this.visible,this},close(){(0,U.removeChildren)(this.container).remove(),this.editor.removeWindow(this.id)},refresh(){return this.isEmpty()?this.hide():this.show(),this},render(){const t=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["editor-window"],tabindex:-1})),(0,U.isHTMLElement)(this.header)||(this.header=(0,U.createHeader)({class:["editor-window-header"]}),t.append(this.header)),(0,U.isHTMLElement)(this.title)||(this.title=(0,U.createH3)({class:["title","editor-window-title","fit-content"]})),(0,U.isHTMLElement)(this.btnClose)||(this.btnClose=(0,U.createButton)({class:["btn","editor-window-header__btn-delete"],title:"Close the window",dataset:{action:"close",context:this.type,id:this.id}}));let e=(0,U.createDiv)({class:["editor-window-toolbar"]},[this.btnClose]);return(0,U.removeChildren)(this.header).append(this.title,e),t.hasChildNodes()&&(this.container.appendChild(t),this.bindEvents()),this.refresh(),this.container},getInstance(t){return(0,U.isNullOrUndefined)(t)?null:Array.from(this.instances).find((e=>e.id===t))},addInstance(t){if(!(0,U.isNullOrUndefined)(t)&&!this.instances.has(t))return this.instances.add(t),t.window=this,this.container.append(t.container),this.refresh(),!0},removeInstance(t){if(!(0,U.isNullOrUndefined)(t)&&this.instances.has(t))return this.instances.delete(t),this.refresh(),!0},actionHandler(t){"close"===t&&this.close()},bindEvents(){}},Ft={schema:null,isOpen:!1,visible:!0,btnClose:null,btnExport:null,outputName:null,selector:null,init(t){return t&&(this.schema=t),this},get isRendered(){return(0,U.isHTMLElement)(this.container)},clear(){return(0,U.removeChildren)(this.logList),this},update(){},render(){const t=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["editor-exporter","hidden"]})),(0,U.isHTMLElement)(this.btnClose)||(this.btnClose=(0,U.createButton)({title:"Close window",class:["btn","btn-collapse"]}),t.append(this.btnClose));let e=(0,U.createH4)({class:["editor-exporter-title"]},"Export model");if(t.append(e),(0,U.isNullOrUndefined)(this.selector)){let e=(0,U.createParagraph)({class:["editor-exporter__instruction"]},"Select the export format");this.selector=(n=["JSON","XML"],Object.create($t).init(n)),t.append(e,this.selector.render()),this.selector.select("JSON")}var n;if(!(0,U.isHTMLElement)(this.outputName)){let e=(0,U.createLabel)({class:["editor-exporter-file__label"]}),n=(0,U.createLabel)({class:["editor-exporter-file__label-value"]},"File");this.outputName=(0,U.createInput)({placeholder:"File name",class:["editor-exporter-file__input"]}),e.append(n,this.outputName),t.append(e)}return(0,U.isHTMLElement)(this.btnExport)||(this.btnExport=(0,U.createButton)({class:["btn","btn-export"]},"Export"),t.append(this.btnExport)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this},execute(){switch(this.selector.getValue()){case"JSON":this.toJSON(this.outputName.value);break;case"XML":this.toXML(this.outputName.value)}},toXML(){const{conceptModel:t}=this.editor,e=t.toXML();this.editor.download(e,`${this.outputName.value}.xml`,"XML")},toJSON(){const{conceptModel:t,projectionModel:e}=this.editor,n=JSON.stringify({type:"model",concept:t.schema,projection:e.schema,values:t.export()});this.editor.download(n,`${this.outputName.value}.json`,"JSON")},isValid(){return!(0,U.isNullOrWhitespace)(this.outputName.value)},bindEvents(){this.btnClose.addEventListener("click",(t=>{this.close()})),this.btnExport.addEventListener("click",(t=>{if(!this.isValid())return $(this.btnExport),void this.editor.notify("Enter the file name",J.ERROR,3e3);this.execute()}))}},$t={container:null,values:null,selectors:null,selected:null,value:null,init(t){return this.values=(0,U.valOrDefault)(t,[]),this.selectors=new Map,this},getValue(){return this.value},refresh(){(0,U.isNullOrUndefined)(this.value)?this.container.classList.add("empty"):this.container.classList.remove("empty")},render(){let t=!1;return(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createUnorderedList)({class:["bare-list","export-selector"]}),t=!0),this.values.forEach((t=>{let e=this.createItem(t);this.container.append(e)})),t&&this.bindEvents(),this.container},select(t){if((0,U.isNullOrUndefined)(t))return;if(!this.selectors.has(t))return;let e=this.selectors.get(t);this.setSelectedItem(e),this.value=t,this.refresh()},createItem(t){let e=(0,U.createListItem)({class:["export-selector-item"],dataset:{value:t}}),n=(0,U.createLabel)({class:["export-selector-item__label"]}),i=(0,U.createInput)({type:"radio",name:"export-choice",value:t,class:["export-selector-item__input"]});return n.append(i,t),e.append(n),this.addItem(t,e),e},addItem(t,e){return this.selectors.set(t,e),this.refresh(),this},getItem(t){return this.selectors.get(t)},setSelectedItem(t){return!(!(0,U.isHTMLElement)(t)||t.parentElement!==this.container)&&(this.selected!==t?(this.selected&&X(this.selected),this.selected=t,Y(this.selected),!0):void 0)},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t;(0,U.isNullOrUndefined)(e.value)||this.select(e.value)}))}},Wt={container:null,isOpen:!1,visible:!0,show(){return B(this.container),this.visible=!0,this},hide(){return q(this.container),this.visible=!1,this},toggle(){return F(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this.editor.refresh(),this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this.editor.refresh(),this}};function Yt(){return Object.create(Ht,{object:{value:"environment"},name:{value:"editor-header"},editor:{value:this}})}function Xt(){return Object.create(Lt,{object:{value:"environment"},name:{value:"editor-breadcrumb"},type:{value:"breadcrumb"},editor:{value:this}})}function Gt(){return Object.assign(Object.create(Wt,{object:{value:"environment"},name:{value:"editor-home"},type:{value:"home"},editor:{value:this}}),kt)}function Jt(){return Object.create(It,{object:{value:"environment"},name:{value:"editor-status"},type:{value:"status"},editor:{value:this}})}function Zt(){return Object.assign(Object.create(Wt,{object:{value:"environment"},name:{value:"editor-log"},type:{value:"log"},editor:{value:this}}),Tt)}function Qt(){return Object.assign(Object.create(Wt,{object:{value:"environment"},name:{value:"editor-exporter"},type:{value:"exporter"},editor:{value:this}}),Ft)}const Kt={getHandlers(t){return(0,U.valOrDefault)(this.handlers.get(t),[])},triggerEvent(t,e,n=!0){const{name:i,options:r,args:s}=t,a=this.getHandlers(i),o=(0,U.isFunction)(e);let l=!1;return a.forEach((t=>{let i=t.call(this,s,r);!1!==i?n&&o&&e.call(this,i):l=!0})),!l&&(!n&&o&&e.call(this),!0)},registerHandler(t,e){return this.hasHanlder(t)||this.handlers.set(t,[]),this.handlers.get(t).push(e),!0},unregisterHandler(t,e){if(!this.hasHanlder(t))return!1;let n=this.getHandlers(t);for(let t=0;t<n.length;t++)if(n[t]===e)return n.splice(t,1),!0;return!1},hasHanlder(t){return this.handlers.has(t)},registerReceiver(t,e){(0,U.isNullOrUndefined)(this.activeReceiver[e])&&(this.activeReceiver[e]=t),(0,U.isNullOrUndefined)(this.receivers[e])&&(this.receivers[e]={root:t,projections:[]},t.isRoot=!0),this.receivers[e].projections.push(t)},saturationRevolved(t,e){let n,i=this.receivers[e].projections;for(let e=0;e<i.length;e++)t.id===i[e].id&&(n=e);if(n>=i.length)return void this.setActiveReceiver(t,e);let r=i[n+1].transmitFirst();t.acceptAnchor(r)},getActiveReceiver(t){return this.activeReceiver[t]},setActiveReceiver(t,e){this.activeReceiver[e]=t},getRootReceiver(t){return this.receivers[t].root},findReceiverInstance(t,e){let n=this.receivers[e].projections;for(let e=0;e<n.length;e++){let i=n[e].instances.get(t);if((0,U.isHTMLElement)(i))return{container:n[e],instance:i}}alert("Not Found")}},te={create(t,e){const n=Object.create(this);return n.concept=t,n.schema=e,n},model:null,schema:null,source:null,id:null,value:null,object:"structure",init(t){throw new Error("This function has not been implemented")}};Object.defineProperty(te,"model",{get(){return this.concept.model}}),Object.defineProperty(te,"name",{get(){return this.schema.name}}),Object.defineProperty(te,"required",{get(){return(0,U.valOrDefault)(this.schema.required,!0)}});const ee={object:"attribute",target:null,init(t){return this.target=this.model.createConcept(this.schema.target,{value:(0,U.valOrDefault)(t,this.schema.value),parent:this.concept,ref:this}),this},getValue(){return this.target.getValue()},hasValue(){return this.target.hasValue()},setValue(t){this.target.setValue(t)},getTarget(){return this.target},copy(){return this.target.hasValue()?this.target.copy(!1):null},clone(){return this.target.hasValue()?this.target.clone():null},export(){return this.target.hasValue()?{id:this.target.id,name:this.target.name}:null},toString(){return{[`attribute.${this.name}`]:this.target.toString()}},toXML(){return this.target.hasValue()?this.target.toXML():""}},ne=Object.assign(Object.create(te),ee),ie={attributes:null,attributes_created:null,initAttribute(){return this.attributes=[],this.attributes_created=new Set,this.attributes_updated=new Set,this.attributes_deleted=new Set,Array.isArray(this.attributeSchema)&&this.attributeSchema.filter((t=>(0,U.valOrDefault)(t.required,!0))).forEach((t=>this.createAttribute(t.name))),this},getAttributes(){return this.attributes},getAttribute(t){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad argument");return this.getAttributeByName(t)},getAttributeSchema(t){if((0,U.isNullOrWhitespace)(t))throw new TypeError("Bad argument");if(!this.hasAttribute(t))throw new Error(`Attribute '${t}' does not exist`);return(0,U.cloneObject)(this.attributeSchema.find((e=>e.name===t)))},getAttributeByName(t){if((0,U.isNullOrWhitespace)(t))throw new TypeError("Bad argument");var e=this.attributes.find((e=>e.name===t));return(0,U.isNullOrUndefined)(e)&&(e=this.createAttribute(t)),e},createAttribute(t,e){if(!this.hasAttribute(t))throw new Error(`Attribute not found: The concept '${this.name}' does not contain an attribute named '${t}'`);if(this.isAttributeCreated(t)){let n=this.getAttributeByName(t);if(e){let t=this.model.getValue(e);n.target.initValue(t)}return n}const n=this.getAttributeSchema(t);let i=this.model.getValue(e);var r=ne.create(this,n).init(i);return this.addAttribute(r),r},addAttribute(t){if((0,U.isNullOrUndefined)(t)||"attribute"!==t.object)throw new Error("Bad argument: 'attribute' must be an attribute object");return this.attributes.push(t),this.attributes_created.add(t.name),this.notify("attribute.added",t),this},hasAttributes(){return!(0,U.isEmpty)(this.attributeSchema)||!(0,U.isEmpty)(this.attributes)},hasAttribute(t){return-1!==this.attributeSchema.findIndex((e=>e.name===t))},isAttributeRequired(t){const e=this.getAttributeSchema(t);return(0,U.valOrDefault)(e.required,!0)},isAttributeCreated(t){return this.attributes_created.has(t)},listAttributes(){const t=[];return this.attributeSchema.forEach((e=>{t.push({type:"attribute",name:e.name,target:e.target,accept:e.accept,required:this.isAttributeRequired(name),created:this.isAttributeCreated(name)})})),t},removeAttribute(t){if(this.isAttributeRequired(t))return{message:`The attribute '${t}' is required.`,success:!1};var e=this.attributes.findIndex((e=>e.name===t));if(-1===e)return{message:`The attribute '${t}' was not found.`,success:!1};var n=this.attributes.splice(e,1)[0];return this.attributes_created.delete(t),this.notify("attribute.removed",n),{message:`The attribute '${t}' was successfully removed.`,success:!0}}},re={listeners:null,initObserver(){return this.listeners=[],this},register(t){return this.listeners.includes(t)||this.listeners.push(t),!0},unregister(t){var e=this.listeners.indexOf(t);return-1!==e&&(this.listeners.splice(e,1),!0)},unregisterAll(){this.listeners=[]},notify(t,e){this.listeners.forEach((n=>{n.update(t,e,this)}))}},se={model:null,schema:null,source:null,id:null,name:null,ref:null,actions:null,operations:null,accept:null,parent:null,references:null,errors:null,value:null,values:null,action:null,shadows:null,watchers:null,kind:"concept",init(t={}){return this.accept=t.accept,this.parent=t.parent,this.ref=t.ref,this.properties=(0,U.valOrDefault)(this.schema.properties,[]),Array.isArray(t.properties)&&this.properties.push(...t.properties),this.default=(0,U.valOrDefault)(this.schema.default,null),this.values=(0,U.valOrDefault)(t.values,(0,U.valOrDefault)(this.schema.values,[])),this.src=(0,U.valOrDefault)(this.schema.src,[]),this.constraint=this.schema.constraint,this.watchers=new Map,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},isRoot(){return(0,U.isNullOrUndefined)(this.parent)},initValue(){throw new Error("This function has not been implemented")},getName(){return this.ref&&"attribute"===this.ref.object?this.ref.name:this.name},getCandidates(){return this.values.forEach((t=>{(0,U.isObject)(t)&&(t.type="value")})),this.values},getStructure(){return[...this.listAttributes()]},getProperty(t,e){if("refname"===t){if((0,U.isNullOrUndefined)(this.ref))return;return this.ref.name}if("name"===t)return this.name;if("value"===t)return this.value;if(!this.hasProperty(t))return;let n=this.properties.find((e=>e.name===t));const{type:i,value:r}=n;return"string"===i?ae.call(this,r):"number"===i?+r:"boolean"===i?(0,U.toBoolean)(r):r},hasProperty(t){return!!["refname","name","value"].includes(t)||-1!==(0,U.valOrDefault)(this.schema.properties,[]).findIndex((e=>e.name===t))},getConstraint(t){if(this.hasConstraint(t))return this.constraint[t]},hasConstraint(t){return!(0,U.isNullOrUndefined)(this.constraint)&&(!!(0,U.isNullOrUndefined)(t)||(0,U.hasOwn)(this.constraint,t))},hasParent(){return!this.isRoot()},getParent(t){if(this.isRoot())return null;if((0,U.isNullOrWhitespace)(t))return this.parent;const e=this.parent;return e.name===t?e:e.getParent(t)},getParentWith(t){if(this.isRoot())return null;if((0,U.isNullOrWhitespace)(t))return this.parent;const e=this.parent;return e.hasPrototype(t)?e:e.getParentWith(t)},getPrototype(){return(0,U.isNullOrUndefined)(this.prototype)?null:this.prototype},hasPrototype(t){if((0,U.isNullOrUndefined)(this.schema.prototype))return!1;if((0,U.isNullOrUndefined)(t))return!0;let e=this.model.getConceptSchema(this.schema.prototype);for(;!(0,U.isNullOrUndefined)(e);){if(e.name===t)return!0;e=this.model.getConceptSchema(e.prototype)}return!1},getAncestor(t){const e=[];for(var n=this.getParent(t);n;)e.push(n),n=n.getParent(t);return e},getChildren(t){const e=[];return(0,U.isNullOrUndefined)(t)?this.getAttributes().forEach((t=>{e.push(t.target)})):this.getAttributes().forEach((n=>{n.target.name===t?e.push(n.target):e.push(...n.target.getChildren(t))})),e},getDescendant(t){const e=[];return this.getChildren(t).forEach((n=>{e.push(n),e.push(...n.getDescendant(t))})),e},propagate(t,e,n){this.watchers.has(t)&&this.signal(t,e,n),this.hasParent()&&this.getParent().propagate(t,e,n)},watch(t,e){this.watchers.has(t)||this.watchers.set(t,[]),this.watchers.get(t).push(e)},signal(t,e,n){this.watchers.has(t)&&this.watchers.get(t).forEach((t=>t(e,n)))},unwatch(t,e){if((0,U.isNullOrUndefined)(t)||!this.watchers.has(t))return!1;if(!(0,U.isFunction)(e))return this.watchers.delete(t),!0;let n=this.watchers.get(t).findIndex((t=>t===e));return-1!==n&&(this.watchers.splice(n,1),!0)},done(){this.unregisterAll(),this.watchers.clear()},delete(t=!1){if(!t){const{object:t}=this.ref;let e={success:!0};if("concept"===t?e=this.getParent().removeValue(this):"attribute"===t&&(e=this.getParent().removeAttribute(this.ref.name)),!e.success)return e}this.getChildren().forEach((t=>{t&&t.delete(!0)}));try{this.notify("delete"),this.model.removeConcept(this.id),this.notify("delete")}catch(t){return console.error(this),{message:"Concept not found",success:!1}}return{message:`The concept '${this.name}' was successfully deleted.`,success:!0}},copy(t=!0){const e={name:this.name,nature:this.nature};var n=[];return this.getAttributes().forEach((t=>{n.push({name:t.name,value:t.copy(!1)})})),e.attributes=n,t&&this.model.addValue(e),e},clone(){const t={id:this.id,name:this.name};var e=[];return this.getAttributes().forEach((t=>{e.push({name:t.name,value:t.clone()})})),t.attributes=e,t},export(){const t={id:this.id,root:this.isRoot(),name:this.name};var e=[];return this.getAttributes().forEach((t=>{e.push({name:t.name,value:t.export()})})),t.force=this.force,t.attributes=e,t},toString(){var t={};return this.attributes.forEach((e=>{Object.assign(t,e.toString())})),t},toXML(){let t=this.getName().replace(" ","-");return`<${t} id="${this.id}">`+this.attributes.map((t=>t.toXML())).join("")+`</${t}>`},toXMI(){let t=this.getName().replace(" ","-");return`<${t} id="${this.id}">`+this.attributes.map((t=>t.toXML())).join("")+`</${t}>`}};function ae(t){if((0,U.isString)(t))return t;const{type:e}=t;return"concat"===e?le.call(this,t.concat):void 0}function oe(t,e){const{type:n}=t;return"string"===n?ae.call(this,t.value):"property"===n?this.getProperty(t.name):e||t}function le(t,e=""){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");return t.length<2?oe.call(this,t[0]):t.map((t=>oe.call(this,t))).join(e)}const ce=Object.assign(se,re,ie);Object.defineProperty(ce,"attributeSchema",{get(){return this.schema.attributes}}),Object.defineProperty(ce,"_prototype",{get(){return this.schema.prototype}}),Object.defineProperty(ce,"hasError",{get(){return this.errors&&!(0,U.isEmpty)(this.errors)}});const he={nature:"primitive",init(t={}){return this.parent=t.parent,this.ref=t.ref,this.default=(0,U.valOrDefault)(this.schema.default,!0),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){if((0,U.isNullOrUndefined)(t))return this.value=this.default,this;if((0,U.isObject)(t)){const{id:e="",value:n}=t;e.length>10&&(this.id=e),this.setValue(n)}else this.setValue(t);return this},hasValue(){return!(0,U.isNullOrUndefined)(this.value)},getValue(){return this.value},setValue(t){let e=(0,U.isObject)(t)?t.value:t;return 200!==this.validate(e)?{success:!1,message:"Validation failed: The value could not be updated."}:(this.value=(0,U.toBoolean)(e),this.notify("value.changed",e),{success:!0,message:"The value has been successfully updated."})},restore(t){const{value:e}=t;this.setValue(e)},update:(t,e)=>!0,getCandidates:()=>[!0,!1],getChildren:t=>[],validate(t){return this.errors=[],(0,U.isString)(t)&&["true","false"].includes(t.toLowerCase())||Number.isInteger(t)&&[1,0].includes(t)||[!0,!1].includes(t)?200:400},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}},ue=Object.assign(Object.create(ce),he);function de(t,e){switch(t){case 400:return{success:!1,message:"The value is not a number."};case 401:return{success:!1,message:`Valid values: ${e}`};case 403:return{success:!1,message:`Maximum allowed: ${e.value}.`};case 402:return{success:!1,message:`Minimum allowed: ${e.value}.`};case 404:return{success:!1,message:`Value allowed: ${e.value}.`}}}const pe={nature:"primitive",initValue(t){if((0,U.isNullOrUndefined)(t))return this.value=this.default,this;if((0,U.isObject)(t)){const{id:e="",value:n}=t;e.length>10&&(this.id=e),this.setValue(n)}else this.setValue(t);return this},hasValue(){return"number"==typeof this.value&&!isNaN(this.value)},getValue(){return this.hasValue()?+this.value:null},setValue(t){let e=(0,U.isObject)(t)?t.value:t;const{code:n,ctx:i}=this.validate(e);return this.value!==e&&(this.value=(0,U.isNullOrWhitespace)(e)?null:+e,this.notify("value.changed",e),this.propagate("value.changed",e,this)),200!==n?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},restore(t){const{value:e}=t;this.setValue(e)},getCandidates(){return this.values.forEach((t=>{(0,U.isObject)(t)&&(t.type="value")})),this.values},getChildren:t=>[],update:(t,e)=>!0,validate(t){if(this.errors=[],isNaN(t)){let t=400;return this.errors.push(de.call(this,t).message),{code:t}}if(!this.hasConstraint())return{code:200};if(this.hasConstraint("value")){let e=this.getConstraint("value");const{type:n}=e;if("range"===n){const{min:i,max:r}=e[n];if(i&&+t<i.value){let t=402;return this.errors.push(de.call(this,t,i).message),{code:t,ctx:i}}if(r&&+t>r.value){let t=403;return this.errors.push(de.call(this,t,r).message),{code:t,ctx:r}}}else if("fixed"===n){const{value:i}=e[n];if(t!==i){let t=404;return this.errors.push(de.call(this,t,e[n]).message),{code:t,ctx:e[n]}}}}if(this.hasConstraint("values")){let e=this.getConstraint("values").map((t=>fe.call(this,t))).flat(),n=!1;for(let i=0;!n&&i<e.length;i++){const r=e[i];n=(0,U.isObject)(r)?r.value===t:r===t}if(!n){let t=401;return this.errors.push(de.call(this,t,e).message),{code:t,ctx:e}}}return{code:200}},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}};function fe(t){if("reference"===t.type){let t=[];return this.model.isPrototype("model concept")&&(t=this.model.getConceptsByPrototype("model concept")),t.map((t=>t.getChildren(this.name))).flat().map((t=>t.value))}return t}const me=Object.assign(Object.create(ce),pe),ge={nature:"primitive",reference:null,path:null,init(t={}){return this.parent=t.parent,this.ref=t.ref,this.accept=this.schema.accept,this.path=this.schema.path,this.values=(0,U.valOrDefault)(this.schema.values,[]),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){return(0,U.isNullOrUndefined)(t)||this.setValue(t.value),this},restore(t){const{value:e}=t;this.setValue(e)},hasValue(){return!(0,U.isNullOrWhitespace)(this.value)},getValue(t=!1){return(0,U.isNullOrUndefined)(this.value)?null:t?this.reference:this.value},removeValue(){return this.reference&&this.reference.unregister(this),this.reference=null,this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},getReference(){return(0,U.isNullOrUndefined)(this.reference)?null:this.reference},setValue(t,e=!0){let n=(0,U.isObject)(t)?t.id:t;return 200!==this.validate(n)?{success:!1,message:"Validation failed: The value could not be updated."}:(0,U.isNullOrUndefined)(n)||this.value===n?{success:!0,message:"The value has been ignored."}:(this.reference&&this.reference.unregister(this),this.value=n,this.reference=this.model.getConcept(n),(0,U.isNullOrUndefined)(this.reference)&&e?setTimeout((()=>this.setValue(t,!1)),20):(this.reference.register(this),this.notify("value.changed",this.reference)),{success:!0,message:"The value has been successfully updated."})},getCandidates(){if((0,U.isNullOrUndefined)(this.accept))throw new Error("Bad reference: 'accept' property is not defined");var t=be.call(this,this.accept);return this.path&&ve(this,this.path).map((t=>({type:this.accept.type,value:t}))),t},getChildren(t){return(0,U.isNullOrUndefined)(this.reference)||t&&this.reference.name!==t?[]:[this.reference]},delete(t=!1){if(!t){const{object:t}=this.ref;let e={success:!0};if("concept"===t?e=this.getParent().removeValue(this):"attribute"===t&&(e=this.getParent().removeAttribute(this.ref.name)),!e.success)return e}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(t,e){switch(t){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference);break;case"value.changed":this.setValue(this.value)}return!0},validate(t){return this.errors=[],(0,U.isNullOrUndefined)(t)||this.model.hasConcept(t)?200:(this.errors.push("This element is not valid"),401)},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){var t=[];return this.value.forEach((e=>{t.push(e.toString())})),t},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}};function be(t){const{name:e,scope:n,rel:i}=t;return"parent"===i?this.getParent(n).getChildren(e):"children"===i?this.getChildren(e):this.model.isPrototype(e)?this.model.getConceptsByPrototype(e):this.model.getConcepts(e)}function ve(t,e){if((0,U.isNullOrUndefined)(e))return t;const{target:n,value:i,rel:r}=e;var s=[];return"parent"===r?s.push(t.getParentWith(n)):"children"===r?s.push(...t.getChildren(n)):"property"===r&&s.push(t.getProperty(n)),s.map((t=>ve(t,i))).flat()}const ye=Object.assign({},ce,ge),xe={SUCCESS:200,INVALID_VALUE:401,MIN_CARDINALITY_ERROR:402,MAX_CARDINALITY_ERROR:403,FIX_CARDINALITY_ERROR:404};function we(t,e){switch(t){case xe.INVALID_VALUE:return{success:!1,message:`Valid values: ${e}`};case xe.MAX_CARDINALITY_ERROR:return{success:!1,message:`Maximum cardinality: ${this.value.length}/${e.value}.`};case xe.MIN_CARDINALITY_ERROR:return{success:!1,message:`Minimum cardinality: ${this.value.length}/${e.value}.`};case xe.FIX_CARDINALITY_ERROR:return{success:!1,message:`Fixed cardinality: ${e.value}.`};case xe.PATTERN_ERROR:return{success:!1,message:"The value is not valid."}}}const Ee={nature:"primitive",init(t={}){return this.parent=t.parent,this.ref=t.ref,this.accept=this.schema.accept,this.ordered=(0,U.valOrDefault)(this.schema.ordered,!0),this.constraint=this.schema.constraint,this.watchers=new Map,this.value=[],this.initObserver(),this.initAttribute(),this.initValue(t),this},initValue(t){this.removeAllElement();let e=Ae.call(this);if((0,U.isNullOrUndefined)(t)){let t=e;for(let e=0;e<t;e++)this.createElement();return this}const{id:n="",name:i,value:r=[]}=t;n.length>10&&(this.id=n);for(let t=0;t<r.length;t++)this.createElement(r[t]);let s=e-r.length;for(let t=0;t<s;t++)this.createElement();return this},hasValue(){return!(0,U.isEmpty)(this.value)},getValue(t=!1){const e=this.value.map((t=>this.model.getConcept(t)));return t?e.map((t=>t.getValue())):e},removeValue(t){return this.hasValue()?(this.removeElement(t),{success:!0,message:"The value has been successfully updated."}):{success:!0,message:"The value has been successfully updated."}},isValidElement(t){const{name:e,accept:n}=this.accept;return this.model.isPrototype(e)?(0,U.isNullOrUndefined)(n)?this.model.hasPrototype(t.name,e):Array.isArray(n)?n.some((e=>e.name===t.name)):n.name===t.name:this.accept.name===t.name},setValue(t){let e=t.value||t;if(Array.isArray(e)){this.removeAllElement();for(let t=0;t<e.length;t++)this.createElement(e[t])}else this.isValidElement(e)&&this.createElement(e)},restore(t){const{value:e}=t;e.forEach(((t,e)=>{this.value.includes(t.id)||this.createElement(t)}))},getElements(){return this.value.map((t=>this.model.getConcept(t)))},getElement(t){var e=this.value.find((e=>e===t));if(!(0,U.isNullOrUndefined)(e))return this.model.getConcept(e)},getElementAt(t){if(!(t<0||t>=this.value.length))return this.model.getConcept(this.value[t])},getFirstElement(){return this.getElementAt(0)},getLastElement(){return this.getElementAt(this.count-1)},addElement(t){return!(0,U.isNullOrUndefined)(t)&&(this.value.push(t.id),t.index=this.value.length-1,t.parent=this,t.ref=this,this.validate(),this.notify("value.added",t),this.propagate("value.changed",t,this),!0)},addElementAt(t,e=0){return(0,U.isNullOrUndefined)(t)&&(t=this.createElement()),this.value.splice(e,0,t.id),this.validate(),this.notify("value.added",t),this.propagate("value.changed",t,this),this},swapElement(t,e){if(!this.ordered)return this;let n=this.value[t];this.value[t]=this.value[e],this.value[e]=n;let i=this.getElementAt(t);i.index=+t;let r=this.getElementAt(e);return r.index=+e,this.notify("value.swapped",[i,r]),this},removeElement(t){let e=(0,U.valOrDefault)(t.index,this.value.indexOf(t.id));return-1!==e&&this.removeElementAt(e)},removeElementAt(t){let e=this.getElementAt(t);if((0,U.isNullOrUndefined)(e))return{message:`The element at index '${t}' was not found.`,success:!1};e.delete(!0),this.value.splice(t,1);const n=this.getValue();for(let e=t;e<n.length;e++)n[e].index=e;return this.validate(),this.notify("value.removed",e),this.propagate("value.changed",e,this),{message:`The element '${e.name}' was successfully removed.`,success:!0}},removeAllElement(){return this.value.forEach((t=>{this.model.removeConcept(t)})),this.value=[],this.notify("value.changed",this.value),this.propagate("value.changed",this.value,this),this},createElement(t){const e={value:this.model.getValue(t),parent:this,ref:this},n=this.model.createConcept(this.accept,e);return this.addElement(n),n},getProperty(t,e){if("refname"===t)return this.ref.name;if("name"===t)return this.name;if("value"===t)return this.value;if("length"===t||"cardinality"===t)return this.value.length;let n=this.properties.find((e=>e.name===t));if((0,U.isNullOrUndefined)(n))return;const{type:i,value:r}=n;return"string"===i?r:"number"===i?+r:"boolean"===i?(0,U.toBoolean)(r):r},hasProperty(t){return!!["refname","name","value","length","cardinality"].includes(t)||-1!==this.properties.findIndex((e=>e.name===t))},getCandidates(){return Ne.call(this,this.accept)},getChildren(t){if(!this.hasValue())return[];const e=this.getElements();return(0,U.isNullOrUndefined)(t)?e:e.filter((e=>e.name===t))},validate(){if(this.errors=[],!this.hasConstraint())return{code:xe.SUCCESS};if(this.hasConstraint("cardinality")){let t=this.getConstraint("cardinality");const{type:e}=t;if("range"===e){const{min:n,max:i}=t[e];if(n&&this.value.length<n.value){let t=xe.MIN_CARDINALITY_ERROR;return this.errors.push(we.call(this,t,n).message),{code:t,ctx:n}}if(i&&this.value.length>i.value){let t=xe.MAX_CARDINALITY_ERROR;return this.errors.push(we.call(this,t,i).message),{code:t,ctx:i}}}else if("fixed"===e){const{value:n}=t[e];if(this.value.length!==n){let n=xe.FIX_CARDINALITY_ERROR;return this.errors.push(we.call(this,n,t[e]).message),{code:n,ctx:t[e]}}}}return{code:xe.SUCCESS}},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue().map((t=>t.copy(!1)))};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue().map((t=>t.clone()))}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.value}},toString(){return this.getValue().map((t=>t.toString()))},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue().map((t=>t.toXML())).join("")+`</${t}>`}};function Ae(){if(!this.hasConstraint("cardinality"))return 0;const t=this.getConstraint("cardinality"),{type:e}=t;if("range"===e){const{min:n}=t[e];return n.value}if("fixed"===e){const{value:n}=t[e];return n}return 0}function Ne(t){return this.model.getConceptSchema(t)}const Oe=Object.assign(Object.create(ce),Ee);Object.defineProperty(Oe,"count",{get(){return this.value.length}}),Object.defineProperty(Oe,"canAddValue",{get:()=>!0});const ke=200,_e=405;function je(t,e){switch(t){case 401:return{success:!1,message:`Valid values: ${e}`};case 403:return{success:!1,message:`Maximum length: ${e.value}.`};case 402:return{success:!1,message:`Minimum length: ${e.value}.`};case 404:return{success:!1,message:`Fixed length: ${e.value}.`};case _e:return{success:!1,message:"The value is not valid."};case 406:return{success:!1,message:"The value is already used."}}}const Me={nature:"primitive",initValue(t){if((0,U.isNullOrUndefined)(t))return this.value=this.default,this;if((0,U.isObject)(t)){const{id:e="",value:n}=t;e.length>10&&(this.id=e),this.setValue(n)}else this.setValue(t);return this},restore(t){const{value:e}=t;this.setValue(e)},hasValue(){return!(0,U.isNullOrWhitespace)(this.value)},getValue(){return this.value},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},setValue(t){let e=(0,U.isObject)(t)?t.value:t;var{code:n,ctx:i}=this.validate(e);return this.value!==e&&(this.value=e,this.notify("value.changed",e),this.propagate("value.changed",e,this)),n!==ke?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},getProperty(t,e){if("refname"===t)return this.ref.name;if("name"===t)return this.name;if("value"===t)return this.value;if("length"===t)return this.value.length;let n=this.properties.find((e=>e.name===t));if((0,U.isNullOrUndefined)(n))return;const{type:i,value:r}=n;return"string"===i?r:"number"===i?+r:"boolean"===i?(0,U.toBoolean)(r):r},hasProperty(t){return!!["refname","name","value","length"].includes(t)||-1!==this.properties.findIndex((e=>e.name===t))},getCandidates(){let t=(0,U.valOrDefault)(this.getConstraint("values"),[]);return(0,U.isEmpty)(t)?[...this.src.map((t=>{if("reference"===t.type){const{source:e,target:n}=t;let i=this.model.environment.getModel(e.name||e);if((0,U.isNullOrUndefined)(i))return null;let r=i.concept||i;if(!Array.isArray(r))return null;if(r.forEach((t=>{const e=function(t,e){var n=e;const i=[],r=e=>{let n=t.find((t=>t.name===e));if(!(0,U.isNullOrUndefined)(n))return gt(n)};for(;!(0,U.isNullOrUndefined)(n);){const t=(0,U.valOrDefault)(r(n),{});s=t.attributes,Array.isArray(s)&&s.forEach((t=>{const e=i.find((e=>e.name===t.name));(0,U.isNullOrUndefined)(e)?i.push(t):t.required&&(e.required=t.required)})),n=t.prototype}var s;return{attributes:i}}(r,t.prototype);t.attributes.push(...e.attributes)})),(0,U.isNullOrUndefined)(n.rel))return r.map((t=>t[n.value]));let s=Se.call(this,n,r);return(0,U.isNullOrUndefined)(s)?[]:s}if("concept"===t.type){const{concept:e,value:n}=t;let i=this.model.getConceptsByPrototype(e.prototype);return"attribute"===n.type?i.map((t=>t.getAttribute(n.name).getValue())):[]}return t}))].flat().filter((t=>!(0,U.isNullOrUndefined)(t))):t.map((t=>Ce.call(this,t))).flat().filter((t=>!(0,U.isNullOrWhitespace)(t)))},getChildren:t=>[],update:(t,e)=>!0,validate(t){if(this.errors=[],(0,U.isNullOrWhitespace)(t))return{code:ke};if(!this.hasConstraint())return{code:ke};if(this.hasConstraint("length")){let e=this.getConstraint("length");const{type:n}=e;if("range"===n){const{min:i,max:r}=e[n];if(i&&t.length<i.value){let t=402;return this.errors.push(je.call(this,t,i).message),{code:t,ctx:i}}if(r&&t.length>r.value){let t=403;return this.errors.push(je.call(this,t,r).message),{code:t,ctx:r}}}else if("fixed"===n){const{value:i}=e[n];if(t.length!==i){let t=404;return this.errors.push(je.call(this,t,e[n]).message),{code:t,ctx:e[n]}}}}if(this.hasConstraint("value")){let e=this.getConstraint("value");const{type:n}=e;if("pattern"===n){const{value:n,insensitive:i=!0,global:r=!0}=e.pattern;let s="";if(i&&(s+="g"),r&&(s+="i"),!new RegExp(n,s).test(t)){let t=_e;return this.errors.push(je.call(this,t,e.pattern).message),{code:t,ctx:e.pattern}}}else if(n==="match".startsWith){const{start:i,end:r}=e[n];if(i&&!t.startsWith<i.value){let t=_e;return this.errors.push(je.call(this,t,e.match).message),{code:t,ctx:e.match}}if(r&&t.length>r.value){let t=_e;return this.errors.push(je.call(this,t,e.match).message),{code:t,ctx:e.match}}}else if("unique"===n){const{rel:n="parent",prototype:i}=e.unique;let r=this.getParent(),s=[];if(i?(r.hasPrototype()||(s=[]),s=this.model.getConceptsByPrototype(r._prototype)):s=this.model.getConcepts(r.name),s.some((e=>e!==r&&Te(e,this.ref.name)===t))){let t=406;return this.errors.push(je.call(this,t,e.unique).message),{code:t,ctx:e.unique}}}}if(this.hasConstraint("values")){let e=this.getConstraint("values").map((t=>Ce.call(this,t))).flat(),n=!1;for(let i=0;!n&&i<e.length;i++){const r=e[i];n=(0,U.isObject)(r)?r.value===t:r===t}if(!n){let t=401;return this.errors.push(je.call(this,t,e).message),{code:t,ctx:e}}}return{code:ke}},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}};function Ce(t){if("reference"===t.type){let t=[];return this.model.isPrototype("model concept")&&(t=this.model.getConceptsByPrototype("model concept")),t.map((t=>t.getChildren(this.name))).flat().map((t=>t.value))}if("meta-reference"===t.type){let t=[];return this.model.isPrototype("model concept")&&(t=this.model.getConceptsByPrototype("model concept")),t.map((t=>t.getChildren(this.name))).flat().map((t=>t.value))}return t}function Se(t,e){const{name:n,rel:i,scope:r,value:s}=t;let a=null;if("parent"===i){let t=this.getParent(n);if((0,U.isNullOrUndefined)(s))return t;if("reference"===s.type)return Se.call(t,s);if("attribute"===s.type)return t.getAttributeByName(s.name).getValue()}if("children"===i){let t=this.getChildren(n);if((0,U.isNullOrUndefined)(s))return t;if("reference"===s.type)return t.map((t=>Se.call(t,s)));if("attribute"===s.type)return t.filter((t=>Ue(t,s.name)&&Ie(t,s.name))).map((t=>Te(t,s.name)))}if(t.source){const{type:e,value:n}=t.source;a="reference"===e?Se.call(this,t.source):n}if((0,U.isNullOrUndefined)(a))return e.map((t=>t[n].map((t=>t[s]))));if((0,U.isIterable)(a)&&(0,U.isEmpty)(a))return[];let o=e.find((t=>Array.isArray(a)?a.includes(t.name):t.name===a));return(0,U.isNullOrUndefined)(o)||!(0,U.hasOwn)(o,n)?[]:o[n].map((t=>t[s]))}const Le=(t,e)=>t.getAttributeByName(e).target,Te=(t,e)=>Le(t,e).getValue(),Ie=(t,e)=>Le(t,e).hasValue(),Ue=(t,e)=>t.isAttributeCreated(e),De=Object.assign(Object.create(ce),Me),He={nature:"concrete",initValue(t){if((0,U.isNullOrUndefined)(t))return!1;const{id:e="",attributes:n=[]}=t;return e.length>10&&(this.id=e),n.forEach((t=>{const{name:e,id:n,value:i}=t;this.createAttribute(e,i)})),!0},restore(t){const{attributes:e}=t;e.forEach((t=>{const{name:e,id:n,value:i}=t;this.isAttributeCreated(e)||this.createAttribute(e,i)}))},hasValue:()=>!0,getValue(){return{name:this.name,attributes:this.getAttributes().map((t=>({name:t.name,value:t.copy(!1)})))}},setValue(t){const{attributes:e=[]}=t;return e.forEach((t=>{const{name:e,id:n,value:i}=t;this.hasAttribute(e)&&this.createAttribute(e,i)})),!0}},Pe=Object.assign(Object.create(ce),He),ze=200;function Ve(t){if(401===t)return{success:!1,message:"The value is not included in the list of valid values."}}const Re={name:"prototype",nature:"prototype",initValue(t){if((0,U.isNullOrUndefined)(t)){if(this.default){let t=this.createConcept(this.default);this.setValue(t)}return this}const{id:e="",value:n}=t;e.length>10&&(this.id=e);let i=null;return n?(i=this.createConcept(n.name,n),this.setValue(i)):t.name&&t.attributes&&(i=this.createConcept(t.name,t),this.setValue(i)),this},getValue(t=!1){return(0,U.isNullOrUndefined)(this.value)?null:t?this.target:this.value},getTarget(){return this.target},restore(t){const{value:e}=t;if((0,U.isNullOrUndefined)(e))return;let n=this.createConcept(e.name,e);this.setValue(n)},setValue(t){let e=t.name||t;if(this.validate(e)!==ze)return{success:!1,message:"Validation failed: The value could not be updated."};let n=t;if(t&&"concept"===t.object&&(0,U.hasOwn)(t,"id")||(n=t.attributes?this.createConcept(e,t):this.createConcept(e)),this.target){let t=this.target.copy(!1);this.target.delete(!0),n.setValue(t)}return this.target=n,this.value=e,this.notify("value.changed",this.getCandidates().find((t=>t.name===this.value))),this.propagate("value.changed",e,this),{success:!0,message:"The value has been successfully updated."}},removeValue(){return(0,U.isNullOrUndefined)(this.value)||(this.value=null,this.notify("value.changed",this.value)),{success:!0,message:"The value has been successfully updated."}},hasValue(){return!(0,U.isNullOrUndefined)(this.value)},getCandidates(){return this.candidates||(this.candidates=Be.call(this,this.schema.accept).map((t=>({type:"meta-concept",name:t.name,concept:Object.create(qe,{object:{value:"meta-concept"},type:{value:"meta-concept"},name:{value:t.name},model:{value:this.model},schema:{value:t}})})))),this.candidates},getChildren(t){if(!this.hasValue())return[];const e=[];return((0,U.isNullOrUndefined)(t)||this.target.name===t)&&e.push(this.target),e},createConcept(t,e){let n=this.model.getValue(e);const i={parent:this,ref:this};n&&(i.value=n);const r=this.model.createConcept(t,i);return r.prototype=this,r},validate(t){if((0,U.isNullOrWhitespace)(t))return ze;if((0,U.isEmpty)(this.values))return ze;var e=!1;for(let n=0;!e&&n<this.values.length;n++){const i=this.values[n];e=(0,U.isObject)(i)?i.value===t:i===t}if(!e){let t=401;return this.errors.push(Ve.call(this,t).message),t}return ze},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.target.copy(!1)};return t&&this.model.addValue(e),e},clone(){let t=null;return this.hasValue()&&(t=this.target.clone()),{id:this.id,name:this.name,value:t}},export(){let t=null;return this.hasValue()&&(t={id:this.target.id,name:this.target.name}),{id:this.id,name:this.name,root:this.isRoot(),value:t}},toXML(){if(!this.hasValue())return"";let t=this.getName();return`<${t} id="${this.id}">`+this.target.attributes.map((t=>t.toXML())).join("")+`</${t}>`}};function Be(t){const e=this.model.getConcreteConcepts(this.name);return(0,U.isNullOrUndefined)(t)?e:Array.isArray(t)?e.filter((e=>t.some((t=>t.name===e.name)))):e.filter((e=>t===e.name))}const qe={getProperty(t,e){if("refname"===t)return this.name;if("name"===t)return this.name;let n=this.properties.find((e=>e.name===t));if((0,U.isNullOrUndefined)(n))return;const{type:i,value:r}=n;return"string"===i?r:"number"===i?+r:"boolean"===i?(0,U.toBoolean)(r):r},hasPrototype(t){if((0,U.isNullOrUndefined)(this.schema.prototype))return!1;let e=this.model.getConceptSchema(this.schema.prototype);for(;!(0,U.isNullOrUndefined)(e);){if(e.name===t)return!0;e=this.model.getConceptSchema(e.prototype)}return!1}},Fe=Object.assign({},ce,Re);function $e(t){if(401===t)return{success:!1,message:"The value is not included in the list of valid values."}}const We={name:"meta",reference:null,initValue(t){return(0,U.isNullOrUndefined)(t)||this.setValue(t.value),this},hasValue(){return!(0,U.isNullOrWhitespace)(this.value)},getValue(){return(0,U.isNullOrUndefined)(this.value)?null:this.value},getProperty(t){const e=this.schema[t];if((0,U.isObject)(e)){const t=[];for(const n in e){const i=e[n];t.push(Object.assign({},{name:n},i))}return t}return e},setValue(t){var e=this.validate(t);return 200!==e?{success:!1,message:"Validation failed: The value could not be updated.",errors:[$e(e).message]}:(0,U.isNullOrUndefined)(t)||this.value===t?void 0:(this.reference&&this.reference.unregister(this),this.reference=this.model.getConcept(t),this.reference.register(this),this.value=t,this.notify("value.changed",this.reference),{success:!0,message:"The value has been successfully updated."})},getChildren:t=>[],delete(t=!1){if(!t){let t=this.getParent().remove(this);if(!t.success)return t}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(t,e){return"delete"===t&&(this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)),!0},validate(t){return(0,U.isNullOrWhitespace)(t)||(0,U.isEmpty)(this.values),200},export(){return{id:this.id,name:this.name,value:this.value}},toString(){var t=[];return this.value.forEach((e=>{t.push(e.toString())})),t}},Ye=Object.assign({},ce,We);function Xe(t,e){return{object:{value:"concept"},type:{value:"concept"},model:{value:t},name:{value:e.name},base:{value:e.base},schema:{value:e,writable:!0}}}const Ge={boolean:(t,e)=>Object.create(ue,Xe(t,e)),number:(t,e)=>Object.create(me,Xe(t,e)),reference:(t,e)=>Object.create(ye,Xe(t,e)),set:(t,e)=>Object.create(Oe,Xe(t,e)),string:(t,e)=>Object.create(De,Xe(t,e)),meta:(t,e)=>Object.create(Ye,Xe(t,e))},Je={primitive:(t,e)=>Ge[e.name](t,e),prototype:(t,e)=>Object.create(Fe,Xe(t,e)),concrete:(t,e)=>Object.create(Pe,Xe(t,e)),derivative:(t,e)=>Ge[e.base](t,e)},Ze={createConcept(t,e,n){const{name:i,nature:r}=e,s=Je[r];if((0,U.isNullOrUndefined)(s))throw new Error(`Missing handler: The '${i}' concept could not be handled`);const a=s(t,e);if((0,U.isNullOrUndefined)(a))throw new Error(`Bad request: The '${i}' concept could not be created`);return a.init(n),(0,U.isNullOrUndefined)(a.id)&&(a.id=bt.generate()),a}};var Qe=0;const Ke={concepts:null,values:null,listeners:null,get hasError(){return this.concepts.some((t=>t.hasError))},init(t){return this.concepts=[],this.values=[],this.listeners=[],Array.isArray(t)&&(this.values=t,t.filter((t=>t.root)).forEach((t=>{this.createConcept({name:t.name},{value:t})})),this.values=t.filter((t=>t.id.startsWith("value")))),this},initValue(t){return Array.isArray(t)&&(this.values=t,t.filter((t=>t.root)).forEach((t=>{this.createConcept({name:t.name},{value:t})})),this.values=t.filter((t=>t.id.startsWith("value")))),this},done(){return this.concepts.forEach((t=>{t.done()})),this.concepts=[],!0},createConcept(t,e){const n=this.getCompleteModelConcept(t);if((0,U.isNullOrUndefined)(n))throw new Error(`Concept not found: ${t}`);var i=Ze.createConcept(this,n,e);return this.addConcept(i),i},getConcepts(t){if((0,U.isIterable)(t)){const e=Array.isArray(t)?e=>t.includes(e.name):e=>e.name===t;return this.concepts.filter((t=>e(t)))}return this.concepts.slice()},getRootConcepts(){return this.concepts.filter((t=>t.isRoot()))},getConceptsByPrototype(t){return this.concepts.filter((e=>e.hasPrototype(t)))},getConcept(t){if(!(0,U.isString)(t)||(0,U.isEmpty)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");return this.concepts.find((e=>e.id===t))},addConcept(t){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad request: The 'concept' argument must be a Concept");return this.concepts.push(t),t.register(this.environment),this},removeConcept(t){if(!(0,U.isObject)(t)&&!(0,U.isString)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var e=this.concepts.findIndex((e=>e.id===t));return-1===e?null:this.concepts.splice(e,1)[0]},hasConcept(t){if(!(0,U.isObject)(t)&&!(0,U.isString)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");if((0,U.isEmpty)(this.concepts))return!1;let e=t.id||t;return t.name,this.concepts.some((t=>t.id===e))},getValues(t){if((0,U.isIterable)(t)){const e=Array.isArray(t)?e=>t.includes(e.name):e=>e.name===t;return this.values.filter((t=>e(t)))}return this.values.slice()},getValue(t){return(0,U.isNullOrUndefined)(t)?null:(0,U.hasOwn)(t,"value")||(0,U.hasOwn)(t,"attributes")?t:(0,U.hasOwn)(t,"id")?this.values.find((e=>e.id===t.id)):this.values.find((e=>e.id===t))},addValue(t){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad request: The 'value' argument must be a Value");return this.values.some((e=>{return i=t,(n=e).name===i.name&&(n.value?n.value===i.value:JSON.stringify(n.attributes)===JSON.stringify(i.attributes));var n,i}))||(t.id="value"+Qe++,this.values.push(t),this.notify("value.added",t)),this},removeValue(t){if(!(0,U.isObject)(t)&&!(0,U.isString)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var e=this.values.findIndex((e=>e.id===t));if(-1===e)return null;let n=this.values.splice(e,1)[0];return this.notify("value.removed",n),n},register(t){return this.listeners.includes(t)||this.listeners.push(t),!0},unregister(t){let e=this.listeners.indexOf(t);return-1!==e&&(this.listeners.splice(e,1),!0)},unregisterAll(){this.listeners=[]},notify(t,e){this.listeners.forEach((n=>{n.update(t,e)}))},isConcept(t){return!!(0,U.isString)(t)&&-1!==this.schema.findIndex((e=>e.name===t))},isConcrete(t){if(!(0,U.isString)(t))return!1;const e=this.schema.find((e=>e.name===t));return!(0,U.isNullOrUndefined)(e)&&"concrete"===e.nature},isPrototype(t){if(!(0,U.isString)(t))return!1;const e=this.schema.find((e=>e.name===t));return!(0,U.isNullOrUndefined)(e)&&"prototype"===e.nature},hasPrototype(t,e){if(!this.isConcept(t))return!1;let n=this.getConceptSchema(t);for(;!(0,U.isNullOrUndefined)(n);){if(n.prototype===e)return!0;n=this.model.getConceptSchema(n.prototype)}return!1},addConceptSchema(t){let e=t.concept||t;return this.schema.push(...e),this.environment.update("concept-model.updated"),!0},getSchema(t){if((0,U.isIterable)(t)){const e=Array.isArray(t)?e=>t.includes(e.nature):e=>e.nature===t;return this.schema.filter((t=>e(t)))}return this.schema.slice()},getConceptSchema(t){const e=nn(this.schema,t);if(!(0,U.isNullOrUndefined)(e))return gt(e)},getCompleteModelConcept(t){let e=t;(0,U.isString)(t)&&(e={name:t});const n=this.getConceptSchema(e.name);if((0,U.isNullOrUndefined)(n))return;Object.assign(n,e),(0,U.hasOwn)(n,"attributes")||(n.attributes=[]);const i=tn.call(this,n.prototype);return n.attributes.push(...i.attributes),n},getConcreteConcepts(t){const e=e=>{for(var n=e.prototype;!(0,U.isNullOrUndefined)(n);){if(n===t)return!0;n=(0,U.valOrDefault)(nn(this.schema,n),{}).prototype}return!1},n=this.schema.filter((t=>"concrete"===t.nature));return t?n.filter((t=>e(t))):n},getDerivedConcepts(t){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad argument");return this.schema.filter((e=>e.base===t))},export(){const t=[];return this.getConcepts().forEach((e=>{t.push(e.export())})),t.push(...this.getValues()),t},toString(){return JSON.stringify({[this.root.name]:this.root.toString()})},toXML(){return"<model:gentleman>"+this.getRootConcepts().map((t=>t.toXML())).join("")+"</model:gentleman>"},toXMI(){return'\n            <?xml version="1.0" encoding="ISO-8859-1"?>\n            <xmi:XMI xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gent="geodes.sms.gentleman">\n                <gent:Model name="MindMap">\n        '+this.getRootConcepts().map((t=>t.toXMI())).join("")+"\n                </gent:Model>\n            </xmi:XMI>\n        "}};function tn(t){var e=t;const n=[];for(;!(0,U.isNullOrUndefined)(e);){const t=(0,U.valOrDefault)(this.getConceptSchema(e),{});i=t.attributes,Array.isArray(i)&&i.forEach((t=>{const e=n.find((e=>e.name===t.name));(0,U.isNullOrUndefined)(e)?n.push(t):t.required&&(e.required=t.required)})),e=t.prototype}var i;return{attributes:n}}const en=[{name:"string",nature:"primitive"},{name:"number",nature:"primitive"},{name:"boolean",nature:"primitive"},{name:"reference",nature:"primitive"},{name:"set",nature:"primitive"}];function nn(t,e){let n=t.find((t=>t.name===e));return(0,U.isNullOrUndefined)(n)&&(n=en.find((t=>t.name===e))),n}const rn=[],sn={createModel(t,e){var n=Object.create(Ke,{schema:{value:(0,U.valOrDefault)(t,[])},environment:{value:e}});return rn.push(n),n}};function an(t){const{type:e}=t;let n=this.concept||this.source;return"property"===e?(0,U.valOrDefault)(n.getProperty(t.name),""):"param"===e?this.getParam(t.name):t}const on={css:function(t,e){return(0,U.isIterable)(e)?(pn(t,e),t):t},ref:function(t,e){return(0,U.isIterable)(e)?(e.forEach((e=>{const{style:n={}}=(0,U.valOrDefault)(this.model.getStyleSchema(e),{});n.gss?cn.call(this,t,n):hn.call(this,t,n)})),t):t},gss:hn,text:un,box:bn,html:function(t,e){return(0,U.isIterable)(e)?(e.forEach((e=>{let n=`style${(0,U.capitalizeFirstLetter)(e.name)}`;t.dataset[n]=an.call(this,e.value),"property"===e.value.type&&this.registerHandler("value.changed",(i=>{t.dataset[n]=an.call(this,e.value)}))})),t):t}},ln={text:un,box:bn};function cn(t,e){if(!(0,U.isObject)(e))return t;for(const n in e){const i=e[n];let r=on[n];(0,U.isFunction)(r)&&r.call(this,t,i)}return t}function hn(t,e){if(!(0,U.isObject)(e))return t;for(const n in e){const i=e[n];let r=ln[n];(0,U.isFunction)(r)&&r.call(this,t,i)}return t}function un(t,e){for(const n in e){const i=e[n];if(!1!==i)switch(n){case"bold":t.style.fontWeight=mn(i);break;case"italic":t.style.fontStyle="italic";break;case"underline":t.style.textDecoration="underline";break;case"strikethrough":t.style.textDecoration="line-through";break;case"color":t.style.color=fn(i);break;case"font":t.style.fontFamily=i.toString();break;case"size":t.style.fontSize=gn(i);break;case"transform":t.style.textTransform=i}}return t}const dn=t=>t.replace(/\s+/g," ").trim();function pn(t,e){if(Array.isArray(e))t.classList.add(...e);else{let n=dn(e);(0,U.isNullOrWhitespace)(t.className)?t.className=n:pn(t,n.split(" "))}return t}function fn(t){if((0,U.isNullOrUndefined)(t))return"";const{type:e,value:n}=t;switch(e){case"rgb":return(0,U.isObject)(n)?`rgb(${n.red}, ${n.green}, ${n.blue})`:n;case"rgba":return(0,U.isObject)(n)?`rgba(${n.red}, ${n.green}, ${n.blue}, ${n.opacity/100})`:n;case"name":case"hexadecimal":return n;default:return n||t}}function mn(t){if((0,U.isNullOrUndefined)(t))return"";const{type:e,value:n}=t;return Number.isInteger(t)?`${t}`:"bold"}function gn(t){if((0,U.isNullOrUndefined)(t))return"";const{value:e,unit:n}=t;return(0,U.isNullOrUndefined)(e)?"":`${e}${n}`}function bn(t,e){for(const n in e){const i=e[n];if(!1!==i)switch(n){case"inner":vn.call(this,t,i,"padding");break;case"outer":vn.call(this,t,i,"margin");break;case"border":wn.call(this,t,i);break;case"corner":En.call(this,t,i);break;case"background":yn.call(this,t,i);break;case"width":t.style.width=gn.call(this,i);break;case"height":t.style.height=gn.call(this,i);break;case"opacity":t.style.opacity=i/100;break;case"shadow":xn.call(this,t,i,"shadow")}}return t}function vn(t,e,n){if(!(0,U.isNullOrUndefined)(e))for(const i in e){const r=e[i];switch(i){case"all":t.style[`${[n]}`]=gn.call(this,r);break;case"top":t.style[`${[n]}Top`]=gn.call(this,r);break;case"right":t.style[`${[n]}Right`]=gn.call(this,r);break;case"bottom":t.style[`${[n]}Bottom`]=gn.call(this,r);break;case"left":t.style[`${[n]}Left`]=gn.call(this,r)}}}function yn(t,e){if((0,U.isNullOrUndefined)(e))return;const{color:n,image:i}=e;n&&(t.style.backgroundColor=fn.call(this,n)),i&&(t.style.backgroundImage=`url(${i})`)}function xn(t,e){if((0,U.isNullOrUndefined)(e))return null;const{offsetX:n,offsetY:i,blur:r,spread:s,inset:a=!1,color:o}=e;if((0,U.isNullOrUndefined)(n)||(0,U.isNullOrUndefined)(i))return null;let l=gn.call(this,n),c=gn.call(this,i),h=gn.call(this,r),u=gn.call(this,s),d=fn.call(this,o);t.style.boxShadow=a?`inset ${l} ${c} ${h} ${u} ${d}`.trim():`${l} ${c} ${h} ${u} ${d}`.trim()}function wn(t,e){if(!(0,U.isNullOrUndefined)(e))for(const n in e){const i=e[n];switch(n){case"all":t.style.borderStyle=(0,U.valOrDefault)(i.type,"solid"),t.style.borderWidth=gn.call(this,i.width),t.style.borderColor=fn.call(this,i.color);break;case"top":t.style.borderTopStyle=(0,U.valOrDefault)(i.type,"solid"),t.style.borderTopWidth=gn.call(this,i.width),t.style.borderTopColor=fn.call(this,i.color);break;case"right":t.style.borderRightStyle=(0,U.valOrDefault)(i.type,"solid"),t.style.borderRightWidth=gn.call(this,i.width),t.style.borderRightColor=fn.call(this,i.color);break;case"bottom":t.style.borderBottomStyle=(0,U.valOrDefault)(i.type,"solid"),t.style.borderBottomWidth=gn.call(this,i.width),t.style.borderBottomColor=fn.call(this,i.color);break;case"left":t.style.borderLeftStyle=(0,U.valOrDefault)(i.type,"solid"),t.style.borderLeftWidth=gn.call(this,i.width),t.style.borderLeftColor=fn.call(this,i.color)}}}function En(t,e){if((0,U.isNullOrUndefined)(e))return null;for(const n in e){const i=e[n];switch(n){case"all":t.style.borderRadius=gn.call(this,i);break;case"top-left":t.style.borderTopLeftRadius=gn.call(this,i);break;case"top-right":t.style.borderTopRightRadius=gn.call(this,i);break;case"bottom-right":t.style.borderBottomRightRadius=gn.call(this,i);break;case"bottom-left":t.style.borderBottomLeftRadius=gn.call(this,i)}}}const An={init(){throw new Error("This function has not been implemented")},element:null,statusElement:null,attached:null,children:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasError(){return this.source.hasError},get hasAttached(){return!(0,U.isEmpty)(this.attached)},attach(t,e){this.attached.push(t)},detach(t){this.attached.slice(this.attached.indexOf(t),1)},getAttached(t){return(0,U.isFunction)(t)?this.attached.filter((e=>t(e))):this.attached},show(){return B(this.element),this.visible=!0,this.active=!0,this},hide(){return q(this.element),this.visible=!1,this},toggle(){return F(this.container),this.visible=!this.visible,this},focus(t){return this.element.contentEditable=!1,this.element.focus(),this.focused=!0,this},getContainer(){return this.element},notify(t,e,n){$(this.element),this.environment.notify(t,e)},append(t){if(!(0,U.isHTMLElement)(t))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.append(t),this},_focusIn:t=>!1,enable(){return this.disabled=!1,this},disable(){return this.disabled=!0,this},clear:()=>!0,delete(){var t=this.source.delete();t.success?(this.clear(),(0,U.removeChildren)(this.element),this.element.remove()):(this.environment.notify(t.message),$(this.element))},spaceHandler(t){return console.warn(`SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_spaceHandler(t){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(t){return console.warn(`ESCAPE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},enterHandler(t){this.focusOut()},deleteHandler(t){if(this.projection.element!==this)return $(t),!1;if(!this.projection.optional)return $(this.element),!1;let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex)),n=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),n),this.source.delete();let i=this.environment.resolveElement(e);return(0,U.isNullOrUndefined)(i)||i.focus(),!1},backspaceHandler(t){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(t,e){return console.warn(`ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_arrowHandler(t,e){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(t){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},controlHandler(t){this.toolbar&&this.toolbar.remove()},shiftHandler(t,e){return console.warn(`SHIFT_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1}},Nn=Object.assign(An);function On(t){if(!(0,U.isHTMLElement)(t))return!1;const{nature:e,id:n}=t.dataset;return"field-component"===e&&n===this.id}const kn={init(){return this.elements=new Map,this},render(){const t=(0,U.createDocFragment)(),{content:e="Add",items:n}=this.schema;(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:["field","add-button"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),cn.call(this.projection,this.element,this.schema.style));let i=(0,U.createButton)({class:["field-action","field--list__add"],tabindex:0,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}});return(0,U.isNullOrUndefined)(n)||(this.item=n),i.append(e),t.appendChild(i),t.hasChildNodes()&&this.element.append(t),this.bindEvent(),this.element},focusIn(){},clickHandler(t){const e=(t=>On.call(this,t)?t:(0,U.findAncestor)(t,(t=>On.call(this,t)),5))(t);if((0,U.isNullOrUndefined)(e))return;const{action:n,index:i,name:r}=e.dataset;"add"===n?(this.parent.prio=this.element,this.createElement()):"remove"===n&&this.delete(e.parentElement),this.parent.prio=this.element},createElement(){this.source.createElement()},addItem(t){return this.parent.addItem(t,this),this},removeItem(t){this.parent.removeItem(t)},refresh(){this.element&&this.source.getValue().forEach((t=>{this.addItem(t)}))},focusOut(){},bindEvent(){this.projection.registerHandler("value.added",(t=>{this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)}))}},_n=Object.assign(Object.create(Nn),kn);function jn(t,e){if(!Array.isArray(e))return!1;t.currentState=null;for(let n=0;n<e.length;n++){const i=e[n],{rule:r,result:s}=i;if((0,U.isNullOrUndefined)(r))return s;let a=!1,o=Mn[r.type];if((0,U.isFunction)(o)&&(a=o.call(this,r[r.type])),a)return t.currentState=n,s}return null}const Mn={ref:function(t){const{rule:e={}}=(0,U.valOrDefault)(this.model.getRuleSchema(t),{});let n=Mn[e.type];return!!(0,U.isFunction)(n)&&n.call(this,e[e.type])},eq:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return Cn.call(this,t[0])==Cn.call(this,t[1])},ne:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return Cn.call(this,t[0])!=Cn.call(this,t[1])},lt:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return Cn.call(this,t[0])<Cn.call(this,t[1])},le:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return Cn.call(this,t[0])<=Cn.call(this,t[1])},gt:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return Cn.call(this,t[0])>Cn.call(this,t[1])},ge:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return Cn.call(this,t[0])>=Cn.call(this,t[1])},and:function(t){return Sn.call(this,t[0])&&Sn.call(this,t[1])},or:function(t){return Sn.call(this,t[0])||Sn.call(this,t[1])},not:function(t){return!Sn.call(this,t[0])},no:function(t){let e=Cn.call(this,t);return(0,U.isIterable)(e)?(0,U.isEmpty)(e):(0,U.isNullOrUndefined)(e)}};function Cn(t,e){if(t&&"property"===t.type){const{name:e}=t;let n=`get${(0,U.pascalCase)(e)}`;return this[n]?this[n]():this[e]}if(t&&"param"===t.type){const{name:e}=t;return this.projection.getParam(e)}if((0,U.isObject)(t)){let e=`get${(0,U.pascalCase)(t.prop)}`;return this[e]?this[e]():this[t.prop]}return e||t}function Sn(t){let e=Mn[t.type];return(0,U.isFunction)(e)?e.call(this,t[t.type]):(0,U.toBoolean)(Cn.call(this,t))}function Ln(t){const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,U.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?this.projection.getParam(t.name):"html"===e?(0,U.htmlToElement)(t.html):"raw"===e?(0,U.htmlToElement)(t.raw):t}const Tn={input:null,label:null,value:"",state:null,init(){const{focusable:t=!0}=this.schema;return this.focusable=t,this.children=[],this},refresh(){if((0,U.valOrDefault)(jn.call(this,this.schema,this.schema.state),this.schema),this.schema.state){let t=this.schema.state[this.getValue().toString()];if(t&&t.content){const{style:e,content:n,value:i}=t;let r=(0,U.createDocFragment)();n.forEach((t=>{r.append(Na.call(this,t))})),(0,U.removeChildren)(this.label).append(r),cn.call(this.projection,this.label,e)}}this.input.checked?this.element.dataset.state="on":this.element.dataset.state="off",this.hasError?(this.element.classList.add("error"),this.input.classList.add("error")):(this.element.classList.remove("error"),this.input.classList.remove("error"))},render(){const t=(0,U.createDocFragment)(),{checkbox:e}=this.schema;var n;if((0,U.isHTMLElement)(this.element)||(this.element=(n=this.id,(0,U.createDiv)({id:n,class:["field","field--binary"],tabindex:-1,dataset:{nature:"field",view:"binary",id:n}})),this.readonly&&this.element.classList.add("readonly"),cn.call(this.projection,this.element,this.schema.style)),!(0,U.isHTMLElement)(this.input)){if(this.input=function(t){return(0,U.createInput)({id:`checkbox${t}`,type:"checkbox",class:["field--binary__input"],tabindex:0,dataset:{nature:"field-component",view:"binary",id:t}})}(this.id),this.input.checked=this.source.getValue(),this.value=this.input.checked,this.readonly&&(this.input.classList.add("readonly"),this.input.disabled=!0),e){const{style:t}=e;cn.call(this.projection,this.input,t)}else q(this.input);t.append(this.input)}if(!(0,U.isHTMLElement)(this.label)){if(this.label=(0,U.createLabel)({class:["field--checkbox__label"],for:this.input.id,tabindex:0,dataset:{nature:"field-component",view:"binary",id:this.id}}),this.label.htmlFor=this.input.id,e&&e.label){const{content:t}=e.label;if(Array.isArray(t))t.forEach((t=>{let e=Ln.call(this,t),n=(0,U.createSpan)({class:["field--checkbox__label-content"],dataset:{ignore:"all"}},e);cn.call(this.projection,n,t.style),this.label.append(n)}));else{let e=Ln.call(this,t);this.label.append(e)}cn.call(this.projection,this.label,e.label.style)}t.append(this.label)}return t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.value=this.input.checked,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.hasChanges()&&this.setValue(this.input.checked),this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.choice&&q(this.choice),this.input.blur(),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!==this.input.checked},hasValue(){return this.input.checked},getValue(){return this.input.checked},setValue(t,e=!1){var n;(n=e?this.source.setValue(t):{success:!0}).success||this.environment.notify(n.message,"error"),this.input.checked=t,this.value=t,this.refresh()},getCandidates(){return this.source.getCandidates()},enable(){this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1},disable(){this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0},escapeHandler(t){let e=!0;if(this.messageElement&&!tt(this.messageElement)&&(q(this.messageElement),e=!1),e){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));return this.environment.resolveElement(e).focus(e),!0}},backspaceHandler(t){return this.arrowHandler("left",t)},enterHandler(t){this.setValue(!this.input.checked,!0)},arrowHandler(t,e){return!!this.parent&&this.parent.arrowHandler(t,this.element)},bindEvents(){this.element.addEventListener("change",(t=>{this.setValue(this.getValue(),!0)})),this.projection.registerHandler("value.changed",(t=>{this.setValue(t)}))}},In=Object.assign(Object.create(Nn),Tn);function Un(t){const e=t=>t.parentElement===this.choices;return e(t)?t:(0,U.findAncestor)(t,e,5)}function Dn(t){const{type:e}=t.dataset;return e}function Hn(t){const{type:e,value:n}=t.dataset;return"concept"===e?this.values.find((t=>t.id===n)).id:"meta-concept"===e?this.values.find((t=>t.name===n)).name:"value"===e?n:"placeholder"===e?null:n}const Pn=(t,e)=>"concept"===t.type?Pn(t.id,e):"concept"===e.type?Pn(t,e.id):"meta-concept"===t.type?Pn(t.name,e):"meta-concept"===e.type?Pn(t,e.name):t===e,zn={value:null,placeholder:null,expanded:null,values:null,choices:null,input:null,items:null,selection:null,selectList:null,selectListValue:null,icoToggle:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0,placeholder:n=!1,expanded:i=!0}=this.schema;return this.items=new Map,this.focusable=e,this.expanded=i,this.placeholder=n,this.children=[],(0,U.hasOwn)(this.schema,"choice")||(this.schema.choice={}),(0,U.hasOwn)(this.schema.choice,"option")||(this.schema.choice.option={}),this},hasChanges(){return this.value!=this.source.getValue()},reset(){this.source.removeValue()},hasValue(){return!(0,U.isNullOrUndefined)(this.value)},getValue(){return this.selection},setValue(t,e=!1){var n=null;if(e)return(n=this.source.setValue(t)).success||this.environment.notify(n.message,J.ERROR),!0;(0,U.isNullOrUndefined)(t)?(this.selection&&this.selection.classList.remove("selected"),this.expanded||(0,U.removeChildren)(this.selectListValue),this.selection=null):this.setChoice(t),(0,U.isNullOrUndefined)(t)?this.value=null:"concept"===t.type?this.value=t.id:"meta-concept"===t.type?this.value=t.name:this.value=t;const{template:i={}}=this.schema.choice.option;if(this.selection&&!this.expanded&&t)if((0,U.removeChildren)(this.selectListValue),"meta-concept"===t.type){let e=this.model.getProjectionSchema(t.concept,(0,U.valOrDefault)(i.tag))[0],n=e.type,r={type:n,[n]:e.content||e.projection},s=Na.call(this,r,t.concept,{focusable:!1,meta:t.name});this.selectListValue.append(s)}else if("concept"===t.type){let e=this.model.createProjection(t,i.tag).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection,this.selectListValue.append(e.render())}else this.selectListValue.append(t.toString());this.refresh()},refresh(){return this.hasValue()?(this.element.classList.remove("empty"),this.element.dataset.value=this.value.name||this.value):(this.element.classList.add("empty"),this.element.dataset.value="",!this.expanded&&this.placeholder&&(0,U.removeChildren)(this.selectListValue).append(this.placeholder)),this.input&&(this.element.dataset.input=this.input.value),this.element.classList.remove("querying"),this.hasError?(this.element.classList.add("error"),this.input&&this.input.classList.add("error")):(this.element.classList.remove("error"),this.input&&this.input.classList.remove("error")),this},render(){const t=(0,U.createDocFragment)(),{choice:e,input:n,style:i}=this.schema;if((0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:["field","field--choice"],tabindex:-1,dataset:{nature:"field",view:"choice",input:"",id:this.id}})),!(0,U.isHTMLElement)(this.input)&&n){const{placeholder:e="",type:i,style:r}=n;let s=xa.call(this,e);this.input=(0,U.createInput)({class:["field--choice__input"],type:(0,U.valOrDefault)(i,"text"),placeholder:s,title:s,dataset:{nature:"field-component",view:this.type,id:this.id}}),cn.call(this,this.input,r),t.append(this.input)}if(!(0,U.isHTMLElement)(this.choices)){const{style:n}=e;this.choices=(0,U.createUnorderedList)({class:["bare-list","field--choice__choices"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),cn.call(this,this.choices,n),t.append(this.choices)}if(!this.expanded){let e=(0,U.createDiv)({class:["field--choice__select-wrapper"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}});this.selectListValue=(0,U.createDiv)({class:["field--choice__select-value"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),this.icoToggle=(0,U.createI)({class:["field--choice__select-icon"],dataset:{nature:"field-component",view:"choice",id:this.id}}),e.append(this.selectListValue,this.icoToggle),this.selectList=(0,U.createDiv)({class:["field--choice__select-list","hidden"],dataset:{nature:"field-component",view:"choice",id:this.id}}),this.input&&this.selectList.append(this.input),this.selectList.append(this.choices),t.append(e),t.append(this.selectList)}if(cn.call(this,this.element,i),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),(0,U.removeChildren)(this.choices),this.placeholder){const{style:t}=this.schema.choice.option;let e=(0,U.createListItem)({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(e),cn.call(this,e,t)}return this.values=this.source.getCandidates(),this.values.forEach((t=>{this.choices.append(this.createChoiceOption(t))})),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},focus(t){if(this.expanded)if(this.choices.hasChildNodes()){let t=function(t){for(let e=0;e<t.children.length;e++){const n=t.children[e];if(!tt(n))return n}return null}(this.choices);t&&t.focus()}else this.input&&!tt(this.input)?this.input.focus():this.selection&&this.selection.focus();else this.input&&!tt(this.input)?this.input.focus():this.selectListValue.focus();return this.element.classList.add("active"),this},navigate(t,e,n){let i=null;if("up"===t?i=pt(this.element):"down"===t?i=ht(this.element):"left"===t?i=dt(this.element):"right"===t&&(i=ut(this.element)),(0,U.isNullOrUndefined)(i))return!1;i.focus()},focusIn(){this.focused=!0,this.element.classList.add("active");const t=(0,U.createDocFragment)();return this.source.getCandidates().filter((t=>!this.values.some((e=>Pn(e,t))))).forEach((e=>{t.append(this.createChoiceOption(e)),this.values.push(e)})),this.choices.append(t),this.expanded||(B(this.selectList),this.selectList.dataset.state="open"),this},focusOut(){if(this.readonly)return;this.input&&(0,U.isNullOrWhitespace)(this.input.value)&&(this.input.value=""),this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.input&&this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("querying");const{children:t}=this.choices;for(let e=0;e<t.length;e++){const n=t[e];B(n),n.hidden=!1}return this.expanded||(q(this.selectList),this.selectList.dataset.state="close"),this.focused=!1,this},showChoices(){const{children:t}=this.choices;for(let e=0;e<t.length;e++){const n=t[e];B(n),n.hidden=!1}},enable(){return this.input&&(this.input.disabled=!1,this.input.tabIndex=0),this.disabled=!1,this},disable(){return this.input&&(this.input.disabled=!0,this.input.tabIndex=-1),this.disabled=!0,this},filterChoice(t){const{children:e}=this.choices;if(this.element.dataset.input=t.trim(),(0,U.isNullOrWhitespace)(t)){for(let t=0;t<e.length;t++){const n=e[t];B(n),n.hidden=!1}return}this.element.classList.add("querying");let n=t.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let t=0;t<e.length;t++){const i=e[t];let r=i.textContent.toLowerCase(),s=r.replace(/[_-]+/g," ").replace(/\s+/g,"").trim();n.some((t=>r.includes(t)||s.includes(t)))?(B(i),i.hidden=!1):(q(i),i.hidden=!0)}return!0},createChoiceOption(t){const{template:e={},style:n}=this.schema.choice.option,i=(0,U.isObject)(t),r=(0,U.createListItem)({class:["field--choice__choice"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:i?"concept":"value",value:i?t.id:t}});if(cn.call(this,r,n),this.items.set(t.id,r),"meta-concept"===t.type){let n=this.model.getProjectionSchema(t.concept,(0,U.valOrDefault)(e.tag))[0],i=n.type,s={type:i,[i]:n.content||n.projection},a=Na.call(this,s,t.concept,{focusable:!1,meta:t.name});r.dataset.type="meta-concept",r.dataset.value=t.name,r.append(a)}else if(i){if(!this.model.hasProjectionSchema(t,e.tag))return r;let n=this.model.createProjection(t,e.tag).init({focusable:!1});n.readonly=!0,n.focusable=!1,n.parent=this.projection,r.append(n.render())}else r.append(t.toString());return r},setChoice(t){const{children:e}=this.choices;let n=!1;for(let i=0;i<e.length;i++){const r=e[i];let s=Hn.call(this,r);s&&Pn(s,t)?(r.classList.add("selected"),r.dataset.selected="selected",this.selection=r,B(r),n=!0):(r.classList.remove("selected"),delete r.dataset.selected)}return this},delete(){if(this.hasValue())this.reset();else{let t=this.source.delete();t.success?(this.clear(),(0,U.removeChildren)(this.element),this.element.remove()):(this.environment.notify(t.message),$(this.element))}},_spaceHandler(t){let e=this.source.getCandidates();if((0,U.isEmpty)(e))return void this.notify("No candidates found.",J.INFO);const n=(0,U.createDocFragment)();if(e.forEach((t=>{n.append(this.createChoiceOption(t))})),(0,U.removeChildren)(this.choices),this.placeholder){const{style:t}=this.schema.choice.option;let e=(0,U.createListItem)({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(e),cn.call(this,e,t)}this.choices.append(n),this.filterChoice(this.input.value),B(this.choices),this.element.classList.add("querying")},escapeHandler(t){let e=!0;if(this.messageElement&&!tt(this.messageElement)&&(q(this.messageElement),e=!1),!this.expanded&&"open"===this.selectList.dataset.state)return q(this.selectList),this.selectList.dataset.state="close",!0;if(e){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));return this.environment.resolveElement(e).focus(e),!0}this.focus()},enterHandler(t){const e=Un.call(this,t);(0,U.isHTMLElement)(e)&&this.selection!==e&&("placeholder"===Dn(e)?this.source.removeValue():this.setValue(Hn.call(this,e),!0),this.expanded||(q(this.selectList),this.selectList.dataset.state="close",this.focus()))},backspaceHandler(t){Un.call(this,t)&&this.input&&this.input.focus()},clickHandler(t){const e=Un.call(this,t);(0,U.isHTMLElement)(e)&&this.selection!==e?("placeholder"===Dn(e)?this.source.removeValue():this.setValue(Hn.call(this,e),!0),this.expanded||(q(this.selectList),this.selectList.dataset.state="close")):t===this.selectListValue&&(B(this.selectList),this.selectList.dataset.state="open")},arrowHandler(t,e){if(!(0,U.isHTMLElement)(e))return!1;const{parentElement:n}=e,i=()=>!!this.parent&&this.parent.arrowHandler(t,this.element);if(!this.expanded&&e===this.selectListValue)return this.arrowHandler(t,this.selectListValue.parentElement);let r=Un.call(this,e);if(r){let e=ct(r,t,this.choices,!1);return(0,U.isHTMLElement)(e)?(e.focus(),!0):this.arrowHandler(t,this.choices)}if(this.expanded&&n!==this.element)return i();let s=ct(e,t,n,!1);return(0,U.isHTMLElement)(s)?(s===this.selectList&&(s=this.input||this.choices),s===this.choices&&this.choices.hasChildNodes()&&("up"===t?s=pt(this.choices):"down"===t?s=ht(this.choices):"left"===t?s=dt(this.choices):"right"===t&&(s=ut(this.choices))),s.focus(),!0):i()},bindEvents(){(0,U.isHTMLElement)(this.input)&&this.element.addEventListener("input",(t=>{this.filterChoice(this.input.value)})),this.projection.registerHandler("value.changed",((t,e)=>{this.setValue(t)}))}},Vn=Object.assign(Object.create(Nn),zn),Rn={init(){return this},render(){const t=(0,U.createDocFragment)(),{content:e,markers:n,marker:i,self:r}=this.schema;var s=new DOMParser;return(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:[],dataset:{nature:"field",view:"dynamic",id:this.id}})),(0,U.isHTMLElement)(this.content)||(this.content=s.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)),(0,U.isNullOrUndefined)(this.place)&&(this.place=this.content.querySelector("[data-"+i+"]")),(0,U.isNullOrUndefined)(this.markers)&&(this.markers=new Map,this.content.querySelectorAll("[data-"+i+"]").forEach((t=>{let e=t.getAttribute("data-"+i);(0,U.isNullOrUndefined)(this.markers.get(e))?this.markers.set(e,[t]):this.markers.set(e,this.markers.get(e).concat([t]))}))),(0,U.isNullOrUndefined)(this.aliases)&&(this.aliases=new Map,n.forEach((t=>{let e=[];t.aliases.forEach((t=>{let n=this.markers.get(t.mv);const i=[];n.forEach((e=>{const n={};n.target=e;let r=[];t.props.forEach((t=>{const n={};n.property=t.props,n.value=t.value,(0,U.isNullOrUndefined)(e.style)||(0,U.isNullOrUndefined)(e.style[t.props])?n.default=e[t.props]:n.default=e.style[t.props],r.push(n)})),n.impacts=r,i.push(n)})),e.push(i)})),this.aliases.set(t.mv,e)}))),(0,U.isNullOrUndefined)(this.self)&&!(0,U.isEmpty)(r)&&(this.self=[],r.forEach((t=>{const e={};e.property=t,(0,U.isNullOrUndefined)(this.place.style[t])?e.default=this.place[t]:e.default=this.place.style[t],this.self.push(e)}))),t.hasChildNodes()&&this.element.appendChild(t),this.update=this.refresh,this.clear=this.clean,this},refresh(t){let e=this.aliases.get(t.toString());(0,U.isNullOrUndefined)(e)||e.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,U.isNullOrUndefined)(t.target[e.property])?t.target.style[e.property]=e.value:t.target[e.property]=e.value}))}))})),(0,U.isNullOrUndefined)(this.self)||this.self.forEach((e=>{(0,U.isNullOrUndefined)(this.place.style[e.property])?this.place[e.property]=t:this.place.style[e.property]=t}))},clean(t){let e=this.aliases.get(t);(0,U.isNullOrUndefined)(e)||e.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,U.isNullOrUndefined)(t.target.style[e.property])?t.target[e.property]=e.default:t.target.style[e.property]=e.default}))}))})),(0,U.isNullOrUndefined)(this.self)||this.self.forEach((t=>{(0,U.isNullOrUndefined)(this.place.style[t.property])?this.place[t.property]=t.default:this.place.style[t.property]=t.default}))}},Bn=Object.assign(Object.create(Nn),Rn),qn={content:"",init(){return this},render(){const t=(0,U.createDocFragment)(),{content:e,marker:n,tag:i}=this.schema;var r=new DOMParser;return(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:[],dataset:{nature:"field",view:"interactive",id:this.id}})),(0,U.isHTMLElement)(this.content)||(this.content=r.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)),(0,U.isNullOrUndefined)(this.place)&&(this.place=this.content.querySelector("[data-"+n+"]")),(0,U.isHTMLElement)(this.field)||(0,U.isNullOrUndefined)(i)||(this.field=Na.call(this,{type:"external",tag:i},null,this.args)),t.hasChildNodes()&&this.element.appendChild(t),this.initValue=this.update,this.bindEvents(),this.element},createForeign(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),n=this.place.getBBox(),i=document.createElementNS("http://www.w3.org/2000/svg","rect");i.setAttribute("x",n.x),i.setAttribute("y",n.y),i.setAttribute("width",n.width),i.setAttribute("height",n.height),i.style.fill="red",e.setAttribute("width",n.width),e.setAttribute("height",n.height),t.setAttribute("width",n.width),t.setAttribute("height",n.height),t.append(e),e.append(this.field),this.place.replaceWith(t),t.setAttribute("x",120),t.setAttribute("y",50);let r=this.field.getBoundingClientRect();e.setAttribute("width",r.width),e.setAttribute("height",r.height),t.setAttribute("viewBox","0 0 "+r.width+" "+r.height)},selfUpdate(){let t;(0,U.isNullOrUndefined)(this.aliases)||(t=this.aliases.get(this.value)),(0,U.isNullOrUndefined)(t)||t.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,U.isNullOrUndefined)(t.target[e.property])?t.target.style[e.property]=e.value:t.target[e.property]=e.value}))}))})),(0,U.isNullOrUndefined)(this.self)||this.self.forEach((t=>{(0,U.isNullOrUndefined)(this.place.style[t.property])?this.place[t.property]=this.value:this.place.style[t.property]=this.value}))},clear(){let t;(0,U.isNullOrUndefined)(this.aliases)||(t=this.aliases.get(this.value)),(0,U.isNullOrUndefined)(t)||t.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,U.isNullOrUndefined)(t.target.style[e.property])?t.target[e.property]=e.default:t.target.style[e.property]=e.default}))}))})),(0,U.isNullOrUndefined)(this.self)||this.self.forEach((t=>{(0,U.isNullOrUndefined)(this.place.style[t.property])?this.place[t.property]=t.default:this.place.style[t.property]=t.default}))},updateStatics(){if(!(0,U.isNullOrUndefined)(this.sd)){let t=this.sd.get(this.value);(0,U.isNullOrUndefined)(t)||this.content.appendChild(t.content)}},clearStatics(){if(!(0,U.isNullOrUndefined)(this.sd)){let t=this.sd.get(this.value);(0,U.isNullOrUndefined)(t)||t.content.parentNode.removeChild(t.content)}},updateDynamics(t){(0,U.isNullOrUndefined)(this.dd)||this.dd.forEach((e=>{e.update(t)}))},clearDynamics(t){(0,U.isNullOrUndefined)(this.dd)||this.dd.forEach((e=>{e.clear(t)}))},update(t){(0,U.isNullOrUndefined)(this.value)||(this.clearStatics(),this.clearDynamics(this.value),this.clear()),""===t?this.value=this.attributeName:(0,U.isNullOrUndefined)(this.property)?this.value=t:this.value=this.translateProperty(t),this.selfUpdate(),this.updateDynamics(this.value),this.updateStatics()},bindEvents(){this.place.addEventListener("click",(t=>{(0,U.isNullOrUndefined)(this.foreign)?this.createForeign():(this.place.replaceWith(this.foreign),this.field.focus())}))},getContent(){return(0,U.isHTMLElement)(this.content)||(this.content=parser.parseFromString(content.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement),this.content},arrowHandler(t,e){return this.parent.arrowHandler(t,this)},focus(){this.focusIn()},focusIn(){this.place.replaceWith(this.foreign),this.field.focus()},focusOut(){this.foreign.replaceWith(this.place),""===this.field.value?this.update(this.attributeName):this.update(this.field.value)}},Fn=Object.assign(Object.create(Nn),qn),$n={content:[{type:"static",static:{type:"text",content:"+",focusable:!1}}]};function Wn(t){if(!(0,U.isHTMLElement)(t))return!1;const{nature:e,id:n}=t.dataset;return"field-component"===e&&n===this.id}function Yn(t){const e=t=>t.parentElement===this.list;return e(t)?t:(0,U.findAncestor)(t,e,3)}const Xn={list:null,items:null,elements:null,selection:null,content:null,init(t){const{focusable:e=!0}=this.schema;return this.items=new Map,this.elements=new Map,this.children=[],this.focusable=e,(0,U.hasOwn)(this.schema,"list")||(this.schema.list={item:{}}),this},hasChanges:()=>!1,hasValue(){return this.items.size>0},getValue(){return this.list.children},setValue(t,e=!1){e&&this.source.setValue(t),this.list&&((0,U.removeChildren)(this.list),t.forEach((t=>{var e=this.createItem(t);this.list.append(e)}))),this.refresh()},clear(){this.items.clear(),this.list&&(0,U.removeChildren)(this.list)},focus(t){if(this.hasValue()&&this.list)this.list.firstElementChild.focus();else{let t=ht(this.element,(t=>t!==this.list));if(!(0,U.isHTMLElement)(t))return this;t.focus()}return this},navigate(t,e,n){let i=null;if("up"===t?i=pt(this.element,(t=>t!==this.notification&&t.hasChildNodes())):"down"===t?i=ht(this.element,(t=>t!==this.notification&&t.hasChildNodes())):"left"===t?i=dt(this.element,(t=>t!==this.notification&&t.hasChildNodes())):"right"===t&&(i=ut(this.element,(t=>t!==this.notification&&t.hasChildNodes()))),!(0,U.isHTMLElement)(i))return!1;let r=this.environment.resolveElement(i);return!(0,U.isNullOrUndefined)(r)&&(r.focus(),!0)},focusIn(t){this.focused=!0,this.element.classList.add("active");const{component:e}=t.dataset},focusOut(){if(!this.readonly)return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},createElement(){return this.source.createElement()},getItem(t){return(0,U.isNullOrUndefined)(t)?null:(0,U.hasOwn)(t,"id")?this.items.get(t.id):this.items.get(t)},getItemIndex:t=>(0,U.isHTMLElement)(t)?t.dataset.index:null,createItem(t){const{template:e={},style:n}=this.schema.list.item;if(!this.model.hasProjectionSchema(t,e.tag))return"";let i=this.model.createProjection(t,e.tag);i.optional=!0,i.collapsible=!0,i.parent=this.projection;let r=i.init(e.options).render();return r.dataset.index=t.index,i.element.parent=this,i.registerHandler("view.changed",(t=>{cn.call(this.projection,t,n)})),cn.call(this.projection,r,n),this.items.set(t.id,r),r},addItem(t){if(!(0,U.isHTMLElement)(this.list))return;const e=this.createItem(t);t.index?this.list.children[t.index-1].after(e):this.list.append(e),this.refresh()},removeItem(t){this.hasList&&!(0,U.isNullOrUndefined)(t)&&(this.items.delete(t.id),this.items.forEach(((t,e)=>{let n=this.source.getElement(e);n&&(t.dataset.index=n.index)})),this.refresh())},moveItem(t,e,n=!1){return this.list.children[e].before(t),t.dataset.index=e,n&&this.source.swapElement(+this.getItemIndex(t),+e),this},swapItem(t,e,n=!1){const i=this.getItemIndex(t),r=this.getItemIndex(e);return this.moveItem(e,i),this.moveItem(t,r),n&&this.source.swapElement(+i,+r),this},delete(t){if(t===this.element)return this.environment.save(this.source.getParent()),void this.source.remove();const{index:e}=t.dataset;var n=this.source.removeElementAt(+e);if(n.success)if(this.hasValue()){let t=+e<this.list.childElementCount?+e:this.list.childElementCount-1;this.list.children[t].focus()}else this.focus();else this.environment.notify(`This element cannot be deleted: ${n.message}`),$(t)},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.list&&this.list.classList.remove("empty")):(this.element.classList.add("empty"),this.list&&this.list.classList.add("empty")),this.elements.forEach(((t,e)=>{if(!Array.isArray(e.state))return;const{currentState:n}=e,i=jn.call(this,e,e.state);if(n===e.currentState)return;let r=e.content;i&&(r=i.content);let s=(0,U.createDocFragment)();r.forEach((t=>{let e=Na.call(this,t,null,{focusable:!1});s.append(e)})),(0,U.removeChildren)(t).append(s)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},render(){const t=(0,U.createDocFragment)(),{list:e,style:n,action:i={}}=this.schema;if((0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:["field","field--list"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),cn.call(this.projection,this.element,this.schema.style)),e&&!(0,U.isHTMLElement)(this.list)){const{style:n}=e;this.list=(0,U.createDiv)({class:["field--list__list"],dataset:{nature:"field-component",view:"list",id:this.id}}),this.source.hasValue()||this.list.classList.add("empty"),e.currentState=null,this.elements.set(e,this.list),cn.call(this.projection,this.list,n),t.append(this.list)}let r=(0,U.valOrDefault)(i.add,$n);if(r){const{position:e="after",content:n,help:i,style:s}=r;let a=(0,U.createButton)({class:["field-action","field--list__add"],tabindex:0,title:i,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}});n.forEach((t=>{let e=Na.call(this,t,null,{focusable:!1});a.append(e)})),r.currentState=null,this.elements.set(r,a),cn.call(this.projection,a,s),"before"===e&&this.list?this.list.before(a):t.append(a)}return this.list&&this.source.getValue().forEach((t=>{var e=this.createItem(t);this.list.append(e)})),cn.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},_spaceHandler(t){this.notify(`Add or remove ${this.source.accept.name}`)},spaceHandler(t){return!!(0,U.isHTMLElement)(t)&&t.parentElement===this.list&&(this.createElement(),!0)},deleteHandler(t){return!(!Wn.call(this,t)||t.parentElement!==this.list||(this.delete(t),0))},escapeHandler(t){let e=!0;if(this.messageElement&&!tt(this.messageElement)&&(q(this.messageElement),e=!1),e){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));return this.environment.resolveElement(e).focus(e),!0}return this.focus(),!1},enterHandler(t){const e=(t=>Wn.call(this,t)?t:(0,U.findAncestor)(t,(t=>Wn.call(this,t)),5))(t);if((0,U.isNullOrUndefined)(e))return this.focus(),!1;const{action:n,index:i,component:r}=e.dataset;return"add"===n?(this.createElement(),!0):"remove"===n&&(this.delete(e.parentElement),!0)},backspaceHandler:t=>!1,clickHandler(t){const e=(t=>Wn.call(this,t)?t:(0,U.findAncestor)(t,(t=>Wn.call(this,t)),5))(t);if((0,U.isNullOrUndefined)(e))return;const{action:n,index:i,name:r}=e.dataset;"add"===n?this.createElement():"remove"===n&&this.delete(e.parentElement)},_arrowHandler(t,e){if(!(0,U.isHTMLElement)(e))return!1;let n=Yn.call(this,e);if(n){let e=ct(n,t,this.list);return!!(0,U.isHTMLElement)(e)&&(this.swapItem(n,e,!0),n.focus(),!0)}return!1},arrowHandler(t,e){if(!(0,U.isHTMLElement)(e))return!1;const{parentElement:n}=e,i=()=>!!this.parent&&this.parent.arrowHandler(t,this.element);if(n===this.list){let n=ct(e,t,this.list);return(0,U.isHTMLElement)(n)?(this.environment.resolveElement(n).focus(),!0):this.arrowHandler(t,this.list)}if(n!==this.element)return i();let r=ct(e,t,this.element);if(!(0,U.isHTMLElement)(r))return i();if(r===this.notification)return this.arrowHandler(t,r);if(r===this.list){if(!this.list.hasChildNodes())return i();"up"===t?r=pt(this.list):"down"===t?r=ht(this.list):"left"===t?r=dt(this.list):"right"===t&&(r=ut(this.list))}return r.focus(),!0},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.projection.listen&&!(0,U.isNullOrUndefined)(this.environment.activeReceiver)?this.environment.activeReceiver.addItem(t,this,this.schema.list.item.template.tag):this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.projection.listen&&!(0,U.isNullOrUndefined)(this.environment.activeReceiver)?this.environment.activeReceiver.removeItem(t):this.removeItem(t)})),this.projection.registerHandler("value.changed",(t=>{this.clear(),this.list&&this.source.getValue().forEach((t=>{let e=this.createItem(t);this.list.append(e)}))})),this.projection.registerHandler("value.swapped",(t=>{const[e,n]=t;let i=this.getItem(e),r=this.getItem(n),s=+this.getItemIndex(i);this.getItemIndex(r),s!==e.index&&this.swapItem(i,r)}))}},Gn=Object.assign(Object.create(Nn),Xn);Object.defineProperty(Gn,"size",{get(){return this.items.size}}),Object.defineProperty(Gn,"hasList",{get(){return(0,U.isHTMLElement)(this.list)}});const Jn={init(){return this},render(){const t=(0,U.createDocFragment)(),{content:e,mv:n}=this.schema;var i=new DOMParser;return(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:[],dataset:{nature:"field",view:"static",id:this.id}})),(0,U.isHTMLElement)(this.content)||(this.content=i.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)),(0,U.isNullOrUndefined)(this.mv)&&(this.mv=n),t.hasChildNodes()&&this.element.appendChild(t),this}},Zn=Object.assign(Object.create(Nn),Jn);var Qn=0;const Kn={content:{type:"static",static:{type:"text",content:"Add"}}},ti={content:{type:"static",static:{type:"text",content:"Remove"}}},ei={table:null,header:null,body:null,footer:null,elements:null,contentElements:null,content:null,init(){const{content:t=[],template:e,focusable:n=!0}=this.schema;return this.elements=new Map,this.focusable=n,this.content=t,this.contentElements=new Map,this.template=this.model.getProjectionSchema(this.source.accept,e.tag)[0].projection,this},render(){const{content:t,action:e={}}=this.schema,{disposition:n}=this.template,i=(0,U.createDocFragment)();if(!Array.isArray(t))throw new Error("Empty content for listfield");if((0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({class:["field","field--table"],id:this.id,tabindex:-1,dataset:{nature:"field",view:"table",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),cn.call(this.projection,this.element,this.schema.style)),t.forEach((t=>{if("table"===t.type){let e=(0,U.valOrDefault)(t.table,{});const{style:n,header:r,body:s={},footer:a}=e;if(this.table=(0,U.createTable)({class:["field--table__table"],tabindex:0,dataset:{nature:"field-component",view:"table",id:this.id}}),r){const{style:t}=r;this.header=(0,U.createTableHeader)({class:["field--table-header"],dataset:{nature:"field-component",view:"table",id:this.id}}),cn.call(this.projection,this.header,t),this.table.append(this.header)}if(s){const{style:t}=s;this.body=(0,U.createTableBody)({class:["field--table-body"],dataset:{nature:"field-component",view:"table",id:this.id}}),cn.call(this.projection,this.body,t),this.table.append(this.body)}if(a){const{style:t}=a;this.footer=(0,U.createTableFooter)({class:["field--table-footer"],dataset:{nature:"field-component",view:"table",id:this.id}}),cn.call(this.projection,this.footer,t),this.table.append(this.footer)}e.currentState=null,this.contentElements.set(e,this.table),cn.call(this.projection,this.table,n),i.append(this.table)}else if("action"===t.type){let e=(0,U.valOrDefault)(t,Kn);const{content:n,style:r}=e;let s=Na.call(this,n,null),a=(0,U.createButton)({class:["field-action","field--table__add"],tabindex:0,dataset:{nature:"field-component",view:"table",component:"action",id:this.id,action:"add"}},[s]);e.currentState=null,this.contentElements.set(e,a),cn.call(this.projection,a,r),i.append(a)}else{let e=Na.call(this,t);this.contentElements.set(t,e),i.append(e)}})),this.header){let t=(0,U.createTableRow)({class:["field--table-header-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id}});n.forEach((e=>{const{header:n}=e,{style:i,content:r}=n;var s=Na.call(this,r),a=(0,U.createTableHeaderCell)({class:["field--table-header-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},s);cn.call(this.projection,a,i),t.append(a)}));let e=(0,U.createTableCell)({class:["field--table-header-cell","field--table-header-cell--action"]},"Action");t.append(e),this.header.append(t)}return this.source.hasValue()&&this.source.getValue().forEach((t=>{this.addRow(t)})),i.hasChildNodes()&&(this.element.append(i),this.bindEvents()),this.refresh(),this.element},hasChanges:()=>!1,hasValue(){return this.body.rows.length>0},getValue(){return this.body.rows},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.table.classList.remove("empty")):(this.element.classList.add("empty"),this.table.classList.add("empty")),this.contentElements.forEach(((t,e)=>{if(!Array.isArray(e.state))return;const{currentState:n}=e,i=jn.call(this,e,e.state);if(n===e.currentState)return;let r=null;r=i?Na.call(this,i.content,null):Na.call(this,e.content,null),(0,U.removeChildren)(t).append(r)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},createElement(){return this.source.createElement()},addRow(t){const{action:e={},before:n={},after:i={}}=this.schema,{disposition:r}=this.template,s=(0,U.valOrDefault)(t.index,this.table.rows.length),a="row"+Qn++,o=(0,U.createTableRow)({class:["field--table-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id,index:s,elementId:a}});this.elements.set(a,o),r.forEach((e=>{const{body:n}=e,{style:i,content:r}=n;var s=Na.call(this,r,t),a=(0,U.createTableCell)({class:["field--table-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},s);cn.call(this.projection,a,i),o.append(a)}));var l=(0,U.createTableCell)({class:["field--table__cell-action"]}),{content:c,style:h}=(0,U.valOrDefault)(e.remove,ti),u=Na.call(this,c),d=(0,U.createButton)({class:["btn","field--table__button"],dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"remove",rowId:a}},u),p=(0,U.createButton)({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-up",rowId:a}},"Move up"),f=(0,U.createButton)({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-down",rowId:a}},"Move down");cn.call(this.projection,d,h),l.append(d,p,f),o.append(l),this.body.append(o),this.refresh()},removeRow(t){var e=this.body.rows.item(t.index);if(!(0,U.isHTMLElement)(e))throw new Error("Table error: Row not found");(0,U.removeChildren)(e),e.remove();for(let e=t.index;e<this.body.rows.length;e++){const t=this.body.rows.item(e),{index:n}=t.dataset;t.dataset.index=+n-1}this.refresh()},removeElement(t){return this.source.removeElement(t)},delete(t){if(t===this.element||t===this.table)return void this.source.delete();const{index:e}=t.dataset;this.source.removeElementAt(+e)||(this.environment.notify("This element cannot be deleted"),$(t))},bindEvents(){this.element.addEventListener("click",(t=>{const{target:e}=t,n=function(t){const e="field-component";return t.dataset.nature===e?t:(0,U.findAncestor)(t,(t=>t.dataset.nature===e))}(e);if(!(0,U.isHTMLElement)(n))return;const{id:i,action:r}=n.dataset;if(i===this.id)if("add"===r)this.createElement();else if("remove"===r){const{rowId:t}=n.dataset;let e=this.elements.get(t);this.delete(e)}else if("move-up"===r){const{rowId:t}=n.dataset;let e=this.elements.get(t),i=e.previousElementSibling;i&&i.before(e)}else if("move-down"===r){const{rowId:t}=n.dataset;let e=this.elements.get(t),i=e.nextElementSibling;i&&i.after(e)}}),!0),this.projection.registerHandler("value.added",(t=>{this.addRow(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeRow(t)})),this.projection.registerHandler("value.changed",(t=>{(0,U.removeChildren)(this.body),this.source.getValue().forEach((t=>{this.addRow(t)}))}))}},ni=Object.assign(Object.create(Nn),ei),ii=t=>(0,U.isHTMLElement)(t,["input","textarea"]),ri="error";function si(){return(0,U.isHTMLElement)(this.choice)||(this.choice=(0,U.createUnorderedList)({class:["bare-list","field--textbox__choices"],dataset:{nature:"field-component",view:"text",component:"choice",id:this.id}}),this.append(this.choice)),this.choice}function ai(t){return(0,U.createListItem)({class:["field--textbox__choice"],tabindex:0,dataset:{nature:"field-component",view:"text",component:"choice-item",value:t,id:this.id}},t)}function oi(t){return t.parentElement===this.choice?t:(0,U.findAncestor)(t,(t=>t.parentElement===this.choice),3)}function li(t){const{placeholder:e="",type:n}=t;let i="";return i=this._placeholder?(0,U.valOrDefault)(xa.call(this,this._placeholder),""):(0,U.valOrDefault)(xa.call(this,e),""),this.readonly||this.resizable?(0,U.createSpan)({class:["field--textbox__input","field--textbox__input-pseudo"],editable:!this.readonly,title:i,dataset:{placeholder:i,nature:"field-component",view:this.type,id:this.id}}):this.multiline?(0,U.createTextArea)({class:["field--textbox__input"],placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}}):(0,U.createInput)({class:["field--textbox__input"],type:(0,U.valOrDefault)(n,"text"),placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}})}const ci={input:null,choice:null,value:"",placeholder:null,multiline:!1,resizable:!1,content:null,hasOwnSource:!1,init(t={}){Object.assign(this.schema,t);const{multiline:e=!1,placeholder:n="",resizable:i=!1,focusable:r=!0,source:s}=this.schema;if(this.multiline=e,this.focusable=r,this.resizable=i,this.children=[],this._placeholder=n,s){const t=this.projection.concept.getAttribute(s).getTarget();t.register(this),this.source=t,this.hasOwnSource=!0}return(0,U.hasOwn)(this.schema,"choice")||(this.schema.choice={}),this},focus(t){return this.input.focus(),this},focusIn(){return this.focused=!0,this.value=this.getValue(),this.element.classList.add("active"),this.element.classList.add("focus"),this},focusOut(){return this.hasChanges()&&this.setValue(this.getValue(),!0),(0,U.isNullOrWhitespace)(this.getValue())&&(this.input.textContent=""),this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.choice&&q(this.choice),this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("focus"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!=this.getValue()},hasValue(){return!(0,U.isEmpty)(this.getValue())},getValue(){return ii(this.input)?this.input.value:this.input.textContent},setValue(t,e=!1){var n;(n=e?this.source.setValue(t):{success:!0}).success||($(this.element),this.environment.notify(n.message,"error")),this.setInputValue(t),this.value=t,this.refresh()},setInputValue(t){ii(this.input)?this.input.value=t:this.input.textContent=t},getCandidates(){let t=this.source.getCandidates();return Array.isArray(t)?t:[]},enable(){return this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1,this.element.classList.add("disabled"),this},disable(){return this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0,this.element.classList.remove("disabled"),this},refresh(){jn.call(this,this.schema,this.schema.state),this.hasValue()?this.element.classList.remove("empty"):this.element.classList.add("empty"),this.element.dataset.value=this.value,this.hasError?(this.element.classList.add(ri),this.input.classList.add(ri)):(this.element.classList.remove(ri),this.input.classList.remove(ri)),this.choice&&this.filterChoice(this.getValue())},render(){const t=(0,U.createDocFragment)(),{container:e,input:n={},style:i}=this.schema;if((0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:["field","text-field","field--textbox"],dataset:{nature:"field",view:"text",id:this.id,disabled:this.disabled,readonly:this.readonly,value:""}}),this.readonly&&this.element.classList.add("readonly"),this.disabled&&this.element.classList.add("disabled"),cn.call(this.projection,this.element,this.schema.style)),e){const{content:n=[],style:i}=e;n.forEach((e=>{if("input"===e.type){const{style:n}=e.input;this.input=li.call(this,e.input),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",cn.call(this.projection,this.input,n),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}else{let n=Na.call(this,e,null,{focusable:!1});t.append(n)}})),cn.call(this.projection,this.element,i)}else{if(!(0,U.isHTMLElement)(this.input)){const{style:e}=n;this.input=li.call(this,n),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",cn.call(this,this.input,e),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}cn.call(this.projection,this.element,i)}return t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},filterChoice(t){const{children:e}=this.choice;if((0,U.isNullOrWhitespace)(t)){for(let t=0;t<e.length;t++){const n=e[t];B(n),n.hidden=!1}return!0}let n=t.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let t=0;t<e.length;t++){const i=e[t],{value:r}=i.dataset;n.some((t=>r.toLowerCase().includes(t)))?(B(i),i.hidden=!1):(q(i),i.hidden=!0)}return!0},selectChoice(t){if(!(0,U.isHTMLElement)(t))return;const e=function(t){return t.dataset.value}(t);return this.setValue(e,!0),this.input.focus(),q(this.choice),this},update(t,e,n){"delete"!==t?"value.changed"===t&&this.setValue(e):this.delete()},_spaceHandler(t){const e=new Set(this.getCandidates());if(0===e.size)this.notify("Enter any text.",J.INFO);else{si.call(this);const t=(0,U.createDocFragment)();e.forEach((e=>t.append(ai.call(this,e)))),(0,U.removeChildren)(this.choice).append(t),this.filterChoice(this.getValue()),B(this.choice)}},escapeHandler(t){let e=!0;if(this.messageElement&&!tt(this.messageElement)&&(q(this.messageElement),e=!1),this.choice&&!tt(this.choice)&&(q(this.choice),e=!1),e){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex)),n=this.environment.resolveElement(e);return n&&n.focus(e),!1}return this.input.focus(),!0},enterHandler(t){const e=oi.call(this,t);return e?this.selectChoice(e):this.multiline||(t===this.input?this.setValue(this.getValue(),!0):this.focus()),!0},backspaceHandler(t){oi.call(this,t)&&this.input.focus()},clickHandler(t){const e=oi.call(this,t);(0,U.isHTMLElement)(e)&&this.selectChoice(e)},arrowHandler(t,e){if(!(0,U.isHTMLElement)(e))return!1;const{parentElement:n}=e,i=()=>!!this.parent&&this.parent.arrowHandler(t,this.element);let r=oi.call(this,e);if((0,U.isHTMLElement)(r)){let e=ct(r,t,this.choice);return(0,U.isHTMLElement)(e)?(e.focus(),!0):this.arrowHandler(t,this.choice)}if(n!==this.element)return i();let s=null;if("right"===t){if(e===this.input&&!(this.getValue().length<D(this.input)+1))return!1;s=ct(e,t,this.element,!1)}else if("left"===t){if(e===this.input&&0!==D(this.input))return!1;s=ct(e,t,this.element,!1)}else s=ct(e,t,this.element,!1);return(0,U.isHTMLElement)(s)&&s.dataset.id===this.id?("up"===t?s=pt(this.choice):"down"===t?s=ht(this.choice):"left"===t?s=dt(this.choice):"right"===t&&(s=ut(this.choice)),s.focus(),!0):i()},bindEvents(){this.element.addEventListener("input",(t=>{this.hasError&&this.source.setValue(this.getValue(),!0),this.refresh()})),this.hasOwnSource||this.projection.registerHandler("value.changed",(t=>{this.setValue(t)}))}},hi=Object.assign(Object.create(Nn),ci);var ui=n(7496);const di={init(){const{arrowStyle:t=null,path:e,attach:n={}}=this.schema;return(0,U.isNullOrUndefined)(t)?this.arrowStyle={}:this.arrowStyle=t,e&&(this.meet=e.meet),n&&(this.attach=n.type),this},render(){const{reference:t,decorator:e=!1}=this.schema;if((0,U.isHTMLElement)(this.element)||(this.element=document.createElementNS("http://www.w3.org/2000/svg","path"),this.element.style.fill="transparent",this.element.id=this.id,this.element.classList.add("field"),this.element.tabindex=-1,this.element.dataset.nature="field",this.element.dataset.view="arrow",this.element.dataset.id=this.id),(0,U.isNullOrUndefined)(this.reference))switch(t.type){case"multiple":this.reference=this.source.getAttributeByName(t.listen).target,this.multiple=!0;break;case"duo":this.from=this.source.getAttributeByName(t.from).target,this.to=this.source.getAttributeByName(t.to).target,this.multiple=!1}return this.computeStyle(),this.bindEvent(),this.element},getStyle(){},signal(){(0,U.isNullOrUndefined)(this.valSource)||(0,U.isNullOrUndefined)(this.valTarget)||this.projection.parent.accept(this.valSource,this.valTarget,this)},computeStyle(){const{stroke:t="black",dasharray:e=null,width:n=1,linecap:i="butt",end:r=!1,start:s=!1}=this.arrowStyle;this.element.style.stroke=t,(0,U.isNullOrUndefined)(e)||(this.element.style["stroke-dasharray"]=e),this.element.style["stroke-width"]=(0,U.valOrDefault)(n,5),this.element.style["stroke-linecap"]=i,r&&this.createMarkerEnd()},createMarkerEnd(){(0,U.isNullOrUndefined)(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.end=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.end.id="marker"+this.id,this.end.setAttribute("refY",5),this.end.setAttribute("refX",10),this.end.setAttribute("markerUnit","strokeWidth"),this.end.setAttribute("markerWidth",10),this.end.setAttribute("markerHeight",10),this.end.setAttribute("orient","auto"),this.end.classList.add("end");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t.setAttribute("fill","black"),this.end.appendChild(t),this.definitions.appendChild(this.end),this.path.setAttribute("marker-end","url(#"+this.end.id+")")},createMarkerStart(){(0,U.isNullOrUndefined)(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.start=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.start.id="marker"+this.id,this.start.setAttribute("refY",5),this.start.setAttribute("refX",1),this.start.setAttribute("markerUnit","strokeWidth"),this.start.setAttribute("markerWidth",10),this.start.setAttribute("markerHeight",10),this.start.setAttribute("orient","auto"),this.start.classList.add("start");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t.setAttribute("fill","black"),this.start.appendChild(t),this.definitions.appendChild(this.end),this.element.setAttribute("marker-start","url(#"+this.end.id+")")},setValues(){(0,U.isNullOrUndefined)(this.source.getAttributeByName("target").target.value)||(this.valTarget=this.source.getAttributeByName("target").target.value),(0,U.isNullOrUndefined)(this.source.getAttributeByName("source").target.value)||(this.valSource=this.source.getAttributeByName("source").target.value)},refresh(){this.setValues(),this.updateRegister(),this.signal()},deleteRef(t,e){this.valTarget!==t.id&&this.valSource!==t.id||this.projection.parent.removeArrow(this,e)},setLine(t,e){this.element.setAttribute("d","M "+t.x+", "+t.y+"L "+e.x+", "+e.y)},setPath(t){this.element.setAttribute("d",t)},updateRegister(){for(let t=0;t<this.registered.length;t++)this.registered[t]={name:this.registered[t].name,value:this.source.getAttributeByName(this.registered[t].name).target.value}},register(t){(0,U.isNullOrUndefined)(this.getAttribute)&&(this.registered.push({name:t,value:this.source.getAttributeByName(t).target.value}),this.source.getAttributeByName(t).target.register(this.projection),this.projection.registerHandler("value.added",(t=>{this.refresh()})))},get(t){for(let e=0;e<this.registered.length;e++)if(this.registered[e].name===t)return this.registered[e].value},registerValue(t){(0,U.isNullOrUndefined)(this.registered)&&(this.registered=[]),t.register(this),this.registered.push({concept:t,currentVal:t.value})},update(t,e){"value.changed"===t&&this.updatePath(e)},updatePath(){this.lineUpdate(),this.parent.container.append(this.element)},updatePathDuo(){"anchor"===this.attach&&this.anchorAttach()},anchorAttach(){this.occupied&&ui.AnchorHandler.freeOccupation(this),this.occupant&&this.occupant.removeAnchor(this);let t=this.parent.container.querySelector('[data-concept="'+this.valueF+'"]'),e=this.parent.container.querySelector('[data-concept="'+this.valueT+'"]'),n=ui.AnchorHandler.findCommonIndex(t.dataset.id,e.dataset.id,this.occupant,this),i=ui.AnchorHandler.getAnchorAt(t.dataset.id,n),r=ui.AnchorHandler.getAnchorAt(e.dataset.id,n),s=t.getBoundingClientRect(),a=this.parent.container.createSVGPoint();a.x=s.x+i.x,a.y=s.y+i.y;let o=a.matrixTransform(this.parent.container.getScreenCTM().inverse());s=e.getBoundingClientRect(),a.x=s.x+r.x,a.y=s.y+r.y;let l=a.matrixTransform(this.parent.container.getScreenCTM().inverse());this.setPath("M "+o.x+" "+o.y+" L "+l.x+" "+l.y),this.parent.container.append(this.element),this.occupant&&this.occupant.accept(this,o,l,n),ui.AnchorHandler.registerOccupation(this,n,t.dataset.id,e.dataset.id),this.occupied=!0},forceAnchor(t){let e=this.parent.container.querySelector('[data-concept="'+this.valueF+'"]'),n=this.parent.container.querySelector('[data-concept="'+this.valueT+'"]'),i=ui.AnchorHandler.getAnchorAt(e.dataset.id,t),r=ui.AnchorHandler.getAnchorAt(n.dataset.id,t),s=e.getBoundingClientRect(),a=this.parent.container.createSVGPoint();a.x=s.x+i.x,a.y=s.y+i.y;let o=a.matrixTransform(this.parent.container.getScreenCTM().inverse());s=n.getBoundingClientRect(),a.x=s.x+r.x,a.y=s.y+r.y;let l=a.matrixTransform(this.parent.container.getScreenCTM().inverse());return this.setPath("M "+o.x+" "+o.y+" L "+l.x+" "+l.y),this.parent.container.append(this.element),this.occupant&&this.occupant.accept(this,o,l,t),ui.AnchorHandler.registerOccupation(this,t,e.dataset.id,n.dataset.id),this.occupied=!0,{e:this,from:e.dataset.id,to:n.dataset.id,index:t}},lineUpdate(){let t=this.targetInformations();if("minY"===this.meet){let e=t[0].y,n=t[0];for(let i=1;i<t.length;i++){let r=t[i].y;r<e&&(e=r,n=t[i])}this.computeLineMin(t,t[0],n)}},computeLineMin(t,e,n,i){let r=e.x,s=n.x,a=e.y,o=(a-n.y)/(r-s),l=a-o*r;(0,U.isNullOrUndefined)(i)||(l-=i);for(let i=0;i<t.length;i++){let r=o*t[i].x+l;if(r>t[i].y)return this.computeLineMin(t,e,n,r-t[i].y)}let c="M "+(r-.5)+" "+(s*o+l)+" L "+(t[t.length-1].x+.5)+" "+(s*o+l);this.setPath(c),(0,U.isNullOrUndefined)(this.subPath)&&(this.subPath=[]),(0,U.isEmpty)(this.subPath)||(this.subPath.forEach((t=>{t.remove()})),this.subPath=[]);let h=s*o+l;for(let e=0;e<t.length;e++)if(t[e].y>h){let n=document.createElementNS("http://www.w3.org/2000/svg","line");n.classList.add("subPath"),this.subPath.push(n),n.setAttribute("x1",t[e].x),n.setAttribute("x2",t[e].x),n.setAttribute("y1",t[e].y),n.setAttribute("y2",h),this.parent.container.append(n),n.style["stroke-width"]=.75,n.setAttribute("stroke","black")}},targetInformations(){let t=[],e=!1;return this.registered.forEach((n=>{let i=n.concept.value;if((0,U.isNullOrUndefined)(i))return void(e=!0);let r=this.parent.container.querySelector('[data-concept="'+i+'"]'),s=this.projection.resolveElement(r),a=this.parent.container.createSVGPoint(),o=r.getBoundingClientRect();a.x=o.x,a.y=o.y;let l=a.matrixTransform(this.parent.container.getScreenCTM().inverse());(0,U.isNullOrUndefined)(s.schema.arrowAnchor)||(l.x+=s.schema.arrowAnchor.x,l.y+=s.schema.arrowAnchor.y),t.push({x:l.x,y:l.y})})),!e&&t},duoUpdate(){this.valueF=this.from.value,this.valueT=this.to.value,(0,U.isNullOrUndefined)(this.valueF)||(0,U.isNullOrUndefined)(this.valueT)||this.updatePathDuo()},updatePosition(t){let e=this.projection.resolveElement(this.projection.parent.findItem(t.id).render),n=this.projection.resolveElement(this.projection.parent.findAncestor(this.bind.container).render),i=n.findAnchorIndex(this.bind.container),r=e.findAnchor(i),s=n.findAnchor(i);const a=Number(n.container.getAttribute("x"))+s.x,o=Number(n.container.getAttribute("y"))+s.y,l=Number(e.container.getAttribute("x"))+r.x,c=Number(e.container.getAttribute("y"))+r.y;this.element.setAttribute("d","M "+a+" "+o+" L "+l+" "+c),this.projection.parent.container.append(this.element)},bindProj(t){this.bind=t;const e=this.schema.reference.target;this.objectiv=this.source.getAttributeByName(e).target,this.objectiv.register(this.projection),this.projection.registerHandler("value.changed",(t=>{this.updatePosition(t)}))},bindEvent(){switch(this.schema.reference.type){case"duo":this.from.register(this.projection),this.to.register(this.projection),this.projection.registerHandler("value.changed",(t=>{this.duoUpdate()}));break;case"multiple":this.reference.register(this.projection),this.projection.registerHandler("value.added",(t=>{this.registerValue(t)}))}}},pi=Object.assign(Object.create(Nn),di),fi={init(t){if(!(0,U.isNullOrUndefined)(t)){const{focusable:e=!1}=t;this.focusable=e}return this},render(){const{placeholder:t,style:e,readonly:n,breakDown:i=!1,linebreak:r=!1}=this.schema;return(0,U.isNullOrUndefined)(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","text"),this.element.id=this.id,this.element.classList.add("field"),this.element.tabindex=-1,this.element.dataset.nature="field",this.element.dataset.view="svg",this.element.style["dominant-baseline"]="hanging",this.element.dataset.id=this.id,this.element.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")),this.source.hasValue()?this.content=this.source.getValue().toString():this.content=t,i&&(this.breakDown=i),this.breakDown?this.element.textContent=this.content.substring(0,i):this.element.textContent=this.content,r&&(this.linebreak=r),this.caps=!1,this.readonly=n,this.bindEvents(),this.style(),this.element},registerDimensionsObserver(t){(0,U.isNullOrUndefined)(this.observers)&&(this.observers=[]),this.observers.push(t)},setActiveChar(t,e,n){let{target:i,end:r=!1}=this.findChar(e,n);this.index=i,this.end=r,this.char=r?this.element.getEndPositionOfChar(i):this.element.getStartPositionOfChar(i),this.createCursor(),this.switchOn(),this.addListeners()},style(){const{font:t,size:e,anchor:n="left",weight:i,baseline:r}=this.schema.style;this.element.setAttribute("text-anchor",n),this.element.setAttribute("font-family",t),this.element.setAttribute("font-size",e),this.element.style["dominant-baseline"]=r,i&&this.element.setAttribute("font-weight",i),this.baseline=r,this.size=e},setValue(){"number"===this.source.name?this.source.setValue(Number(this.content)):this.source.setValue(this.content),this.parent.updateSize()},addListeners(){this.element.addEventListener("keydown",(t=>{let e=t.keyCode;if(27===e)return""===this.content&&(this.content=this.schema.placeholder,this.element.textContent=this.content),this.setValue(this.content),void this.switchOff();if(t.stopPropagation(),e!==this.lastKey||!this.repeat){switch(e){case 8:0===this.index&&this.end&&""!==this.content&&(this.content="",this.element.textContent=""),this.index>0&&(this.end?(this.content=this.content.slice(0,this.index),this.element.textContent=this.content):(this.content=this.content.slice(0,this.index-1)+this.content.slice(this.index),this.element.textContent=this.content),this.index--);break;case 46:this.index<this.content.length-1&&!this.end&&(this.content=this.content.slice(0,this.index)+this.content.slice(this.index+1),this.element.textContent=this.content),this.index!==this.content.length-1||this.end||(this.content=this.content.slice(0,this.index),this.element.textContent=this.content,this.end=!0,this.index--),0===this.index&&1===this.content.length&&(this.content="",this.element.textContent=this.content);break;case 20:this.caps=!this.caps;break;case 32:t.preventDefault(),this.end?(this.content+=" ",this.element.textContent=this.content):(this.content=this.content.slice(0,this.index)+" "+this.content.slice(this.index),this.element.textContent=this.content),this.index++}"number"!==this.source.name&&(e>=65&&e<=90||e>=48&&e<=57||e>=90&&e<=105)&&(this.caps?this.end?this.content=this.content+String.fromCharCode(t.keyCode):this.content=this.content.slice(0,this.index)+String.fromCharCode(t.keyCode)+this.content.slice(this.index):this.end?this.content=this.content+String.fromCharCode(t.keyCode).toLowerCase():this.content=this.content.slice(0,this.index)+String.fromCharCode(t.keyCode).toLowerCase()+this.content.slice(this.index),this.element.textContent=this.content,this.index++),"number"===this.source.name&&(e>=48&&e<=57||e>=96&&e<=105)&&(e>=96&&e<=105&&(e-=48),this.end?this.content=this.content+String.fromCharCode(e):this.content=this.content.slice(0,this.index)+String.fromCharCode(e)+this.content.slice(this.index),this.element.textContent=this.content,this.index++),this.lastKey=t.keyCode,this.repeat=!0,setTimeout((()=>{this.repeat=!1}),50),this.updateCursor(),this.setValue(this.content)}}))},switchOn(){this.on=!0,this.element.parentNode.append(this.cursor),(0,U.isNullOrUndefined)(this.interval)||clearInterval(this.interval),this.interval=setInterval((()=>{this.on?(this.cursor.remove(),this.on=!1):(this.element.parentNode.append(this.cursor),this.on=!0)}),1e3)},switchOff(){this.on=!1,(0,U.isNullOrUndefined)(this.cursor)||this.cursor.remove(),clearInterval(this.interval)},createCursor(){(0,U.isNullOrUndefined)(this.cursor)||this.cursor.remove();let t=this.element.getBBox();switch(U.isNullOrUndefined&&(this.cursor=document.createElementNS("http://www.w3.org/2000/svg","rect")),this.cursor.setAttribute("x",this.char.x),this.baseline){case"middle":case"auto":this.cursor.setAttribute("y",Number(this.element.getAttribute("y"))-t.height/2);break;case"hanging":this.cursor.setAttribute("y",this.element.getAttribute("y"))}this.cursor.setAttribute("width",1),this.cursor.setAttribute("height",t.height)},updateCursor(){if(""!==this.content){if(this.end)return this.char=this.element.getEndPositionOfChar(this.content.length-1),void this.cursor.setAttribute("x",this.char.x);this.char=this.element.getStartPositionOfChar(this.index),this.cursor.setAttribute("x",this.char.x)}else this.cursor.setAttribute("x",Number(this.element.getAttribute("x")))},findChar(t,e){let n=0,i=this.element.getStartPositionOfChar(0),r=i.x,s=this.element.getBoundingClientRect().x,a=(t-s)*(t-s);for(let e=1;e<this.element.getNumberOfChars();e++){let i=t-(s-r+this.element.getStartPositionOfChar(e).x);if(!(a>i*i))return{target:e,end:!1};a=i*i,n=e}i=this.element.getEndPositionOfChar(this.element.getNumberOfChars()-1);let o=t-(s-r+i.x);return o*o<a?{target:this.element.getNumberOfChars()-1,end:!0}:{target:this.element.getNumberOfChars()-1,end:!1}},findCharRelative(t){let e,n=0,i=this.element.getStartPositionOfChar(0),r=t.x-i.x,s=t.y-i.y,a=Math.sqrt(r*r+s*s),o=a;for(e=1;e<this.element.getNumberOfChars();e++){if(i=this.element.getStartPositionOfChar(e),r=t.x-i.x,s=t.y-i.y,a=Math.sqrt(r*r+s*s),!(a<o))return{target:n,start:!0};o=a,n=e}return i=this.element.getEndPositionOfChar(e-1),r=t.x-i.x,s=t.y-i.y,a=Math.sqrt(r*r+s*s),a<o?{target:e-1,start:!1,end:!0}:{target:n,start:!0}},focusIn(){},focusOut(){this.readonly||(this.switchOff(),this.setValue(this.content))},bindEvents(){this.readonly||this.element.addEventListener("click",(t=>{this.setActiveChar(t.target,t.clientX,t.clientY)})),this.projection.registerHandler("value.changed",(t=>{this.content=t.toString(),this.breakDown&&t.length>this.breakDown?this.element.textContent=this.content.substring(0,this.breakDown):this.element.textContent=this.content}))}},mi=Object.assign(Object.create(Nn),fi),gi={createHolder(t){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return e.append(n),n.append(t),e},analysePos(t,e){let n=e.coordinates;const i={};return i.type=n.type,i.render=t,"delegate"===n.type?i.await=!1:(i.anchor=n.anchor,i.x=n.x,i.y=n.y,i.await=!0),i},positionElement(t,e){switch(t.anchor){case"middle":return e.setAttribute("x",t.x-Number(e.getAttribute("width"))/2),void e.setAttribute("y",t.y);case"right":return e.setAttribute("x",t.x-Number(e.getAttribute("width"))),void e.setAttribute("y",t.y);case"center":return e.setAttribute("x",t.x-Number(e.getAttribute("width"))/2),void e.setAttribute("y",t.x-Number(e.getAttribute("height"))/2);default:e.setAttribute("x",t.x),e.setAttribute("y",t.y)}},analyseDim(t,e){let n=e.dimension;const i={};switch(i.type=n.type,i.item=t,n.type){case"fixed":i.value=n.value,i.holder=this.createHolder(t),i.await=!0;break;case"absolute":i.width=n.width,i.height=n.height,i.holder=this.createHolder(t),i.await=!0;break;case"ratio":i.ratio=n.ratio,i.holder=this.createHolder(t),i.await=!0;break;case"pure":i.await=!1}return i},setDimensions(t){switch(t.type){case"fixed":this.adaptFixed(t.item,t.value);break;case"absolute":this.adaptAbsolute(t.item,t.width,t.height);break;case"ratio":this.adaptRatio(t.item,t.ratio)}},adaptFixed(t,e){let n=t.parentNode,i=n.parentNode,r=t.getBoundingClientRect();n.setAttribute("width",r.width),n.setAttribute("height",r.height),i.setAttribute("width",e),i.setAttribute("height",e*r.height/r.width),i.setAttribute("viewBox","0 0 "+r.width+" "+r.height)},adaptAbsolute(t,e,n){let i=t.parentNode,r=i.parentNode;i.setAttribute("width",e),i.setAttribute("height",n),r.setAttribute("width",e),r.setAttribute("height",n)},adaptRatio(t,e){let n=Number(t.getAttribute("width")),i=Number(t.getAttribute("height")),r=t.parentNode,s=r.parentNode;r.setAttribute("width",n),r.setAttribute("height",i),s.setAttribute("width",n*e),s.setAttribute("height",i*e),s.setAttribute("viewBox","0 0 "+n+" "+i)}},{createDocFragment:bi,isNullOrUndefined:vi,createI:yi,createArticle:xi,findAncestor:wi,removeChildren:Ei,windowWidth:Ai,isObject:Ni,valOrDefault:Oi}=n(6689);function ki(t){const{type:e,value:n}=t.dataset;return"concept"===e?this.candidates.find((t=>t.id===n)).id:"meta-concept"===e?this.candidates.find((t=>t.name===n)).name:"value"===e?n:"placeholder"===e?null:n}const _i={init(){return this.width=0,this.height=0,this.items=new Map,this},render(){const{selection:t,dimensions:e,openSelection:n}=this.schema;if(vi(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.element.dataset.id=this.id,this.element.dataset.nature="field",this.element.dataset.view="svg-choice",this.element.id=this.id,this.element.classList.add("field"),this.element.classList.add("field--svg_choice")),e?(this.element.setAttribute("width",e.width),this.element.setAttribute("height",e.height)):this.element.style.overflow="visible",this.candidates=this.source.getCandidates(),vi(this.selection)&&(this.createSelection(t),this.element.append(this.selection)),n&&vi(this.openSelection)){const t=new DOMParser;this.openSelection=t.parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.element.append(this.openSelection),this.openSelection.addEventListener("click",(()=>{if(this.open)return this.selection.remove(),void(this.open=!1);this.element.append(this.selection),this.open=!0}))}return this.open=!0,this.bindEvents(),this.element},setValue(t){this.source.setValue(t)},createSelection(t){const{item:e,breakPoint:n=!1,direction:i,close:r}=t;this.selection=document.createElementNS("http://www.w3.org/2000/svg","svg");let s=0;this.candidates.forEach((t=>{const r=Ni(t),{dimension:a,tag:o}=e;let{holder:l,foreign:c}=this.createChoiceContainer(a);if(this.items.set(t.id,l),"meta-concept"===t.type){let e=this.model.getProjectionSchema(t.concept,Oi(o))[0],n=e.type,i={type:n,[n]:e.content||e.projection},r=Na.call(this,i,t.concept,{focusable:!1,meta:t.name});l.dataset.type="meta-concept",l.dataset.value=t.name,r.style.position="fixed",c.append(r)}else if(r){if(!this.model.hasProjectionSchema(t,o))return container;let e=this.model.createProjection(t,o).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection,c.append(e.render()),c.childNodes[0].style.position="fixed",l.dataset.type="concept",l.dataset.value=t.id}else c.append(t.toString());switch(i){case"horizontal":n?(l.setAttribute("y",~~(s/n)*a.height),l.setAttribute("x",s%n*a.width),this.width=n*a.width,this.height=(1+~~(s/n))*a.height):(l.setAttribute("x",s*a.width),this.width=(s+1)*a.width,this.height=a.height);break;case"vertical":n?(l.setAttribute("x",~~(s/n)*a.width),l.setAttribute("y",s%n*a.height)):l.setAttribute("y",s*a.height)}this.bindEvent(l),this.selection.append(l),l.style.border="dotted black",s++}))},registerDimensionsObserver(t){vi(this.observers)&&(this.observers=[]),this.observers.push(t)},notifyDimObservers(){vi(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))},bindEvent(t){t.addEventListener("click",(()=>{this.setValue(ki.call(this,t)),this.schema.selection.close&&(this.open=!1,this.selection.remove(),this.width=0,this.height=0,this.notifyDimObservers())}))},bindEvents(){this.projection.registerHandler("displayed",(()=>{this.displayed||(this.displayed=!0,this.items.forEach(((t,e)=>{const n=t.childNodes[0].childNodes[0];this.projection.resolveElement(n).projection.update("displayed")})))})),this.projection.registerHandler("value.changed",(()=>{this.schema.selection.close&&(this.open=!1,this.selection.remove(),this.width=0,this.height=0,this.notifyDimObservers())}))},createChoiceContainer(t){const{width:e,height:n}=t;let i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return i.setAttribute("width",e),i.setAttribute("height",n),r.setAttribute("width",e),r.setAttribute("height",n),i.append(r),{holder:i,foreign:r}},focusIn(){},focusOut(){}},ji=Object.assign(Object.create(Nn),_i),{createDocFragment:Mi,isNullOrUndefined:Ci,createI:Si,createArticle:Li,findAncestor:Ti,removeChildren:Ii,windowWidth:Ui,isObject:Di,valOrDefault:Hi}=n(6689);function Pi(t){const{type:e,value:n}=t.dataset;return"concept"===e?this.candidates.find((t=>t.id===n)).id:"meta-concept"===e?this.candidates.find((t=>t.name===n)).name:"value"===e?n:"placeholder"===e?null:n}const zi={init(){return this.width=0,this.height=0,this.items=new Map,this},render(){const{selection:t,dimensions:e,open:n,overflow:i=!1}=this.schema;if(Ci(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.element.dataset.id=this.id,this.element.dataset.nature="field",this.element.dataset.view="svg-placeholder",this.element.id=this.id,this.element.classList.add("field"),this.element.classList.add("field--svg_choice")),i&&(this.element.style.overflow="visible"),e&&(this.element.setAttribute("width",e.width),this.element.setAttribute("height",e.height)),Ci(this.openBack)){const{render:t,coordinates:e,dimensions:i}=n;this.openBack=Na.call(this,Object.assign(t,{action:{type:"OPEN",target:this}})),this.openBack.setAttribute("x",Hi(e.x,0)),this.openBack.setAttribute("y",Hi(e.y,0))}return this.candidates=this.source.getCandidates(),Ci(this.selection)&&(this.createSelection(t),this.element.append(this.selection)),Ci(this.source.value)?this.opened=!0:(this.opened=!1,this.element.append(this.openBack)),this.element},clickHandler(t){},setValue(t){this.source.setValue(t),this.element.append(this.openBack),this.opened=!1},open(){this.opened=!0,this.element.append(this.selection),this.openBack.remove(),this.source.removeValue()},createSelection(t){const{item:e,breakPoint:n=!1,direction:i,close:r}=t;this.selection=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.candidates.forEach((t=>{const n=Di(t),{tag:i}=e;if("meta-concept"===t.type){let e=this.model.getProjectionSchema(t.concept,Hi(i))[0],n=e.type,r={type:n,[n]:e.content||e.projection},s=Na.call(this,r,t.concept,{focusable:!1,meta:t.name});s.dataset.type="meta-concept",s.dataset.value=t.name;const a=this.projection.resolveElement(s).schema.coordinates;s.setAttribute("x",a.x),s.setAttribute("y",a.y),this.bindEvent(s),this.selection.append(s),this.items.set(t.id,s)}else if(n){if(!this.model.hasProjectionSchema(t,i))return container;let e=this.model.createProjection(t,i).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection;let n=e.render();const r=e.element.schema.coordinates;n.setAttribute("x",r.x),n.setAttribute("y",r.y),this.bindEvent(n),this.selection.append(n),this.items.set(t.id,n)}}))},focusIn(){this.opened||this.element.append(this.openBack)},focusOut(){this.opened||this.openBack.remove()},registerDimensionsObserver(t){Ci(this.observers)&&(this.observers=[]),this.observers.push(t)},notifyDimObservers(){Ci(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))},bindEvent(t){t.addEventListener("click",(()=>{const e=Pi.call(this,t);this.setValue(e),this.selection.remove(),this.element.append(this.openBack)}))}},Vi=Object.assign(Object.create(Nn),zi),{isNull:Ri,isNullOrUndefined:Bi}=n(6689),qi={init(){return this},render(){const{order:t,dimensions:e=!1}=this.schema;if(Bi(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.element.dataset.id=this.id,this.element.dataset.nature="field",this.element.dataset.view="svg-switch",this.element.id=this.id,this.element.classList.add("field"),this.element.classList.add("field--svg_choice")),e&&(this.element.setAttribute("width",e.width),this.element.setAttribute("height",e.height)),Bi(this.index)&&(this.index=0),this.order=t,this.source.hasValue())for(let t=0;t<this.order.length;t++)if(this.order[t]===this.source.value){this.index=t;break}return this.bindEvents(),this.element},clickHandler(){this.index=(this.index+1)%this.order.length,this.source.setValue(this.order[this.index])},registerDimensionsObserver(t){},focusIn(){},focusOut(){},bindEvents(){}},Fi=Object.assign(Object.create(Nn),qi),$i={binary:(t,e,n)=>Object.create(In,{object:{value:"field"},name:{value:"binary-field"},type:{value:"binary"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),choice:(t,e,n)=>Object.create(Vn,{object:{value:"field"},name:{value:"choice-field"},type:{value:"choice"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),list:(t,e,n)=>Object.create(Gn,{object:{value:"field"},name:{value:"list-field"},type:{value:"list"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),table:(t,e,n)=>Object.create(ni,{object:{value:"field"},name:{value:"table-field"},type:{value:"table"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),text:(t,e,n)=>Object.create(hi,{object:{value:"field"},name:{value:"text-field"},type:{value:"text"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),interactive:(t,e,n)=>Object.create(Fn,{object:{value:"field"},name:{value:"interactive-field"},type:{value:"interactive"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),static:(t,e,n)=>Object.create(Zn,{object:{value:"field"},name:{value:"static-field"},type:{value:"static"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),dynamic:(t,e,n)=>Object.create(Bn,{object:{value:"field"},name:{value:"dynamic-field"},type:{value:"dynamic"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),add:(t,e,n)=>Object.create(_n,{object:{value:"field"},name:{value:"add-field"},type:{value:"add"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),arrow:(t,e,n)=>Object.create(pi,{object:{value:"field"},name:{value:"arrow"},type:{value:"arrow"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),svg:(t,e,n)=>Object.create(mi,{object:{value:"field"},name:{value:"svg"},type:{value:"svg"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),"svg-choice":(t,e,n)=>Object.create(ji,{object:{value:"field"},name:{value:"switch"},type:{value:"switch"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),"svg-placeholder":(t,e,n)=>Object.create(Vi,{object:{value:"field"},name:{value:"switch"},type:{value:"switch"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),"svg-switch":(t,e,n)=>Object.create(Fi,{object:{value:"field"},name:{value:"switch"},type:{value:"switch"},id:{value:Yi()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}})};var Wi=0;const Yi=()=>"field"+Wi++,Xi={createField(t,e,n){const{type:i}=e,r=$i[i];if((0,U.isNullOrUndefined)(r))throw new Error(`Missing handler: The '${i}' field could not be handled`);var s=r(t,e,n);if((0,U.isNullOrUndefined)(s))throw new Error(`Bad request: The '${i}' field could not be created`);return s.errors=[],s.readonly=(0,U.valOrDefault)(e.readonly,!1),(0,U.isNullOrUndefined)(s.id)&&(s.id=Yi()),s}},Gi={init(){throw new Error("This function has not been implemented")},element:null,children:null,statusElement:null,attached:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasAttached(){return!(0,U.isEmpty)(this.attached)},attach(t,e){this.attached.push(t)},detach(t){this.attached.slice(this.attached.indexOf(t),1)},getAttached(t){return(0,U.isFunction)(t)?this.attached.filter((e=>t(e))):this.attached},show(){return B(this.element),this.visible=!0,this.active=!0,this},hide(){return q(this.element),this.visible=!1,this},toggle(){return F(this.container),this.visible=!this.visible,this},focus(){return this.element.focus(),this.focused=!0,this.active=!0,this},_focusIn:t=>!1,navigate(t,e,n){return this.focusable?(this.element.focus(),!0):this.parent.arrowHandler(t,this.element)},clear:()=>!0,delete(){this.environment.notify("This element cannot be removed",J.WARNING,1500),$(this.element)},spaceHandler(t){return this.arrowHandler("right",t)},_spaceHandler(t){return this.environment.notify("Nothing do here.",J.NORMAL,1500),!1},escapeHandler(t){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));return this.projection.resolveElement(e).focus(e),!0},enterHandler(t){this.element.click()},deleteHandler(t){return this.environment.notify("This element cannot be removed",J.WARNING,1500),$(this.element),!1},backspaceHandler(t){return this.arrowHandler("left",t)},arrowHandler(t,e){return!!this.parent&&this.parent.arrowHandler(t,e)},clickHandler:t=>(console.warn("CLICK_HANDLER NOT IMPLEMENTED"),!1),controlHandler:t=>(console.warn("CONTROL NOT IMPLEMENTED"),!1)},Ji=Object.assign(Gi),Zi={init(){return this.children=[],this},render(){const t=(0,U.createDocFragment)(),{help:e,style:n,content:i}=this.schema;return(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createAudio)({class:["static","audio-static"],src:i,dataset:{nature:"static",static:"audio",id:this.id,ignore:"all"}})),(0,U.isNullOrUndefined)(e)||(this.element.title=e),cn.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},bindEvents(){}},Qi=Object.assign(Object.create(Ji),Zi);function Ki(t,e){let n=t.param.find((t=>t.name===e));if((0,U.isNullOrUndefined)(n))return;const{type:i="string",value:r}=n;let s=(0,U.valOrDefault)(r,n.default);return(0,U.isNullOrUndefined)(s)?null:"string"===i?s.toString():"number"===i?+s:void 0}function tr(t){if((0,U.isNullOrUndefined)(t))return"";const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,U.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?Ki.call(this,this.schema.template,t.name):"raw"===e?(0,U.htmlToElement)(t.raw):t}function er(t){return(0,U.isNullOrWhitespace)(t)?"":t.startsWith("http://")||t.startsWith("https://")?new URL(t).href:er(`https://${t}`)}const nr={url:null,alt:null,width:null,height:null,init(){const{url:t,width:e,height:n,alt:i}=this.schema;return this.width=e,this.height=n,this.alt=i,this},render(){let t=!1;const{help:e,style:n,url:i}=this.schema;return this.url=er(tr.call(this,i)),(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createImage)({class:["static","image-static"],src:this.url,alt:this.alt,dataset:{nature:"static",static:"image",id:this.id,ignore:"all"}}),t=!0),(0,U.isNullOrUndefined)(this.width)||isNaN(this.width)||(this.element.width=this.width),(0,U.isNullOrUndefined)(this.height)||isNaN(this.height)||(this.element.height=this.height),(0,U.isNullOrUndefined)(e)||(this.element.title=e),cn.call(this.projection,this.element,n),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return(0,U.isNullOrWhitespace)(this.url)?this.element.classList.add("empty"):this.element.classList.remove("empty"),this},update(){const{url:t}=this.schema;return this.url=er(tr.call(this,t)),this.element.src=this.url,this.refresh(),this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.added",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.update()})))}},ir=Object.assign(Object.create(Ji),nr),rr={email:t=>`mailto:${t}`,phone:t=>`tel:${t}`,link:t=>`${t}`,url:t=>`${t}`};function sr(t,e){let n=t.param.find((t=>t.name===e));if((0,U.isNullOrUndefined)(n))return;const{type:i="string",value:r}=n;let s=(0,U.valOrDefault)(r,n.default);return(0,U.isNullOrUndefined)(s)?null:"string"===i?s.toString():"number"===i?+s:void 0}function ar(t){if((0,U.isNullOrUndefined)(t))return"";const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,U.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?sr.call(this,this.schema.template,t.name):"raw"===e?(0,U.htmlToElement)(t.raw):t}const or={url:null,urlType:null,href:null,hrefHandler:null,content:null,init(){const{content:t=[],urlType:e="link"}=this.schema;if(this.content=t,this.urlType=e,this.children=[],this.hrefHandler=rr[this.urlType],!(0,U.isFunction)(this.hrefHandler))throw new TypeError("type not handled");return this},render(){let t=!1;const e=(0,U.createDocFragment)(),{help:n,style:i,url:r}=this.schema;return this.href=this.hrefHandler(ar.call(this,r)),(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createAnchor)({class:["static","link"],href:this.href,dataset:{nature:"static",static:"link",id:this.id,ignore:"all"}}),"link"===this.urlType&&(this.element.target="_blank"),t=!0),this.content.forEach((t=>{let n=Na.call(this,t,this.projection.concept,{focusable:!1});e.append(n)})),(0,U.isNullOrUndefined)(n)||(this.element.title=n),cn.call(this.projection,this.element,i),e.hasChildNodes()&&this.element.append(e),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},update(){const{url:t}=this.schema;return this.element.href=this.hrefHandler(ar.call(this,t)),(0,U.removeChildren)(this.element),this.content.forEach((t=>{this.element.append(Na.call(this,t,this.projection.concept,{focusable:!1}))})),this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.added",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.update()})))}},lr=Object.assign(Object.create(Ji),or);function cr(t,e){let n=t.param.find((t=>t.name===e));if((0,U.isNullOrUndefined)(n))return;const{type:i="string",value:r}=n;let s=(0,U.valOrDefault)(r,n.default);return(0,U.isNullOrUndefined)(s)?null:"string"===i?s.toString():"number"===i?+s:void 0}function hr(t){if((0,U.isNullOrUndefined)(t))return"";const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,U.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?cr.call(this,this.schema.template,t.name):"html"===e?(0,U.htmlToElement)(t.html):"raw"===e?(0,U.htmlToElement)(t.raw):t}const ur={editable:null,focusable:null,hasProperty:!1,asHTML:!1,init(t={}){Object.assign(this.schema,t);const{content:e,editable:n=!1,focusable:i=!1}=this.schema;return this.children=[],this._content=e,this.editable=n,this.focusable=i,this},render(){let t=!1;const{content:e,help:n,style:i}=this.schema;if(!(0,U.isHTMLElement)(this.element)){if(this.element=(0,U.createSpan)({class:["text","static","text-static"],editable:this.editable,dataset:{nature:"static",view:"text",static:"text",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0),Array.isArray(e))e.forEach((t=>{let e=hr.call(this,t),n=(0,U.createSpan)({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",content:e,id:this.id,ignore:"all"}},e);cn.call(this.projection,n,t.style),this.element.append(n)}));else{let t=hr.call(this,e);this.element.append(t),this.element.content=t}t=!0}return(0,U.isNullOrUndefined)(n)||(this.element.title=n),cn.call(this.projection,this.element,i),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},getLength(){return this.element.textContent.length},backspaceHandler(t){return this.arrowHandler("left",t)},arrowHandler(t,e){if(!this.editable&&this.parent)return this.parent.arrowHandler(t,e);if("right"===t){if(this.getLength()<D(this.element)+1&&this.parent)return this.parent.arrowHandler(t,e)}else if("left"===t){if(0===D(this.element)&&this.parent)return this.parent.arrowHandler(t,e)}else if(this.parent)return this.parent.arrowHandler(t,e);return!1},escapeHandler(t){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));this.projection.resolveElement(e).focus(e)},update(){const{content:t}=this.schema;return(0,U.removeChildren)(this.element),Array.isArray(t)?t.forEach((t=>{this.element.append((0,U.createSpan)({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",id:this.id,ignore:"all"}},hr.call(this,t)))})):this.element.append(hr.call(this,t)),this},refresh(){return this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.added",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.update()})))}},dr=Object.assign(Object.create(Ji),ur),pr={contentType:null,editable:null,focusable:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0}=this.schema;return this.children=[],this.focusable=e,this},render(){const t=(0,U.createDocFragment)(),{help:e,style:n,content:i}=this.schema;return(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createButton)({class:["btn","static"],dataset:{nature:"static",view:"plink",static:"plink",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),i.forEach((e=>{let n=Na.call(this,e,this.projection.concept,{focusable:!1});t.append(n)})),(0,U.isNullOrUndefined)(e)||(this.element.title=e),cn.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(t,e){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(t,e)},escapeHandler(t){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));this.environment.resolveElement(e).focus(e)},enterHandler(t){const e=this.projection.schema.findIndex((t=>t.tags.includes(this.schema.tag)));return this.projection.changeView(e),!1},clickHandler(t){let e=this.projection.findView(this.schema.tag);return-1===e||this.projection.changeView(e),!1},refresh(){return this},bindEvents(){}},fr=Object.assign(Object.create(Ji),pr),mr={template:null,selector:null,content:null,init(){return this.selector=this.schema.selector,this.template=(0,U.getTemplate)(this.selector),this},render(){const{style:t,content:e}=this.schema;return(0,U.isNode)(this.element)||(this.element=(0,U.cloneTemplate)(this.template)),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},gr=Object.assign(Object.create(Ji),mr);function br(t,e){let n=t.param.find((t=>t.name===e));if((0,U.isNullOrUndefined)(n))return;const{type:i="string",value:r}=n;let s=(0,U.valOrDefault)(r,n.default);return(0,U.isNullOrUndefined)(s)?null:"string"===i?s.toString():"number"===i?+s:void 0}const vr={contentType:null,editable:null,focusable:null,disabled:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0,disabled:n=!1}=this.schema;return this.children=[],this.focusable=e,this.disabled=n,this},render(){const t=(0,U.createDocFragment)(),{help:e,style:n,content:i}=this.schema;return(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createButton)({class:["btn","static"],dataset:{nature:"static",view:"button",static:"button",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),i.forEach((e=>{let n=Na.call(this,e,this.projection.concept,{template:this.schema.template,focusable:!1});t.append(n)})),(0,U.isNullOrUndefined)(e)||(this.element.title=e),cn.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(t,e){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(t,e)},escapeHandler(t){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));this.environment.resolveElement(e).focus(e)},enterHandler(t){const e=this.projection.schema.findIndex((t=>t.tags.includes(this.schema.tag)));return this.projection.changeView(e),!1},clickHandler(t){let e=this.source;if(this.schema.bind&&(e=this.source.getValue(!0)),this.schema.action){const{type:t,value:n,target:i}=this.schema.action;if((0,U.isObject)(n))for(const t in n){const e=n[t];"param"===e.type&&(n[t]=br.call(this,this.schema.template,e.name))}switch(t){case"CREATE":(0,U.isNullOrUndefined)(i)?e.createElement():"attribute"===i.type&&e.getAttribute(i.name).target.createElement({value:n});break;case"SELECT":if((0,U.isNullOrUndefined)(i)&&e.createElement(),(0,U.isObject)(n))for(const t in n){const e=n[t];"param"===e.type&&(n[t]=br.call(this,this.schema.template,e.name))}"attribute"===i.type&&e.getAttribute(i.name).target.setValue((0,U.valOrDefault)(n.name,n)),"bind"===i.type&&e.setValue((0,U.valOrDefault)(n.name,n));break;case"CREATES":if((0,U.isNullOrUndefined)(i)&&e.createElement(),(0,U.isObject)(n))for(const t in n){const e=n[t];"param"===e.type&&(n[t]=br.call(this,this.schema.template,e.name))}"attribute"===i.type&&e.getAttribute(i.name).target.createElement().getAttribute(i.attribute).target.setValue((0,U.valOrDefault)(n.name,n));break;case"SIDE":let t=this.environment.createProjection(e,i),r=this.environment.findWindow("side-instance");(0,U.isNullOrUndefined)(r)&&(r=this.environment.createWindow("side-instance"),r.container.classList.add("model-projection-sideview")),r.instances.size>0&&Array.from(r.instances)[0].delete();let s=this.environment.createInstance(e,t,{type:"projection",close:"DELETE-PROJECTION"});r.addInstance(s)}return!1}return this.environment.triggerEvent({name:this.schema.trigger,args:[e]}),!1},refresh(){return this},bindEvents(){}},yr=Object.assign(Object.create(Ji),vr),xr={editable:null,focusable:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0}=this.schema;return this.focusable=e,this},render(){(0,U.createDocFragment)();const{help:t,style:e,content:n,external:i=!0,tag:r}=this.schema,s=new DOMParser;return(0,U.isHTMLElement)(this.element)||(this.element=s.parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.element.classList.add(["btn","static"]),this.element.dataset.nature="static",this.element.dataset.view="svg-alt",this.element.dataset.id=this.id,this.element.dataset.ignore="all",this.focusable&&(this.element.tabIndex=0)),(0,U.isNullOrUndefined)(t)||(this.element.title=t),this.refresh(),this.bindEvents(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(q(this.messageElement),(0,U.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(t,e){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(t,e)},escapeHandler(t){let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex));this.environment.resolveElement(e).focus(e)},enterHandler(t){const e=this.projection.schema.findIndex((t=>t.tags.includes(this.schema.tag)));return this.projection.changeView(e),!1},clickHandler(t){},refresh(){return this},bindEvents(){this.element.addEventListener("click",(()=>{let t=this.source,e=this.environment.createProjection(t,this.schema.tag),n=this.environment.findWindow("side-instance");(0,U.isNullOrUndefined)(n)&&(n=this.environment.createWindow("side-instance"),n.container.classList.add("model-projection-sideview")),n.instances.size>0&&Array.from(n.instances)[0].delete();let i=this.environment.createInstance(t,e,{type:"projection",close:"DELETE-PROJECTION"});n.addInstance(i)}))}},wr=Object.assign(Object.create(Ji),xr),Er={CREATE:function(t,e){this.source.createElement(e)},CREATES:function(t,e){this.source.createElement().setValue((0,U.valOrDefault)(e.name,e))},DELETE:Ar,EXTRACT:function(t,e){let n=this.projection.environment.actions.get("extract-instance")("graphical").getAttribute("shape").target.getAttribute("elements").target.createElement();n.setValue(this.source.name),Nr.call(this,n.getValue(!0)),Or.call(this,n.getValue(!0)),Ar.call(this)},SIDE:function(t,e){let n=this.environment.createProjection(this.source,t),i=this.environment.findWindow("side-instance");(0,U.isNullOrUndefined)(i)&&(i=this.environment.createWindow("side-instance"),i.container.classList.add("model-projection-sideview")),i.instances.size>0&&Array.from(i.instances)[0].delete();let r=this.environment.createInstance(this.source,n,{type:"projection",close:"DELETE-PROJECTION"});i.addInstance(r)},OPEN:function(t){(0,U.isNullOrUndefined)(this.target)&&(this.target=t),this.target.open()},"CREATE-TREE":function(t,e){let n=this.container;for(;(0,U.isNullOrUndefined)(n.getAttribute("data-tree"))&&n.getAttribute("data-tree")!==t;)n=n.parentNode;let i=this.source.createElement();this.environment.getActiveReceiver(t).accept(i,n,(0,U.valOrDefault)(e,"main"))}};function Ar(t,e){"prototype"!==this.source.parent.schema.nature?this.source.delete():this.source.parent.delete()}function Nr(t){switch(this.source.name){case"circle":t.getAttributeByName("cx").target.setValue(this.source.getAttributeByName("cx").target.value),t.getAttributeByName("cy").target.setValue(this.source.getAttributeByName("cy").target.value),t.getAttributeByName("r").target.setValue(this.source.getAttributeByName("r").target.value);break;case"ellipse":t.getAttributeByName("cx").target.setValue(this.source.getAttributeByName("cx").target.value),t.getAttributeByName("cy").target.setValue(this.source.getAttributeByName("cy").target.value),t.getAttributeByName("rx").target.setValue(this.source.getAttributeByName("rx").target.value),t.getAttributeByName("ry").target.setValue(this.source.getAttributeByName("ry").target.value);break;case"rectangle":t.getAttributeByName("x").target.setValue(this.source.getAttributeByName("x").target.value),t.getAttributeByName("y").target.setValue(this.source.getAttributeByName("y").target.value),t.getAttributeByName("width").target.setValue(this.source.getAttributeByName("width").target.value),t.getAttributeByName("height").target.setValue(this.source.getAttributeByName("height").target.value);break;case"polygon":t.getAttributeByName("points").target.setValue(this.source.getAttributeByName("points").target.value);break;case"path":t.getAttributeByName("d").target.setValue(this.source.getAttributeByName("d").target.value)}}function Or(t){const e=t.getAttributeByName("style").target,n=this.source.getAttributeByName("style").target;e.getAttributeByName("fill").target.setValue(n.getAttributeByName("fill").target.value),e.getAttributeByName("stroke").target.setValue(n.getAttributeByName("stroke").target.value),e.getAttributeByName("s-width").target.setValue(n.getAttributeByName("s-width").target.value),e.getAttributeByName("s-dash").target.setValue(n.getAttributeByName("s-dash").target.value),e.getAttributeByName("rx").target.setValue(n.getAttributeByName("rx").target.value),e.getAttributeByName("ry").target.setValue(n.getAttributeByName("ry").target.value)}const kr={init(){return this},render(){const{action:t,content:e}=this.schema;if((0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="static",this.container.dataset.algorithm="button",this.container.dataset.id=this.id),e&&(0,U.isNullOrUndefined)(this.content)&&this.createContent(e),this.schema.dimensions){const{width:t,height:e}=this.schema.dimensions;this.container.setAttribute("width",t),this.container.setAttribute("height",e)}return this.container.style.width="fit-content",this.container},createContent(t){const e=new DOMParser;this.content=e.parseFromString(t.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.container.append(this.content)},focusIn(){},focusOut(){},clickHandler(){const{type:t,target:e,value:n}=this.schema.action;Er[t].call(this,e,n)}},_r=Object.assign({},Object.create(Ji),kr),jr={init(){return this},render(){const t=new DOMParser,{content:e}=this.schema;return(0,U.isNullOrUndefined)(this.element)&&(this.element=t.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement),this.element},focusIn(){},focusOut(){},clickHandler(t){}},Mr=Object.assign(Object.create(Ji),jr),Cr={init(){return this},render(){new DOMParser;const{content:t,style:e}=this.schema;return(0,U.isNullOrUndefined)(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","text"),this.element.textContent=t),this.style(),this.element},style(){const{font:t,size:e,anchor:n="left",weight:i,baseline:r}=this.schema.style;this.element.setAttribute("text-anchor",n),this.element.setAttribute("font-family",t),this.element.setAttribute("font-size",e),this.element.style["dominant-baseline"]=r,i&&this.element.setAttribute("font-weight",i)},focusIn(){},focusOut(){},clickHandler(t){}},Sr=Object.assign(Object.create(Ji),Cr);var Lr=0;const Tr=()=>"static"+Lr++,Ir={audio:(t,e,n)=>Object.create(Qi,{object:{value:"static"},name:{value:"audio-static"},type:{value:"audio"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),plink:(t,e,n)=>Object.create(fr,{object:{value:"static"},name:{value:"plink-static"},type:{value:"plink"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),image:(t,e,n)=>Object.create(ir,{object:{value:"static"},name:{value:"image-static"},type:{value:"image"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),link:(t,e,n)=>Object.create(lr,{object:{value:"field"},name:{value:"link-static"},type:{value:"link"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),text:(t,e,n)=>Object.create(dr,{object:{value:"static"},name:{value:"text-static"},type:{value:"text"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),html:(t,e,n)=>Object.create(gr,{object:{value:"static"},name:{value:"html-static"},type:{value:"html"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),button:(t,e,n)=>Object.create(yr,{object:{value:"static"},name:{value:"button-static"},type:{value:"button"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),"svg-alt":(t,e,n)=>Object.create(wr,{object:{value:"static"},name:{value:"svg-static"},type:{value:"svgAlt"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),"svg-button":(t,e,n)=>Object.create(_r,{object:{value:"static"},name:{value:"svg-button"},type:{value:"svgButton"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),svg:(t,e,n)=>Object.create(Mr,{object:{value:"static"},name:{value:"svg-static"},type:{value:"svg"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}}),"svg-text":(t,e,n)=>Object.create(Sr,{object:{value:"static"},name:{value:"svgText-static"},type:{value:"svgText"},id:{value:Tr()},model:{value:t},schema:{value:e},projection:{value:n}})},Ur={createStatic(t,e,n){const{type:i}=e,r=Ir[i];if((0,U.isNullOrUndefined)(r))throw new Error(`Missing handler: The '${i}' static could not be handled`);var s=r(t,e,n);if((0,U.isNullOrUndefined)(s))throw new Error(`Bad request: The '${i}' static could not be created`);return(0,U.isNullOrUndefined)(s.id)&&(s.id=Tr()),s}},Dr={focusable:null,readonly:!1,visible:!1,editable:!1,active:!1,container:null,elements:null,children:null,editing:!1,getStyle(){return this.schema.style},setStyle(t){return this.schema.style=t,cn.call(this.projection,this.container,t),this.refresh(),!0},getContainer(){return this.container},isRoot(){return(0,U.isNullOrUndefined)(this.parent)},getField(t){return this.projection.getField(t)},getStatic(t){return this.projection.getStatic(t)},getLayout(t){return this.environment.getLayout(t)},show(){return B(this.element),this.visible=!0,this.active=!0,this},hide(){return q(this.element),this.visible=!1,this},toggle(){return F(this.container),this.visible=!this.visible,this},_focusIn:t=>!1,spaceHandler(t){return t===this.container&&!(0,U.isNullOrUndefined)(this.parent)&&this.parent.spaceHandler(this.container)},_spaceHandler(t){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(t){if(this.isRoot())return!1;let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex)),n=this.environment.resolveElement(e);return!(0,U.isNullOrUndefined)(n)&&(n.focus(e),!0)},enterHandler(t){let e=(0,U.getElement)('[tabindex]:not([tabindex="-1"])',this.container),n=this.environment.resolveElement(e);return!(0,U.isNullOrUndefined)(n)&&(n.focus(),!0)},delete(){var t=this.source.delete();t.success||this.environment.notify(t.message)},deleteHandler(t){if(this.projection.element!==this)return!1;if(!this.projection.optional)return $(this.container),!1;let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex)),n=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),n),this.source.delete();let i=this.environment.resolveElement(e);return(0,U.isNullOrUndefined)(i)||i.focus(),!1},backspaceHandler(t){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(t,e){if(e===this.container)return!(0,U.isNullOrUndefined)(this.parent)&&this.parent.arrowHandler(t,this.container);let n=ct(e,t,this.container);if(!(0,U.isHTMLElement)(n))return!(0,U.isNullOrUndefined)(this.parent)&&"layout"===this.parent.object&&this.parent.arrowHandler(t,this.container);let i=this.environment.resolveElement(n);return i&&((0,U.isFunction)(i.navigate)?i.navigate(t):i.focus()),!0},shiftHandler(t,e){if("up"===t){let t=it(window.getComputedStyle(this.container).marginTop);this.container.style.marginTop=`${t+1}px`}return!0},_arrowHandler(t,e){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(t){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},updateSize:()=>!1,controlHandler(t){this.toolbar&&this.toolbar.remove()}},Hr={ROW:"row",COLUMN:"column"},Pr={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center",stretch:"stretch",baseline:"baseline"},zr={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly"};var Vr=0;const Rr=()=>"layout"+Vr++;function Br(t,e,n){return Object.create(Fr,{object:{value:"layout"},name:{value:"flex-layout"},type:{value:"flex"},id:{value:Rr()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})}const qr={orientation:null,wrappable:null,alignItems:null,justifyContent:null,args:null,init(t={}){const{editable:e=!0,focusable:n=!1}=this.schema,{orientation:i=Hr.ROW,wrappable:r=!0,alignItems:s,justifyContent:a}=this.schema.layout;return this.orientation=i,this.wrappable=r,this.alignItems=s,this.justifyContent=a,this.focusable=n,this.editable=e,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},getOrientation(){return this.orientation},setOrientation(t){(0,U.hasOwn)(Hr,t)&&(this.orientation=t,this.refresh())},collapse(t=!1){if(!this.collapsed||t)return this.collapseContainer=(0,U.createDiv)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t=!1){if(!this.collapsed&&!t)return;let e=(0,U.createDocFragment)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(e),this.collapseContainer.remove(),this.collapsed=!1,this.refresh(),this},render(){const{label:t,content:e,style:n,help:i}=this.schema,r=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["layout-container"],dataset:{nature:"layout",layout:"flex",id:this.id}})),i&&(this.container.title=i);for(let t=0;t<e.length;t++){let n=Na.call(this,e[t],null,this.args),i=this.environment.resolveElement(n);i&&(i.parent=this),this.elements.push(n),r.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",cn.call(this.projection,this.container,n),r.hasChildNodes()&&(this.container.append(r),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="flex",this.refresh(),this.container},refresh(){return this.container.style.flexDirection=this.orientation,this.container.style.justifyContent=zr[this.justifyContent],this.container.style.alignItems=Pr[this.alignItems],this.wrappable?this.container.style.flexWrap="wrap":this.container.style.flexWrap="nowrap",this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,U.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,U.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t,{prop:n}=e.dataset;"orientation"===n&&this.setOrientation(e.value)})),this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(t=>{this.collapsed?this.expand():this.collapse()}))}},Fr=Object.assign({},Dr,qr),$r={circle:function(t){let e=this.content[0].element.getBBox(),n=e.x,i=e.y,r=e.x+e.width,s=e.y+e.height;this.content.forEach((t=>{e=t.element.getBBox(),n=Math.min(e.x,n),i=Math.min(e.y,i),r=Math.max(e.x+e.width,r),s=Math.max(e.y+e.height,s)}));let a={x:Number(t.getAttribute("cx")),y:Number(t.getAttribute("cy")),r:Number(t.getAttribute("r"))},o=Math.sqrt(Math.pow(n-a.x,2)+Math.pow(i-a.y,2)),l=Math.sqrt(Math.pow(r-a.x,2)+Math.pow(i-a.y,2)),c=Math.sqrt(Math.pow(r-a.x,2)+Math.pow(s-a.y,2)),h=Math.sqrt(Math.pow(n-a.x,2)+Math.pow(s-a.y,2)),u=Math.max(o,l,c,h);u>a.r-10&&Wr.call(this,u,a.r,t)}};function Wr(t,e,n){let i=Number(n.getAttribute("stroke-width"));(0,U.isNullOrUndefined)(this.containerView)&&(this.containerView={x:0,y:0,w:2*(e+(0,U.valOrDefault)(i,0)),h:2*(e+(0,U.valOrDefault)(i,0)),radius:e,defaultRadius:e});let r=Math.max(e,t)-Math.min(e,t)+5;this.containerView.x-=r,this.containerView.y-=r,this.containerView.radius+=r,this.containerView.h=2*(this.containerView.radius+i),this.containerView.w=2*(this.containerView.radius+i),this.container.setAttribute("viewBox",this.containerView.x+" "+this.containerView.y+" "+this.containerView.w+" "+this.containerView.h),this.container.setAttribute("width",this.containerView.w),this.container.setAttribute("height",this.containerView.h),this.width=this.containerView.w,this.height=this.containerView.h,n.setAttribute("r",this.containerView.radius)}const Yr={clickHandler(t){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},getContainer(){return this.container},getWidth(){return this.width},getHeight(){return this.height},setViewBox(t){this.container.setAttribute("viewBox",t),this.notifyObsevers()},setWidth(t){this.width=t,this.container.setAttribute("width",t),this.notifyObsevers()},setWidth(t){this.height=t,this.container.setAttribute("height",t),this.notifyObsevers()},notifyDimObservers(){(0,U.isNullOrUndefined)(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))},registerDimensionsObserver(t){(0,U.isNullOrUndefined)(this.observers)&&(this.observers=[]),this.observers.push(t)},setInteraction(t){(0,U.isNullOrUndefined)(this.items)||((0,U.isNullOrUndefined)(this.warnings)&&(this.warnings=[]),this.warnings.push(t),this.items.forEach((e=>{this.projection.resolveElement(e.render).warn(t)})))},checkAugment(t,e){if(!(0,U.isNullOrUndefined)(this.background))if(t.x+Number(e.getAttribute("x"))>Number(this.background.getAttribute("x"))+Number(this.background.getAttribute("width"))||t.y+Number(e.getAttribute("y"))>Number(this.background.getAttribute("y"))+Number(this.background.getAttribute("height"))){let n=this.background.querySelector("[data-augment]");const i=Number(n.getAttribute("y")),r=t.y+Number(e.getAttribute("y"));n.setAttribute("height",r-i)}else if(t.y+Number(e.getAttribute("y"))<Number(this.background.getAttribute("y"))+Number(this.background.getAttribute("height"))){let n=this.background.querySelector("[data-augment]");const i=Number(n.getAttribute("y")),r=t.y+Number(e.getAttribute("y"));n.setAttribute("height",r-i)}},createDelete(){const{type:t}=this.schema.rmv;if("bind"===t){this.deleteMap=new Map;let t=0;this.schema.rmv.bind.forEach((e=>{t++;const{alias:n,focus:i,coordinates:r,content:s}=e;let a=(new DOMParser).parseFromString(s.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement;a.dataset.nature="static",a.dataset.algorithm="button",a.setAttribute("x",r.x),a.setAttribute("y",r.y),a.addEventListener("click",(()=>{this.source.delete()})),this.deleteMap.set(n,a)})),this.projection.registerHandler("value.changed",(t=>{(0,U.isNullOrUndefined)(this.deleteElem)||this.deleteElem.remove(),this.deleteMap.get("default").remove();const e=t.name||t;let n=this.deleteMap.get(e);if(!n.dataset.focusable||this.focused)return(0,U.isNullOrUndefined)(n)?(this.container.append(this.deleteMap.get("default")),void(this.deleteElem=this.deleteMap.get("default"))):(this.container.append(n),void(this.deleteElem=n));this.deleteElem=n})),this.source.hasValue()?(this.container.append(this.deleteMap.get(this.source.value)),this.deleteElem=this.deleteMap.get(this.source.value)):(this.container.append(this.deleteMap.get("default")),this.deleteElem=this.deleteMap.get("default"))}else{const{focus:t,coordinates:e,dimensions:n,render:i}=this.schema.rmv;let r=Na.call(this,i);r.setAttribute("x",e.x),r.setAttribute("y",e.y),this.container.append(r),r.addEventListener("click",(()=>{this.source.delete()})),t&&(this.rmv=r)}},findItem(t){for(let e=0;e<this.items.length;e++)if(this.items[e].render.dataset.concept===t)return this.items[e]},findAncestor(t){for(let e=0;e<this.items.length;e++)if(this.items[e].render.contains(t))return this.items[e]},findAnchorIndex(t){for(let e=0;e<this.items.length;e++)if(this.items[e].render===t)return this.items[e].index},findAnchorIndex(t){return this.anchors.indexes[t]},updateSize(){if(this.wrapped)return void this.updateSizeWrap();if(this.fixed)return;let t=this.container.querySelector("[data-adapter]");$r[t.tagName].call(this,t),(0,U.isNullOrUndefined)(this.parent)||this.parent.updateSize()},updateSizeWrap(){if((0,U.isEmpty)(this.content))return this.width=0,this.height=0,this.container.setAttribute("width",0),void this.container.setAttribute("width",0);let t=this.content[0],e=this.getBox(t),n=e.x,i=e.y,r=e.x+e.width,s=e.y+e.height;for(let t=0;t<this.content.length;t++)e=this.getBox(this.content[t]),n=Math.min(n,e.x),i=Math.min(i,e.y),r=Math.min(r,e.x+e.width),s=Math.min(s,e.y+e.height);this.containerView={x:n,y:i,w:r-n,h:s-i},this.container.setAttribute("viewBox",this.containerView.x+" "+this.containerView.y+" "+this.containerView.w+" "+this.containerView.h),this.container.setAttribute("width",this.containerView.w),this.container.setAttribute("height",this.containerView.h),this.width=this.containerView.w,this.height=this.containerView.h,(0,U.isNullOrUndefined)(this.parent)||this.parent.updateSize()},getBox(t){let e=t.container||t.element;return e.getBBox(),(0,U.isNullOrUndefined)(t.width)?e.getBBox():{width:t.width,height:t.height,x:(0,U.valOrDefault)(Number(e.getAttribute("x")),0),y:(0,U.valOrDefault)(Number(e.getAttribute("y")),0)}}},Xr={init(){const{dimensions:t={}}=this.schema;return this.ratio=.4,this.width=(0,U.valOrDefault)(t.width,500),this.height=(0,U.valOrDefault)(t.height,500),this.buttons=[],this.dummies=[],this.transLink=[],this.transLinkId=[],this.arrowInventory=[],this.linkInventory=new Map,this},render(){const{dimensions:t,style:e}=this.schema,n=(0,U.createDocFragment)();return(0,U.isNullOrUndefined)(this.instances)&&(this.instances=new Map),(0,U.isNullOrUndefined)(this.holders)&&(this.holders=new Map),(0,U.isHTMLElement)(this.container)||(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="force",this.container.dataset.id=this.id,this.container.tabindex=1,this.container.id=this.id),t&&(this.container.setAttribute("width",t.width),this.container.setAttribute("height",t.height)),this.focusable=!0,(0,U.isHTMLElement)(this.ids)||(this.ids=[]),n.hasChildNodes()&&this.container.append(n),e&&(this.container.style=e),(0,U.isNullOrUndefined)(this.content)&&(this.content=[]),this.bindEvents(),this.container},setUpForce(){const{intensity:t,linkval:e}=this.schema.force;this.force=d3.layout.force().size([this.width,this.height]).nodes([]).links([]).linkDistance(e).charge(t).on("tick",this.ticked.bind(this));var n=d3.select("#"+this.id);this.nodes=this.force.nodes(),this.node=n.selectAll("svg"),this.links=this.force.links(),this.link=n.selectAll(".link"+this.id),this.force.start()},restart(){let t=d3.select("#"+this.id);this.node=t.selectAll(".node"+this.id).data(this.nodes),(0,U.isNullOrUndefined)(this.links)||(0,U.isEmpty)(this.links)||(this.link=t.selectAll(".link"+this.id).data(this.links)),console.log(this.nodes),this.force.start()},addItem(t){if((0,U.isNullOrUndefined)(this.force)&&this.setUpForce(this.width,this.height,this.intensity,this.direction),"prototype"===t.schema.nature)if(t.hasValue())for(let e=0;e<this.nodes.length;e++)this.nodes[e].concept===t.id&&(this.nodes[e].meta=this.nodes[e].concept,this.nodes[e].concept=t.getValue(!0).id);else t.register(this.projection),this.projection.registerHandler("value.changed",(e=>{if(t.hasValue())for(let e=0;e<this.nodes.length;e++)this.nodes[e].concept===t.id&&(this.nodes[e].meta=this.nodes[e].concept,this.nodes[e].concept=t.getValue(!0).id)}));let e=this.createItem(t,this.schema.tag);e.classList.add("node"+this.id),this.container.append(e);let n=this.projection.resolveElement(e);if(n.projection.update("displayed"),console.log(n),this.content.push(n),"prototype"===t.schema.nature)if(t.force)t.force.index=this.nodes.length,t.force.id=n.id,this.nodes.push(t.force),t.force=this.nodes[this.nodes.length-1];else{const e={nbLink:0,points:[],width:n.width,height:n.height,id:n.id,concept:t.id};this.nodes.push(e),t.force=e}else if(t.force)t.force.index=this.nodes.length,t.force.id=n.id,this.nodes.push(t.force),t.force=this.nodes[this.nodes.length-1];else{const i={nbLink:0,points:[],width:n.width,height:n.height,id:n.id,concept:t.id,shape:this.computeShape(e)};this.nodes.push(i),t.force=i}this.restart()},checkForContent(t,e){const n=this.findIndex(t),i=this.findIndex(e);return n>=0&&i>=0},addArrow(t,e,n){if((0,U.isNullOrUndefined)(this.force)&&this.setUpForce(),(0,U.isNullOrUndefined)(this.links)&&(this.links=this.force.links()),this.containsArrow(t,e,n))return;this.containsTransArrow(t,e,n),this.force.stop();const i=e.id||e,r=n.id||n,s=this.findIndex(i),a=this.findIndex(r);if(s<0||a<0){let i=this.environment.getReceivers(this.projection.rtag);for(let r=0;r<i.length;r++)if(i[r].checkForContent(e,n))return t.projection.parent=i[r],void i[r].addArrow(t,e,n);return this.environment.getRootReceiver(this.projection.rtag).addTransLink(t,e,n),void this.restart()}let o=this.linkInventory.get(s+","+a);(0,U.isNullOrUndefined)(o)?(this.linkInventory.set(s+","+a,{length:1}),this.links.push({source:s,target:a,id:t.id,indexL:1})):(o.length++,this.links.push({source:s,target:a,id:t.id,indexL:o.length})),t.path.classList.add("link"+this.id),this.container.append(t.path),t.definitions&&this.container.append(t.definitions),this.addDummy(t,t.decorator,this.links.length-1),this.restart()},addDummy(t,e,n){if((0,U.isNullOrUndefined)(e)){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("node"+this.id),t.classList.add("dummy"),this.container.append(t),this.nodes.push({dummy:!0,ref:n,fixed:!0,width:10,height:10})}else{this.container.append(e),e.classList.add("node"+this.id),e.classList.add("dummy");const t=e.getBBox();this.nodes.push({dummy:!0,ref:n,fixed:!0,width:t.width,height:t.height})}},addTransLink(t,e,n){t.projection.parent=this,(0,U.isNullOrUndefined)(this.transLinks)&&(this.transLinks=[]),this.transLinks.push({id:t.id,from:e.id||e,to:n.id||n,arrow:t}),this.container.append(t.path),t.definitions&&this.container.append(t.definitions),this.restart()},containsTransArrow(t,e,n){if(!(0,U.isNullOrUndefined)(this.transLinks))for(let e=0;e<this.transLinks.length;e++)if(this.transLinks[e].id===t.id)return void this.transLinks.splice(e,1)},containsArrow(t,e,n){for(let i=0;i<this.links.length;i++)if(this.links[i].id===t.id){const r=e.id||e,s=n.id||n,a=this.findIndex(r),o=this.findIndex(s);if(a<0||o<0)this.removeArrow(t,i),this.addTransLink(t,e,n);else{let t=this.links[i].source.index,e=this.links[i].target.index;if(!(0,U.isNullOrUndefined)(this.linkInventory.get(t+","+e))){let n=this.linkInventory.get(t+","+e);n.length--,n.length<=0&&this.linkInventory.delete(t+","+e)}this.links[i].source=a,this.links[i].target=o,(0,U.isNullOrUndefined)(this.linkInventory.get(a+","+o))?this.linkInventory.set(a+","+o,{length:1}):this.linkInventory.get(a+","+o).length++}return this.restart(),!0}return!1},removeArrow(t,e=-1,n,i){if((0,U.isNullOrUndefined)(this.links))return;let r=0;if(e>=0){if(!(0,U.isNullOrUndefined)(this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index))){let t=this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index);t.length--,0===t.length&&this.linkInventory.delete(this.links[e].source.index+","+this.links[e].target.index)}return this.links.splice(e,1),t.decorator&&(r=this.removeDummy(e),t.decorator.remove()),t.path.remove(),this.restart(),r}for(let e=0;e<this.links.length;e++)if(this.links[e].id===t.id){if(!(0,U.isNullOrUndefined)(this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index))){let t=this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index);t.length--,0===t.length&&this.linkInventory.delete(this.links[e].source.index+","+this.links[e].target.index)}return t.decorator&&(r=this.removeDummy(e),t.decorator.remove()),this.links.splice(e,1),t.path.remove(),void this.restart()}},findIndex(t){for(let e=0;e<this.nodes.length;e++)if(this.nodes[e].concept===t)return e;return-1},createItem(t,e){console.log("Item");const n=this.schema.item;console.log(n);let i=this.model.createProjection(t,n);i.optional=!0;let r=i.init().render();return i.element.parent=this,this.instances.set(i.element.source.id,r),r},removeItem(t){let e;for(this.force.stop(),e=0;e<this.nodes.length&&this.nodes[e].meta!==t.id&&this.nodes[e].concept!==t.id;e++);if((0,U.isNullOrUndefined)(this.links)||(0,U.isEmpty)(this.links))return this.nodes.splice(e,1),void this.restart();for(let t=0;t<this.links.length;t++){let n;if(this.links[t].source.index===e||this.links[t].target.index===e){let i=this.projection.model.getArrow(this.links[t].id);n=this.removeArrow(i,t,null,e),t--}(0,U.isNullOrUndefined)(this.links[t])||(this.links[t].source.index>e&&this.links[t].source.index--,this.links[t].target.index>e&&this.links[t].target.index--)}this.nodes.splice(e,1),this.restart()},removeDummy(t){for(let e=0;e<this.nodes.length;e++)this.nodes[e].ref===t&&(this.nodes.splice(e,1),e--),this.nodes[e].ref>t&&this.nodes[e].ref--},ticked(){let t=!0;for(;t&&!(0,U.isEmpty)(this.nodes);)this.nodes.forEach((e=>{this.nodes.forEach((n=>{t=this.collide(e,n)}))}));let e=this.links,n=this.container,i=this.linkInventory;const r=this.width,s=this.height;(0,U.isNullOrUndefined)(this.link)||(0,U.isEmpty)(this.links)||this.link.attr("d",(function(t){if(t.source===t.target)return;const e=Gr.computeBorder(t.source,t.target),n=Gr.computeBorder(t.target,t.source);let r=n.x-e.x,s=n.y-e.y,a=Math.sqrt(r*r+s*s);t.dr=a,t.s=e,t.t=n;let o=i.get(t.source.index+","+t.target.index);return o.length>1&&(a/=1+1/o.length*(t.indexL-1)),"M"+n.x+","+n.y+"A"+a+","+a+" 0 0 1,"+e.x+","+e.y+"A"+a+","+a+" 0 0 0,"+n.x+","+n.y})),this.node.attr("x",(function(t){if(!(0,U.isNullOrUndefined)(t.ref)){let r=e[t.ref].dr,s=i.get(e[t.ref].source.index+","+e[t.ref].target.index);s.length>1&&(r/=1+1/s.length*(e[t.ref].indexL-1));let a=Gr.getEllipseCenter(r,e[t.ref].s,e[t.ref].t,n),o=Gr.getPerpendicularLine(e[t.ref].s,e[t.ref].t),l=Gr.getPointConstructedEllipse(o,r,r,a),c=Gr.getCloserBorder(l,e[t.ref].t);return t.fx=c.x,(0,U.isNullOrUndefined)(t.width)?c.x:(t.fx=c.x-t.width/2,c.x-t.width/2)}return(t.x=Math.max(t.width/2,Math.min(r-t.width/2,t.x)))-t.width/2})).attr("y",(function(t){if(!(0,U.isNullOrUndefined)(t.ref)){let r=e[t.ref].dr,s=i.get(e[t.ref].source.index+","+e[t.ref].target.index);s.length>1&&(r/=1+1/s.length*(e[t.ref].indexL-1));let a=Gr.getEllipseCenter(r,e[t.ref].s,e[t.ref].t,n),o=Gr.getPerpendicularLine(e[t.ref].s,e[t.ref].t),l=Gr.getPointConstructedEllipse(o,r,r,a),c=Gr.getCloserBorder(l,e[t.ref].t);return t.fy=c.y,(0,U.isNullOrUndefined)(t.height)?c.y:c.y-t.height/2}return(t.y=Math.max(t.height/2,Math.min(s-t.height/2,t.y)))-t.height/2}))},analyseContentDim(){this.content.forEach((t=>{for(let e=0;e<this.nodes.length;e++)if(this.nodes[e].id===t.id){this.nodes[e].width=t.width,this.nodes[e].height=t.height,this.nodes[e].shape=this.computeShape(t.container||t.element);break}})),this.force.start()},computeRelativeShape(t,e){const n=e.querySelector("[data-shape]");if((0,U.isUndefined)(n))return;const i=t.getBoundingClientRect(),r=n.getBoundingClientRect(),s=e.getBoundingClientRect(),a=Number(t.getAttribute("width")),o=Number(t.getAttribute("height")),l={};l.width=a*r.width/i.width,l.height=o*r.height/i.height;const c=t.createSVGPoint();c.x=r.x,c.y=r.y;const h=c.matrixTransform(t.getScreenCTM().inverse());l.x=h.x,l.y=h.y;const u={};u.width=a*s.width/i.width,u.height=o*s.height/i.height;const d=t.createSVGPoint();d.x=r.x,d.y=r.y;const p=d.matrixTransform(t.getScreenCTM().inverse());let f;switch(u.x=p.x,u.y=p.y,n.tagName){case"circle":return{type:"circle",r:l.width/2};case"ellipse":return f=Number(n.getAttribute("width"))/r.width,s.width,f=Number(n.getAttribute("height"))/r.height,s.height,{type:"ellipse",rx:l.width/2,ry:l.height/2};default:f=Number(n.getAttribute("width"))/r.width;const t=s.width*f;return f=Number(n.getAttribute("height"))/r.height,{type:"rect",w:t,h:s.height*f}}},computeShape(t){const e=t.querySelector("[data-shape]");if(console.log("ComputingShape"),console.log(e),(0,U.isNullOrUndefined)(e))return;const n=e.getBBox(),i=t.getBoundingClientRect();let r;switch(console.log(n),console.log(i),e.tagName){case"circle":return r=Number(e.getAttribute("r"))/(n.width/2),{type:"circle",r:i.width*r/2};case"ellipse":r=Number(e.getAttribute("width"))/n.width;const t=i.width*r;return r=Number(e.getAttribute("height"))/n.height,{type:"ellipse",rx:t,ry:i.height*r};case"polygon":let s=e.getAttribute("data-points").split(" "),a=[];for(let t=0;t<s.length;t++)a.push({x:Number(s[t].split(",")[0])/n.width,y:Number(s[t].split(",")[1])/n.height});return{type:"polygon",points:a};case"rect":return{type:"rect",w:n.width,h:n.height,yOff:n.y,xOff:n.x};default:r=Number(e.getAttribute("width"))/n.width;const o=i.width*r;return r=Number(e.getAttribute("height"))/n.height,{type:"rect",w:o,h:i.height*r}}},collide(t,e){let n=!1;const i=this.width,r=this.height;if(!(0,U.isNullOrUndefined)(t.ref)&&!(0,U.isNullOrUndefined)(e.ref))return n;if(!(0,U.isNullOrUndefined)(t.ref)){if(t.fx<e.x&&t.fy<e.y&&t.fx+t.width/2>e.x-e.width/2&&t.fy+t.height>e.x-e.height/2){let n=t.fx+t.width/2-(e.x-e.width/2),i=1.1*(t.fy+t.height/2-(e.y-e.height/2));switch(Math.min(n,i)){case n:e.x+=n;break;case i:e.y+=i}}else if(t.fx>e.x&&t.fy<e.y&&e.x+e.width/2>t.fx-t.width/2&&t.fy+t.height/2>e.y-e.height/2){let n=e.x+e.width/2-(t.fx-t.width/2),i=1.1*(t.fy+t.height/2-(e.y-e.height/2));switch(Math.min(n,i)){case n:e.x-=n;break;case i:e.y+=i}}else if(t.fx>e.x&&t.fy>e.y&&e.x+e.width/2>t.fx-t.width/2&&e.y+e.height/2>t.fy-t.height){let n=e.x+e.width/2-(t.fx-t.width/2),i=1.1*(e.y+e.height/2-(t.fy-t.height/2));switch(Math.min(n,i)){case n:e.x-=n;break;case i:e.y-=i}}else if(t.fx<e.x&&t.fy>e.y&&t.fx+t.width/2>e.x-e.width/2&&t.fy-t.height<e.y+e.height/2){let n=t.x+t.width-(e.x-e.width/2),i=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(n,i)){case n:e.x+=n;break;case i:e.y-=i}}return n}if(!(0,U.isNullOrUndefined)(e.ref)){if(t.x<e.fx&&t.y<e.fy&&t.x+t.width/2>e.fx-e.width/2&&t.y+t.height/2>e.fx-e.height/2){let n=t.x+t.width/2-(e.fx-e.width/2),i=1.1*(t.y+t.height/2-(e.fy-e.height/2));switch(Math.min(n,i)){case n:t.x-=n;break;case i:t.y-=i}}else if(t.x>e.fx&&t.y<e.fy&&e.fx+e.width/2>t.x-t.width/2&&t.y+t.height/2>e.fy-e.height/2){let n=e.fx+e.width/2-(t.x-t.width/2),i=1.1*(t.y+t.height/2-(e.fy-e.height/2));switch(Math.min(n,i)){case n:t.x+=n;break;case i:t.y-=i}}else if(t.x>e.fx&&t.y>e.fy&&e.fx+e.width/2>t.x-t.width/2&&e.fy+e.height/2>t.y-t.height/2){let n=e.fx+e.width/2-(t.x-t.width/2),i=1.1*(e.fy+e.height/2-(t.y-t.height/2));switch(Math.min(n,i)){case n:t.x+=n;break;case i:t.y+=i}}else if(t.x<e.fx&&t.y>e.fy&&t.x+t.width/2>e.fx-e.width/2&&t.y-t.height/2<e.fy+e.height/2){let n=t.x+t.width/2-(e.fx-e.width/2),i=1.1*(e.fy+e.height/2-(t.y-t.height/2));switch(Math.min(n,i)){case n:t.x-=n;break;case i:t.y+=i}}return n}if(e&&e!==t)if(t.x<=e.x&&t.y<=e.y&&t.x+t.width/2>=e.x-e.width/2&&t.y+t.height/2>=e.y-e.height/2){let n=t.x+t.width/2-(e.x-e.width/2),s=1.1*(t.y+t.height/2-(e.y-e.height/2));switch(Math.min(n,s)){case n:if(t.x-n/2<0){e.x+=n;break}if(e.x+n/2>i){t.x-=n;break}t.x-=n/2,e.x+=n/2;break;case s:if(t.y-s/2<0){e.x+=s;break}if(e.y+s/2>r){t.x-=s;break}t.y-=s/2,e.y+=s/2}}else if(t.x>e.x&&t.y<e.y&&e.x+e.width/2>t.x-t.width/2&&t.y+t.height/2>e.y-e.height/2){let n=e.x+e.width/2-(t.x-t.width/2),s=1.1*(t.y+t.height/2-(e.y-e.height/2));switch(Math.min(n,s)){case n:if(t.x+n/2>i){e.x-=n;break}if(e.x-n/2<0){t.x+=n;break}t.x+=n/2,e.x-=n/2;break;case s:if(t.y-s/2<0){e.x+=s;break}if(e.y+s/2>r){t.x-=s;break}t.y-=s/2,e.y+=s/2}}else if(t.x>e.x&&t.y>e.y&&e.x+e.width/2>t.x-t.width/2&&e.y+e.height/2>t.y-t.height/2){let n=e.x+e.width/2-(t.x-t.width/2),s=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(n,s)){case n:if(t.x+n/2>i){e.x-=n;break}if(e.x-n/2<0){t.x+=n;break}t.x+=n/2,e.x-=n/2;break;case s:if(t.y+s/2>r){e.y-=s;break}if(e.y-s/2<0){t.y+=s;break}t.y+=s/2,e.y-=s/2}}else if(t.x<e.x&&t.y>e.y&&t.x+t.width/2>e.x-e.width/2&&t.y-t.height/2<e.y+e.height/2){let n=t.x+t.width/2-(e.x-e.width/2),s=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(n,s)){case n:if(t.x-n/2<0){e.x+=n;break}if(e.x+n/2>i){t.x-=n;break}t.x-=n/2,e.x+=n/2;break;case s:if(t.y+s/2>r){e.y-=s;break}if(e.y-s/2<0){t.y+=s;break}t.y+=s/2,e.y-=s/2}}return n},focus(){return this.container.focus(),this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this.container.focus(),this},focusOut(){return this.focused=!1,this.container.classList.remove("active"),this.container.classList.remove("focus"),this},updateSize(){for(let t=0;t<this.nodes.length;t++)if(!this.nodes[t].dummy){let e=this.instances.get(this.nodes[t].meta||this.nodes[t].concept);console.log("UpdatingSize Here?"),console.log(e),console.log(this.instances),console.log(this.nodes[t]),console.log(t),console.log(this.nodes);let n=this.projection.resolveElement(e);this.nodes[t].width=n.width,this.nodes[t].height=n.height,this.nodes[t].shape=this.computeShape(e)}this.restart()},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)})),this.projection.registerHandler("displayed",(()=>{(0,U.isEmpty)(this.source.value)||this.source.values.forEach((t=>{this.addItem(t),"prototype"===value.schema.nature&&(this.nodes[this.nodes.length-1].meta=this.nodes[i].concept,this.nodes[this.nodes.length-1].concept=value.getValue(!0).id)}))}))}},Gr={getPointEllipse(t,e,n){const i=n.rx/2,r=n.ry/2,s=t.x,a=t.y,o=this.getDeq(t,e);let l=r*r+i*i*o.a*o.a,c=2*i*i*o.a*o.b-2*s*r*r-2*a*o.a*i*i,h=c*c-4*l*(s*s*r*r+i*i*a*a+i*i*o.b*o.b-2*a*i*i*o.b-i*i*r*r);if(h>=0){let t=(-c-Math.sqrt(h))/(2*l),e=t*o.a+o.b,n=(-c+Math.sqrt(h))/(2*l);return{x1:{x:t,y:e},x2:{x:n,y:n*o.a+o.b}}}},getPointConstructedEllipse(t,e,n,i){const r=e,s=n,a=i.x,o=i.y;let l=s*s+r*r*t.a*t.a,c=2*r*r*t.a*t.b-2*a*s*s-2*o*t.a*r*r,h=c*c-4*l*(a*a*s*s+r*r*o*o+r*r*t.b*t.b-2*o*r*r*t.b-r*r*s*s);if(h>=0){let e=(-c-Math.sqrt(h))/(2*l),n=e*t.a+t.b,i=(-c+Math.sqrt(h))/(2*l);return[{x:e,y:n},{x:i,y:i*t.a+t.b}]}},getEllipseCenter(t,e,n,i){let r=(e.x-n.x)/2,s=(e.y-n.y)/2,a=-Math.sqrt((t*t*(t*t)-t*t*(s*s)-t*t*(r*r))/(t*t*(s*s)+t*t*r*r)),o=a*(-t*r/t);return{x:a*(t*s/t)+(e.x+n.x)/2,y:o+(e.y+n.y)/2}},getPerpendicularLine(t,e){let n=(t.x+e.x)/2,i=(t.y+e.y)/2,r=-1/Gr.getDeq(t,e).a;return{a:r,b:i-r*n}},getSelfPointEllipse(t){let e={x:t.x-t.ellipse.rx/2,y:t.y},n={x:t.x+t.ellipse.rx/2,y:t.y},i={x:t.x,y:t.y-t.ellipse.ry/2},r={x:t.x,y:t.y-t.ellipse.ry/2},s=0,a=0,o=0,l=0;switch(t.points.forEach((t=>{s+=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),a+=Math.sqrt((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y)),o+=Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)),l+=Math.sqrt((t.x-r.x)*(t.x-r.x)+(t.y-r.y)*(t.y-r.y))})),Math.max(s,a,o,l)){case o:return{x:i.x,y:i.y,direction:"top"};case a:return{x:n.x,y:n.y,direction:"right"};case l:return{x:r.x,y:r.y,direction:"bot"};default:return{x:e.x,y:e.y,direction:"left"}}},getPointPolygon(t,e,n){let i=[];n.points.forEach((e=>{i.push({x:e.x*t.width+t.x-t.width/2,y:e.y*t.height+t.y-t.height/2})}));let r=i[0].x-e.x,s=i[0].y-e.y,a=Math.sqrt(r*r+s*s),o=a,l=0;for(let t=1;t<i.length;t++)r=i[t].x-e.x,s=i[t].y-e.y,a=Math.sqrt(r*r+s*s),a<o&&(o=a,l=t);return i[l]},getDeq(t,e){let n=(e.y-t.y)/(e.x-t.x);return{a:n,b:t.y-n*t.x}},getCloserBorder(t,e){let n=Math.sqrt((t[0].x-e.x)*(t[0].x-e.x)+(t[0].y-e.y)*(t[0].y-e.y));return Math.sqrt((t[1].x-e.x)*(t[1].x-e.x)+(t[1].y-e.y)*(t[1].y-e.y))<n?t[1]:t[0]},getPointRect(t,e,n){let i=t.x-t.width/2+n.xOff,r=t.y-t.height/2+n.yOff,s=r,a=t.x-t.width/2+n.xOff+n.w,o=t.y-t.height/2+n.yOff+n.h;console.log(t),console.log(e),console.log(i,r,a,s,o);let l=Gr.getDeq({x:t.x,y:t.y},{x:e.x,y:e.y}),c=Gr.getDeq({x:i,y:r},{x:a,y:s}),h=Gr.getLineIntersection(l,c);return h&&h.x>i&&h.x<a?[h,{x:(o-l.b)/l.a,y:o}]:[{x:a,y:l.a*a+l.b},{x:i,y:l.a*i+l.b}]},getLineIntersection(t,e){if(t.a===e.a)return!1;let n=t.a-e.a,i=e.b-t.b;return{x:i/n,y:t.a*(i/n)+t.b}},getPointCircle(t,e,n){let i=Gr.getDeq({x:t.x,y:t.y},{x:e.x,y:e.y}),r=i.a*i.a+1,s=2*i.a*i.b-2*i.a*t.y-2*t.x,a=s*s-4*r*(i.b*i.b-i.b*t.y*2+t.y*t.y+t.x*t.x-n.r*n.r);if(a>0){let t=(-s+Math.sqrt(a))/(2*r),e=(-s-Math.sqrt(a))/(2*r);return[{x:t,y:i.a*t+i.b},{x:e,y:i.a*e+i.b}]}},computeBorder(t,e){let n={},i={};switch(t.shape.type){case"rect":return n=Gr.getPointRect(t,e,t.shape),i=Gr.getCloserBorder(n,e),i;case"circle":return n=Gr.getPointCircle(t,e,t.shape),i=Gr.getCloserBorder(n,e),i;case"ellipse":return n=Gr.getPointEllipse(t,e,t.shape),i=Gr.getCloserBorder(n,e),i;case"polygon":return n=Gr.getPointPolygon(t,e,t.shape),n}}},Jr=Object.assign({},Yr,Xr),Zr={init(){const{dimensions:t}=this.schema;return this.dimensions=t,this},render(){(0,U.createDocFragment)();const{dimensions:t,saturation:e,overflow:n=!1,create:i,add:r,style:s}=this.schema;if(this.focusable=!0,(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),t&&(this.container.setAttribute("width",t.width),this.container.setAttribute("height",t.height)),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="pattern",this.container.dataset.id=this.id,this.container.dataset.click="container",this.container.tabIndex=0),n&&(this.container.style.overflow="visible"),e&&(this.saturation=e.value,this.satTarget=e.target,(0,U.isNullOrUndefined)(e.satParams)||(this.satParams=e.satParams),(0,U.isNullOrUndefined)(e.acceptTarget)||(this.acceptTarget=e.acceptTarget)),(0,U.isNullOrUndefined)(this.anchors)&&this.setUpAnchors(),r&&(0,U.isNullOrUndefined)(this.add)){const{coordinates:t=!1,render:e}=r;this.add=Na.call(this,e),t?(this.add.setAttribute("x",t.x),this.add.setAttribute("y",t.y)):(this.add.setAttribute("x",this.anchors.current.x),this.add.setAttribute("y",this.anchors.current.y)),this.container.append(this.add),this.add.style.overflow="visible",this.add.addEventListener("click",(()=>{}))}return this.displayed=!1,s&&(this.container.style=s),this.bindEvents(),i&&this.source.createElement(),s&&(this.container.style=s),this.container},checkDim(t,e,n){e+20+Number(n.getAttribute("y"))>Number(this.items[0].render.getAttribute("height"))&&this.items.forEach((t=>{this.projection.resolveElement(t.render).augment()}))},checkSpeDim(t,e,n){for(;e+20+Number(n.getAttribute("y"))>Number(this.items[this.items.length-1].render.getAttribute("height"));)this.projection.resolveElement(this.items[this.items.length-1].render).augment()},createItem(t){const{tag:e}=this.schema.pattern;let n=this.model.createProjection(t,e);return n.optional=!0,n.parent=this.projection,{render:n.init().render(),projection:n}},addItem(t){if(this.saturation&&((0,U.isNullOrUndefined)(this.count)&&(this.count=0),this.count>=this.saturation))return this.environment.getActiveReceiver(this.satTarget).source.createElement(),void this.saturate(t);let{render:e,projection:n}=this.createItem(t);(0,U.isNullOrUndefined)(this.dimSchema)&&(this.dimSchema=new Map),this.dimSchema.set(e.dataset.id,gi.analyseDim(e,this.schema.pattern)),this.container.append(e);let i=this.anchors.current;(0,U.isNullOrUndefined)(this.items)&&(this.items=[]),this.items.push({render:e,position:i,index:this.anchorIndex,id:t.id}),this.displayed?(gi.setDimensions(this.dimSchema.get(e.dataset.id)),n.update("displayed",e.dataset.id)):((0,U.isNullOrUndefined)(this.waiting)&&(this.waiting=[]),this.waiting.push({render:e,projection:n})),(0,U.isNullOrUndefined)(this.anchors)&&this.setUpAnchors(),gi.positionElement(i,e),this.nextAnchor(!0),this.count++,this.warnings&&this.warnings.forEach((t=>{n.warn(t)}))},placeAdd(){this.add.setAttribute("x",this.anchors.current.x),this.add.setAttribute("y",this.anchors.current.y)},setUpAnchors(){const{first:t,next:e}=this.schema.pattern;this.anchors={},this.anchors.current=t,this.anchors.next=e,this.anchors.indexes=[t],this.anchorIndex=0},saturate(t){let e=this.environment.projectionModel.createProjection(this.projection.concept,this.projection.tag).init();e.render(),this.environment.getActiveReceiver("solo").accept(e.element.container,this.satParams.dimension,this.satParams.coordinates),e.element.addItem(t),this.full=!0,this.saturated=!0},accept(t,e=!1){const{render:n,params:i}=t;if(e){let t=this.projection.resolveElement(n);return t.parent=this,void(t.definitions&&this.container.append(t.definitions))}this.container.append(n)},acceptAnchor(t){this.container.append(t);let e=this.anchors.current;this.items.push({render:t,anchor:e,index:this.anchorIndex,id:t.id}),gi.positionElement(e,t),this.nextAnchor(!0),this.count++,this.count>=this.saturation&&(this.full=!0)},nextAnchor(t=!1){let{x:e,y:n}=this.anchors.current,i=this.anchors.next.x,r=this.anchors.next.y;this.anchors.current={x:e+i,y:n+r},t&&this.anchorModel&&ui.AnchorHandler.nextAnchor(this.schema.handler.id,this.id),(0,U.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd(),this.anchors.indexes.push({x:e+i,y:n+r}),this.anchorIndex++,(0,U.isNullOrUndefined)(this.parent)||this.parent.checkAugment(this.anchors.current,this.container)},createHolder(t){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return n.append(t),e.append(n),e},adapt(t,e){let n,i=t.parentNode.parentNode,r=t.parentNode;"fixed"===e.type&&(i.setAttribute("width",e.value),r.setAttribute("width",e.value),n=t.getBoundingClientRect(),r.setAttribute("height",n.height),r.setAttribute("width",n.width),i.setAttribute("height",n.height*e.value/n.width),i.setAttribute("viewBox","0 0 "+n.width+" "+n.height))},transmitFirst(){const{render:t,position:e,index:n,id:i}=this.items[0];return this.removeItem({id:i}),t},removeItem(t){let e,n;for(n=0;n<this.items.length;n++)if(this.items[n].id===t.id){const{position:t}=this.items[n];e=t;break}if(n>=this.items.length||(0,U.isNullOrUndefined)(this.items[n]))return;const i=this.items[n].index;for(this.items.splice(n,1),n>this.items.length&&n--;n<this.items.length;){let t=this.items[n].position;this.items[n].position=e,this.items[n].render.setAttribute("x",e.x),this.items[n].render.setAttribute("y",e.y),this.items[n].index--,e=t,n++}this.anchors.indexes.splice(this.anchors.indexes.length-1,1),this.anchors.current=this.anchors.indexes[this.anchors.indexes.length-1],(0,U.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd(),(0,U.isNullOrUndefined)(this.parent)||this.parent.checkAugment(this.anchors.current,this.container),this.anchorModel&&ui.AnchorHandler.deleteItem(this.schema.handler.id,this.id,i),(0,U.isNullOrUndefined)(this.count)||(this.count--,this.full&&(this.full=!1,this.environment.saturationRevolved(this,this.projection.rtag),this.saturated=!0),this.count)},removeAnchor(t){if(!(0,U.isNullOrUndefined)(this.items))for(let e=0;e<this.items.length;e++)this.items[e].index>t&&(this.items[e].position.x-=this.anchors.next.x,this.items[e].position.y-=this.anchors.next.y,this.items[e].render.setAttribute("x",this.items[e].position.x),this.items[e].render.setAttribute("y",this.items[e].position.y),this.items[e].index--);this.anchors.indexes.splice(this.anchors.indexes.length-1,1),this.anchors.current=this.anchors.indexes[this.anchors.indexes.length-1],(0,U.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd(),(0,U.isNullOrUndefined)(this.parent)||this.parent.checkAugment(this.anchors.current,this.container)},moveElemToAnchor(t,e){this.anchors.indexes.length<=t+1&&(this.nextAnchor(!0),(0,U.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd());let n=this.anchors.indexes[t];this.items[e].position=n,this.items[e].index=t;let i=this.items[e].render;return i.setAttribute("x",n.x),i.setAttribute("y",n.y),i},increaseAnchors(t,e,n,i){e>this.anchors.indexes.length&&this.nextAnchor(!0),(0,U.isNullOrUndefined)(this.items)||this.items.forEach((r=>{r.render!==n&&r.index>=t&&r.index<=e&&(r.index++,i.includes(r.index)?this.projection.resolveElement(r.render).increaseAnchor():(r.position=this.anchors.indexes[r.index],r.render.setAttribute("x",r.position.x),r.render.setAttribute("y",r.position.y)))}))},decreaseAnchors(t,e,n,i){(0,U.isNullOrUndefined)(this.items)||this.items.forEach((r=>{r.render!==n&&r.index>=t&&r.index<=e&&(r.index--,i.includes(r.index)?this.projection.resolveElement(r.render).decreaseAnchor():(r.position=this.anchors.indexes[r.index],r.render.setAttribute("x",r.position.x),r.render.setAttribute("y",r.position.y)))}))},clickHandler(t){},focusIn(){return this.add&&this.container.append(this.add),this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.hide&&this.add&&this.add.remove(),this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.projection.registerHandler("displayed",(t=>{this.displayed||(this.displayed=!0,(0,U.isNullOrUndefined)(this.waiting)||this.waiting.forEach((t=>{let{render:e,projection:n}=t;gi.setDimensions(this.dimSchema.get(e.dataset.id)),n.update("displayed")}))),this.schema.handler&&(this.anchorModel=ui.AnchorHandler.create(this,this.schema.handler))})),this.projection.registerHandler("value.added",(t=>{this.full?this.saturated||this.saturate():this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)}))}},Qr=Object.assign({},Yr,Zr),{isHTMLElement:Kr,createDiv:ts,isNullOrUndefined:es,createDocFragment:ns,isEmpty:is,isNull:rs,valOrDefault:ss,isUndefined:as}=n(6689),os={init(){return this},render(){const{content:t=[],coordinates:e=!1,overflow:n=!1,background:i,data:r=!1,reference:s=!1,dimensions:a=!1,style:o,rmv:l=!1,anchor:c=!1}=this.schema,h=ns(),u=new DOMParser;if(es(this.container)){if(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),i&&(this.background=u.parseFromString(i.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.background.childNodes.forEach((t=>{this.container.append(t)})),this.container.setAttribute("width",this.background.getAttribute("width")),this.container.setAttribute("height",this.background.getAttribute("height")),this.width=Number(this.background.getAttribute("width")),this.height=Number(this.background.getAttribute("height"))),a&&"wrap"!==a.type){const{width:t,height:e,viewBox:n=!1}=a;this.container.setAttribute("width",t),this.container.setAttribute("height",e),this.width=a.width,this.height=a.height,this.fixed=!0,n&&this.container.setAttribute("viewBox",n.minX+" "+n.minY+" "+n.width+" "+n.height),this.fixed=!0}if("wrap"!==a.type||i||(this.wrapped=!0,this.projection.registerHandler("displayed",(()=>{this.updateSizeWrap()}))),n&&(this.container.style.overflow="visible"),i||a||(this.container.style.overflow="visible"),e){const{x:t,y:n}=e;this.container.setAttribute("x",t),this.container.setAttribute("y",n)}this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="decoration",this.container.dataset.id=this.id,this.container.id=this.id,s&&(this.container.dataset.reference=!0)}return r&&this.container.setAttribute("data-shape",r),c&&(this.attachPoint=c),es(this.content)&&!is(t)&&(this.waiting=[],this.positioning=[],this.itemsPos=new Map,this.itemsDim=new Map,this.content=[],t.forEach((t=>{let e=Na.call(this,t.render),n=gi.analyseDim(e,t);this.itemsDim.set(e.dataset.id,n);let i=this.projection.resolveElement(e);es(i)?this.waitingRendered=!0:(i.source.register(this.projection),this.content.push(i)),n.await&&this.waiting.push(e.dataset.id);let r=gi.analysePos(e,t);this.itemsPos.set(e.dataset.id,r),r.await&&this.positioning.push(r),es(n.holder)?this.container.append(n.item):this.container.append(n.holder)}))),h.hasChildNodes()&&this.container.append(h),o&&(this.container.style=o),this.displayed=!1,this.bindEvents(),this.container},focus(t){this.container.focus()},focusIn(){return!es(this.deleteElem)&&this.deleteElem.dataset.focusable&&this.container.append(this.deleteElem),es(this.focusedElement)||this.focusedElement.forEach((t=>{this.container.append(t)})),es(this.content)||this.content.forEach((t=>{t.focusIn()})),this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this.rmv&&this.container.append(this.rmv),this},focusOut(){return!es(this.deleteElem)&&this.deleteElem.dataset.focusable&&this.deleteElem.remove(),es(this.focusedElement)||this.focusedElement.forEach((t=>{t.remove()})),es(this.content)||this.content.forEach((t=>{t.focusOut()})),this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this.rmv&&this.rmv.remove(),this},notify(t){this.updateContentDim(t.id)},augment(){let t=this.container.querySelector("[data-augment]");t.setAttribute("height",Number(t.getAttribute("height"))+30),es(this.container.getAttribute("height"))||this.container.setAttribute("height",Number(this.container.getAttribute("height"))+30),rs(this.background)||this.background.setAttribute("height",Number(this.background.getAttribute("height"))+30)},updateContentDim(t){let e=this.itemsDim.get(t),n=this.itemsPos.get(t);"ratio"===e.type&&(gi.adaptRatio(e.item,e.ratio),gi.positionElement(n,e.holder))},accept(t,e,n){let i=gi.analyseDim(t,{dimension:e}),r=gi.analysePos(t,{coordinates:n});es(this.itemsDim)&&(this.itemsDim=new Map),this.itemsDim.set(t.dataset.id,i),es(this.itemsPos)&&(this.itemsPos=new Map),this.itemsPos.set(t.dataset.id,r),this.displayed?(gi.setDimensions(i),es(i.holder)?gi.positionElement(r,t):gi.positionElement(r,i.holder)):(es(this.content)&&(this.content=[],this.waiting=[],this.positioning=[]),this.content.push(this.projection.resolveElement(t)),i.await&&this.waiting.push(t.dataset.id),r.await&&this.positioning.push(r)),es(i.holder)?this.container.append(i.item):this.container.append(i.holder)},analyseContentDim(){if(this.fixed)return;let t=0;if(0===this.content.length)return;for(;t<this.content.length&&es(this.content[t]);)t++;if(t>this.content.length)return;let e=this.itemsDim.get(this.content[t].id);if("pure"===e.type){let e,n,i,r;es(this.content[t].container)?(e=Number(this.content[t].element.getAttribute("x")),n=Number(this.content[t].element.getAttribute("y")),i=Number(this.content[t].width),r=Number(this.content[t].height)):(e=Number(this.content[t].container.getAttribute("x")),n=Number(this.content[t].container.getAttribute("y")),i=Number(this.content[t].width),r=Number(this.content[t].height)),this.width=e+i,this.height=n+r}for(let n=t+1;n<this.content.length;n++)if(!es(this.content[n])&&(e=this.itemsDim.get(this.content[n].id),"pure"===e.type)){let t,e,i,r;es(this.content[n].container)?(t=Number(this.content[n].element.getAttribute("x")),e=Number(this.content[n].element.getAttribute("y")),i=Number(this.content[n].width),r=Number(this.content[n].height)):(t=Number(this.content[n].container.getAttribute("x")),e=Number(this.content[n].container.getAttribute("y")),i=Number(this.content[n].width),r=Number(this.content[n].height)),(es(this.width)||this.width<t+i)&&(this.width=t+i),(es(this.height)||this.height<e+r)&&(this.height=e+r)}this.notifyDimObservers()},clickHandler(t){if(this.container.contains(t)){for(;t!==this.container&&es(t.dataset.nature);)t=t.parentNode;t!==this.container&&this.projection.resolveElement(t).clickHandler(t)}return!1},bindEvents(){this.projection.registerHandler("displayed",(t=>{this.displayed||(this.displayed=!0,es(this.waiting)||this.waiting.forEach((t=>{gi.setDimensions(this.itemsDim.get(t))})),es(this.positioning)||this.positioning.forEach((t=>{let e=this.itemsDim.get(t.render.dataset.id);e.holder?gi.positionElement(t,e.holder):gi.positionElement(t,t.render)})),es(this.content)||this.content.forEach((t=>{es(t)||t.projection.update("displayed",t.id)})),es(this.width)&&this.analyseContentDim(),es(this.parent)||this.parent.updateSize())})),this.waitingRendered&&this.projection.registerHandler("binding",(t=>{this.content.push(this.projection.resolveElement(t))}))}},ls=Object.assign({},Yr,os),cs={init(){return this},render(){const{interaction:t,algorithm:e}=this.schema,n=(0,U.createDocFragment)();if((0,U.isNullOrUndefined)(this.container)&&(this.container=(0,U.createDiv)({id:this.id,class:["algorithm","algorithm--holder"],tabindex:-1,dataset:{nature:"algorithm",view:"holder",id:this.id}})),(0,U.isNullOrUndefined)(this.interactionArea)&&(this.interactionArea=Na.call(this,t),n.append(this.interactionArea)),(0,U.isNullOrUndefined)(this.svgArea)){let t=this.source.getAttributeByName(e.name).target,i=this.environment.projectionModel.createProjection(t,e.tag);this.svgArea=i.init().render(),n.append(this.svgArea)}return n.hasChildNodes()&&this.container.append(n),this.container}},hs=Object.assign({},Yr,cs),{createDocFragment:us,isNullOrUndefined:ds,isEmpty:ps,isNull:fs}=n(6689),{AnchorHandler:ms}=n(7496),gs={init(){return this},render(){const{dimensions:t,overflow:e=!1,contains:n,reserve:i,model:r,style:s,offset:a,zindex:o,content:l=[]}=this.schema;if(ds(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="anchor",this.container.dataset.id=this.id),e&&(this.container.style.overflow="visible"),t){const{width:e,height:n}=t;this.container.setAttribute("width",e),this.container.setAttribute("height",n)}return!ps(l)&&ds(this.items)&&(this.items=[],l.forEach((t=>{const{coordinates:e,render:n,dimension:i}=t;let r=Na.call(this,n);r.setAttribute("x",e.x),r.setAttribute("y",e.y),this.container.append(r),this.items.push(r)}))),r&&(ms.createSubModel(r,this),this.anchorModel=r),this.bindEvents(),s&&this.createStyleMimic(s),this.container},focusIn(){},focusOut(){},increaseSize(){const t=Number(this.container.getAttribute("height"));this.container.setAttribute("height",t+this.anchors.y),this.mimic.setAttribute("height",t+this.anchors.y)},decreaseSize(){const t=Number(this.container.getAttribute("height"));this.container.setAttribute("height",t-this.anchors.y),this.mimic.setAttribute("height",t-this.anchors.y)},increaseAnchor(){const t=Number(this.container.getAttribute("y"));this.container.setAttribute("y",t+this.anchors.y)},decreaseAnchor(){const t=Number(this.container.getAttribute("y"));this.container.setAttribute("y",t-this.anchors.y)},createStyleMimic(t){this.mimic=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.mimic.setAttribute("width",this.container.getAttribute("width")),this.mimic.setAttribute("height",this.container.getAttribute("height")),this.mimic.style=t,this.container.prepend(this.mimic)},checkCover(){let t,e;for(let n=0;n<this.covering.length;n++)ds(t)?(t=Math.min(this.covering[n].from.x,this.covering[n].to.x),e=Math.max(this.covering[n].from.x,this.covering[n].to.x)):(t>Math.min(this.covering[n].from.x,this.covering[n].to.x)&&(t=Math.min(this.covering[n].from.x,this.covering[n].to.x)),e<Math.max(this.covering[n].from.x,this.covering[n].to.x)&&(e=Math.max(this.covering[n].from.x,this.covering[n].to.x)));const n=Number(this.container.getAttribute("x"));n<t?(this.container.setAttribute("width",e-t+2*this.schema.offset.x+(t-n)),this.mimic.setAttribute("width",e-t+2*this.schema.offset.x+(t-n))):(this.container.setAttribute("width",e-t+2*this.schema.offset.x),this.mimic.setAttribute("width",e-t+2*this.schema.offset.x))},bindEvents(){this.projection.registerHandler("displayed",(()=>{let t=ms.estimatePositionCondamn(this.anchorModel,this);const{offset:e=!1}=this.schema;e&&(this.container.setAttribute("x",t.x-e.x),this.container.setAttribute("y",t.y-e.y)),this.anchors=t.anchors,this.rtag=this.environment.getActiveReceiver(this.schema.rtag),this.rtag.container.prepend(this.container)})),this.projection.registerHandler("accept",(t=>{ms.registerSubModel(this.anchorModel,this,t)})),this.projection.registerHandler("cover",(t=>{ds(this.rtag)&&(this.rtag=this.findActiveReceiver(this.schema.rtag));const e=ms.estimatePosition(t.calcS),n=ms.estimatePosition(t.calcT);ds(this.covering)&&(this.covering=[]),this.setCovering(t,e,n),this.checkCover()}))},setCovering(t,e,n){for(let i=0;i<this.covering.length;i++)if(this.covering[i].item===t)return this.covering[i].from=e,void(this.covering[i].to=n);this.covering.push({item:t,from:e,to:n})}},bs=Object.assign({},Yr,gs),vs={init(){return this},render(){const{button:t,view:e}=this.schema;if((0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="decoration",this.container.dataset.id=this.id),(0,U.isNullOrUndefined)(this.button)){const e=new DOMParser,{content:n,coordinates:i}=t;this.button=e.parseFromString(parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement),this.button.setAttribute("x",i.x),this.button.setAttribute("y",i.y),this.container.append(t)}return this.bindEvents(),this.container},bindEvents(){}},ys=Object.assign({},Yr,vs),{isHTMLElement:xs,createDiv:ws,isNullOrUndefined:Es,createDocFragment:As,isEmpty:Ns,isNull:Os,valOrDefault:ks}=n(6689),_s={init(){return this},render(){const{content:t,dimensions:e}=this.schema;return Es(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","text"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="add",this.container.dataset.id=this.id,this.container.setAttribute("font-size",12),this.container.style["dominant-baseline"]="hanging"),this.container.textContent=t,this.container},focusIn(){},focusOut(){},clickHandler(){this.source.createElement()},bindEvents(){this.container.addEventListener("click",(()=>{this.source.createElement()}))}},js=Object.assign({},Yr,_s),Ms={init(){return this},render(){const{action:t,content:e,background:n}=this.schema;if((0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="button",this.container.dataset.id=this.id),e&&(0,U.isNullOrUndefined)(this.content)&&this.createContent(e),n){const t=new DOMParser;this.background=t.parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.container.append(this.background)}return this.container},createContent(t){if("text"===t.type){this.content=document.createElementNS("http://www.w3.org/2000/svg","text");const{placeholder:e,font:n,size:i,anchor:r}=t.text;this.content.setAttribute("font-family",n),this.content.setAttribute("font-size",i),this.content.setAttribute("text-anchor",r),this.content.style["dominant-baseline"]="hanging",this.content.textContent=e,this.container.append(this.content)}},focusIn(){},focusOut(){}},Cs=Object.assign({},Yr,Ms),Ss={init(){const{width:t,height:e}=this.schema.dimensions,{depth:n}=this.schema;return this.width=t,this.height=e,this.intensity=n,this},render(){const{tag:t,duration:e,orientation:n}=this.schema;return(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="tree",this.container.dataset.id=this.id,this.container.tabindex=1,this.container.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,U.isNullOrUndefined)(this.linkSpace)&&(this.linkSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.container.append(this.linkSpace),this.linkSpace.classList.add("linkSpace")),(0,U.isNullOrUndefined)(this.nodeSpace)&&(this.nodeSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.container.append(this.nodeSpace),this.nodeSpace.classList.add("nodeSpace")),this.rootTag=t,this.duration=e,this.orientation=n,(0,U.isNullOrUndefined)(this.tree)&&("vertical"===this.orientation?this.tree=d3.layout.tree().size([this.width,this.height]):this.tree=d3.layout.tree().size([this.height,this.width])),this.createRoot(),this.setData(),this.bindEvents(),this.container},accept(t,e,n){let i=this.findData(e.getAttribute("data-concept")),r=this.model.createProjection(t,n).init();r.optional=!0;let s=r.render();t.register(this.projection);let a=this.createHolder();a.append(s),a.setAttribute("id",s.getAttribute("data-concept")),s.setAttribute("data-tree",this.schema.treeId),s.classList.add("node"),this.nodeSpace.append(a),r.element.source.notify("displayed"),(0,U.isNullOrUndefined)(i.children)&&(i.children=[]);let o=s.getBBox();i.children.push({proj:a,id:s.getAttribute("data-concept"),offW:o.width/2,offH:o.height/2,children:[]}),(0,U.isNullOrUndefined)(this.treeIndex)&&(this.treeIndex=new Map),this.treeIndex.set(s.getAttribute("data-concept"),a),this.update()},findData(t){let e=this.data[0];return this.findDataAt(t,e)},findDataAt(t,e){if(e.id===t)return e;if((0,U.isNullOrUndefined)(e.children)||(0,U.isEmpty)(e.children))return!1;for(let n=0;n<e.children.length;n++){let i=this.findDataAt(t,e.children[n]);if(i)return i}return!1},createRoot(){this.rootProj=this.model.createProjection(this.source,this.rootTag).init(),this.rootProj.parent=this.projection;let t=this.rootProj.render();t.setAttribute("data-tree",this.schema.treeId),this.root=t;let e=this.createHolder();switch(this.projMap=new Map,this.projMap.set(t,{group:e,index:0}),e.setAttribute("id",t.getAttribute("data-concept")),this.orientation){case"horizontal":e.setAttribute("x",0),e.setAttribute("y",this.height/2-this.rootProj.element.height/2);break;case"vertical":e.setAttribute("y",0),e.setAttribute("x",this.width/2-this.rootProj.element.width/2)}e.append(t),this.nodeSpace.appendChild(e)},createHolder(){let t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.classList.add("node"),t},setData(){this.data=[{name:"root",index:0,id:this.root.getAttribute("data-concept"),children:[]}]},update(){(0,U.isNullOrUndefined)(this.svg)&&(this.svg=d3.select("#"+this.id)),"vertical"===this.orientation?this.updateVertical():this.updateHorizontal()},arrange(){let t=this.data[0],e=1;if((0,U.isNullOrUndefined)(t.children))return 0;for(let n=0;n<t.children.length;n++)e=this.arrangeChildren(t.children[n],e);return e>3?1:0},arrangeChildren(t,e){let n=this.treeIndex.get(t.id);if(n.setAttribute("example",e),this.nodeSpace.children.length>e?this.nodeSpace.insertBefore(n,this.nodeSpace.children[e]):this.nodeSpace.append(n),(0,U.isNullOrUndefined)(t.children))return e+1;let i=e+1;for(let e=0;e<t.children.length;e++)i=this.arrangeChildren(t.children[e],i),i++;return i},updateVertical(){var t=d3.svg.diagonal().projection((function(t){return[t.y,t.x]}));let e=this.data[0];e.x0=this.width/2,e.y0=50;let n=this.tree.nodes(e),i=this.tree.links(n);const r=this.intensity,s=this.duration;n.forEach((function(t){t.y=t.depth*r+50}));var a=this.svg.select("g.node").data(n),o=this.svg.select("path.link").data(i);a.enter().append("g").attr("class","node").attr("data-content",(function(t){return t.id})).attr("data-moved",(function(t){return"true"})).attr("transform",(function(t){return"translate("+e.x0+", "+e.y0+")"})),this.arrange(),a.transition().duration(s).attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})),a.exit().transition().attr("transform",(function(t){return"translate("+e.x+", "+e.y+")"})).remove(),n.forEach((function(t){t.x0=t.x,t.y0=t.y})),(o=svg.selectAll("path.link").data(i)).enter().insert("path","g").attr("class","link").attr("fill",a).attr("stroke",black).attr("stroke-width",2).attr("d",(function(e){var n={x:source.x0,y:source.y0};return t({source:n,target:n})})),o.transition().duration(s).attr("d",t),o.exit().transition().duration(s).attr("d",(function(e){var n={x:source.x,y:source.y};return t({source:n,target:n})})).remove()},updateHorizontal(){var t=d3.svg.diagonal().projection((function(t){return[t.y,t.x]}));let e=this.data[0];e.x0=this.width/2,e.y0=50;let n=this.tree.nodes(e),i=this.tree.links(n);const r=this.intensity,s=this.duration;n.forEach((function(t){t.y=t.depth*r+2*e.offW})),this.arrange();var a=this.svg.select("g.nodeSpace").selectAll("g.node").data(n);a.enter().append("g").attr("class","node").attr("transform",(function(t){return"translate("+(e.y0-e.offW)+", "+(e.x0-e.offH)+")"})),a.transition().duration(s).attr("transform",(function(t){return"translate("+(t.y-t.offW)+", "+(t.x-t.offH)+")"})),a.exit().transition().attr("transform",(function(t){return"translate("+(e.y-e.offW)+", "+(e.x-e.offH)+")"})).remove(),n.forEach((function(t){t.x0=t.x,t.y0=t.y}));var o=this.svg.select("g.linkSpace").selectAll("path.link").data(i);o.enter().insert("path","g").attr("class","link").attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("d",(function(n){var i={x:e.x0,y:e.y0};return t({source:i,target:i})})),o.transition().duration(s).attr("d",t),o.exit().transition().duration(s).attr("d",(function(n){var i={x:e.x,y:e.y};return t({source:i,target:i})})).remove()},removeNode(t,e){if(!e.children)return!1;for(let n=0;n<e.children.length;n++){if(e.children[n].id===t)return e.children.splice(n,1),0===e.children.length&&(e.children=null),!0;if(deleteItem(t,e.children[n]))return!0}return!1},bindEvents(){this.projection.registerHandler("displayed",(()=>{if(!this.displayed){this.displayed=!0,this.rootProj.element.source.notify("displayed");let t=this.rootProj.element.container.getBBox();this.data[0].offW=t.width/2,this.data[0].offH=t.height/2,this.update()}})),this.projection.registerHandler("delete",((t,e)=>{this.removeNode(e.id,this.data[0]),this.treeIndex.delete(e.id),this.update()}))}},Ls=Object.assign(Object.create(Yr),Ss);var Ts=0;const Is=()=>"algo"+Ts++,Us={force:(t,e,n)=>Object.create(Jr,{object:{value:"algorithm"},name:{value:"force-algorithm"},type:{value:"force"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),pattern:(t,e,n)=>Object.create(Qr,{object:{value:"algorithm"},name:{value:"pattern-algorithm"},type:{value:"pattern"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),decoration:(t,e,n)=>Object.create(ls,{object:{value:"algorithm"},name:{value:"decoration-algorithm"},type:{value:"decoration"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),holder:(t,e,n)=>Object.create(hs,{object:{value:"algorithm"},name:{value:"holder-algorithm"},type:{value:"holder"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),anchor:(t,e,n)=>Object.create(bs,{object:{value:"algorithm"},name:{value:"anchor-algorithm"},type:{value:"anchor"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),"alt-view":(t,e,n)=>Object.create(ys,{object:{value:"algorithm"},name:{value:"alt-view"},type:{value:"alt-view"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),add:(t,e,n)=>Object.create(js,{object:{value:"algorithm"},name:{value:"add"},type:{value:"add"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),button:(t,e,n)=>Object.create(Cs,{object:{value:"algorithm"},name:{value:"svg-button"},type:{value:"button"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),tree:(t,e,n)=>Object.create(Ls,{object:{value:"algorithm"},name:{value:"tree-layout"},type:{value:"tree"},id:{value:Is()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},Ds={createAlgo(t,e,n){const{type:i}=e,r=Us[i];if((0,U.isNullOrUndefined)(r))throw new TypeError(`Missing handler: The '${i}' algo could not be handled`);const s=r(t,e,n);if((0,U.isNullOrUndefined)(s))throw new Error(`Bad request: The '${i}' algo could not be created`);return s.createAlgo=this.createAlgo,(0,U.isNullOrUndefined)(s.id)&&(s.id=Is()),s}};var Hs=n(3296),Ps=n(4143);const zs={init(){return this.width=700,this.height=700,this},render(){(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",350),this.container.setAttribute("height",350),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="force",this.container.dataset.id=this.id,this.simulationArea=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.simulationArea.setAttribute("width",350),this.simulationArea.setAttribute("height",350),this.simulationArea.setAttribute("viewBox","0 0 700 700"),this.simulationArea.setAttribute("preserveAspectRatio","xMidYMid meet"),this.simulationArea.id=this.id,this.settingArea=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.settingArea.setAttribute("x",0),this.settingArea.setAttribute("y",0),this.container.append(this.settingArea),this.container.append(this.simulationArea)),(0,U.isNullOrUndefined)(this.circleRadiusTxt)&&(this.circleRadiusTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.circleRadiusTxt.textContent="Radius:",this.circleRadiusTxt.setAttribute("x",5),this.circleRadiusTxt.setAttribute("y",30),this.circleRadiusTxt.setAttribute("font-size",8),this.circleRadiusTxt.setAttribute("font-weight",500),this.circleRadiusTxt.setAttribute("font-family","Segoe UI"),this.settingArea.append(this.circleRadiusTxt)),(0,U.isNullOrUndefined)(this.radiusTxt)&&(this.radiusTxt=Na.call(this,{type:"attribute",name:"radius",tag:"simulation"}),this.radiusTxt.setAttribute("x",37),this.radiusTxt.setAttribute("y",30),this.settingArea.append(this.radiusTxt)),(0,U.isNullOrUndefined)(this.widthTxt)&&(this.widthTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.widthTxt.textContent="Width:",this.widthTxt.setAttribute("x",5),this.widthTxt.setAttribute("y",40),this.widthTxt.setAttribute("font-size",8),this.widthTxt.setAttribute("font-weight",500),this.widthTxt.setAttribute("font-family","Segoe UI"),this.settingArea.append(this.widthTxt)),(0,U.isNullOrUndefined)(this.wTxt)&&(this.wTxt=Na.call(this,{type:"attribute",name:"width",tag:"simulation"}),this.wTxt.setAttribute("x",37),this.wTxt.setAttribute("y",40),this.settingArea.append(this.wTxt)),(0,U.isNullOrUndefined)(this.heightTxt)&&(this.heightTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.heightTxt.textContent="Height",this.heightTxt.setAttribute("x",5),this.heightTxt.setAttribute("y",50),this.heightTxt.setAttribute("font-size",8),this.heightTxt.setAttribute("font-weight",500),this.heightTxt.setAttribute("font-family","Segoe UI"),this.settingArea.append(this.heightTxt)),(0,U.isNullOrUndefined)(this.hTxt)&&(this.hTxt=Na.call(this,{type:"attribute",name:"height",tag:"simulation"}),this.hTxt.setAttribute("x",37),this.hTxt.setAttribute("y",50),this.settingArea.append(this.hTxt)),this.button=document.createElementNS("http://www.w3.org/2000/svg","text"),this.button.textContent="Simulate",this.settingArea.append(this.button),this.button.addEventListener("click",(()=>{this.setUpForce()})),this.button.setAttribute("x",5),this.button.setAttribute("y",12),this.button.setAttribute("font-size",12),this.button.setAttribute("font-weight",500),this.button.setAttribute("font-family","Segoe UI");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.classList.add("linkSimulation"),t.id="linkSimulation"+this.id,t.setAttribute("stroke","black"),this.simulationArea.append(t),this.svgNode=[];for(let t=0;t<3;t++){let t=document.createElementNS("http://www.w3.org/2000/svg","circle");t.style.fill="red",t.style.stroke="black",t.setAttribute("r",50),t.classList.add("nodeSimulation"),t.classList.add("hidden"),this.svgNode.push(t),this.simulationArea.append(t)}let e=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.classList.add("nodeSimulation"),e.classList.add("hidden"),this.svgNode.push(e),this.simulationArea.append(e),this.bindEvents(),this.intensity=Number(this.intensityAttr.value),this.linkVal=Number(this.linkDistAttr.value),this.container},branch(){this.setUpForce()},setUpForce(){if((0,U.isNullOrUndefined)(this.force)){this.svgNode.forEach((t=>{t.classList.remove("hidden")})),this.source.getAttributeByName("intensity").target.value;const e=Number(this.source.getAttributeByName("linkVal").target.value);this.force=Ps.layout.force().size([this.width,this.height]).nodes([]).links([{source:0,target:1}]).linkDistance(e).charge(-500).on("tick",this.tick.bind(this));var t=Ps.select("#"+this.id);this.nodes=this.force.nodes(),this.nodes.push({x:25,y:25}),this.nodes.push({x:325,y:25}),this.nodes.push({x:175,y:75}),this.nodes.push({ref:!0}),this.node=t.selectAll("circle").data(this.nodes),this.links=this.force.links(),this.link=t.selectAll("path").data(this.links)}this.force.start()},clickHandler(){},tick(){let t=this.nodes;this.node.attr("cx",(function(e){if(e.ref){Vs.getMediatrice(t[0],t[1]);let e={x:(t[0].x+t[1].x)/2,y:(t[0].y+t[1].y)/2};return t[0].x,t[1].x,t[0].x,t[1].x,t[0].y,t[1].y,t[0].y,t[1].y,e.x}return e.x})).attr("cy",(function(e){if(e.ref){Vs.getMediatrice(t[0],t[1]);let e={x:(t[0].x+t[1].x)/2,y:(t[0].y+t[1].y)/2};return t[0].x,t[1].x,t[0].x,t[1].x,t[0].y,t[1].y,t[0].y,t[1].y,e.y}return e.y})),this.link.attr("d",(function(t){return"M"+t.target.x+","+t.target.y+"A1,1 0 0 1,"+t.source.x+","+t.source.y+"A1,1 0 0 0,"+t.target.x+","+t.target.y}))},updateClean(){this.height=this.heightAttr.value,this.width=this.widthAttr.value,this.height>0&&this.width>0&&this.simulationArea.setAttribute("viewBox","0 0 "+this.width+" "+this.height);for(let t=0;t<3;t++)this.radius.value>0&&this.svgNode[t].setAttribute("r",this.radius.value)},focusIn(){},focusOut(){},updateParams(){if((0,U.isNullOrUndefined)(this.force))this.updateClean();else{this.force.stop(),this.intensity=Math.min(-1*Number(this.intensityAttr.value),-1*Number(this.intensityAttr.value)),this.linkVal=Number(this.linkDistAttr.value);for(let t=0;t<3;t++)this.radius.value>0&&this.svgNode[t].setAttribute("r",this.radius.value);this.height=this.heightAttr.value,this.width=this.widthAttr.value,this.height>0&&this.width>0&&(this.simulationArea.setAttribute("viewBox","0 0 "+this.width+" "+this.height),this.force.size([this.width,this.height])),this.force.linkDistance(this.linkVal).charge(this.intensity),this.force.start()}},bindEvents(){this.intensityAttr=this.source.getAttributeByName("intensity").target,this.linkDistAttr=this.source.getAttributeByName("linkVal").target,this.widthAttr=this.source.getAttributeByName("width").target,this.heightAttr=this.source.getAttributeByName("height").target,this.radius=this.source.getAttributeByName("radius").target,this.intensityAttr.register(this.projection),this.linkDistAttr.register(this.projection),this.widthAttr.register(this.projection),this.heightAttr.register(this.projection),this.radius.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateParams()}))}},Vs={getMediatrice(t,e){let n=(t.x+e.x)/2,i=(t.y+e.y)/2,r=(e.y-t.y)/(e.x-t.x);return{k:-1/r,h:i+-1/r*n}},findPoint(t,e,n){let i=1-t.k*t.k,r=2*e.y*t.k-2-2*t.k*t.h,s=r*r-4*i*(e.x*e.x-e.y*e.y-t.h*t.h+2*e.y*t.h-n);if(s>0)return(-r-Math.sqrt(s))/(2*i)}},Rs=Object.assign(Object.create(Hs.Simulation),zs),Bs={init(){return this.width=350,this.height=100,this},focusIn(){},focusOut(){},render(){return(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",300),this.container.setAttribute("height",50),this.container.setAttribute("x",100),this.container.setAttribute("y",0),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.schema.wider?this.path.setAttribute("d","M 0 25 L 275 25"):this.path.setAttribute("d","M 0 25 L 200 25"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="arrow",this.container.dataset.id=this.id,this.container.id=this.id,this.path.id="path"+this.id,this.container.append(this.path)),this.markerStart=Na.call(this,{type:"attribute",name:"start",placeholder:!1,tag:"simulation-start"}),this.markerEnd=Na.call(this,{type:"attribute",name:"end",placeholder:!1,tag:"simulation-end"}),this.container.append(this.markerStart),this.container.append(this.markerEnd),this.bindEvents(),this.container},applyStyle(){this.stroke.hasValue()&&this.path.setAttribute("stroke",this.stroke.value),this.width.hasValue()&&this.path.setAttribute("stroke-width",this.width.value),this.dasharray.hasValue()&&this.path.setAttribute("stroke-dasharray",this.dasharray.value),this.linecap.hasValue()&&this.path.setAttribute("stroke-linecap",this.linecap.value)},bindEvents(){this.stroke=this.source.getAttributeByName("stroke").target,this.stroke.register(this.projection),this.path.setAttribute("stroke","black"),this.width=this.source.getAttributeByName("width").target,this.width.register(this.projection),this.width.hasValue()&&this.path.setAttribute("stroke-width",this.width.value),this.dasharray=this.source.getAttributeByName("dasharray").target,this.dasharray.register(this.projection),this.dasharray.hasValue()&&this.path.setAttribute("stroke-dasharray",this.dasharray.value),this.linecap=this.source.getAttributeByName("linecap").target,this.linecap.register(this.projection),this.linecap.hasValue()&&this.path.setAttribute("stroke-linecap",this.linecap.value),this.projection.registerHandler("value.changed",(()=>{this.applyStyle()}))}},qs=Object.assign(Object.create(Hs.Simulation),Bs),Fs={init(){return this.width=350,this.height=100,this},render(){return(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",200),this.container.setAttribute("height",200),this.container.setAttribute("viewBox","0 0 50 50"),this.text=document.createElementNS("http://www.w3.org/2000/svg","text"),this.text.setAttribute("x",25),this.text.setAttribute("y",25),this.text.textContent="Element",this.heightTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.heightTxt.setAttribute("x",2),this.heightTxt.setAttribute("y",45),this.heightTxt.setAttribute("font-size",2),this.heightTxt.textContent="dimensions: 50x50",this.xyText=document.createElementNS("http://www.w3.org/2000/svg","text"),this.xyText.setAttribute("x",2),this.xyText.setAttribute("y",47),this.xyText.setAttribute("font-size",2),this.xyText.textContent="x,y: 25, 25",this.container.append(this.text),this.container.append(this.widthTxt),this.container.append(this.heightTxt),this.container.append(this.xyText),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="text",this.container.dataset.id=this.id,this.container.style="border:solid rgb(135, 161, 255); border-radius:10%;",this.container.id=this.id),this.bindEvents(),this.container},applyStyle(){this.font.hasValue()&&this.text.setAttribute("font-family",this.font.value),this.size.hasValue()&&this.text.setAttribute("font-size",this.size.value),this.anchor.hasValue()&&this.text.setAttribute("text-anchor",this.anchor.value),this.weight.hasValue()&&this.text.setAttribute("font-weight",this.weight.value),this.baseline.hasValue()&&(this.text.style["dominant-baseline"]=this.baseline.value)},bindEvents(){this.font=this.source.getAttributeByName("font").target,this.font.register(this.projection),this.text.setAttribute("font-family","Verdana"),this.size=this.source.getAttributeByName("size").target,this.size.register(this.projection),this.size.hasValue()&&this.text.setAttribute("font-size",this.size.value),this.weight=this.source.getAttributeByName("weight").target,this.weight.register(this.projection),this.weight.hasValue()&&this.text.setAttribute("font-weight",this.weight.value),this.anchor=this.source.getAttributeByName("anchor").target,this.anchor.register(this.projection),this.anchor.hasValue()&&this.text.setAttribute("text-anchor",this.anchor.value),this.baseline=this.source.getAttributeByName("baseline").target,this.baseline.register(this.projection),this.baseline.hasValue()&&this.text.setAttribute("dominant-baseline",this.anchor.value),this.projection.registerHandler("value.changed",(()=>{this.applyStyle()}))}},$s=Object.assign(Object.create(Hs.Simulation),Fs),Ws={init(){return this.width=400,this.height=200,this},render(){return(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",200),this.container.setAttribute("height",200),this.container.setAttribute("viewBox","0 0 400 400"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.simulation="selection",this.container.dataset.id=this.id,this.container.style="border:solid rgb(135, 161, 255); border-radius:10%;",this.container.id=this.id),this.bindEvents(),this.setUpSimulation(),this.container},bindEvents(){this.nbItem=this.source.getAttributeByName("nbItem").target,this.orientation=this.source.getAttributeByName("orientation").target,this.break=this.source.getAttributeByName("break").target,this.itemW=this.source.getAttributeByName("dimensions").target.getAttributeByName("width").target,this.itemH=this.source.getAttributeByName("dimensions").target.getAttributeByName("height").target,this.nbItem.register(this.projection),this.orientation.register(this.projection),this.break.register(this.projection),this.itemW.register(this.projection),this.itemH.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.setUpSimulation()}))},setUpSimulation(){this.baseLetter=65,(0,U.isNullOrUndefined)(this.selection)||this.selection.remove(),this.selection=document.createElementNS("http://www.w3.org/2000/svg","svg");for(let t=0;t<this.nbItem.value;t++){let e=this.createItem();this.place(e,t),this.baseLetter++}this.center(),this.container.append(this.selection)},focusIn(){},focusOut(){},place(t,e){const n=(0,U.valOrDefault)(this.itemW.value,50),i=(0,U.valOrDefault)(this.itemH.value,50),r=this.break.value;switch(this.orientation.value){case"horizontal":r>0?(t.setAttribute("x",e%r*n),t.setAttribute("y",~~(e/r)*i)):t.setAttribute("x",e*n);break;case"vertical":r>0?(t.setAttribute("x",~~(e/r)*i),t.setAttribute("y",e%r*n)):t.setAttribute("y",e*i)}},createItem(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");const e=(0,U.valOrDefault)(this.itemW.value,50),n=(0,U.valOrDefault)(this.itemH.value,50);this.break.value,t.setAttribute("width",e),t.setAttribute("height",n);let i=document.createElementNS("http://www.w3.org/2000/svg","text");return i.textContent=String.fromCharCode(this.baseLetter),i.setAttribute("x",e/2),i.setAttribute("y",n/2),i.setAttribute("text-anchor","middle"),i.setAttribute("font-size",n/2),i.setAttribute("font-family","Segoe UI"),i.setAttribute("font-weight",500),t.append(i),this.selection.append(t),t},center(){const t=this.orientation.value,e=this.break.value,n=(0,U.valOrDefault)(this.itemW.value,50),i=(0,U.valOrDefault)(this.itemH.value,50),r=this.nbItem.value;switch(t){case"horizontal":e>0&&r>e?(this.selection.setAttribute("x",200-e*n/2),this.selection.setAttribute("y",200-Math.ceil(r/e)*i/2)):(this.selection.setAttribute("x",200-r*n/2),this.selection.setAttribute("y",200-i/2));break;case"vertical":e>0&&r>e?(this.selection.setAttribute("y",200-e*i/2),this.selection.setAttribute("x",200-Math.ceil(r/e)*n/2)):(this.selection.setAttribute("y",200-r*i/2),this.selection.setAttribute("x",200-n/2))}}},Ys=Object.assign(Object.create(Hs.Simulation),Ws),Xs={init(){return this},focusIn(){},focusOut(){},render(){return(0,U.isNullOrUndefined)(this.def)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.def=document.createElementNS("http://www.w3.org/2000/svg","defs"),this.marker=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.marker.setAttribute("orient","auto"),this.marker.setAttribute("markerUnit","strokeWidth"),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="marker",this.container.dataset.id=this.id,this.def.append(this.marker),this.marker.append(this.path),this.container.append(this.def)),this.bindEvents(),this.container},focus(){},updateParams(){(0,U.isNullOrUndefined)(this.idAttr.value)||(this.marker.setAttribute("id",this.idAttr.value),this.user=this.container.parentNode.getElementById("path"+this.container.parentNode.id),this.user.setAttribute("marker-"+(this.schema.start?"start":"end"),"url(#"+this.idAttr.value+")")),(0,U.isNullOrUndefined)(this.minX.value)||(0,U.isNullOrUndefined)(this.minY.value)||(0,U.isNullOrUndefined)(this.width.value)||(0,U.isNullOrUndefined)(this.height.value)||this.marker.setAttribute("viewBox",this.minX.value+" "+this.minY.value+" "+this.width.value+" "+this.height.value),(0,U.isNullOrUndefined)(this.refX.value)||this.marker.setAttribute("refX",this.refX.value),(0,U.isNullOrUndefined)(this.refY.value)||this.marker.setAttribute("refY",this.refY.value),(0,U.isNullOrUndefined)(this.markerWidth.value)||this.marker.setAttribute("markerWidth",this.markerWidth.value),(0,U.isNullOrUndefined)(this.markerHeight.value)||this.marker.setAttribute("markerHeight",this.markerHeight.value),(0,U.isNullOrUndefined)(this.d.value)||this.path.setAttribute("d",this.d.value)},bindEvents(){this.idAttr=this.source.getAttributeByName("id").target,this.idAttr.register(this.projection),this.minX=this.source.getAttributeByName("minX").target,this.minX.register(this.projection),this.minY=this.source.getAttributeByName("minY").target,this.minY.register(this.projection),this.width=this.source.getAttributeByName("width").target,this.width.register(this.projection),this.height=this.source.getAttributeByName("height").target,this.height.register(this.projection),this.refX=this.source.getAttributeByName("refX").target,this.refX.register(this.projection),this.refY=this.source.getAttributeByName("refY").target,this.refY.register(this.projection),this.markerWidth=this.source.getAttributeByName("markerWidth").target,this.markerWidth.register(this.projection),this.markerHeight=this.source.getAttributeByName("markerHeight").target,this.markerHeight.register(this.projection),this.d=this.source.getAttributeByName("d").target,this.d.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateParams()}))}},Gs=Object.assign(Object.create(Hs.Simulation),Xs),Js={init(){return this.width=350,this.height=350,this},render(){return(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="content",this.container.dataset.id=this.id,this.container.setAttribute("width",300),this.container.setAttribute("height",300),this.holder=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.append(this.holder)),this.bindEvent(),this.container},focusIn(){},focusOut(){},scale(){const t=this.content.width.baseVal.value,e=this.content.height.baseVal.value;let n=Math.max(t,e)/100;this.holder.setAttribute("viewBox","0 0 "+t+" "+e),this.holder.setAttribute("width",t/n),this.holder.setAttribute("height",e/n),this.holder.setAttribute("x",100),this.holder.setAttribute("y",100)},bindEvent(){const t=new DOMParser;this.projection.registerHandler("value.changed",(e=>{(0,U.isNullOrUndefined)(this.content)||this.content.remove(),this.content=t.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.holder.append(this.content),this.scale()})),this.source.hasValue()&&(this.content=t.parseFromString(this.source.value.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.holder.append(this.content),this.scale())}},Zs=Object.assign(Object.create(Hs.Simulation),Js),Qs={init(){return this.width=350,this.height=350,this},render(){return(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",400),this.container.setAttribute("height",400),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="pattern",this.container.dataset.id=this.id),(0,U.isNullOrUndefined)(this.visualization)&&(this.visualization=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.visualization.setAttribute("viewBox","0 0 400 400"),this.visualization.setAttribute("width",400),this.visualization.setAttribute("height",400),this.visualization.setAttribute("preserveAspectRatio","xMidYMid meet"),this.container.append(this.visualization)),(0,U.isNullOrUndefined)(this.interaction)&&(this.interaction=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.interaction.setAttribute("viewBox","0 0 400 400"),this.interaction.setAttribute("width",400),this.interaction.setAttribute("height",400),this.container.append(this.interaction)),(0,U.isNullOrUndefined)(this.firstX)&&(this.firstX=this.source.getAttributeByName("first").target.getAttributeByName("x").target,this.firstY=this.source.getAttributeByName("first").target.getAttributeByName("y").target),(0,U.isNullOrUndefined)(this.nextX)&&(this.nextX=this.source.getAttributeByName("next").target.getAttributeByName("x").target,this.nextY=this.source.getAttributeByName("next").target.getAttributeByName("y").target),(0,U.isNullOrUndefined)(this.itemWidth)&&(this.itemWidth=this.source.getAttributeByName("itemWidth").target,this.itemWidthTextual=Na.call(this,{type:"attribute",name:"itemWidth",tag:"simulation-large"}),this.itemWidthTextual.setAttribute("x",57),this.itemWidthTextual.setAttribute("y",30),this.itemWidthStatic=Na.call(this,{kind:"static",type:"svg-text",content:"ItemWidth:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.itemWidthStatic.setAttribute("x",56),this.itemWidthStatic.setAttribute("y",30),this.interaction.append(this.itemWidthTextual),this.interaction.append(this.itemWidthStatic)),(0,U.isNullOrUndefined)(this.widthTextual)&&(this.widthAttr=this.source.getAttributeByName("width").target,this.widthTextual=Na.call(this,{type:"attribute",name:"width",tag:"simulation-large"}),this.widthTextual.setAttribute("x",34),this.widthTextual.setAttribute("y",45),this.widthStatic=Na.call(this,{kind:"static",type:"svg-text",content:"Width:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.widthStatic.setAttribute("x",33),this.widthStatic.setAttribute("y",45),this.interaction.append(this.widthTextual),this.interaction.append(this.widthStatic)),(0,U.isNullOrUndefined)(this.heightTextual)&&(this.heightAttr=this.source.getAttributeByName("height").target,this.heightTextual=Na.call(this,{type:"attribute",name:"height",tag:"simulation-large"}),this.heightTextual.setAttribute("x",38),this.heightTextual.setAttribute("y",60),this.heightStatic=Na.call(this,{kind:"static",type:"svg-text",content:"Height:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.heightStatic.setAttribute("x",37),this.heightStatic.setAttribute("y",60),this.interaction.append(this.heightTextual),this.interaction.append(this.heightStatic)),(0,U.isNullOrUndefined)(this.nbItem)&&(this.nbItem=this.source.getAttributeByName("nbItem").target,this.nbItemText=Na.call(this,{type:"attribute",name:"nbItem",tag:"simulation-large"}),this.nbItemStatic=Na.call(this,{kind:"static",type:"svg-text",content:"nbItem:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.nbItemText.setAttribute("x",26),this.nbItemText.setAttribute("y",15),this.nbItemStatic.setAttribute("x",25),this.nbItemStatic.setAttribute("y",15),this.interaction.append(this.nbItemStatic),this.interaction.append(this.nbItemText),this.setUpItems()),this.bindEvents(),this.container},setUpItems(){let t=this.nbItem.value;this.items=[];for(let e=0;e<t;e++){let t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("width",this.itemWidth.value),t.setAttribute("height",this.itemWidth.value),t.setAttribute("fill","white"),t.setAttribute("stroke","#738CFF"),t.setAttribute("stroke-width",5),t.setAttribute("x",e*this.nextX.value+this.firstX.value),t.setAttribute("y",e*this.nextY.value+this.firstY.value),this.visualization.append(t),this.items.push(t)}},updateContainer(){(0,U.isNullOrUndefined)(this.widthAttr.value)||(0,U.isNullOrUndefined)(this.heightAttr.value)||this.visualization.setAttribute("viewBox","0 0 "+this.widthAttr.value+" "+this.heightAttr.value)},updateItems(){let t=this.nbItem.value;if(!(0,U.isNullOrUndefined)(t)){if(this.items.length>t){for(let e=t;e<this.items.length;e++)this.items[e].remove();this.items.splice(t,this.items.length-t)}if(this.items.length<t)for(let e=this.items.length;e<t;e++){let t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("fill","white"),t.setAttribute("stroke","#738CFF"),t.setAttribute("stroke-width",5),this.visualization.append(t),this.items.push(t)}for(let t=0;t<this.items.length;t++)this.items[t].setAttribute("width",(0,U.valOrDefault)(this.itemWidth.value,50)),this.items[t].setAttribute("height",(0,U.valOrDefault)(this.itemWidth.value,50)),this.items[t].setAttribute("x",t*this.nextX.value+this.firstX.value),this.items[t].setAttribute("y",t*this.nextY.value+this.firstY.value)}},bindEvents(){this.nbItem.register(this.projection),this.firstX.register(this.projection),this.firstY.register(this.projection),this.nextX.register(this.projection),this.nextY.register(this.projection),this.itemWidth.register(this.projection),this.widthAttr.register(this.projection),this.heightAttr.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateContainer(),this.updateItems()}))}},Ks=Object.assign(Object.create(Hs.Simulation),Qs),ta={init(){return this.width=460,this.height=220,this},render(){if((0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="force",this.container.dataset.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,U.isNullOrUndefined)(this.nodes)){this.nodes=[];for(let t=0;t<3;t++){let t=Na.call(this,{kind:"static",type:"svg",content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10" width="10" height="10" version="1"><circle r="5" cx="5" cy="5"></circle></svg>'});this.container.append(t),this.nodes.push(t)}this.nodes[0].setAttribute("x",50),this.nodes[0].setAttribute("y",110),this.nodes[1].setAttribute("x",225),this.nodes[1].setAttribute("y",35),this.nodes[2].setAttribute("x",400),this.nodes[2].setAttribute("y",190)}return(0,U.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.setAttribute("stroke","black"),this.path.setAttribute("fill","transparent"),this.container.append(this.path)),this.sp=Na.call(this,{type:"attribute",name:"sub-paths",tag:"simulation"}),this.container.append(this.sp),this.subPaths=this.projection.resolveElement(this.sp),this.bindEvents(),this.bindStyle(),this.bindSubPath(),this.bindSubStyle(),this.setPath(),this.container},setPath(){let t=this.meet.value;switch(t){case"free":this.path.setAttribute("d","M 55 115 L 230 40 L 405 195");break;case"minX":this.path.setAttribute("d","M 55 40 L 55 195");break;case"maxX":this.path.setAttribute("d","M 405 40 L 405 195");break;case"minY":this.path.setAttribute("d","M 55 40 L 405 40");break;case"maxY":this.path.setAttribute("d","M 55 195 L 405 195")}this.style(),this.subPaths.setPath(t,{x:0,y:0})},bindEvents(){this.meet=this.source.getAttributeByName("meet").target,this.meet.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.setPath()}))},style(){this.path.setAttribute("stroke",this.stroke.value),this.path.setAttribute("stroke-width",this.width.value),this.path.setAttribute("stroke-linecap",this.linecap.value),(0,U.isNullOrUndefined)(this.dasharray.value)||(this.path.style["stroke-dasharray"]=this.dasharray.value)},bindStyle(){const t=this.source.getAttributeByName("arrow-style").target;this.dasharray=t.getAttributeByName("dasharray").target,this.dasharray.register(this.projection),this.stroke=t.getAttributeByName("stroke").target.getAttributeByName("value").target,this.stroke.register(this.projection),this.width=t.getAttributeByName("width").target,this.width.register(this.projection),this.linecap=t.getAttributeByName("linecap").target,this.linecap.register(this.projection)},bindSubPath(){},bindSubStyle(){}},ea=Object.assign(Object.create(Hs.Simulation),ta),na={init(){return this.width=460,this.height=220,this},render(){if((0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="force",this.container.dataset.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,U.isNullOrUndefined)(this.paths)){this.paths=[];for(let t=0;t<3;t++){let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("stroke","black"),t.setAttribute("fill","transparent"),this.container.append(t),this.paths.push(t)}}return this.bindEvents(),this.bindStyle(),this.container},setPath(t,e){if((0,U.isNullOrUndefined)(t)||(this.meet=t),(0,U.isNullOrUndefined)(e)||(this.offset=e),"free"===this.meet)return this.paths[0].remove(),this.paths[1].remove(),this.paths[2].remove(),void this.style();switch(this.container.append(this.paths[0]),this.container.append(this.paths[1]),this.container.append(this.paths[2]),this.meet){case"minX":this.paths[0].setAttribute("d","M "+(55+this.offset.x)+" 110 L 60 110"),this.paths[1].setAttribute("d","M "+(55+this.offset.x)+" 40 L 230 40"),this.paths[2].setAttribute("d","M "+(55+this.offset.x)+" 195 L 405 195");break;case"maxX":this.paths[0].setAttribute("d","M "+(405+this.offset.x)+" 110 L 60 110"),this.paths[1].setAttribute("d","M "+(405+this.offset.x)+" 35 L 230 110"),this.paths[2].setAttribute("d","M "+(405+this.offset.x)+" 190 L 405 190");break;case"minY":this.paths[0].setAttribute("d","M 110 "+(35+this.offset.y)+" 110 L 60 110"),this.paths[1].setAttribute("d","M 35 "+(35+this.offset.y)+" 35 L 230 110"),this.paths[2].setAttribute("d","M 190 "+(35+this.offset.y)+" 190 L 405 190");break;case"maxY":this.paths[0].setAttribute("d","M 110 "+(190+this.offset.y)+" 110 L 60 110"),this.paths[1].setAttribute("d","M 35 "+(190+this.offset.y)+" 35 L 230 110"),this.paths[2].setAttribute("d","M 190 "+(190+this.offset.y)+" 190 L 405 190")}this.style()},bindEvents(){this.projection.registerHandler("value.changed",(()=>{this.setPath()}))},style(){for(let t=0;t<3;t++)this.paths[t].setAttribute("stroke",this.stroke.value),this.paths[t].setAttribute("stroke-width",this.width.value),this.paths[t].setAttribute("stroke-linecap",this.linecap.value),(0,U.isNullOrUndefined)(this.dasharray.value)||(this.path.style["stroke-dasharray"]=this.dasharray.value)},bindStyle(){const t=this.source.getAttributeByName("arrow-style").target;this.dasharray=t.getAttributeByName("dasharray").target,this.dasharray.register(this.projection),this.stroke=t.getAttributeByName("stroke").target.getAttributeByName("value").target,this.stroke.register(this.projection),this.width=t.getAttributeByName("width").target,this.width.register(this.projection),this.linecap=t.getAttributeByName("linecap").target,this.linecap.register(this.projection)}},ia=Object.assign(Object.create(Hs.Simulation),na),{isNullOrUndefined:ra,valOrDefault:sa}=n(6689),aa={init(){return this},render(){return ra(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="anchor",this.container.dataset.id=this.id),ra(this.path)&&(this.path=Na.call(this,{type:"attribute",name:"arrow-style",tag:"simulation-wider"}),this.container.append(this.path),this.path.setAttribute("x",25),this.path.setAttribute("y",0)),this.bindEvents(),this.container},bindEvents(){this.offSetX=this.source.getAttributeByName("offSet").target.getAttributeByName("x").target,this.offSetX.register(this.projection),this.offSetY=this.source.getAttributeByName("offSet").target.getAttributeByName("y").target,this.offSetY.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.path.setAttribute("x",25+sa(this.offSetX.value,0)),this.path.setAttribute("y",sa(this.offSetY.value,0))}))}},oa=Object.assign(Object.create(Hs.Simulation),aa),{isNullOrUndefined:la,valOrDefault:ca,isEmpty:ha}=n(6689),ua={init(){return this},render(){return la(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="anchor",this.container.dataset.id=this.id,this.container.setAttribute("width",250),this.container.setAttribute("height",250),this.middle={x:125,y:125},this.container.setAttribute("preserveAspectRatio","xMidYMid meet"),this.container.style="border: 2px solid black"),la(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.style.stroke="black",this.path.style["stroke-width"]=3,this.container.append(this.path),this.path.setAttribute("fill","transparent")),la(this.center)&&(this.center=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.center.setAttribute("cx",125),this.center.setAttribute("cy",125),this.center.setAttribute("fill","white"),this.center.setAttribute("stroke","#738CFF"),this.center.setAttribute("stroke-width",3),this.center.setAttribute("r",5),this.container.append(this.center)),this.bindEvents(),this.container},registerPoint(t){la(this.d)&&(this.d=[]),this.d.push(t),t.getAttributeByName("x").target.register(this.projection),t.getAttributeByName("y").target.register(this.projection)},drawPath(){(la(this.d)||ha(this.d))&&this.path.setAttribute("d","");let t=this.middle.x,e=this.middle.y;this.minX=this.middle.x,this.minY=this.middle.y,this.maxX=this.middle.x,this.maxY=this.middle.y;let n="M "+t+" "+e;for(let i=0;i<this.d.length;i++){let r=this.d[i].getAttributeByName("x").target,s=this.d[i].getAttributeByName("y").target;t+=ca(r,0),e+=ca(s,0),n+=" L "+t+" "+e,this.minX>t&&(this.minX=t),this.maxX<t&&(this.maxX=t),this.minY>e&&(this.minY=e),this.maxY<e&&(this.maxY=e)}this.path.setAttribute("d",n),this.setDimensions()},setDimensions(){let t=Math.min(this.minX-5,0),e=Math.min(this.minY-5,0),n=Math.max(this.maxX+5-Math.min(this.minX-5,0),250),i=Math.max(this.maxY+5-Math.min(this.minY-5,0),250);this.container.setAttribute("viewBox",t+" "+e+" "+n+" "+i)},unregisterPoint(t){if(!la(this.d))for(let e=0;e<this.d.length;e++)if(d.id===t.id)return void this.d.splice(e,0)},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.registerPoint(t)})),this.projection.registerHandler("value.removed",(t=>{this.unregisterPoint(t)})),this.projection.registerHandler("value.changed",(()=>{this.drawPath()}))}},da=Object.assign(Object.create(Hs.Simulation),ua),{Simulation:pa}=n(3296),fa={init(){return this.depth=(0,U.valOrDefault)(20,this.source.getAttributeByName("depth").target.value),this.width=(0,U.valOrDefault)(400,this.source.getAttributeByName("width").target.value),this.height=(0,U.valOrDefault)(400,this.source.getAttributeByName("height").target.value),this},render(){return(0,U.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="tree",this.container.dataset.id=this.id,this.container.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,U.isNullOrUndefined)(this.nodeSpace)&&(this.nodeSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.nodeSpace.classList.add("nodeSpace"),this.container.append(this.nodeSpace)),(0,U.isNullOrUndefined)(this.linkSpace)&&(this.linkSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.linkSpace.classList.add("linkSpace"),this.container.prepend(this.linkSpace)),(0,U.isNullOrUndefined)(this.data)&&(this.data=[{id:0,children:[{id:1,children:[{id:2},{id:3}]},{id:4,children:[{id:5}]}]}]),(0,U.isNullOrUndefined)(this.tree)&&("vertical"===this.orientation?this.tree=d3.layout.tree().size([this.width,this.height]):this.tree=d3.layout.tree().size([this.height,this.width])),this.bindEvents(),this.container},update(){switch(this.svg=d3.select("#"+this.id),this.direction.value){case"horizontal":this.updateHorizontal();break;case"vertical":this.updateVertical()}},updateHorizontal(){var t=d3.svg.diagonal().projection((function(t){return[t.y,t.x]}));let e=this.data[0];e.x0=this.width/2,e.y0=50;let n=this.tree.nodes(e),i=this.tree.links(n);const r=this.depth.value;n.forEach((function(t){t.y=t.depth*r+40}));var s=this.svg.select("g.nodeSpace").selectAll("g.node").data(n);s.enter().append("g").attr("class","node").attr("transform",(function(t){return"translate("+e.y0+", "+e.x0+")"})).append("circle").attr("fill","red").attr("r",12.5),s.transition().duration(500).attr("transform",(function(t){return"translate("+t.y+", "+t.x+")"})),s.exit().transition().attr("transform",(function(t){return"translate("+e.y+", "+e.x+")"})).remove(),n.forEach((function(t){t.x0=t.x,t.y0=t.y}));var a=this.svg.select("g.linkSpace").selectAll("path.link").data(i);a.enter().insert("path","g").attr("class","link").attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("d",(function(n){var i={x:e.x0,y:e.y0};return t({source:i,target:i})})),a.transition().duration(500).attr("d",t),a.exit().transition().duration(500).attr("d",(function(n){var i={x:e.x,y:e.y};return t({source:i,target:i})})).remove()},bindEvents(){this.depth=this.source.getAttributeByName("depth").target,this.depth.register(this.projection),this.direction=this.source.getAttributeByName("direction").target,this.direction.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.update()})),this.projection.registerHandler("displayed",(()=>{this.update()}))}},ma=Object.assign(Object.create(pa),fa);var ga=0;const ba=()=>"algo"+ga++,va={force:(t,e,n)=>Object.create(Rs,{object:{value:"simulation"},name:{value:"force-simulation"},type:{value:"force"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),arrow:(t,e,n)=>Object.create(qs,{object:{value:"simulation"},name:{value:"arrow-simulation"},type:{value:"arrow"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),text:(t,e,n)=>Object.create($s,{object:{value:"simulation"},name:{value:"text-simulation"},type:{value:"text"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),selection:(t,e,n)=>Object.create(Ys,{object:{value:"simulation"},name:{value:"selection-simulation"},type:{value:"selection"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),marker:(t,e,n)=>Object.create(Gs,{object:{value:"simulation"},name:{value:"marker-simulation"},type:{value:"marker"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),content:(t,e,n)=>Object.create(Zs,{object:{value:"simulation"},name:{value:"content-simulation"},type:{value:"content"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),pattern:(t,e,n)=>Object.create(Ks,{object:{value:"simulation"},name:{value:"pattern-simulation"},type:{value:"pattern"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),multi:(t,e,n)=>Object.create(ea,{object:{value:"simulation"},name:{value:"multi-simulation"},type:{value:"multi"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),"sub-path":(t,e,n)=>Object.create(ia,{object:{value:"simulation"},name:{value:"subPath-simulation"},type:{value:"subPath"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),anchor:(t,e,n)=>Object.create(oa,{object:{value:"simulation"},name:{value:"anchor-simulation"},type:{value:"anchor"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),set:(t,e,n)=>Object.create(da,{object:{value:"simulation"},name:{value:"set-simulation"},type:{value:"set"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),tree:(t,e,n)=>Object.create(ma,{object:{value:"simulation"},name:{value:"tree-simulation"},type:{value:"tree"},id:{value:ba()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},ya={createSimulation(t,e,n){const{type:i}=e,r=va[i];if((0,U.isNullOrUndefined)(r))throw new TypeError(`Missing handler: The '${i}' simulation could not be handled`);const s=r(t,e,n);if((0,U.isNullOrUndefined)(s))throw new Error(`Bad request: The '${i}' simulation could not be created`);return s.createSimulation=this.createSimulation,(0,U.isNullOrUndefined)(s.id)&&(s.id=ba()),s}};function xa(t){return"property"===t.type?this.projection.concept.getProperty(t.name):t}function wa(t,e,n){const{tag:i,placeholder:r={},style:s,options:a,listen:o}=e;if(!n.hasAttribute(t)){let e=`Attribute '${t}' does not exist in the concept '${n.name}'`;return this.environment.notify(e,J.ERROR),this.environment.addError({source:"projection",code:"attribute_not_found",message:e}),(0,U.createI)({hidden:!0},t)}(0,U.valOrDefault)(e.required,n.isAttributeRequired(t))&&!n.isAttributeCreated(t)&&n.createAttribute(t);const l={name:t,get created(){return n.isAttributeCreated(t)},schema:e,placeholder:(0,U.createI)({class:["projection-element"],hidden:!0},t),parent:this,projection:this.projection,element:null};if(this.projection.attributes.push(l),!l.created){const{content:e}=r;return l.placeholder=e?Na.call(this,e,n,{focusable:!0}):(0,U.createI)({class:["projection-element","projection-element--placeholder"],tabindex:0,dataset:{object:"attribute",id:t}},`Add ${t}`),l.placeholder.addEventListener("click",(e=>{n.createAttribute(t),this.projection.resolveElement(l.element).focus()})),l.placeholder}{const{target:e,schema:r}=n.getAttributeByName(t);let c=this.projection.model.createProjection(e,i).init(a);if(o&&(c.listen=!0),c.parent=this.projection,c._style=s,l.element=c.render(),(0,U.isNullOrUndefined)(l.element))return(0,U.createI)({hidden:!0},t);c.element.parent=this}return l.element}function Ea(t,e){const{value:n,placement:i}=t,{target:r,description:s}=e.getAttributeByName(n);let a=this.projection.model.createProjection(r,i.tag).init();a.parent=this.projection,a.render(),(0,U.isNullOrUndefined)(r.value)||a.element.initValue(r.value),a.element.parent=this;let o=n[0].toUpperCase()+n.substring(1);return a.element.attributeName=o,a.element}function Aa(t,e){let n=this.projection.model.createProjection(e,t).init();return n.parent=this.projection,n.render(),n.element.parent=this,n.element.container}function Na(t,e,n={}){if(t.kind)return Oa.call(this,t,e,n);const i=(0,U.valOrDefault)(e,this.projection.concept);if("container"===t.type){let e=Br(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("layout"===t.type){let e=Ka.createLayout(this.model,t.layout,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("field"===t.type){let e=Xi.createField(this.model,t.field,this.projection);return e.parent=this,e.init(n),this.model.registerField(e),e.render()}if("static"===t.type){let e=Ur.createStatic(this.model,t.static,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerStatic(e),e.render()}if("algorithm"===t.type){let e=Ds.createAlgo(this.model,t.algorithm,this.projection);return e.init(),this.model.registerAlgorithm(e),e.render()}if("simulation"===t.type){let e=ya.createSimulation(this.model,t.simulation,this.projection);return e.init(),this.model.registerSimulation(e),e.render()}if("dynamic"===t.type)return Na.call(this,t.dynamic,e,n);if("attribute"===t.type)return wa.call(this,t.name,t,i);if("svg-attribute"===t.type)return Ea.call(this,t,i);if("external"===t.type)return Aa.call(this,t.tag,i);if("g-fragment"===t.type){let e=t.name,n=this.model.getGFragmentSchema(e.toLowerCase());return(new DOMParser).parseFromString(n.content.content.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement}if("template"===t.type){let i=t.name;"param"===i.type&&(i=this.projection.getParam(i.name));let r=this.model.getTemplateSchema(i);r.param&&(t.param&&r.param.forEach((e=>{Object.assign(e,t.param.find((t=>t.name===e.name)))})),this.projection.addParam(r.param));const s=(0,U.createDocFragment)();let a,o=Object.assign({template:r},n),l=!1;return r.content.forEach((t=>{s.append(Na.call(this,t,e,o))})),l?a:s}if("projection"===t.type){const{tag:e,style:n,src:r,required:s=!1}=t;if(r&&"attribute"===r.type)return wa.call(this,r.name,t,i);const a={schema:t,placeholder:(0,U.createI)({class:["projection-element"],hidden:!0}),parent:this,projection:this.projection,element:null,update:function(t,r,s){if(a.element&&(a.element.remove(),a.element=null),i.hasValue()){let t=i.getValue(!0);console.log("ContentConcept"),console.log(e);let r=this.projection.model.createProjection(t,e).init();r.placeholder=a.placeholder,r.parent=this.projection,a.element=r.render(),a.placeholder&&a.placeholder.after(a.element),(0,U.isHTMLElement)(a.element)&&cn.call(this.projection,a.element,n),r.element.parent=this.projection.element,this.projection.update("binding",r.element.container||r.element.element),r.update("displayed")}}};return i.register(a),a.update(),a.element||a.placeholder}if("property"===t.type){const{name:e}=t;return this.projection.concept.getProperty(e)}if("html"===t.type){const{html:e}=t;return(0,U.htmlToElement)(e)}if("raw"===t.type){const{raw:e}=t;return e}if("state"===t.type){let i={},r=jn.call(this,i,t.state);return Na.call(this,r.content,e,n)}throw console.error(t),new TypeError("Bad argument: The type is not recognized")}function Oa(t,e,n={}){const i=(0,U.valOrDefault)(e,this.projection.concept),{kind:r}=t;if("container"===r){let e=Br(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("layout"===r){let e=Ka.createLayout(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("field"===r){let e=Xi.createField(this.model,t,this.projection);return e.parent=this,e.init(n),this.model.registerField(e),e.render()}if("static"===r){let e=Ur.createStatic(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerStatic(e),e.render()}if("attribute"===r||"dynamic"===r)return wa.call(this,t.name,t,i);if("template"===r){let i=t.name;"param"===i.type&&(i=this.projection.getParam(i.name));let r=this.model.getTemplateSchema(i);r.param&&(t.param&&r.param.forEach((e=>{Object.assign(e,t.param.find((t=>t.name===e.name)))})),this.projection.addParam(r.param));const s=(0,U.createDocFragment)();return r.content.forEach((t=>{s.append(Na.call(this,t,e,n))})),s}if("projection"===r){const{tag:e,style:n,required:r=!1}=t,s={schema:t,placeholder:(0,U.createI)({class:["projection-element"],hidden:!0}),parent:this,projection:this.projection,element:null,update:function(t,r,a){if(s.element&&(s.element.remove(),s.element=null),i.hasValue()){let t=i.getValue(!0),r=this.projection.model.createProjection(t,e).init();r.placeholder=s.placeholder,r.parent=this.projection,s.element=r.render(),s.placeholder&&s.placeholder.after(s.element),(0,U.isHTMLElement)(s.element)&&cn.call(this.projection,s.element,n),r.element.parent=this.projection.element}}};return i.register(s),s.update(),s.element||s.placeholder}if("property"===r){const{name:e}=t;return this.projection.concept.getProperty(e)}if("html"===r){const{html:e}=t;return(0,U.htmlToElement)(e)}if("raw"===r){const{raw:e}=t;return e}if("state"===r){let i={},r=jn.call(this,i,t.state);return Na.call(this,r.content,e,n)}throw console.error(t),new TypeError("Bad argument: The type is not recognized")}const ka={HORIZONTAL:"horizontal",VERTICAL:"vertical"},_a=[{concept:{name:"stack-layout"},type:"layout",tags:[],projection:{type:"stack",orientation:"vertical",disposition:[{type:"attribute",name:"orientation"}]}}],ja={orientation:null,args:null,init(t={}){const{orientation:e=ka.HORIZONTAL,editable:n=!0,focusable:i=!1}=this.schema;return this.orientation=e,this.focusable=i,this.editable=n,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},getOrientation(){return this.orientation},setOrientation(t){this.orientation=t,this.refresh()},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["layout-container","stack-layout"],title:n,dataset:{nature:"layout",layout:"stack",id:this.id}}));for(let e=0;e<t.length;e++){let n=Na.call(this,t[e],null,this.args),r=this.environment.resolveElement(n);r&&(r.parent=this),this.elements.push(n),i.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",cn.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.container.style.display="flex",this.container.style.flexWrap="nowrap",this.refresh(),this.container},design(){return{concept:[{name:"stack-layout",nature:"concrete",attributes:[{name:"orientation",target:{name:"string",default:this.orientation,constraint:{values:["horizontal","vertical"]}}}]}],projection:_a,handlers:{orientation:(t,e)=>{this.setOrientation(e)}}}},refresh(){return this.orientation===ka.VERTICAL?this.container.style.flexDirection="column":this.orientation===ka.HORIZONTAL&&(this.container.style.flexDirection="row"),this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,U.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,U.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t,{prop:n}=e.dataset;"orientation"===n&&this.setOrientation(e.value)})),this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)}))}},Ma=Object.assign({},Dr,ja),Ca={args:null,init(t={}){const{editable:e=!0,focusable:n=!1}=this.schema;return this.focusable=n,this.editable=e,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["layout-container"],title:n,dataset:{nature:"layout",layout:"wrap",id:this.id}}));for(let e=0;e<t.length;e++){let n=Na.call(this,t[e],this.source,this.args),r=this.environment.resolveElement(n);r&&(r.parent=this),this.elements.push(n),i.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",cn.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="inline-flex",this.container.style.alignItems="baseline",this.refresh(),this.container},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,U.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,U.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},bindEvents(){this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)}))}},Sa=Object.assign({},Dr,Ca),La={elements:null,edit:!1,btnEdit:!1,btnCollapse:!1,menu:!1,collapsed:!1,init(t={}){const{editable:e=!0,collapsible:n=!1,focusable:i=!1}=this.schema;return this.focusable=i,this.collapsible=n,this.editable=e,this.elements=[],this.children=[],Object.assign(this,t),this},collapse(t){if(!this.collapsed)return this.collapseContainer=(0,U.createDiv)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t){if(!this.collapsed)return;let e=(0,U.createDocFragment)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(e),this.collapseContainer.remove(),this.collapsed=!0,this.refresh(),this},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["layout-container"],dataset:{nature:"layout",layout:"table"}})),this.focusable?this.container.tabIndex=-1:this.container.dataset.ignore="all";for(let e=0;e<t.length;e++){let n=t[e],r=(0,U.createDiv)({class:["table-row"]});r.style.display="table-row";for(let t=0;t<n.length;t++){const e=n[t];let i=(0,U.createDiv)({class:["table-cell"]},Na.call(this,e.content));i.style.display="table-cell",cn.call(this.projection,i,e.style),r.append(i)}i.append(r)}return cn.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.container.style.display="table",this.refresh(),this.container},bindEvents(){this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(t=>{this.collapsed?this.expand():this.collapse()}))}},Ta=Object.assign({},Dr,La),Ia={ROW:"row",COLUMN:"column"},Ua={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center",stretch:"stretch",baseline:"baseline"},Da={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly"},Ha={orientation:null,wrappable:null,alignItems:null,justifyContent:null,args:null,init(t={}){const{orientation:e=Ia.ROW,wrappable:n=!0,alignItems:i,justifyContent:r,editable:s=!0,focusable:a=!1}=this.schema;return this.orientation=e,this.wrappable=n,this.alignItems=i,this.justifyContent=r,this.focusable=a,this.editable=s,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},getOrientation(){return this.orientation},setOrientation(t){(0,U.hasOwn)(Ia,t)&&(this.orientation=t,this.refresh())},collapse(t=!1){if(!this.collapsed||t)return this.collapseContainer=(0,U.createDiv)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t=!1){if(!this.collapsed&&!t)return;let e=(0,U.createDocFragment)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(e),this.collapseContainer.remove(),this.collapsed=!1,this.refresh(),this},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,U.createDocFragment)();(0,U.isHTMLElement)(this.container)||(this.container=(0,U.createDiv)({class:["layout-container"],dataset:{nature:"layout",layout:"flex",id:this.id}})),n&&(this.container.title=n);for(let e=0;e<t.length;e++){let n=Na.call(this,t[e],null,this.args),r=this.environment.resolveElement(n);r&&(r.parent=this),this.elements.push(n),i.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",cn.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="flex",this.refresh(),this.container},refresh(){return this.container.style.flexDirection=this.orientation,this.container.style.justifyContent=Da[this.justifyContent],this.container.style.alignItems=Ua[this.alignItems],this.wrappable?this.container.style.flexWrap="wrap":this.container.style.flexWrap="nowrap",this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,U.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,U.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t,{prop:n}=e.dataset;"orientation"===n&&this.setOrientation(e.value)})),this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(t=>{this.collapsed?this.expand():this.collapse()}))}},Pa=Object.assign({},Dr,Ha),za={content:"",init(){return this},render(){const t=(0,U.createDocFragment)(),{content:e,attributes:n=[],link:i,dimensions:r={}}=this.schema;var s=new DOMParser;return(0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,class:[],dataset:{nature:"layout",view:"svg",id:this.id}})),this.element.setAttribute("tabIndex",0),this.focusable=!0,!(0,U.isHTMLElement)(this.content)&&e?(this.content=s.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)):(0,U.isHTMLElement)(this.content)||(this.content=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.appendChild(this.content)),(0,U.isEmpty)(n)||n.forEach((t=>{let e=Na.call(this,t.attribute);this.environment.resolveElement(e),t.marker?this.content.querySelector("[data-"+t.marker+"]").append(e):this.content.append(e)})),r.type&&(this.dimensions=r),t.hasChildNodes()&&this.element.appendChild(t),this.element},getWidth(){return Number(this.content.getAttribute("width"))},getHeight(){return Number(this.content.getAttribute("height"))},registerDimObsever(t){(0,U.isNullOrUndefined)(this.observers)&&(this.observers=[]),this.observers.push(t)},attributeHandler(t,e){switch(t.type){case"interactive":this.content.querySelector("[data-"+e+"]").append(t.content);break;case"text-svg":case"choice":break;default:let n=this.content.querySelector("[data-"+e+"]");t.element.append(t.element);let i=this.createHolder(t.element);n.append(i),this.adapt(t.element,t.ratio)}},createHolder(t){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","foreign");n.append(t),e.append(n)},adapt(t,e){let n=t.getBoundingClientRect();t.parentNode.setAttribute("width",n.width),t.parentNode.setAttribute("height",n.height);let i=t.parentNode.parentNode;if(!(0,U.isNullOrUndefined)(e)){let t=this.content.width.baseVal.value;this.content.height.baseVal.value,i.setAttribute("width",t*e),i.setAttribute("height",t*e)}},_attributeHandler(t){let e=[];return t.forEach((t=>{switch(t.placement.type){case"in-place":let n=this.content.querySelector("[data-"+t.placement.marker+"]");t.type="svg-attribute";let i=Na.call(this,t,null,this.args);(0,U.isNullOrUndefined)(t.property)||(i.property=propertyHandler(t.property)),e.push(i),n.appendChild(i.content);break;case"link-place":let{type:r,sd:s=[],dd:a=[]}=t.placement;(0,U.isNullOrUndefined)(this.linkAttr)&&(this.linkAttr=[]);let o={};o.name=t.value,o.field=this.informations.get(t.value),"list"===o.field.type?o.value=o.field.items:o.value=o.field.value,(0,U.isNullOrUndefined)(t.property)||(o.property=propertyHandler(t.property)),(0,U.isEmpty)(s)||(o.sd=new Map,s.forEach((t=>{t.type="template";const e={};var n=Na.call(this,t,null,this.args);e.render=n,e.parent=this.content.querySelector("[data-"+t.marker+"]"),o.sd.set(n.mv,e)}))),!(0,U.isNullOrUndefined)(this.dd)||(0,U.isEmpty)(a)||(0,U.isNullOrUndefined)(a)||(o.dd=[],a.forEach((t=>{t.type="template";var e=Na.call(this,t,null,this.args);o.dd.push(e),e.property=o.property;var n=this.content.querySelector("[data-"+t.marker+"]");(0,U.isNullOrUndefined)(n)?"before"===this.content.getAttribute("data-"+t.marker)?this.content.prepend(e.content):this.content.appendChild(e.content):"before"===n.getAttribute("data-"+t.marker)?n.prepend(e.content):n.appendChild(e.content)}))),this.linkAttr.push(o)}})),e},update(){(0,U.isNullOrUndefined)(this.linkAttr)||this.linkAttr.forEach((t=>{this.clearStatics(t.sd,t.value),(0,U.isNullOrUndefined)(t.property)?this.clearDynamics(t.dd,t.value):this.clearDynamics(t.dd,this.translateProperty(t.value,t.property)),"list"===t.field.type?t.value=t.field.items:t.value=t.field.value,(0,U.isNullOrUndefined)(t.property)?this.updateDynamics(t.dd,t.value):this.updateDynamics(t.dd,this.translateProperty(t.value,t.property)),this.updateStatics(t.sd,t.value)})),(0,U.isNullOrUndefined)(this.deciders)||(0,U.isEmpty)(this.deciders)||this.deciders.forEach((t=>{t.update(t.field.value)}))},clearDynamics(t,e){(0,U.isNullOrUndefined)(t)||t.forEach((t=>{t.clear(e)}))},updateDynamics(t,e){(0,U.isNullOrUndefined)(t)||t.forEach((t=>{t.update(e)}))},clearStatics(t,e){if(!(0,U.isNullOrUndefined)(t)){let n=t.get(e);(0,U.isNullOrUndefined)(n)||n.parent.removeChild(n.render.content)}},updateStatics(t,e){if(!(0,U.isNullOrUndefined)(t)){let n=t.get(e);(0,U.isNullOrUndefined)(n)||n.parent.appendChild(n.render.content)}},focus(){return this.element.focus(),this.focused=!0,(0,U.isNullOrUndefined)(this.deciders)||this.deciders.forEach((t=>{t.focusOut()})),this},focusIn(){return this.focus(),this},focusOut(){return this.focused=!1,this},arrowHandler(t,e){if(e===this.element)return!(0,U.isNullOrUndefined)(this.parent)&&this.parent.arrowHandler(t,this.element);let n=getClosestSVG(e.foreign,t,this,!1);return!(0,U.isNullOrUndefined)(n)&&(e.focusOut(),n.focus(),!0)},enterHandler(t){this.index=0,this.deciders[0].focusIn()},escapeHandler(t){if(t!==this.element)return this.focus();let e=(0,U.findAncestor)(t,(t=>0===t.tabIndex)),n=this.environment.resolveElement(e);return n&&n.focus(e),!1},getDimensions(){if("absolute"===this.dimensions.type)return{height:this.dimensions.height,width:this.dimensions.width}},setIndex(t){let e=0;this.deciders.forEach((n=>{n.id!==t.id?e++:this.index=e}))}},Va=Object.assign(Object.create(Dr),za);function Ra(t){const{placeholder:e="",type:n}=t;let i=xa.call(this,e);return this.readonly||this.resizable?(0,U.createSpan)({class:["field--textbox__input","field--textbox__input-pseudo"],editable:!this.readonly,title:i,dataset:{placeholder:i,nature:"field-component",view:this.type,id:this.id}}):this.multiline?(0,U.createTextArea)({class:["field--textbox__input"],placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}}):(0,U.createInput)({class:["field--textbox__input"],type:(0,U.valOrDefault)(n,"text"),placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}})}const Ba={init(){return this},render(){const t=(0,U.createDocFragment)(),{current:e={},root:n}=this.schema;this.isRoot=n;var i=new DOMParser;if((0,U.isHTMLElement)(this.element)||(this.element=(0,U.createDiv)({id:this.id,dataset:{nature:"layout",view:"visualizer",id:this.id}})),!(0,U.isHTMLElement)(this.content)&&(this.svg=this.source.value,!(0,U.isNullOrUndefined)(this.svg))){if(this.content=i.parseFromString(this.svg.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,"svg"!==this.content.tagName){let t=i.parseFromString('<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"/>',"image/svg+xml").documentElement;t.appendChild(this.content),this.content=t}t.appendChild(this.content)}if(!(0,U.isHTMLElement)(this.input)){const{placeholder:n="",type:i,style:r}=e;this.input=Ra.call(this,e),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",cn.call(this,this.input,r),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}if(n&&(0,U.isNullOrUndefined)(this.buttons)){this.buttons=[];const e={type:"static",static:{type:"button",trigger:"make interactive",content:[{type:"static",static:{type:"text",content:"Interactive",focusable:!0}}]}};this.mkeInteractive=Na.call(this,e,null,this.args);let n=this.environment.resolveElement(this.mkeInteractive);n.parent=this,n.visualizer=this,this.buttons.push(n),t.append(this.mkeInteractive);const i={type:"static",static:{type:"button",trigger:"make dynamic",content:[{type:"static",static:{type:"text",content:"Dynamic",focusable:!0}}]}};this.mkeDynamic=Na.call(this,i,null,this.args),n=this.environment.resolveElement(this.mkeDynamic),n.visualizer=this,n.parent=this,this.buttons.push(n),t.append(this.mkeDynamic);const r={type:"static",static:{type:"button",trigger:"make static",content:[{type:"static",static:{type:"text",content:"Static",focusable:!0}}]}};this.mkeStatic=Na.call(this,r,null,this.args),n=this.environment.resolveElement(this.mkeStatic),n.visualizer=this,n.parent=this,this.buttons.push(n),t.append(this.mkeStatic)}return t.hasChildNodes()&&this.element.appendChild(t),this.bindEvent(),this.element},focusIn(t){return this.input.focus()},focusOut(){},createProj(){let t=this.current;"tspan"===t.tagName.toLowerCase()&&(t=t.parentNode);let e=new XMLSerializer;return this.cleanInput(),this.updateInput(e.serializeToString(this.content)),'<g xmlns="http://www.w3.org/2000/svg">'+e.serializeToString(t)+"</g>"},cleanInput(){this.input.value="",this.current.parentNode.removeChild(this.current)},updateInput(t){this.source.setValue(t)},bindEvent(){this.content.addEventListener("click",(t=>{var e=new XMLSerializer;let n=t.target;"tspan"===n.tagName.toLowerCase()&&(n=n.parentNode);var i=e.serializeToString(n);this.input.value=i,this.current=n})),this.input.addEventListener("keydown",(t=>{if(""!==this.input.value&&!(0,U.isNullOrUndefined)(this.current)&&"Enter"===t.key){var e=(new DOMParser).parseFromString(this.input.value.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement;this.current!==this.content?this.current.replaceWith(e):this.content=e,this.current=e;var n=new XMLSerializer;this.isRoot?this.updateInput(n.serializeToString(this.content)):this.updateInput(n.serializeToString(this.content.childNodes[0]))}}))}},qa=Object.assign(Object.create(Dr),Ba),{createDocFragment:Fa,isNullOrUndefined:$a,isEmpty:Wa,isHTMLElement:Ya}=n(6689),Xa={init(){const{coordinates:t=null,dimensions:e=null}=this.schema;return this.coordinates=t,this.dimensions=e,this},render(){const{content:t}=this.schema,e=Fa();return $a(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("layout-container"),this.container.dataset.nature="layout",this.container.dataset.layout="holder",this.container.dataset.id=this.id),$a(this.foreign)&&(this.foreign=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),e.append(this.foreign)),$a(this.content)&&!Wa(t)&&(this.content=new Map,t.forEach((t=>{switch(t.type){case"projection":let e=this.projection.model.createProjection(this.projection.concept.getValue(!0),t.tag).init().render(),n=this.projection.resolveElement(e);this.element=e,this.foreign.append(e),this.content.set(t.correspondance,{render:e,projection:n});break;case"attribute":this.container.append(Na.call(this,t))}}))),e.hasChildNodes()&&this.container.append(e),this.bindEvents(),this.container},registerRelative(t){this.apply=t.apply,this.relative=!0,"duo"===t.listen.type&&(this.from=this.source.getValue(!0).getAttributeByName(t.listen.from).target,this.from.register(this.projection),this.to=this.source.getValue(!0).getAttributeByName(t.listen.to).target,this.to.register(this.projection),this.rtag=this.environment.getActiveReceiver(t.rtag))},adapt(){},getDimensions(){return{width:this.dimensions.width,height:this.dimensions.height}},placeItem(t){"delegate"===this.coordinates.type&&(this.container.setAttribute("x",t.schema.coordinates.x),this.container.setAttribute("y",t.schema.coordinates.y))},setDimensions(){if(this.relative){let t=this.rtag.container.querySelector('[data-concept="'+this.from.value+'"]'),e=this.rtag.container.querySelector('[data-concept="'+this.to.value+'"]'),n=this.rtag.container.createSVGPoint(),i=t.getBoundingClientRect();n.x=i.x,n.y=i.y;let r=n.matrixTransform(this.rtag.container.getScreenCTM().inverse());i=e.getBoundingClientRect(),n.x=i.x,n.y=i.y;let s=n.matrixTransform(this.rtag.container.getScreenCTM().inverse()),a=r.x-s.x,o=r.y-s.y,l=Math.sqrt(a*a+o+o);this.width=l,this.container.setAttribute("width",this.width),this.container.setAttribute("height",30),this.foreign.setAttribute("width",this.width),this.foreign.setAttribute("height",30),this.container.setAttribute("x",r.x),this.container.setAttribute("y",r.y),this.projection.resolveElement(this.element).setDimensions(this.width)}else this.adapt(),this.parent.notify(this.container)},setHolder(t,e){this.container.setAttribute("width",t),$a(e)?this.container.setAttribute("height",t*this.height/this.width):this.container.setAttribute("height",e)},bindEvents(){this.projection.registerHandler("value.changed",(t=>{})),this.projection.registerHandler("displayed",(t=>{let{render:e,projection:n}=this.content.get(this.source.value);this.element=e,this.foreign.append(this.element),this.setDimensions(),this.coordinates&&this.placeItem(n)}))}},Ga=Object.assign(Object.create(Dr),Xa);var Ja=0;const Za=()=>"layout"+Ja++,Qa={stack:(t,e,n)=>Object.create(Ma,{object:{value:"layout"},name:{value:"stack-layout"},type:{value:"stack"},id:{value:Za()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),wrap:(t,e,n)=>Object.create(Sa,{object:{value:"layout"},name:{value:"wrap-layout"},type:{value:"wrap"},id:{value:Za()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),table:(t,e,n)=>Object.create(Ta,{object:{value:"layout"},name:{value:"table-layout"},type:{value:"table"},id:{value:Za()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),flex:(t,e,n)=>Object.create(Pa,{object:{value:"layout"},name:{value:"flex-layout"},type:{value:"flex"},id:{value:Za()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),svg:(t,e,n)=>Object.create(Va,{object:{value:"layout"},name:{value:"svg-layout"},type:{value:"svg"},id:{value:Za()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),visualizer:(t,e,n)=>Object.create(qa,{object:{value:"layout"},name:{value:"svg-layout"},type:{value:"svg"},id:{value:Za()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),holder:(t,e,n)=>Object.create(Ga,{object:{value:"layout"},name:{value:"holder-layout"},type:{value:"holder"},id:{value:Za()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},Ka={createLayout(t,e,n){const{type:i}=e,r=Qa[i];if((0,U.isNullOrUndefined)(r))throw new TypeError(`Missing handler: The '${i}' layout could not be handled`);const s=r(t,e,n);if((0,U.isNullOrUndefined)(s))throw new Error(`Bad request: The '${i}' layout could not be created`);return s.createLayout=this.createLayout,(0,U.isNullOrUndefined)(s.id)&&(s.id=Za()),s}},to={stylePath(t){const{stroke:e="black",dasharray:n=null,width:i=1,linecap:r="butt",end:s=!1,start:a=!1}=t;this.path.style.stroke=e,(0,U.isNullOrUndefined)(n)||(this.path.style["stroke-dasharray"]=n),this.path.style["stroke-width"]=(0,U.valOrDefault)(i,5),this.path.style["stroke-linecap"]=r,s&&this.createMarkerEnd()},styleSubPath(t,e){const{stroke:n="black",dasharray:i=null,width:r=1,linecap:s="butt",end:a=!1,start:o=!1}=t;e.style.stroke=n,(0,U.isNullOrUndefined)(i)||(e.style["stroke-dasharray"]=i),e.style["stroke-width"]=(0,U.valOrDefault)(r,5),e.style["stroke-linecap"]=s},createMarkerEnd(){(0,U.isNullOrUndefined)(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.end=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.end.id="marker"+this.id,this.end.setAttribute("refY",5),this.end.setAttribute("refX",10),this.end.setAttribute("markerUnit","strokeWidth"),this.end.setAttribute("markerWidth",10),this.end.setAttribute("markerHeight",10),this.end.setAttribute("orient","auto"),this.end.classList.add("end");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t.setAttribute("fill","black"),this.end.appendChild(t),this.definitions.appendChild(this.end),this.path.setAttribute("marker-end","url(#"+this.end.id+")")},setPath(t){this.path.setAttribute("d",t)}},eo={init(){return this},render(){const{aiming:t,model:e,move:n,decorator:i=!1,style:r}=this.schema;return(0,U.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("arrow-path"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="anchor",this.path.dataset.id=this.id),(0,U.isNullOrUndefined)(this.aiming)&&(this.aiming=this.source.getAttributeByName(t.name).target),(0,U.isNullOrUndefined)(this.anchorModel)&&(this.anchorModel=e,ui.AnchorHandler.registerListener(e,this)),n&&(this.movingPiece=this.source.getAttributeByName(n.name).target,this.movingPiece.register(this)),i&&(0,U.isNullOrUndefined)(this.decorator)&&this.createDecorator(i),this.bind=this.projection.bind,this.bindEvents(),this.stylePath(r),this.path},update(){if(!(0,U.isNullOrUndefined)(this.movingPiece)&&this.movingPiece.hasValue()){let t=this.movingPiece.getValue();(0,U.isString)(t)&&(t=this.movingPiece.getValue(!0)),t.notify("accept",this.bind),(0,U.isNullOrUndefined)(this.path.parenNode)||t.notify("cover",this)}},deleteFromView(){ui.AnchorHandler.unregister(this.anchorModel,this),this.movingPiece=null,this.path.remove(),this.decorator.remove()},createDecorator(t){this.decorator=Na.call(this,t.render)},updateValue(){if(!this.aiming.hasValue())return this.path.remove(),this.decorator.remove(),void this.definitions.remove();let t=this.aiming.value.id||this.aiming.value,e=ui.AnchorHandler.findSource(this.anchorModel,this.bind.element||this.bind.container),n=ui.AnchorHandler.findTarget(this.anchorModel,t,e.index);if(this.schema.offset&&(e.x+=this.schema.offset.x,e.y+=this.schema.offset.y,n.x+=this.schema.offset.x,n.y+=this.schema.offset.y),this.decorator){const{origin:t,x:i,y:r}=this.schema.decorator.coordinates;switch(t){case"source":this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+r),this.projection.parent.container.append(this.decorator);break;case"target":this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+r),this.projection.parent.container.append(this.decorator);break;case"minX":e.x<n.x?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+r)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+r)),this.projection.parent.container.append(this.decorator);break;case"minY":e.y<n.y?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+r)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+r)),this.projection.parent.container.append(this.decorator);break;case"maxX":e.x>n.x?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+r)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+r)),this.projection.parent.container.append(this.decorator);break;case"maxY":e.y>n.y?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+r)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+r)),this.projection.parent.container.append(this.decorator)}}if(e.x===n.x&&e.y===n.y?this.setSelfPath(e):this.setPath("M "+e.x+" "+e.y+" L "+n.x+" "+n.y),this.definitions&&this.projection.parent.container.append(this.definitions),this.projection.parent.container.prepend(this.path),this.decorator&&this.environment.resolveElement(this.decorator).projection.update("displayed"),this.calcS=e.calc,this.calcT=n.calc,this.movingPiece&&this.movingPiece.hasValue()){let t=this.movingPiece.value;(0,U.isString)(t)&&(t=this.movingPiece.getValue(!0)),t.notify("cover",this)}},setSelfPath(t){const e=this.schema.self.points;let n={x:t.x,y:t.y},i="M "+t.x+" "+t.y+" ";for(let t=0;t<e.length;t++){const{x:r,y:s}=e[t];i+=" L "+(n.x+r)+" "+(n.y+s)+" ",n.x+=r,n.y+=s}this.path.setAttribute("d",i),this.path.setAttribute("fill","transparent")},bindEvents(){this.aiming.register(this.projection),this.projection.registerHandler("value.changed",(t=>{this.updateValue(t)}))}},no=Object.assign({},to,eo),io={init(){return this},render(){const{style:t,from:e,to:n,decorator:i}=this.schema;return(0,U.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("arrow-path"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="force",this.path.dataset.id=this.id),(0,U.isNullOrUndefined)(this.from)&&this.registerAttribute(e,!0),(0,U.isNullOrUndefined)(this.to)&&this.registerAttribute(n),t&&this.stylePath(t),i&&(0,U.isNullOrUndefined)(this.decorator)&&(this.decorator=Na.call(this,i)),this.bindEvents(),this.path},registerAttribute(t,e=!1){const{name:n}=t;e?this.from=this.source.getAttributeByName(n).target:this.to=this.source.getAttributeByName(n).target},updateValue(){this.fromVal=this.from.value,this.toVal=this.to.value,(0,U.isNullOrUndefined)(this.fromVal)||(0,U.isNullOrUndefined)(this.toVal)?(0,U.isNullOrUndefined)(this.path.parentNode)||this.projection.parent.removeArrow(this,-1,this.decorator):this.projection.parent.addArrow(this,this.fromVal,this.toVal,this.decorator)},setPath(t){this.path.setAttribute("d",t)},bindEvents(){this.from.register(this.projection),this.to.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateValue()}))}},ro=Object.assign({},to,io),so={minY:function(t){let e=t[0].y,n=t[0].x,i=t[0].x;for(let r=0;r<t.length;r++){const{x:s,y:a}=t[r];s<n&&(n=s),s>i&&(i=s),a<e&&(e=a)}this.setPath("M "+n+" "+e+" L "+i+" "+e),this.drawSupPath(t,e,!1)}},ao={init(){return this.subPath=[],this.targets=[],this.elements=[],this},render(){const{style:t}=this.schema;return(0,U.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("arrow-path"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="multi",this.path.dataset.id=this.id),this.bindEvents(),this.stylePath(t),this.path},addTarget(t){this.targets=[],this.elements.forEach((t=>{t.hasValue()&&this.targets.push(t.getValue())})),this.targets.length>1&&(this.drawPath(),this.projection.parent.container.append(this.path),this.subPath.forEach((t=>{this.projection.parent.container.append(t)})))},drawSupPath(t,e,n){(0,U.isEmpty)(this.subPath)||(this.subPath.forEach((t=>{t.remove()})),this.subPath=[]),t.forEach((t=>{if(t.y===e&&!n)return;if(t.x===e&&n)return;let i=document.createElementNS("http://www.w3.org/2000/svg","path");this.path.classList.add("arrow-subpath"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="multi",this.path.dataset.id=this.id,n||i.setAttribute("d","M "+t.x+" "+e+" L "+t.x+" "+t.y),this.styleSubPath(this.schema.subpath.style,i),this.subPath.push(i)}))},drawPath(){const t=this.projection.parent.container;let e=[];for(let n=0;n<this.targets.length;n++){const i=this.targets[n];let r=t.querySelector("[data-concept='"+i+"']"),s=this.projection.resolveElement(r);if((0,U.isNullOrUndefined)(r))return;e.push({item:r,proj:s})}let n=[];for(let i=0;i<e.length;i++){let r=e[i].item.getBoundingClientRect();const s=t.createSVGPoint();s.x=r.x,s.y=r.y;const a=s.matrixTransform(t.getScreenCTM().inverse());(0,U.isNullOrUndefined)(e[i].proj.attachPoint)?n.push({x:a.x,y:a.y}):n.push({x:a.x+e[i].proj.attachPoint.x,y:a.y+e[i].proj.attachPoint.y})}so[this.schema.meet].call(this,n)},removeTarget(t){(0,U.isNullOrUndefined)(this.targets)},registerElem(t){(0,U.isNullOrUndefined)(this.elements)&&(this.elements=[]),this.elements.push(t),t.register(this.projection)},unregisterElem(t){for(let e=0;e<this.elements.length;e++)if(this.elements[e]===t){this.elements[e].unregister(this.projection),this.elements.splice(e,1);break}this.elements.length>1?this.addTarget():(this.path.remove(),(0,U.isEmpty)(this.subPath)||this.subPath.forEach((t=>{t.remove()})))},deletePaths(){this.path.remove(),(0,U.isEmpty)(this.subPath)||this.subPath.forEach((t=>{t.remove()}))},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.registerElem(t)})),this.projection.registerHandler("value.removed",(t=>{this.unregisterElem(t)})),this.projection.registerHandler("value.changed",(t=>{this.addTarget(t)}))}},oo=Object.assign({},to,ao);var lo=0;const co=()=>"algo"+lo++,ho={force:(t,e,n)=>Object.create(ro,{object:{value:"arrow"},name:{value:"force-arrow"},type:{value:"force"},id:{value:co()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),anchor:(t,e,n)=>Object.create(no,{object:{value:"arrow"},name:{value:"anchor-arrow"},type:{value:"anchor"},id:{value:co()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),multi:(t,e,n)=>Object.create(oo,{object:{value:"arrow"},name:{value:"multi-arrow"},type:{value:"multi"},id:{value:co()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},uo={createArrow(t,e,n){const{type:i}=e,r=ho[i];if((0,U.isNullOrUndefined)(r))throw new TypeError(`Missing handler: The '${i}' arrow could not be handled`);const s=r(t,e,n);if((0,U.isNullOrUndefined)(s))throw new Error(`Bad request: The '${i}' arrow could not be created`);return s.createArrow=this.createArrow,(0,U.isNullOrUndefined)(s.id)&&(s.id=co()),s}},po={},{isNullOrUndefined:fo,valOrDefault:mo}=n(6689),go={init(){return this},render(){const{content:t}=this.schema;return fo(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("shape-container"),this.container.dataset.nature="shape",this.container.dataset.shape="canas",this.container.dataset.id=this.id),fo(t)||t.forEach((t=>{this.container.append(Na.call(this,t))})),this.w=this.source.getAttributeByName("width").target,this.h=this.source.getAttributeByName("height").target,this.minX=this.source.getAttributeByName("minX").target,this.minY=this.source.getAttributeByName("minY").target,this.windowW=this.source.getAttributeByName("windowW").target,this.windowH=this.source.getAttributeByName("windowH").target,this.container.style.border="solid #87a1ff",this.refresh(),this.bindEvents(),this.container},refresh(){this.container.setAttribute("width",this.w.value),this.container.setAttribute("height",this.h.value);const t=mo(this.windowW.value,this.w.value),e=mo(this.windowH.value,this.h.value);this.container.setAttribute("viewBox",this.minX.value+" "+this.minY.value+" "+t+" "+e)},update(){this.refresh()},bindEvents(){this.w.register(this),this.h.register(this),this.minX.register(this),this.minY.register(this),this.windowW.register(this),this.windowH.register(this),this.container.addEventListener("click",(t=>{const e=t.target,{concept:n=null,nature:i=null,shape:r=null}=e.dataset;fo(i)||"shape"!==i||"canvas"===r||this.source.getAttributeByName("current").setValue(n)}))},focusIn(){},focusOut(){},clickHandler(t){}},bo=Object.assign(Object.create(po),go),{isNullOrUndefined:vo,isEmpty:yo}=n(6689),xo={init(){return this.items=[],this},render(){const{add:t}=this.schema;return vo(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","g"),this.container.classList.add("shape-container"),this.container.dataset.nature="shape",this.container.dataset.shape="group",this.container.dataset.id=this.id),t&&(this.addButton=Na.call(this,{kind:"static",type:"svg-button",action:{type:"CREATE"},content:'<svg style="overflow:visible" xmlns="http://www.w3.org/2000/svg" version="1.0"><text style="dominant-baseline:hanging;" font-family="Segoe UI" font-size="16">+</text></svg>'}),this.container.append(this.addButton)),yo(this.source)||this.reconstruct(),this.bindEvents(),this.container},reconstruct(){let t=this.source.value;for(let e=0;e<t.length;e++){let n=this.projection.environment.conceptModel.getConcept(t[e]).getValue(!0),i=this.model.createProjection(n,"shape");i.parent=this.projection;let r=i.init().render();this.items.push({concept:i.concept,projection:r,centered:!0}),i.concept.register(this.projection),this.container.append(r),this.blur()}},createItem(t){let e=this.model.createProjection(t,"shape");e.parent=this.projection;let n=e.init().render();return this.items.push({concept:e.concept,projection:n,centered:!1}),e.concept.register(this.projection),this.blur(),n},addItem(t){let e=this.createItem(t);this.container.append(e)},removeItem(t){for(let e=0;e<this.items.length;e++)if(this.items[e].concept.id===t.id)return this.items[e].projection.remove(),vo(this.items[e].container)||this.items[e].container.remove(),void this.items.splice(e,1)},update(){for(let t=0;t<this.items.length;t++)this.items[t].centered||this.center(this.items[t]),this.items[t].centered=!0},center(t){const e=t.concept.getValue(!0),n=this.getWindow();switch(e.name){case"circle":e.getAttributeByName("cx").setValue((n.minX+n.vW)/2),e.getAttributeByName("cy").setValue((n.minY+n.vH)/2),e.getAttributeByName("r").setValue(20*n.vW/n.width);break;case"rectangle":const t=40*n.vW/n.width,i=30*n.vH/n.height;e.getAttributeByName("x").setValue((n.minX+n.vW)/2-t/2),e.getAttributeByName("y").setValue((n.minY+n.vH)/2-i/2),e.getAttributeByName("width").setValue(t),e.getAttributeByName("height").setValue(i);break;case"ellipse":const r=40*n.vW/(2*n.width),s=30*n.vH/(2*n.height);e.getAttributeByName("cx").setValue((n.minX+n.vW)/2),e.getAttributeByName("cy").setValue((n.minY+n.vH)/2),e.getAttributeByName("rx").setValue(r),e.getAttributeByName("ry").setValue(s);break;case"polygon":const a=40*n.vW/(2*n.width),o=30*n.vH/(2*n.height),l=(n.minX+n.vW)/2,c=(n.minY+n.vH)/2,h={x:l-a/4,y:c-o/2},u={x:l+a/4,y:c-o/2},d={x:l+a/2,y:c-o/4},p={x:l+a/2,y:c+o/4},f={x:l+a/4,y:c+o/2},m={x:l-a/4,y:c+o/2},g={x:l-a/2,y:c+o/4},b={x:l-a/2,y:c-o/4};e.getAttributeByName("points").setValue(h.x+" "+h.y+", "+u.x+" "+u.y+", "+d.x+" "+d.y+", "+p.x+" "+p.y+", "+f.x+" "+f.y+", "+m.x+" "+m.y+", "+g.x+" "+g.y+", "+b.x+" "+b.y);break;case"path":const v=40*n.vW/(2*n.width),y=(n.vH,n.height,(n.minX+n.vW)/2),x=(n.minY+n.vH)/2;e.getAttributeByName("d").setValue("M "+(y-v/2)+" "+x+" L "+(y+v/2)+" "+x)}let i=this.model.createProjection(e,"shape");i.parent=this.projection;let r=i.init().render();this.container.append(r),t.container=r},focusIn(){},focusOut(){},blur(){},getWindow(){const t=this.container.parentNode,e=t.viewBox.baseVal;return{width:Number(t.getAttribute("width")),height:Number(t.getAttribute("height")),vW:e.width,vH:e.height,minX:e.x,minY:e.y}},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.addItem(t)})),this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)}))}},wo=Object.assign(Object.create(po),xo),{isNullOrUndefined:Eo}=n(6689),Ao={init(){return this},render(){return Eo(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="circle",this.element.dataset.id=this.id),this.cx=this.source.getAttributeByName("cx").target,this.cy=this.source.getAttributeByName("cy").target,this.r=this.source.getAttributeByName("r").target,this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("cx",this.cx.value),this.element.setAttribute("cy",this.cy.value),this.element.setAttribute("r",this.r.value)},bindEvents(){this.cx.register(this),this.cy.register(this),this.r.register(this),this.element.addEventListener("click",(()=>{this.source.notify("current.updated",this.source)}))},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.width=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.fill.register(this),this.stroke.register(this),this.width.register(this),this.dash.register(this)},update(t){this.refresh(),Eo(this.fill.value)||this.element.setAttribute("fill",this.fill.value),Eo(this.stroke.value)||this.element.setAttribute("stroke",this.stroke.value),Eo(this.width.value)||(this.element.style["stroke-width"]=this.width.value),Eo(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value)},focusIn(){},focusOut(){}},No=Object.assign(Object.create(po),Ao),{isNullOrUndefined:Oo}=n(6689),ko={init(){return this},render(){return Oo(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("shape-container"),this.container.dataset.nature="shape",this.container.dataset.shape="group",this.container.dataset.id=this.id),this.bindEvents(),this.container.style.overflow="visible",this.container},bindEvents(){this.projection.registerHandler("value.changed",(t=>{let e=this.model.createProjection(this.source.getValue(!0),"shape");e.parent=this.projection;let n=e.init().render();this.container.append(n)}))}},_o=Object.assign(Object.create(po),ko),{isNullOrUndefined:jo}=n(6689),Mo={init(){return this},render(){return jo(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="circle",this.element.dataset.id=this.id),this.x=this.source.getAttributeByName("x").target,this.y=this.source.getAttributeByName("y").target,this.width=this.source.getAttributeByName("width").target,this.height=this.source.getAttributeByName("height").target,this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("x",this.x.value),this.element.setAttribute("y",this.y.value),this.element.setAttribute("height",this.height.value),this.element.setAttribute("width",this.width.value)},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.widthS=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.rx=t.getAttributeByName("rx").target,this.ry=t.getAttributeByName("ry").target,this.fill.register(this),this.stroke.register(this),this.widthS.register(this),this.dash.register(this),this.rx.register(this),this.ry.register(this)},update(t){this.refresh(),jo(this.fill.value)||this.element.setAttribute("fill",this.fill.value),jo(this.stroke.value)||(this.element.style.stroke=this.stroke.value),jo(this.widthS.value)||(this.element.style["stroke-width"]=this.widthS.value),jo(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value),jo(this.rx.value)||this.element.setAttribute("rx",this.rx.value),jo(this.ry.value)||this.element.setAttribute("ry",this.ry.value)},bindEvents(){this.x.register(this),this.y.register(this),this.width.register(this),this.height.register(this)}},Co=Object.assign(Object.create(po),Mo),{isNullOrUndefined:So}=n(6689),Lo={init(){return this},render(){return So(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="ellipse",this.element.dataset.id=this.id),this.cx=this.source.getAttributeByName("cx").target,this.cy=this.source.getAttributeByName("cy").target,this.rx=this.source.getAttributeByName("rx").target,this.ry=this.source.getAttributeByName("ry").target,this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("cx",this.cx.value),this.element.setAttribute("cy",this.cy.value),this.element.setAttribute("ry",this.ry.value),this.element.setAttribute("rx",this.rx.value)},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.width=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.fill.register(this),this.stroke.register(this),this.width.register(this),this.dash.register(this)},update(t){this.refresh(),So(this.fill.value)||this.element.setAttribute("fill",this.fill.value),So(this.stroke.value)||(this.element.style.stroke=this.stroke.value),So(this.width.value)||(this.element.style["stroke-width"]=this.width.value),So(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value)},bindEvents(){this.cx.register(this),this.cy.register(this),this.rx.register(this),this.ry.register(this)}},To=Object.assign(Object.create(po),Lo),{isNullOrUndefined:Io}=n(6689),Uo={init(){return this},render(){return Io(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","polygon"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="polygon",this.element.dataset.id=this.id),this.points=this.source.getAttributeByName("points").target,this.refresh(),this.bindEvents(),this.element},refresh(){this.element.setAttribute("points",this.points.value)},update(t){this.refresh()},bindEvents(){this.points.register(this)}},Do=Object.assign(Object.create(po),Uo),{isNullOrUndefined:Ho}=n(6689),Po={init(){return this},render(){return Ho(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","path"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="path",this.element.dataset.id=this.id),this.d=this.source.getAttributeByName("d").target,this.element.style["stroke-width"]=5,this.element.style.stroke="black",this.source.getAttributeByName("style").target.getAttributeByName("s-width").setValue(5),this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("d",this.d.value)},bindEvents(){this.d.register(this)},bindStyle(){},update(t){this.refresh(),Ho(this.stroke.value)||this.element.setAttribute("fill",this.fill.value),Ho(this.stroke.value)||(this.element.style.stroke=this.stroke.value),Ho(this.width.value)||(this.element.style["stroke-width"]=this.width.value),Ho(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value)},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.width=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.fill.register(this),this.stroke.register(this),this.width.register(this),this.dash.register(this)},focusIn(){},focusOut(){}},zo=Object.assign(Object.create(po),Po);var Vo=0;const Ro=()=>"algo"+Vo++,Bo={canvas:(t,e,n)=>Object.create(bo,{object:{value:"shape"},name:{value:"canvas-shape"},type:{value:"canvas"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),group:(t,e,n)=>Object.create(wo,{object:{value:"shape"},name:{value:"group-shape"},type:{value:"group"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),circle:(t,e,n)=>Object.create(No,{object:{value:"shape"},name:{value:"circle-shape"},type:{value:"circle"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),holder:(t,e,n)=>Object.create(_o,{object:{value:"shape"},name:{value:"holder-shape"},type:{value:"holder"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),rectangle:(t,e,n)=>Object.create(Co,{object:{value:"shape"},name:{value:"rectangle-shape"},type:{value:"rectangle"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),ellipse:(t,e,n)=>Object.create(To,{object:{value:"shape"},name:{value:"ellipse-shape"},type:{value:"ellipse"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),polygon:(t,e,n)=>Object.create(Do,{object:{value:"shape"},name:{value:"polygon-shape"},type:{value:"polygon"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),path:(t,e,n)=>Object.create(zo,{object:{value:"shape"},name:{value:"path-shape"},type:{value:"path"},id:{value:Ro()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},qo={createShape(t,e,n){const{type:i}=e,r=Bo[i];if((0,U.isNullOrUndefined)(r))throw new TypeError(`Missing handler: The '${i}' shape could not be handled`);const s=r(t,e,n);if((0,U.isNullOrUndefined)(s))throw new Error(`Bad request: The '${i}' shape could not be created`);return s.createShape=this.createShape,(0,U.isNullOrUndefined)(s.id)&&(s.id=Ro()),s}};var Fo=0;const $o={createProjection(t,e,n,i){var r=Object.create(Wo,{id:{value:(0,U.valOrDefault)(e.id,"projection"+Fo++)},model:{value:t},schema:{value:e,writable:!0},environment:{value:i}});return r.concept=n,r}},Wo={handlers:null,init(t={}){return this.containers=new Map,this.attributes=[],this.params=[],this.templates=[],this.handlers={},this.args=t,this.concept.register(this),this},schema:null,concept:null,environment:null,parent:null,containers:null,placeholder:null,element:null,attributes:null,params:null,index:0,editing:!1,optional:!1,collapsible:!1,searchable:!1,focusable:!0,get hasMultipleViews(){return this.schema.length>1},get isReadOnly(){return(0,U.valOrDefault)(this.getSchema().readonly,!1)},isRoot(){return(0,U.isNullOrUndefined)(this.parent)},getSchema(t){return this.schema[(0,U.valOrDefault)(t,this.index)]},hasSchema(t){return-1!==this.schema.findIndex((e=>e.tags.includes(t)))},getContainer(t){return this.containers.get((0,U.valOrDefault)(t,this.index))},getStyle(){const{style:t}=this.getSchema();return t},addTemplate(t){this.templates.push(t)},addParam(t){this.params.push(...Array.isArray(t)?t:[t])},getParam(t,e){let n=this.params.find((e=>e.name===t));if((0,U.isNullOrUndefined)(n))return;const{type:i="string",value:r}=n;let s=(0,U.valOrDefault)(r,n.default);return(0,U.isNullOrUndefined)(s)?null:"string"===i?s.toString():"number"===i?+s:"boolean"===i?(0,U.toBoolean)(s):void 0},getParent(){return this.isRoot()?null:this.parent},getAttributes(t){return this.attributes.filter((e=>e.name===t))},getField(t){return this.environment.getField(t)},getStatic(t){return this.environment.getStatic(t)},getLayout(t){return this.environment.getLayout(t)},resolveElement(t){return this.environment.resolveElement(t)},getHandlers(t){return(0,U.valOrDefault)(this.handlers[t],[])},update(t,e,n){if((0,U.isEmpty)(this.containers))return;if("delete"===t&&n===this.concept)return void this.delete();const i=this.getHandlers(t);switch((0,U.isEmpty)(i)||i.forEach((t=>{t(e,n)})),t){case"attribute.added":return void this.getAttributes(e.name).forEach((t=>{const{schema:n}=t,i=this.model.createProjection(e.target,n.tag).init();i.parent=this,i.optional=!0;const r=i.render();cn.call(this,r,n.style),i.element.parent=t.parent,t.element=r,t.placeholder&&(t.placeholder.after(r),q(t.placeholder))}));case"attribute.removed":return void this.getAttributes(e.name).forEach((t=>{t.element&&((0,U.removeChildren)(t.element).remove(),t.element=null),t.placeholder&&B(t.placeholder)}))}},delete(){return this.concept&&setTimeout((()=>{this.concept.unregister(this)}),50),this.placeholder&&this.getContainer().after(this.placeholder),this.containers.forEach((t=>{if((0,U.removeChildren)(t),(0,U.isHTMLElement)(t)&&t.remove(),"path"===t.tagName){if("force"===t.dataset.algorithm){let e=this.environment.resolveElement(t);e.projection.parent.removeArrow(e)}"anchor"===t.dataset.algorithm&&this.environment.resolveElement(t).deleteFromView(),"multi"===t.dataset.algorithm&&this.environment.resolveElement(t).deletePaths()}["svg","text"].includes(t.tagName)&&t.remove(),this.sibling&&this.sibling.delete()})),this.model.removeProjection(this.id),!0},registerHandler(t,e){return Array.isArray(this.handlers[t])||(this.handlers[t]=[]),this.handlers[t].push(e),!0},unregisterHandler(t,e){if(!(0,U.hasOwn)(this.handlers,t))return!1;for(let n=0;n<this.handlers[t].length;n++)if(this.handlers[t][n]===e)return this.handlers[t].splice(n,1),!0;return!1},focus(){this.element.focus()},render(){const t=this.getSchema();if((0,U.isNullOrUndefined)(t))return null;const{type:e,projection:n,content:i,kind:r,sibling:s,rtag:a,ratio:o}=t;var l=null;if("layout"===e||"layout"===r)this.element=Ka.createLayout(this.model,(0,U.valOrDefault)(n,i),this).init(this.args),this.model.registerLayout(this.element);else if("field"===e||"field"===r){let e=(0,U.hasOwn)(t,"field")?t.field:(0,U.valOrDefault)(n,i);this.element=Xi.createField(this.model,e,this).init(this.args),this.model.registerField(this.element)}else"static"===e||"static"===r?(this.element=Ur.createStatic(this.model,(0,U.valOrDefault)(n,i),this).init(this.args),this.element.source=this.concept,this.model.registerStatic(this.element)):"dynamic"===e||"dynamic"===r?(this.element=Ur.createStatic(this.model,(0,U.valOrDefault)(n,i),this).init(this.args),this.model.registerStatic(this.element)):"algorithm"===e?(this.element=Ds.createAlgo(this.model,(0,U.valOrDefault)(n,i),this).init(this.args),this.model.registerAlgorithm(this.element)):"arrow"===e?(this.element=uo.createArrow(this.model,(0,U.valOrDefault)(n,i),this).init(this.args),this.model.registerArrow(this.element)):"shape"===e?(this.element=qo.createShape(this.model,(0,U.valOrDefault)(n,i),this).init(this.args),this.model.registerShape(this.element)):"simulation"===e?(this.element=ya.createSimulation(this.model,(0,U.valOrDefault)(n,i),this).init(this.args),this.model.registerSimulation(this.element)):(this.element=Br(this.model,t.container,this).init(this.args),this.model.registerLayout(this.element));if(this.isRoot()&&(this.element.focusable=!0),this.focusable||(this.element.focusable=!1),this.readonly&&(this.element.readonly=!0),l=this.element.render(),this.element.focusable||(l.tabIndex=-1),!(0,U.isNode)(l))throw new Error("Projection element container could not be created");if(l.classList.add("projection"),Object.assign(l.dataset,{projection:this.id,concept:this.concept.id,object:this.concept.object}),this.optional)if(this.element.schema.rmv)this.element.createDelete(),l.dataset.deletable=!0;else{let t=(0,U.createButton)({class:["btn","structure__btn-delete","projection__btn-delete"],title:`Delete ${this.concept.name}`,tabindex:-1,dataset:{action:"delete",projection:this.id}});t.addEventListener("click",(t=>{let e=this.getContainer(),n=(0,U.findAncestor)(e,(t=>0===t.tabIndex));this.environment.save(this.concept.getParent(),e.cloneNode(!0)),this.concept.delete();let i=this.environment.resolveElement(n);(0,U.isNullOrUndefined)(i)||i.focus()})),l.dataset.deletable=!0,l.prepend(t)}if(this.collapsible){let t=(0,U.createButton)({class:["btn","projection__btn-collapse"],title:`Collapse ${this.concept.name}`,tabindex:-1,dataset:{action:"collapse",projection:this.id}});t.addEventListener("click",(t=>{this.getContainer().classList.toggle("collapsed")})),l.dataset.collapsible=!0,l.prepend(t)}return this._style&&cn.call(this,l,this._style),this.containers.set(this.index,l),s&&this.createSibling(this.concept,s,this.element),a&&(this.rtag=a,this.environment.registerReceiver(this.element,a)),l},refresh(){this.editing?this.containers.forEach((t=>{t.tabIndex=0})):this.containers.forEach((t=>{t.tabIndex=null}))},createSibling(t,e){const{render:n,params:i=!1,bind:r}=e,{tag:s,rtag:a}=n;if(this.checkForAliveSibling(t.id,s,a))return;let o=this.model.createProjection(t,s).init();r&&(o.bind=this.element);let l=o.render();if(i){const{coordinates:t,dimension:e}=i;l.setAttribute("x",t.x),l.setAttribute("y",t.y)}let c=this.environment.getActiveReceiver(a);o.parent=c,(0,U.isNullOrUndefined)(o.element.path)&&c.container.append(o.element.element||o.element.container),this.sibling=o},checkForAliveSibling(t,e,n){if((0,U.isNullOrUndefined)(this.environment.siblingModel)&&(this.environment.siblingModel=new Map),(0,U.isNullOrUndefined)(this.environment.siblingModel.get(t)))return this.environment.siblingModel.set(t,[{tag:e,rtag:n}]),!1;let i=this.environment.siblingModel.get(t);for(let t=0;t<i.length;t++)if(i[t].rtag===n&&i[t].tag===e)return!0;return i.push([{tag:e,rtag:n}]),this.environment.siblingModel.set(t,i),!1},changeView(t){if(!this.hasMultipleViews)return void this.environment.notify("There is no alternative projection for this concept");let e=this.getContainer();this.index=(0,U.valOrDefault)(t,(this.index+1)%this.schema.length);let n=this.getContainer();(0,U.isHTMLElement)(n)||(this.params=[],n=this.render()),e.replaceWith(n),this.element=this.resolveElement(n),"svg"===this.element.type&&this.element.update();const i=this.getHandlers("view.changed");return(0,U.isEmpty)(i)||i.forEach((t=>t(n))),this.focus(),this},findView(t){if(!this.hasSchema(t)){if(!this.model.hasProjectionSchema(this.concept,t))return-1;let e=this.model.getProjectionSchema(this.concept,t);this.schema.push(...e)}return this.schema.findIndex((e=>e.tags.includes(t)))},export(){return{id:this.id,root:this.isRoot(),concept:{id:this.concept.id,name:this.concept.name}}},bindEvents(){}},Yo=[{concept:{name:"set"},type:"field",tags:[],content:{type:"list"}},{concept:{name:"boolean"},type:"field",tags:[],content:{type:"binary"}},{concept:{name:"string"},type:"field",tags:[],content:{type:"text"}},{concept:{name:"number"},type:"field",tags:[],content:{type:"text",input:{type:"number"}}},{concept:{name:"reference"},type:"field",tags:[],content:{type:"choice"}}];function Xo(t,e){return Object.create(Go,{schema:{value:(0,U.valOrDefault)(t,{projection:[],algorithm:[],template:[],style:[]}),writable:!0},editor:{value:e},environment:{value:e}})}const Go={projections:null,fields:null,statics:null,layouts:null,algos:null,init(t){return this.projections=[],this.fields=new Map,this.statics=new Map,this.layouts=new Map,this.algos=new Map,this.arrows=new Map,this.shapes=new Map,this.simulations=new Map,this},addSchema(t){return Array.isArray(t.projection)&&this.schema.projection.push(...t.projection),Array.isArray(t.template)&&this.schema.template.push(...t.template),Array.isArray(t.style)&&this.schema.style.push(...t.style),this.environment.update("projection-model.updated"),!0},setSchema(t){return this.schema=[...t,...Yo],this.environment.update("projection-model.updated"),this},done(){for(;!(0,U.isEmpty)(this.projections);)this.projections[0].delete();return this.projections=[],this.fields.clear(),this.layouts.clear(),this.statics.clear(),this},createProjection(t,e){const n=this.getProjectionSchema(t,e);(0,U.isEmpty)(n)&&this.environment.notify(`Missing projection (#${e}) for ${t.name}`,J.WARNING);const i=$o.createProjection(this,n,t,this.environment);return i.tag=e,this.addProjection(i),i},getProjections(){return this.projections.slice()},getProjection(t){return Number.isInteger(t)?this.projections[t]:this.projections.find((e=>e.id===t))},addProjection(t){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad request: The 'projection' argument must be a Projection");return this.projections.push(t),this},removeProjection(t){var e=this.projections.findIndex((e=>e.id===t));return-1!==e&&(this.projections.splice(e,1),!0)},registerField(t){return t.environment=this.environment,t.editor=this.environment,this.fields.set(t.id,t),this},unregisterField(t){var e=this.fields.get(t.id);return e&&(e.environment=null,this.fields.delete(e.id)),this},getField(t){return this.fields.get(t)},registerStatic(t){return t.environment=this.environment,t.editor=this.environment,this.statics.set(t.id,t),this},unregisterStatic(t){var e=this.statics.get(t.id);return e&&(e.environment=null,this.statics.delete(e.id)),this},getStatic(t){return this.statics.get(t)},registerLayout(t){return t.environment=this.environment,t.editor=this.environment,this.layouts.set(t.id,t),this},unregisterLayout(t){var e=this.layouts.get(t.id);return e&&(e.environment=null,this.layouts.delete(e.id)),this},getLayout(t){return this.layouts.get(t)},registerArrow(t){return t.environment=this.environment,this.arrows.set(t.id,t),this},unregisterArrow(t){var e=this.arrows.get(t.id);return e&&(e.environment=null,this._arrow.delete(e.id)),this},getArrow(t){return this.arrows.get(t)},registerShape(t){return t.environment=this.environment,this.shapes.set(t.id,t),this},registerSimulation(t){return t.environment=this.environment,this.simulations.set(t.id,t),this},unregisterArrow(t){var e=this.shapes.get(t.id);return e&&(e.environment=null,this._shape.delete(e.id)),this},getArrow(t){return this.shapes.get(t)},registerAlgorithm(t){return t.environment=this.environment,this.algos.set(t.id,t),this},unregisterAlgorithm(t){var e=this.algos.get(t.id);return e&&(e.environment=null,this.algos.delete(e.id)),this},getAlgo(t){return this.algos.get(t)},getSimulation(t){return this.simulations.get(t)},getArrow(t){return this.arrows.get(t)},getMetadata(t){let e=this.schema.find((e=>e.id===t));return e?e.metadata:null},hasConceptProjection(t,e){let n=null;return n=(0,U.isString)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((e=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(e.concept.name)||(n=e.concept.prototype,!(0,U.isNullOrUndefined)(n)&&"prototype"!==t.nature&&t.hasPrototype(n));var n})),(0,U.isIterable)(e)&&!(0,U.isEmpty)(e)?-1!==n.findIndex((t=>(t=>Array.isArray(t.tags)&&t.tags.includes(e))(t))):!(0,U.isEmpty)(n)},getSchema(){return this.schema},getProjectionSchema(t,e){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad parameter: concept");var n=null;return n=(0,U.isString)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((e=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(e.concept.name)||(n=e.concept.prototype,!(0,U.isNullOrUndefined)(n)&&"prototype"!==t.nature&&t.hasPrototype(n));var n})),(0,U.isIterable)(e)&&!(0,U.isEmpty)(e)?n.filter((t=>t.tags&&t.tags.includes(e))):n},getTemplateSchema(t){let e=this.schema.template.find((e=>e.name===t));return(0,U.isNullOrUndefined)(e)?null:gt(e)},getGFragmentSchema(t){let e=this.schema.find((e=>"g-fragment"===e.type&&e.name===t));return(0,U.isNullOrUndefined)(e)?null:gt(e)},getRuleSchema(t){let e=this.schema.find((e=>"rule"===e.type&&e.name===t));return(0,U.isNullOrUndefined)(e)?null:gt(e)},getStyleSchema(t){let e=this.schema.style.find((e=>e.name===t));return(0,U.isNullOrUndefined)(e)?null:gt(e)},hasProjectionSchema(t,e){if((0,U.isNullOrUndefined)(t))throw new TypeError("Bad parameter: concept");let n=[];return n=(0,U.isString)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((e=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(e.concept.name)||(n=e.concept.prototype,!(0,U.isNullOrUndefined)(n)&&"prototype"!==t.nature&&t.hasPrototype&&t.hasPrototype(n));var n})),(0,U.isIterable)(e)&&!(0,U.isEmpty)(e)?n.some((t=>t.tags&&t.tags.includes(e))):!(0,U.isEmpty)(n)},export(){const t=[];return this.getProjections().forEach((e=>{t.push(e.export())})),t}},Jo={unloadAllConcept(){return this.hasConceptModel&&(this.conceptModel.done(),this.conceptModel=null,this.refresh()),this.triggerEvent({name:"editor.unload-concept@post"}),this},unloadAllProjection(){return this.hasProjectionModel&&(this.projectionModel.done(),this.projectionModel=null,this.refresh()),this.triggerEvent({name:"editor.unload-projection@post"}),this},loadSession(){this.conceptModel.getRootConcepts().forEach((t=>{this.createInstance(t)}))},loadConcept(t,e){let n=t.concept||t,i=t.values;return Array.isArray(n)?(0,U.isEmpty)(n)?(this.notify("The concept schema is empty",J.ERROR),!1):((0,U.isNullOrUndefined)(this.conceptModel)&&(this.conceptModel=sn.createModel(null,this).init()),this.conceptModel.addConceptSchema(n),this.conceptModel.init(i),this.triggerEvent({name:"editor.load-concept@post",args:[e,JSON.stringify(t)]}),this.refresh(),this):(this.notify("Invalid concept schema",J.ERROR),!1)},loadValues(t,e){let n=t;if(!(0,U.isNullOrUndefined)(this.conceptModel))return this.conceptModel.initValue(n),this.loadSession(),this.triggerEvent({name:"editor.load-values@post",args:[e,JSON.stringify(n)]}),this.refresh(),this;console.error("concept model not found")},loadConcepts(t){return Array.isArray(t)?(0,U.isEmpty)(t)?(this.notify("The concept schema is empty",J.ERROR),!1):((0,U.isNullOrUndefined)(this.conceptModel)&&(this.conceptModel=sn.createModel(null,this).init()),t.forEach((t=>{this.conceptModel.addConceptSchema(t)})),this.refresh(),this):(this.notify("Invalid concept schema",J.ERROR),!1)},loadProjection(t,e){return this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,(0,U.isNullOrUndefined)(this.projectionModel)&&(this.projectionModel=Xo(t,this).init()),this.projectionModel.addSchema(t),(0,U.isNullOrUndefined)(this.projectionModel),this.instances.forEach((t=>{t.projection=this.projectionModel.createProjection(t.concept).init(),t.render()})),this.triggerEvent({name:"editor.load-projection@post",args:[e,JSON.stringify(t)]}),this.refresh(),this},loadProjections(t){return Array.isArray(t)?(0,U.isEmpty)(t)?(this.notify("The concept schema is empty",J.ERROR),!1):(this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,(0,U.isNullOrUndefined)(this.projectionModel)&&(this.projectionModel=Xo(null,this).init()),t.forEach((t=>{this.projectionModel.addSchema(t)})),this.refresh(),this):(this.notify("Invalid concept schema",J.ERROR),!1)},load(t,e){let n=t.type;if((0,U.isNullOrWhitespace)(n)){let e=t.name.indexOf(".")+1;n=t.name.substring(e)}else n=K[n];"jsoncp"===n&&"json"===n||this.addResource(t,e);let i=new FileReader;return i.onload=t=>{const n=JSON.parse(i.result),{type:r}=n;"concept"===r?this.loadConcept(n,e):"projection"===r?this.loadProjection(n,e):"model"===r&&(this.loadConcept(n.concept),this.loadProjection(n.projection),this.loadValues(n.values))},i.readAsText(t),!0},unload(){return this.unloadAllConcept(),this.unloadAllProjection(),this.clear(),this}},Zo={getField(t){if(!(0,U.isHTMLElement)(t)&&"path"!==t.tagName&&"text"!==t.tagName&&"svg"!==t.tagName)return console.warn("Field error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,U.isNullOrUndefined)(e)?(console.warn("Field error: Missing id attribute on field"),null):["field","field-component"].includes(n)?this.projectionModel.getField(e):(console.warn("Field error: Unknown nature attribute on field"),null)},getStatic(t){if(!(0,U.isHTMLElement)(t)&&"svg"!==t.tagName)return console.warn("Static error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,U.isNullOrUndefined)(e)?(console.warn("Static error: Missing id attribute on field"),null):["static","static-component"].includes(n)?this.projectionModel.getStatic(e):(console.warn("Static error: Unknown nature attribute on field"),null)},getLayout(t){if(!(0,U.isHTMLElement)(t)&&"svg"!==t.tagName)return console.warn("Layout error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,U.isNullOrUndefined)(e)?(console.warn("Layout error: Missing id attribute on field"),null):["layout","layout-component"].includes(n)?this.projectionModel.getLayout(e):(console.warn("Layout error: Unknown nature attribute on field"),null)},getAlgo(t){if(!(0,U.isHTMLElement)(t)&&"svg"!==t.tagName&&"text"!==t.tagName)return console.warn("Algo error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,U.isNullOrUndefined)(e)?(console.warn("Algo error: Missing id attribute on field"),null):["algorithm"].includes(n)?this.projectionModel.getAlgo(e):(console.warn("algo error: Unknown nature attribute on field"),null)},getSimulation(t){if(!(0,U.isHTMLElement)(t)&&"svg"!==t.tagName&&"text"!==t.tagName)return console.warn("Simulation error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,U.isNullOrUndefined)(e)?(console.warn("Simulation error: Missing id attribute on Simulation"),null):["simulation"].includes(n)?this.projectionModel.getSimulation(e):(console.warn("Simulation error: Unknown nature attribute on Simulation"),null)},getArrow(t){if("path"!==t.tagName)return console.warn("Arrow error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,U.isNullOrUndefined)(e)?(console.warn("Arrow error: Missing id attribute on field"),null):["arrow","arrow-path"].includes(n)?this.projectionModel.getArrow(e):(console.warn("Layout error: Unknown nature attribute on field"),null)},resolveElement(t){if(t instanceof SVGElement){let e=t;for(;!(0,U.isNullOrUndefined)(e.parentNode)&&(0,U.isNullOrUndefined)(e.dataset);)e=e.parentNode;(0,U.isNullOrUndefined)(e.dataset.nature)||(t=e)}if(!(0,U.isHTMLElement)(t)&&"path"!==t.tagName&&"svg"!==t.tagName&&"text"!==t.tagName)return null;const{nature:e}=t.dataset;if((0,U.isNullOrUndefined)(e))return null;let n=null;switch(e){case"field":case"field-component":n=this.getField(t);break;case"layout":case"layout-component":n=this.getLayout(t);break;case"static":case"static-component":n=this.getStatic(t);break;case"algorithm":n=this.getAlgo(t);break;case"simulation":n=this.getSimulation(t);break;case"arrow":n=this.getArrow(t)}return n&&(n.environment=this),n}};var Qo=0;const Ko={createState(t,e){const{id:n,name:i}=t;let r="value"+Qo++,s=JSON.stringify(t.clone()),a=((0,U.formatDate)(new Date,"hh:dd"),(0,U.createI)({class:["ico","ico-delete"]},"✖")),o=(0,U.createButton)({class:["btn","btn-delete"],title:`Delete ${i} state`},a),l=(0,U.createDiv)({class:["model-state-preview"],title:`Preview ${i}`},e),c=(0,U.createSpan)({class:["model-state-content","fit-content"]},`${t.getName()}`),h=(0,U.createListItem)({class:["model-state"],title:`Restore ${i} state`,dataset:{id:r,concept:n}},[o,c,l]);h.addEventListener("click",(t=>{let e=function(t){const e=t=>t===h||t===o;return e(t)?t:(0,U.findAncestor)(t,(t=>e(t)),5)}(t.target);if(this.unhighlight(),e===o)this.removeState(r);else{let t=this.restore(s);this.removeState(r);let e=(0,U.getElement)(`.projection[data-concept="${t.id}"]`,this.body);e&&e.focus()}}));let u=`.projection[data-concept="${n}"]`;if(h.addEventListener("mouseenter",(t=>{let e=(0,U.getElement)(u,this.body);e&&this.highlight(e)})),h.addEventListener("mouseleave",(t=>{this.unhighlight()})),this.states.length>8){let{id:t}=this.stateList.lastChild.dataset;this.removeValue(t)}let d=Object.create({},{id:{value:r},object:{value:"value"},type:{value:"state"},element:{value:h},concept:{value:t},value:{value:s}});return this.addState(d),d},getState(t){if(!(0,U.isNullOrUndefined)(t)&&!(0,U.isEmpty)(this.states))return this.states[t]},addState(t){return this.stateList.append(t.element),this.states.push(t),this.refresh(),t},removeState(t){if((0,U.isNullOrUndefined)(t))return;const e=this.states.findIndex((e=>e.id===t));if(-1===e)return null;let n=this.states.splice(e,1)[0],{element:i}=n;return(0,U.removeChildren)(i).remove(),this.refresh(),this}},tl={"delete:value":t=>{const{id:e}=t.dataset;(void 0).conceptModel.removeValue(e),(void 0).header._valueSelector.update()},"delete:resource":t=>{const{id:e}=t.dataset;(void 0).removeResource(e)},"change-view":t=>{const{value:e}=t.dataset;(void 0).status.changeView(e)},"add-group":t=>{(void 0).status.addGroup()},"export--copy":t=>{(void 0).export(!0)}};var el=0;const nl={conceptModel:null,projectionModel:null,concept:null,activeConcept:null,activeProjection:null,activeReceiver:null,activeInstance:null,container:null,header:null,body:null,instanceSection:null,designSection:null,navigationSection:null,valueWindow:null,valueList:null,breadcrumb:null,filter:null,home:null,exporter:null,style:null,logs:null,status:null,group:null,input:null,copyValue:null,states:null,activeElement:null,decoratedElements:null,config:null,active:!1,visible:!1,frozen:!1,handlers:null,actions:null,attached:null,instances:null,windows:null,values:null,resources:null,models:null,errors:null,init(t={}){const{conceptModel:e,projectionModel:n,toolbar:i=[],config:r={},handlers:s={},actions:a={}}=t;this.config=Object.assign({},r),this.handlers=new Map,this.actions=new Map,this.attached=[],this.instances=new Map,this.windows=new Map,this.values=new Map,this.resources=new Map,this.models=new Map,this.errors=[],Object.assign(this,zt,Bt),this.states=[],this.decoratedElements=new Set;for(const t in s){const e=s[t];this.registerHandler(t,e)}return this.header=Yt.call(this).init(),this.home=Gt.call(this).init(),this.breadcrumb=Xt.call(this).init(),this.logs=Zt.call(this).init(),this.status=Jt.call(this).init(),this.exporter=Qt.call(this).init(),this.render(),Array.isArray(e)?this.loadConcepts(e):e&&this.loadConcept(e),Array.isArray(n)?this.loadProjections(n):n&&this.loadProjection(n),this.isReady?(this.conceptModel.getRootConcepts().forEach((t=>{this.createInstance(t)})),this.open()):(this.home.open(),this.refresh()),this},setConfig(t){return!(0,U.isNullOrUndefined)(t)&&(this.config=t,this.refresh(),this)},getConfig(t){return(0,U.isNullOrUndefined)(t)?this.config:this.config[t]},getName(){return(0,U.valOrDefault)(this.config.name,`editor${(new Date).getTime()}`)},createConcept(t){if((0,U.isNullOrUndefined)(t))throw new TypeError("Missing argument: The 'name' is required to create a concept");return this.conceptModel.isConcept(t)?this.conceptModel.createConcept(t):(this.notify(`The concept '${t}' is not defined in the model`,J.ERROR),!1)},addConcept(t){let e=t.concept||t;Array.isArray(e)?this.conceptModel.schema.push(...e):this.conceptModel.schema.push(e),this.refresh()},createProjection(t,e){if((0,U.isNullOrUndefined)(t))throw new TypeError("Missing argument: The 'concept' is required to create a projection");return this.projectionModel.hasConceptProjection(t,e)?this.projectionModel.createProjection(t,e).init():(this.notify(`The projection for the concept '${t.name}' is not defined in the model`,J.ERROR),!1)},addProjection(t){Array.isArray(t)?this.projectionModel.schema.projection.push(...t):this.projectionModel.addSchema(t),this.refresh()},download(t,e,n){let i;i=(0,U.isNullOrUndefined)(n)?Q.JSON:Q[n.toUpperCase()];const r=i.type;window.URL=window.webkitURL||window.URL;var s=(0,U.createAnchor)({class:["bare-link","download-item__link"]},"Download");(0,U.isNullOrWhitespace)(s.href)||window.URL.revokeObjectURL(s.href);var a=new Blob([JSON.stringify(t)],{type:r});return Object.assign(s,{download:e,href:window.URL.createObjectURL(a)}),s.dataset.downloadurl=[r,s.download,s.href].join(":"),s.click(),setTimeout((()=>{window.URL.revokeObjectURL(s.href),s.remove()}),1500),t},save(t,e){(0,U.isNullOrUndefined)(t)||(this.createState(t,e),this.refresh())},restore(t){let e=JSON.parse(t),n=this.conceptModel.getConcept(e.id);return n.restore(e),this.refresh(),n},undo(){if((0,U.isEmpty)(this.states))return void this.notify("There are no previous state",J.NORMAL,2e3);let t=(0,U.last)(this.states);this.restore(t.value),this.removeState(t.id)},notify(t,e,n=4500){let i=(0,U.createParagraph)({class:["notify"],html:t});const r="open";e&&i.classList.add(e),this.container.append(i),setTimeout((()=>{i.classList.add(r)}),50),setTimeout((()=>{i.classList.remove(r),setTimeout((()=>{i.remove()}),500)}),n)},addResource(t,e){let n=(0,U.valOrDefault)(e,t.name.split(".")[0]);this.resources.set(n,t);let i=new FileReader;return i.onload=t=>{const e=JSON.parse(i.result);this.addModel(n,e)},i.readAsText(t),this.refresh(),t},getResource(t){return this.resources.get(t)},hasResource(t){return this.resources.has(t)},removeResource(t){return this.resources.delete(t),this.triggerEvent({name:"resource.removed"}),this.refresh(),!0},addError(t){return this.errors.push(t),this.refresh(),$(this.status.editorstatusBadge),t},removeError(t){return this.errors.pop(),this.refresh(),!0},clearError(t){return this.errors=[],this.refresh(),!0},getModel(t){let e=this.models.get(t);return(0,U.isNullOrUndefined)(e)?null:JSON.parse(e)},addModel(t,e){this.models.set(t,e)},removeModel(t){return this.triggerEvent({name:"model.remove@pre",args:[t]},(()=>{this.models.delete(t),this.refresh(),this.triggerEvent({name:"model.remove@post"})}),!1),!0},hasModel(t){return this.models.has(t)},getValue(t){if(this.values.has(t))return this.values.get(t)},addValue(t){let e="value"+el++,n=(0,U.createI)({class:["ico","ico-copy"]}),i=(0,U.createI)({class:["ico","ico-delete"]},"✖"),r=(0,U.createButton)({class:["btn","btn-copy","fit-content"],title:`Copy ${t.name}`},[n,t.name]),s=(0,U.createButton)({class:["btn","btn-delete"]},i),a=(0,U.createListItem)({class:["model-value"],dataset:{id:e}},[r,s]);if(r.addEventListener("click",(e=>{this.copy(t)})),s.addEventListener("click",(t=>{this.removeValue(e)})),this.values.size>5){let{id:t}=this.valueList.lastChild.dataset;this.removeValue(t)}return this.valueList.prepend(a),this.values.set(e,{element:a,value:t}),this.refresh(),t},removeValue(t){if((0,U.isNullOrUndefined)(t)||!this.values.has(t))return;let{element:e}=this.values.get(t);return(0,U.removeChildren)(e).remove(),this.values.delete(t),this.refresh(),this},copy(t,e=!1){return(0,U.isNullOrUndefined)(t)||(this.copyValue=t,(0,U.copytoClipboard)(JSON.stringify(t)),e&&this.addValue(t),this.notify(`${t.name} copied`,J.NORMAL)),this},paste(t,e){let n=(0,U.valOrDefault)(e,this.copyValue);if(!(0,U.isNullOrUndefined)(n)){if((0,U.isNullOrUndefined)(t)){let t=this.createConcept(n.name).init();t.setValue(n),this.createInstance(t)}else"prototype"===n.nature?t.setValue(n.value):t.setValue(n);return this}},show(){return this.triggerEvent({name:"editor.show@pre"},(()=>{B(this.container),this.attached.forEach((t=>t.show())),this.visible=!0,this.triggerEvent({name:"editor.show@post"})}),!1),this},hide(){return this.triggerEvent({name:"editor.hide@pre"},(()=>{q(this.container),this.attached.forEach((t=>t.hide())),this.visible=!1,this.triggerEvent({name:"editor.hide@post"})}),!1),this},toggle(){return this.triggerEvent({name:"editor.toggle@pre"},(()=>{F(this.container),this.visible=!this.visible,this.triggerEvent({name:"editor.toggle@post"})}),!1),this},open(){return this.triggerEvent({name:"editor.open@pre"},(()=>{this.show(),this.active=!0,this.isReady&&this.home.close(),this.triggerEvent({name:"editor.open@post"})}),!1),this},close(){return this.triggerEvent({name:"editor.close@pre"},(()=>{this.hide(),this.active=!1,this.done(),this.clear(),this.triggerEvent({name:"editor.close@post"})}),!1),this},destroy(){return this.triggerEvent({name:"editor.destroy@pre"},(()=>{this.hide(),this.done(),this.instances.forEach((t=>t.delete())),(0,U.removeChildren)(this.container).remove()}),!1),!0},freeze(){return this.triggerEvent({name:"editor.freeze@pre"},(()=>{this.frozen=!0,this.refresh(),this.triggerEvent({name:"editor.freeze@post"})}),!1),this},unfreeze(){return this.frozen=!1,this.refresh(),this},done(){return this.conceptModel&&this.conceptModel.done(),this.projectionModel&&this.projectionModel.done(),this},highlight(t){return(0,U.isHTMLElement)(t)?(function(t){(0,U.isHTMLElement)(t)&&t.classList.add(z)}(t),this.decoratedElements.add(t),this):this},unhighlight(t){return(0,U.isHTMLElement)(t)?(W(t),this.decoratedElements.delete(t),this):(this.decoratedElements.forEach((t=>W(t))),this.decoratedElements.clear(),this)},createWindow(){let t=(0,U.createDiv)({class:["editor-window"],tabindex:0});this.body.append(t)},clear(){return this.triggerEvent({name:"editor.clear@pre"},(()=>{this.instances.forEach((t=>t.delete())),this.instances.clear(),this.resources.clear(),this.models.clear(),this.states.forEach((t=>t.element.remove())),this.states=[],this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,this.refresh(),this.triggerEvent({name:"editor.clear@post"})}),!1),this},update(t,e,n){this.triggerEvent({name:t})},attach(t){this.attached.push(t)},detach(t){let e=this.attached.findIndex((e=>e===t));if(-1===e)return null;this.attached.splice(e,1)},render(t){const e=(0,U.createDocFragment)();if(this.home.isRendered||e.append(this.home.render()),this.header.isRendered||e.append(this.header.render()),this.exporter.isRendered||e.append(this.exporter.render()),(0,U.isHTMLElement)(this.navigationSection)||(this.navigationSection=(0,U.createSection)({class:["model-navigation-section"]}),this.viewSection=(0,U.createAside)({class:["model-view-section"]}),this.navigationSection.append(this.viewSection),e.append(this.navigationSection)),!(0,U.isHTMLElement)(this.body)){this.body=(0,U.createDiv)({class:["editor-body"],tabindex:0});let t=(0,U.createDiv)({class:["editor-body-main"],tabindex:0});this.instanceSection=(0,U.createSection)({class:["model-concept-section"]}),t.append(this.instanceSection),this.body.append(t),e.append(this.body)}return(0,U.isHTMLElement)(this.timeline)||(this.timeline=(0,U.createDiv)({class:["editor-timeline"]}),this.stateList=(0,U.createUnorderedList)({class:["bare-list","model-state-list"]}),this.timeline.append(this.stateList),e.append(this.timeline)),this.logs.isRendered||e.append(this.logs.render()),this.breadcrumb.isRendered||this.navigationSection.append(this.breadcrumb.render()),(0,U.isHTMLElement)(this.valueSection)||(this.valueSection=(0,U.createDiv)({class:["model-value-window"]}),this.valueList=(0,U.createUnorderedList)({class:["bare-list","model-value-list"]}),this.valueSection.append(this.valueList),this.navigationSection.append(this.valueSection)),this.status.isRendered||e.append(this.status.render()),(0,U.isHTMLElement)(this.input)||(this.input=(0,U.createInput)({type:"file",class:["hidden"],accept:".json,.jsoncp"}),e.append(this.input)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),(0,U.isHTMLElement)(t)&&t.append(this.container),this.refresh(),this.container},refresh(t=!1){return this.frozen&&!t||(this.home.isOpen?this.container.classList.add("unfocus"):this.container.classList.remove("unfocus"),this.hasValues?B(this.valueWindow):q(this.valueWindow),this.header.refresh(),this.breadcrumb.refresh(),this.home.refresh(),this.logs.refresh(),this.status.refresh(),this.instanceSection.dataset.view=this.status.view,["grid"].includes(this.status.view)?q(this.viewSection):["tab"].includes(this.status.view)&&B(this.viewSection),(0,U.isEmpty)(this.states)?q(this.timeline):(B(this.timeline),this.states.forEach((t=>{this.conceptModel.hasConcept(t.concept.id)?this.hasActiveConcept&&this.activeConcept===t.concept?t.element.classList.add("active"):t.element.classList.remove("active"):this.removeState(t.id)})))),this},updateActiveElement(t){return this.activeElement&&this.activeElement===t||(this.activeElement=t,this.triggerEvent({name:"editor.element@active:updated"})),this},updateActiveConcept(t){return this.hasActiveConcept&&this.activeConcept===t||(this.activeConcept=t,this.triggerEvent({name:"editor.concept@active:updated"}),this.refresh()),this},updateActiveProjection(t){if(this.activeProjection&&this.activeProjection===t)return this;let e=(0,U.getElements)(".active-parent",this.body);for(let t=0;t<e.length;t++)e[t].classList.remove("active-parent");this.activeProjection=t;let n=this.activeProjection.parent;for(;n;)n.getContainer().classList.add("active-parent"),n=n.parent;return this.triggerEvent({name:"editor.projection@active:updated"}),this.refresh(),this},updateActiveInstance(t){if(this.activeInstance){if(this.activeInstance===t)return this;this.activeInstance,this.activeInstance.container.classList.remove("active")}return this.activeInstance=t,this.activeInstance.container.classList.add("active"),this.triggerEvent({name:"editor.instance@active:updated"}),this.refresh(),this},registerReceiver(t,e){(0,U.isNullOrUndefined)(this.receivers)&&(this.receivers={}),(0,U.isNullOrUndefined)(this.receivers[e])?this.receivers[e]={root:t,projections:[t]}:this.receivers[e].projections.push(t),this.setActiveReceiver(t,e)},setActiveReceiver(t,e){(0,U.isNullOrUndefined)(this.activeReceiver)&&(this.activeReceiver={}),this.activeReceiver[e]=t},getActiveReceiver(t){return this.activeReceiver[t]},getReceivers(t){return this.receivers[t].projections},getRootReceiver(t){return this.receivers[t].root},bindEvents(){var t=null,e=null;const n={[G.up_arrow]:"up",[G.right_arrow]:"right",[G.down_arrow]:"down",[G.left_arrow]:"left"};this.container.addEventListener("click",(t=>{var e=function(t){const e=t=>!(0,U.hasOwn)(t.dataset,"ignore");return e(t)?t:(0,U.findAncestor)(t,e,10)}(t.target);const{action:n,context:i,id:r}=e.dataset;if("instance"===i)return void this.getInstance(r).actionHandler(n);if("menu"===i)return void this.home.actionHandler(n,e);if(this.activeElement&&this.activeElement.clickHandler(e),(0,U.isNullOrUndefined)(n))return;if(this.actions.has(n))return this.actions.get(n).call(this,e),void e.blur();const s=tl[n];(0,U.isFunction)(s)?(s(e),e.blur()):n&&this.triggerEvent({name:n,args:e})}),!0),this.input.addEventListener("change",(t=>{let n=this.input.files[0];this.load(n,e),this.input.value=""})),this.body.addEventListener("copy",(t=>{if(!nt(t.target)){let e=this.activeConcept.copy(!1);this.copy(e,!0),t.preventDefault()}})),this.body.addEventListener("keydown",(e=>{const{target:i}=e,{nature:r}=i.dataset;var s=!1;switch(e.key){case G.backspace:this.activeElement&&t!==G.ctrl&&!0===this.activeElement.backspaceHandler(i)&&e.preventDefault();break;case G.ctrl:case G.shift:e.preventDefault(),s=!0;break;case G.delete:this.activeElement&&t!==G.ctrl&&!nt(i)&&this.activeElement.deleteHandler(i)&&e.preventDefault();break;case G.spacebar:this.activeElement&&t!==G.ctrl&&this.activeElement.spaceHandler(i)&&e.preventDefault();break;case G.alt:e.preventDefault();break;case G.enter:this.activeElement?!0===this.activeElement.enterHandler(i)&&e.preventDefault():"concept-container"===r?this.activeInstance.projection.focus():"editable"===r?i.blur():"BUTTON"===i.tagName?(i.click(),e.preventDefault()):e.preventDefault();break;case G.escape:this.activeElement&&(!0===this.activeElement.escapeHandler(i)?e.preventDefault():(0,U.findAncestor)(i,(t=>0===t.tabIndex)).focus());break;case G.insert:this.activeElement&&e.preventDefault();break;case G.up_arrow:case G.right_arrow:case G.down_arrow:case G.left_arrow:if(this.activeElement&&![G.ctrl,G.shift,G.alt].includes(t))!0===this.activeElement.arrowHandler(n[e.key],i)&&e.preventDefault();else if("concept-container"===r&&![G.ctrl,G.shift,G.alt].includes(t)){let t=ct(i,n[e.key],this.instanceSection);if(!(0,U.isHTMLElement)(t))return!1;t.focus()}break;case"s":t===G.ctrl&&(this.activeConcept.copy(),this.header.valueCount++,this.refresh(),e.preventDefault());break;case"c":if(t===G.ctrl){let t=new ClipboardEvent("copy");this.body.dispatchEvent(t)}break;case"v":if(t===G.ctrl){if(nt(i))return;this.paste(this.activeConcept,this.copyValue)}break;case"e":t===G.ctrl&&this.activeConcept&&(this.createInstance(this.activeConcept,this.activeProjection,{type:"projection",close:"DELETE-PROJECTION"}),e.preventDefault());break;case"f":break;case"z":t===G.ctrl&&(nt(i)||(this.undo(),e.preventDefault()))}s&&(t=e.key)}),!1),this.body.addEventListener("keyup",(e=>{var i=e.target;const{nature:r}=i.dataset;switch(e.key){case G.spacebar:this.activeElement&&t===G.ctrl&&this.activeElement._spaceHandler(i);break;case G.delete:this.activeElement&&t===G.ctrl&&this.activeElement.delete(i);break;case G.alt:break;case G.up_arrow:case G.down_arrow:case G.right_arrow:case G.left_arrow:if(this.activeElement&&t===G.ctrl)!0===this.activeElement._arrowHandler(n[e.key],i)&&e.preventDefault();else if("concept-container"===r&&t===G.ctrl){let r=ct(i,n[e.key],this.instanceSection);if(!(0,U.isHTMLElement)(r))return!1;this.swapInstance(i,r,!0),i.focus(),t=G.ctrl}}t===e.key&&(t=-1)}),!1),this.body.addEventListener("focusin",(e=>{const{target:n}=e,i=this.resolveElement(n);if(t=-1,i?(this.activeElement&&this.activeElement!==i&&(this.activeElement.focusOut(),this.activeElement=null),this.updateActiveElement(i),this.activeElement.focusIn(n)):(this.activeElement&&this.activeElement.focusOut(n),this.activeElement=null),this.activeElement){let t=this.activeElement.projection;this.updateActiveProjection(t),this.updateActiveConcept(t.concept)}else this.activeConcept=null,this.activeProjection=null;this.refresh()})),this.registerHandler("value.changed",(()=>this.refresh())),this.registerHandler("value.added",(()=>this.refresh())),this.registerHandler("value.removed",(()=>this.refresh())),this.registerHandler("export.model",(()=>this.exporter.open())),this.registerHandler("home",(t=>{this.home.toggle()})),this.registerHandler("logs",(t=>{this.logs.toggle()})),this.registerHandler("export",(t=>{this.export()})),this.registerHandler("load",(t=>{let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)})),this.registerHandler("load-resource",(t=>{let n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});e=t[0],this.input.dispatchEvent(n)})),this.registerHandler("load-concept",(t=>{let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)})),this.registerHandler("load-projection",(t=>{let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)})),this.registerHandler("unload",(t=>{this.unload()})),this.registerHandler("unload-concept",(t=>{this.unloadAllConcept()})),this.registerHandler("unload-projection",(t=>{this.unloadAllProjection()})),this.registerHandler("download-concept",(t=>{const{schema:e,values:n}=this.conceptModel;let i=this.getName().toLowerCase().replace(/\s+/g," ").replace(" ","_");this.download({concept:e},`${i}_model`,"JSON")})),this.registerHandler("open",(t=>{const{context:e}=t.dataset;e?this[e].open():this.open()})),this.registerHandler("close",(t=>{const{context:e,id:n,type:i}=t.dataset;e?this[e].close():this.close()})),this.registerHandler("collapse",(t=>{const{rel:e,target:n}=t.dataset;if("parent"===e){let e=(0,U.findAncestor)(t,(t=>t.dataset.name===n));if((0,U.isHTMLElement)(e)){const{alias:n=""}=e.dataset;e.classList.toggle("collapsed");let i=e.classList.contains("collapsed");t.dataset.state=i?"ON":"OFF",t.title=i?`Expand ${n.toLowerCase()}`:`Collapse ${n.toLowerCase()}`}}})),this.registerHandler("delete",(t=>{const{target:e}=t.dataset;if("parent"===e){let e=t.parentElement;(0,U.removeChildren)(e),e.remove()}})),this.registerHandler("create-instance",(t=>{const{concept:e}=t.dataset;let n=this.createConcept(e);this.createInstance(n)})),this.registerHandler("create-instance:value",(t=>{const{id:e}=t.dataset;let n=this.conceptModel.getValue(e),i=this.createConcept(n.name);i.initValue(n),this.createInstance(i)})),this.registerHandler("copy:value",(t=>{const{id:e}=t.dataset;let n=this.conceptModel.getValue(e);this.copy(n)}))}},il=Object.assign(Ko,Jo,Zo,Kt,tl,nl);Object.defineProperty(il,"hasConceptModel",{get(){return!(0,U.isNullOrUndefined)(this.conceptModel)}}),Object.defineProperty(il,"hasProjectionModel",{get(){return!(0,U.isNullOrUndefined)(this.projectionModel)}}),Object.defineProperty(il,"hasInstances",{get(){return this.instances.size>0}}),Object.defineProperty(il,"hasWindows",{get(){return this.windows.size>0}}),Object.defineProperty(il,"hasValues",{get(){return this.values.size>0}}),Object.defineProperty(il,"isReady",{get(){return this.hasConceptModel&&this.hasProjectionModel}}),Object.defineProperty(il,"hasActiveConcept",{get(){return!(0,U.isNullOrUndefined)(this.activeConcept)}}),Object.defineProperty(il,"hasActiveProjection",{get(){return!(0,U.isNullOrUndefined)(this.activeProjection)}}),Object.defineProperty(il,"hasActiveInstance",{get(){return!(0,U.isNullOrUndefined)(this.activeInstance)}}),Object.defineProperty(il,"hasError",{get(){return!(0,U.isEmpty)(this.errors)}});const rl="editor",sl=n(848),al=n(8837),ol=n(2422),ll=(t,e,n=!1)=>((t,e)=>t.getAttributeByName(e).target)(t,e).getValue(n),cl=(t,e)=>t.isAttributeCreated(e),hl=function(){const t=ft(".app-editor"),e=(t=>(0,U.isHTMLElement)(t)&&(0,U.hasOwn)(t.dataset,"gentleman"))(t)?[t]:(0,U.getElements)(`[data-gentleman="${rl}"]`,t),n=[];return e.forEach((t=>{n.push(function(t){let e=ft(t);return(0,U.isHTMLElement)(t)||(e=(0,U.createDiv)({tabindex:-1})),e.classList.add(`gentleman-${rl}`),e.dataset.gentleman=rl,Object.create(il,{object:{value:"environment"},type:{value:rl},name:{value:`gentleman ${rl}`},container:{value:e}})}(t))})),n}()[0],ul=(0,U.getElement)(".app-preview");function dl(t){let e=[],n=[],i=ll(t,"title");return ll(t,"questions").forEach((t=>{const n=ll(t,"type",!0);e.push(pl(t,n))})),ll(t,"groups").forEach((t=>{n.push(function(t){let e=[];return ll(t,"questions").forEach((t=>{const n=ll(t,"type",!0);e.push(pl(t,n))})),{name:ll(t,"name"),order:ll(t,"order"),condition:ll(t,"expression"),questions:e}}(t))})),{title:i,questions:e,groups:n}}function pl(t,e){return{name:ll(t,"name"),order:ll(t,"order"),label:ll(t,"label"),type:fl(e),options:ml(e),condition:cl(t,"expression")?ll(t,"expression"):null,required:ll(t,"required")}}function fl(t){return(0,U.isNullOrUndefined)(t)?null:t.getProperty("alias")}function ml(t){if((0,U.isNullOrUndefined)(t))return null;let e={};if("boolean"===t.getProperty("alias"))return e.checked=ll(t,"default"),e;const n=[["default","value"],["minLength","minlength"],["maxLength","maxlength"],["min","min"],["max","max"],["increment","step"],["multiple","multiple"],["regex","pattern"],["formula","formula"]];for(const[i,r]of n)if(cl(t,i)){const n=ll(t,i);null!=n&&(e[r]=n)}return e}function gl(t){const{name:e,label:n,type:i,options:r={},condition:s,required:a}=t,o=(0,U.createDiv)({class:["form-question",e],dataset:{name:"name",cond:s}});let l;switch(i){case"boolean":l=(0,U.createInput)({name:e,type:"checkbox",checked:r.default||!1});break;case"string":l=(0,U.createInput)({name:e,type:"text",minlength:r.minLength,maxlength:r.maxLength,value:r.default||""});break;case"int":l=(0,U.createInput)({name:e,type:"number",min:r.min,max:r.max,step:1,value:r.default??""});break;case"decimal":l=(0,U.createInput)({name:e,type:"number",min:r.min,max:r.max,step:vl(r.decimal??2),inputMode:"decimal",value:r.default??""});break;case"money":const t=(0,U.createInput)({name:e,type:"number",min:r.min,max:r.max,step:vl(r.decimal??2),inputMode:"decimal",value:r.default??""});l=(0,U.createDiv)({class:["input-money-wrapper"]},[createSpan({class:["money-symbol"]},r.symbol||"$"),t]);break;case"range":l=(0,U.createInput)({name:e,type:"range",min:r.min,max:r.max,step:r.increment??1,value:r.default??r.min??0});break;case"date":l=(0,U.createInput)({name:e,type:"date",value:r.default??""});break;case"enum":l=r.multiple?(0,U.createDiv)({class:["checkbox-group"]},(r.options||[]).map((t=>(0,U.createLabel)({},[(0,U.createInput)({type:"checkbox",name:e,value:t}),t])))):createSelect({name:e},(r.options||[]).map((t=>createOption({value:t,selected:t===r.default},t))));break;case"computed":l=(0,U.createDiv)({class:["computed-field"],dataset:{formula:r.formula||""}},"");break;default:console.warn(`Unsupported question type: ${i}`),l=(0,U.createInput)({name:e,type:"text"})}if(s&&(o.classList.add("conditional"),o.hidden=!0),a&&(o.classList.add("required"),l.required=a),"money"===i){const t=(0,U.createDiv)({class:["input-money-wrapper"]});t.append(createSpan({},"$"),l),l=t}const c=n?(0,U.createLabel)({class:["form-label"]},[n,l]):l;return o.append(c),o}function bl(t){let e=0;return t.map(((t,n)=>{let i;return i=null==t.order||isNaN(t.order)?e:Number(t.order),i<=e&&(i=e+1),e=i,{...t,_effectiveOrder:i}}))}function vl(t=2){return Number((1/Math.pow(10,t)).toFixed(t))}function yl(t,e){const n=e.elements[t];if(n){if("checkbox"===n.type)return n.checked;if("number"===n.type){const t=parseFloat(n.value);return isNaN(t)?0:t}return n.value}}function xl(t,e){const n=function(t){const e=t.match(/\$[a-zA-Z_][a-zA-Z0-9_]*/g)||[];return[...new Set(e.map((t=>t.slice(1))))]}(t),i={};for(const t of n)i[t]=yl(t,e);return i}function wl(t,e={}){if(!t.trim())throw new Error("Empty formula.");const n=t.replace(/\$[a-zA-Z_][a-zA-Z0-9_]*/g,(t=>{const n=t.slice(1),i=e[n];if(void 0===i)throw new Error(`Variable "${n}" is not defined.`);return"string"==typeof i?`"${i}"`:i}));try{return Function(`"use strict"; return (${n})`)()}catch(t){throw new Error(`Invalid expression: ${t.message}`)}}function El(t,e={}){const n=[],i=t.match(/\$[a-zA-Z_][a-zA-Z0-9_]*/g)||[],r=[...new Set(i)];for(const t of r)t.slice(1)in e||n.push(`Variable "${t}" is not defined.`);(t.match(/\(/g)||[]).length!==(t.match(/\)/g)||[]).length&&n.push("Mismatched parentheses.");try{const e=t.replace(/\$[a-zA-Z_][a-zA-Z0-9_]*/g,"1");Function(`"use strict"; return (${e})`)}catch(t){n.push(`Syntax error: ${t.message}`)}return n}ul.hidden=!0,hl.init({config:ol,conceptModel:[sl],projectionModel:[al],handlers:{"build-form":function(t){!function(t){const e=(0,U.createForm)({class:["form"]}),n=(0,U.createH2)({class:["form-title"]},t.title),i=bl(t.questions||[]).sort(((t,e)=>t._effectiveOrder-e._effectiveOrder));let r=(0,U.createDiv)({class:["questions"]},i.map((t=>gl(t))));const s=bl(t.groups||[]).sort(((t,e)=>t._effectiveOrder-e._effectiveOrder)).map((t=>{const e=(0,U.createH3)({},t.name),n=bl(t.questions||[]).sort(((t,e)=>t._effectiveOrder-e._effectiveOrder)).map(gl);return(0,U.createDiv)({class:["group"]},[e,...n])}));let a=(0,U.createButton)({class:["btn"]},"Close"),o=(0,U.createDiv)({class:["form-result"]});(0,U.removeChildren)(ul),e.append(n,r,...s,o,a),a.addEventListener("click",(t=>{ul.hidden=!0})),e.addEventListener("change",(t=>{!function(t){const e=(0,U.getElements)(".conditional",t),n=(0,U.getElement)(".form-result",t);(0,U.removeChildren)(n);for(let i=0;i<e.length;i++){const r=e[i],{cond:s}=r.dataset,a=xl(s,t),o=El(s,a);if(o.length)n.appendChild((0,U.createParagraph)({class:["error"]},`Error: ${o.join(", ")}`));else try{r.hidden=!wl(s,a)}catch(t){n.appendChild((0,U.createParagraph)({class:["error"]},`Runtime error: ${t.message}`))}}const i=(0,U.getElements)(".computed-field",t);for(let e=0;e<i.length;e++){const n=i[e],r=n.dataset.formula,s=xl(r,t);try{const t=wl(r,s);n.textContent=t}catch(t){n.textContent=`${t.message}`}}}(e)})),ul.appendChild(e),ul.hidden=!1}(dl(this.activeInstance.concept))},"download-form":function(t){const e=dl(this.activeInstance.concept);this.download(e,"form-model")}}}),hl.home.close(),hl.exporter.close();const Al={editorInstance:null,survey:null,container:null,menu:null,items:null,views:null,selectedItem:null,init(t,e){return this.container=t,this.items=new Map,this.views=new Map,this.editor=e,this.bindDOM(),this.bindEvents(),this.render(),this},get hasSelectedItem(){return(0,U.isHTMLElement)(this.selectedItem)},getItemName:t=>(0,U.isHTMLElement)(t)?t.dataset.cmsName:null,refresh(){this.container.dataset.item=this.hasSelectedItem?this.getItemName(this.selectedItem):""},render(){return this.instance||(this.survey=this.editor.createConcept("survey"),this.editorInstance=this.editor.createInstance(this.survey),this.editorInstance.full(),this.refresh()),this},updateView(){let t=this.getItemName(this.selectedItem);if((0,U.isNullOrUndefined)(t)||!(0,U.hasOwn)(Tags,t))return;let e=Tags[t],n=this.editorInstance.projection,i=n.findView(e);if(-1===i)return!1;n.changeView(i),this.editorInstance.setTitle("Survey"),this.refresh()},bindDOM(){this.menu=(0,U.getElement)('[data-cms="menu"]'),(0,U.getElements)('[data-cms="menu-item"]',this.menu).forEach((t=>{const{cmsName:e}=t.dataset;this.items.set(e,t)}))},bindEvents(){}};Al.init((0,U.getElement)(".page-body"),hl)})()})();